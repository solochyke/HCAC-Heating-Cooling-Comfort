"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[10733],{975901:function(e,t,n){n.d(t,{I:function(){return I}});var o=n(676422),i=n.n(o),s=n(399179),r=n(173541),a=n(505892),c=n(781872),l=n(202784),d=n(945444),p=n(227711),u=n(552322);const h=e=>(0,u.jsxs)("div",{className:i().dynamic([["2064265997",[c.DM.WARNING_LIGHT,c.DM.GRAY_200]]])+" warning-bubble",children:[(0,u.jsxs)("span",{className:i().dynamic([["2064265997",[c.DM.WARNING_LIGHT,c.DM.GRAY_200]]]),children:[e.counter," "]}),(0,u.jsx)(i(),{id:"2064265997",dynamic:[c.DM.WARNING_LIGHT,c.DM.GRAY_200],children:[`.warning-bubble.__jsx-style-dynamic-selector{background-color:${c.DM.WARNING_LIGHT};display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;border-radius:50%;width:16px;height:16px;color:${c.DM.GRAY_200};}`]})]});var y=n(893291),m=n(282147),f=n(868231),g=n(378888),_=n(63193);const b=l.lazy((()=>Promise.all([n.e(19837),n.e(38429)]).then(n.bind(n,438429)))),I=e=>{var t,n,o,I;const{title:v,onDismiss:w,onChange:O,onSecondaryButtonClick:j,submitButton:S,secondaryButton:N,code:D,submitButtonState:E,language:T,isFormatting:P,validationErrors:C,contextData:x,actions:A}=e,{0:F,1:k}=(0,l.useState)(!1),{0:R,1:M}=(0,l.useState)([]),{0:U,1:Z}=(0,l.useState)(-1),L=(0,l.useRef)(e.submitButtonState),B=(0,l.useRef)(null);(0,l.useEffect)((()=>{L.current=e.submitButtonState}),[e.submitButtonState]),(0,l.useEffect)((()=>{if(!C)return M([]),void Z(-1);const e=C.map((e=>e.line?{line:e.line,message:e.message||e.label,severity:e.severity}:null)).filter((e=>e));var t,n;(M(e),e.length)?null===(t=document.getElementById("expand-button"))||void 0===t||t.classList.add("expand-button-warning"):null===(n=document.getElementById("expand-button"))||void 0===n||n.classList.remove("expand-button-warning")}),[C]);return(0,u.jsxs)("div",{ref:B,className:`jsx-${d.I.__hash} content-modal-wrapper`,children:[(0,u.jsxs)("div",{className:`jsx-${d.I.__hash} content-modal-header`,children:[(0,u.jsx)("p",{className:`jsx-${d.I.__hash} content-modal-title`,children:v.toUpperCase()}),(0,u.jsx)(r.z,{style:"transparent",onClick:w,children:(0,u.jsx)(a.J,{type:"actions/close",size:14,color:c.DM.GRAY_900})})]}),(0,u.jsxs)("div",{className:`jsx-${d.I.__hash} content-modal-children`,children:[(0,u.jsx)("div",{id:"content-modal-editor",className:`jsx-${d.I.__hash} content-modal-editor`,children:(0,u.jsx)(l.Suspense,{fallback:(0,u.jsxs)("div",{className:`jsx-${d.I.__hash} fallback-container`,children:[(0,u.jsx)(s.Z,{}),(0,u.jsx)(i(),{id:d.I.__hash,children:d.I})]}),children:(0,u.jsx)(b,{code:D||"",language:T,handleAutoSaveCode:()=>{var t;null!==(t=L.current)&&void 0!==t&&t.disabled||e.onSubmit()},onChange:e=>O(e||""),errors:R,highlightedLine:U,setHighlightedLine:Z,contextData:x,actions:A})})}),(0,u.jsxs)("div",{id:"right-panel-wrapper",className:`jsx-${d.I.__hash} right-panel-wrapper`,children:[(0,u.jsx)("div",{id:"expand-button",className:`jsx-${d.I.__hash} expand-button`,children:(0,u.jsx)(r.z,{style:"solid",colorScheme:"neutral",size:"small",onClick:()=>{var e,t,n,o,i,s,r,a,c,l,d,p,u,h,y,m;if(F)return null===(c=document.getElementById("right-panel-wrapper"))||void 0===c||c.classList.add("wrapper-collapsed"),null===(l=document.getElementById("right-panel-wrapper"))||void 0===l||l.classList.remove("wrapper-expanded"),null===(d=document.getElementById("right-panel"))||void 0===d||d.classList.add("panel-collapsed"),null===(p=document.getElementById("right-panel"))||void 0===p||p.classList.remove("panel-expanded"),null===(u=document.getElementById("expand-button"))||void 0===u||u.classList.add("arrow-collapsed"),null===(h=document.getElementById("expand-button"))||void 0===h||h.classList.remove("arrow-expanded"),null===(y=document.getElementById("content-modal-editor"))||void 0===y||y.classList.add("code-editor-full-width"),null===(m=document.getElementById("content-modal-editor"))||void 0===m||m.classList.remove("code-editor-half-width"),void k(!1);null===(e=document.getElementById("right-panel-wrapper"))||void 0===e||e.classList.add("wrapper-expanded"),null===(t=document.getElementById("right-panel-wrapper"))||void 0===t||t.classList.remove("wrapper-collapsed"),null===(n=document.getElementById("right-panel"))||void 0===n||n.classList.add("panel-expanded"),null===(o=document.getElementById("right-panel"))||void 0===o||o.classList.remove("panel-collapsed"),null===(i=document.getElementById("expand-button"))||void 0===i||i.classList.add("arrow-expanded"),null===(s=document.getElementById("expand-button"))||void 0===s||s.classList.remove("arrow-collapsed"),null===(r=document.getElementById("content-modal-editor"))||void 0===r||r.classList.add("code-editor-half-width"),null===(a=document.getElementById("content-modal-editor"))||void 0===a||a.classList.remove("code-editor-full-width"),k(!0)},children:(0,u.jsx)(a.J,{type:""+(F?"arrow-right":"arrow-left"),size:12,color:`${R.length?c.DM.GRAY_200:c.DM.GRAY_900}`})})}),(0,u.jsx)("div",{id:"right-panel",className:`jsx-${d.I.__hash} right-panel`,children:null!==(t=e.validationErrors)&&void 0!==t&&t.length?null===(n=e.validationErrors)||void 0===n?void 0:n.map(((e,t)=>(0,u.jsxs)("div",{onClick:()=>{e.line&&Z(e.line)},className:`jsx-${d.I.__hash} validator-section`,children:[(0,u.jsxs)("div",{className:`jsx-${d.I.__hash} validator-title`,children:[(0,u.jsx)("span",{className:`jsx-${d.I.__hash} validator-label`,children:e.label}),e.isValid?(0,u.jsx)(a.J,{size:8,type:"checkmark"}):void 0!==e.issuesCount?(0,u.jsx)(h,{counter:e.issuesCount||0}):null]}),(null===e||void 0===e?void 0:e.actions)&&e.actions.map(((e,t)=>(0,u.jsx)("div",{style:{display:"flex",flexDirection:"column",paddingTop:c.N_.TWO_UNITS},className:`jsx-${d.I.__hash}`,children:e.onClick?(0,u.jsx)(y.r,{onChange:e.onClick,label:e.description,defaultValue:e.state}):null},t)))]},t))):(0,u.jsx)("div",{className:`jsx-${d.I.__hash} validator-section`,children:(0,u.jsx)("span",{className:`jsx-${d.I.__hash}`,children:"\u2728 Everything looks good"})})})]})]}),(0,u.jsxs)("div",{className:`jsx-${d.I.__hash} content-modal-footer`,children:[(0,u.jsx)(r.z,{onClick:()=>{e.onFormat&&e.onFormat()},shape:"square",size:"large",cornerStyle:"sharp",style:"transparent",title:"Prettify code",children:P?(0,u.jsx)(m.$,{}):"{ }"}),null!==(o=e.validationErrors)&&void 0!==o&&o.length?(0,u.jsx)(p.g,{gap:"two",children:null===(I=e.validationErrors)||void 0===I?void 0:I.map((e=>e.displayInBottomBar?(0,u.jsxs)("div",{className:`jsx-${d.I.__hash} validator-title`,children:[e.label,e.isValid?(0,u.jsx)(a.J,{size:8,type:"checkmark"}):void 0!==e.issuesCount?(0,u.jsx)(h,{counter:e.issuesCount||0}):null]},e.label):null))}):null,(0,u.jsx)("span",{style:{color:c.DM.GRAY_600},className:`jsx-${d.I.__hash}`,children:(0,u.jsxs)("i",{className:`jsx-${d.I.__hash}`,children:[(0,g.z2)()?f.KEY_SYMBOLS.getCtrl(!0):`${f.KEY_SYMBOLS.getCtrl(!1)} + `,"S to save while editing"]})}),(0,u.jsx)("div",{className:`jsx-${d.I.__hash}`,children:(0,u.jsxs)(_.h,{alignment:"end",cornerStyle:"round",gap:"two",children:[N?(0,u.jsx)(r.z,{style:"outline",onClick:j,colorScheme:"neutral",children:N}):null,(0,u.jsx)(r.z,{refAttrs:{autoFocus:!0},onClick:()=>e.onSubmit(),isDisabled:null===E||void 0===E?void 0:E.disabled,isLoading:null===E||void 0===E?void 0:E.loading,colorScheme:null===E||void 0===E?void 0:E.colorScheme,style:null===E||void 0===E?void 0:E.style,children:S})]})})]}),(0,u.jsx)(i(),{id:d.I.__hash,children:d.I})]})}},945444:function(e,t,n){n.d(t,{I:function(){return i}});var o=n(781872);const i=[`.content-modal-wrapper.jsx-1656221708{background-color:${o.DM.GRAY_200};overflow:hidden;box-shadow:${o.E6.DEFAULT};border-radius:${o.n_.DEFAULT};display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;resize:both;height:500px;max-height:95vh;max-width:95vw;min-height:500px;min-width:800px;}`,"@media (max-width:800px){.content-modal-wrapper.jsx-1656221708{min-width:700px;}}",`.content-modal-header.jsx-1656221708{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:justify;-webkit-justify-content:space-between;-ms-flex-pack:justify;justify-content:space-between;padding:${o.N_.HALF_UNIT} ${o.N_.ONE_AND_HALF};border-bottom:0.5px solid ${o.GC.NEUTRAL};}`,`.content-modal-title.jsx-1656221708{font-size:${o.um.HEADING};font-weight:${o.Xw.MEDIUM_500};}`,".content-modal-children.jsx-1656221708{position:relative;-webkit-flex:1;-ms-flex:1;flex:1;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;}",".content-modal-editor.jsx-1656221708{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;position:relative;-webkit-flex:1;-ms-flex:1;flex:1;}",`.content-modal-footer.jsx-1656221708{padding-right:${o.N_.TWO_UNITS};display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:justify;-webkit-justify-content:space-between;-ms-flex-pack:justify;justify-content:space-between;border-top:0.5px solid ${o.GC.NEUTRAL};}`,`.validator-title.jsx-1656221708{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;gap:${o.N_.UNIT};-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;}`,".right-panel-wrapper.jsx-1656221708{position:absolute;right:0px;top:0px;bottom:0px;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;cursor:default;height:0px;}",`.right-panel.jsx-1656221708{background-color:${o.DM.GRAY_200};width:250px;border-left:0.5px solid ${o.GC.NEUTRAL};display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;overflow:scroll;-webkit-transform:translateX(100%);-ms-transform:translateX(100%);transform:translateX(100%);}`,`.expand-button.jsx-1656221708{position:absolute;left:-28px;top:0px;z-index:${o.kg.TEN};-webkit-transform:translateX(250px);-ms-transform:translateX(250px);transform:translateX(250px);}`,`.expand-button.jsx-1656221708 .pt-btn{background-color:${o.DM.GRAY_200};border-top-right-radius:0px;border-bottom-right-radius:0px;border:0.5px solid ${o.GC.NEUTRAL};border-right:0px;border-top:0px;}`,`.expand-button-warning.jsx-1656221708 .pt-btn,.expand-button-warning.jsx-1656221708 .pt-btn:hover{background-color:${o.DM.WARNING_LIGHT};}`,`.validator-label.jsx-1656221708{font-weight:${o.Xw.MEDIUM_600};}`,`.validator-section.jsx-1656221708{padding:${o.N_.TWO_UNITS};border-bottom:0.5px solid ${o.GC.NEUTRAL};display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;}`,".fallback-container.jsx-1656221708{min-height:500px;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;}","@-webkit-keyframes slide-in-jsx-1656221708{from{-webkit-transform:translateX(100%);-ms-transform:translateX(100%);transform:translateX(100%);}to{-webkit-transform:translateX(0%);-ms-transform:translateX(0%);transform:translateX(0%);}}","@keyframes slide-in-jsx-1656221708{from{-webkit-transform:translateX(100%);-ms-transform:translateX(100%);transform:translateX(100%);}to{-webkit-transform:translateX(0%);-ms-transform:translateX(0%);transform:translateX(0%);}}","@-webkit-keyframes arrow-in-jsx-1656221708{from{-webkit-transform:translateX(250px);-ms-transform:translateX(250px);transform:translateX(250px);}to{-webkit-transform:translateX(0%);-ms-transform:translateX(0%);transform:translateX(0%);}}","@keyframes arrow-in-jsx-1656221708{from{-webkit-transform:translateX(250px);-ms-transform:translateX(250px);transform:translateX(250px);}to{-webkit-transform:translateX(0%);-ms-transform:translateX(0%);transform:translateX(0%);}}","@-webkit-keyframes slide-out-jsx-1656221708{from{-webkit-transform:translateX(0%);-ms-transform:translateX(0%);transform:translateX(0%);}to{-webkit-transform:translateX(100%);-ms-transform:translateX(100%);transform:translateX(100%);}}","@keyframes slide-out-jsx-1656221708{from{-webkit-transform:translateX(0%);-ms-transform:translateX(0%);transform:translateX(0%);}to{-webkit-transform:translateX(100%);-ms-transform:translateX(100%);transform:translateX(100%);}}","@-webkit-keyframes panel-in-jsx-1656221708{from{height:0px;}5%{height:auto;}to{height:auto;}}","@keyframes panel-in-jsx-1656221708{from{height:0px;}5%{height:auto;}to{height:auto;}}","@-webkit-keyframes panel-out-jsx-1656221708{from{height:auto;}95%{height:auto;}to{height:0px;}}","@keyframes panel-out-jsx-1656221708{from{height:auto;}95%{height:auto;}to{height:0px;}}","@-webkit-keyframes code-editor-full-jsx-1656221708{from{width:550px;}to{width:800px;}}","@keyframes code-editor-full-jsx-1656221708{from{width:550px;}to{width:800px;}}","@-webkit-keyframes code-editor-half-jsx-1656221708{from{width:800px;}to{width:550px;}}","@keyframes code-editor-half-jsx-1656221708{from{width:800px;}to{width:550px;}}","@-webkit-keyframes arrow-out-jsx-1656221708{to{-webkit-transform:translateX(250px);-ms-transform:translateX(250px);transform:translateX(250px);}from{-webkit-transform:translateX(0%);-ms-transform:translateX(0%);transform:translateX(0%);}}","@keyframes arrow-out-jsx-1656221708{to{-webkit-transform:translateX(250px);-ms-transform:translateX(250px);transform:translateX(250px);}from{-webkit-transform:translateX(0%);-ms-transform:translateX(0%);transform:translateX(0%);}}",".arrow-expanded.jsx-1656221708{-webkit-animation:arrow-in-jsx-1656221708 1000ms;animation:arrow-in-jsx-1656221708 1000ms;-webkit-animation-fill-mode:forwards;animation-fill-mode:forwards;}",".arrow-collapsed.jsx-1656221708{-webkit-animation:arrow-out-jsx-1656221708 1000ms;animation:arrow-out-jsx-1656221708 1000ms;-webkit-animation-fill-mode:forwards;animation-fill-mode:forwards;}",".panel-expanded.jsx-1656221708{-webkit-animation-name:slide-in-jsx-1656221708;animation-name:slide-in-jsx-1656221708;-webkit-animation-duration:1000ms;animation-duration:1000ms;-webkit-animation-fill-mode:forwards;animation-fill-mode:forwards;}",".panel-collapsed.jsx-1656221708{-webkit-animation-name:slide-out-jsx-1656221708;animation-name:slide-out-jsx-1656221708;-webkit-animation-duration:1000ms;animation-duration:1000ms;-webkit-animation-fill-mode:forwards;animation-fill-mode:forwards;}",".wrapper-expanded.jsx-1656221708{-webkit-animation-name:panel-in-jsx-1656221708;animation-name:panel-in-jsx-1656221708;-webkit-animation-duration:1000ms;animation-duration:1000ms;-webkit-animation-fill-mode:forwards;animation-fill-mode:forwards;}",".wrapper-collapsed.jsx-1656221708{-webkit-animation-name:panel-out-jsx-1656221708;animation-name:panel-out-jsx-1656221708;-webkit-animation-duration:1000ms;animation-duration:1000ms;-webkit-animation-fill-mode:forwards;animation-fill-mode:forwards;}",".code-editor-full-width.jsx-1656221708{width:800px;-webkit-animation-name:code-editor-full-jsx-1656221708;animation-name:code-editor-full-jsx-1656221708;-webkit-animation-duration:1000ms;animation-duration:1000ms;-webkit-animation-fill-mode:forwards;animation-fill-mode:forwards;}",".code-editor-half-width.jsx-1656221708{width:550px;-webkit-animation-name:code-editor-half-jsx-1656221708;animation-name:code-editor-half-jsx-1656221708;-webkit-animation-duration:1000ms;animation-duration:1000ms;-webkit-animation-fill-mode:forwards;animation-fill-mode:forwards;}"];i.__hash="1656221708"},298384:function(e,t,n){n.d(t,{y:function(){return p}});var o=n(676422),i=n.n(o),s=(n(202784),n(930613)),r=n(16004),a=n(378888),c=n(505892),l=n(781872),d=n(552322);const p=e=>{const{asset:t,nestedLevel:n=0}=e;return(0,d.jsxs)("div",{className:i().dynamic([["3530597640",[l.N_.UNIT,n*r.ys,l.DM.GRAY_900]]])+" asset-wrapper",children:[(()=>{switch(t.type){case"image":{const e=(0,a.zo)(t,`&w=${s.ou.WZ}`);return(0,d.jsx)("div",{style:{backgroundImage:`url(${e})`,backgroundSize:"cover",backgroundPosition:"center center",backgroundRepeat:"no-repeat",width:`${r.$P}px`,height:`${r.$P}px`,borderRadius:l.n_.DISCRETE}})}case"video":{const e=(0,a.Bh)(t);return(0,d.jsx)("video",{src:e,width:r.$P,height:r.$P,style:{objectFit:"cover",borderRadius:l.n_.DEFAULT},muted:!0})}default:return(0,d.jsx)("div",{children:(0,d.jsx)(c.J,{type:"custom-files/file",size:16})})}})(),(0,d.jsx)("span",{className:i().dynamic([["3530597640",[l.N_.UNIT,n*r.ys,l.DM.GRAY_900]]]),children:t.name}),(0,d.jsx)(i(),{id:"3530597640",dynamic:[l.N_.UNIT,n*r.ys,l.DM.GRAY_900],children:[`.asset-wrapper.__jsx-style-dynamic-selector{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;gap:${l.N_.UNIT};height:28px;padding-left:${n*r.ys}px;}`,`.name.__jsx-style-dynamic-selector{color:${l.DM.GRAY_900};}`]})]})}},517805:function(e,t,n){n.d(t,{n:function(){return r}});var o=n(173541),i=(n(202784),n(884481)),s=n(552322);const r=e=>{const{title:t,description:n,onSubmit:r,buttonTitle:a}=e;return(0,s.jsxs)("div",{className:"wrapper",children:[(0,s.jsx)("p",{className:"modal-title",children:t}),(0,s.jsx)("p",{className:"modal-description",children:n}),(0,s.jsx)("div",{className:"modal-btns",children:(0,s.jsx)(o.z,{refAttrs:{autoFocus:!0},onClick:r,style:"solid",colorScheme:"neutral",children:a})}),(0,s.jsx)("style",{children:i.df}),(0,s.jsx)("style",{children:i.W2})]})}},533324:function(e,t,n){n.d(t,{H:function(){return D}});var o,i,s,r,a,c,l,d,p,u,h,y,m,f,g,_,b,I=n(503348),v=n(777460),w=n(918437),O=n(302503),j=n(205632),S=n(393181),N=n(975350);const D=new(o=(0,O.inject)("globalAppState"),i=(0,O.inject)("authUserFlow"),s=(0,O.inject)("sentryService"),r=(0,O.inject)("requestMaker"),a=(0,O.inject)("projectRepository"),c=(0,O.inject)("workspacesRepository"),l=(0,O.inject)("appInitFlow"),d=(0,O.inject)("anonymousLoginFlow"),p=class{constructor(){(0,I.Z)(this,"globalAppState",u,this),(0,I.Z)(this,"authUserFlow",h,this),(0,I.Z)(this,"sentryService",y,this),(0,I.Z)(this,"requestMaker",m,this),(0,I.Z)(this,"projectRepository",f,this),(0,I.Z)(this,"workspacesRepository",g,this),(0,I.Z)(this,"appInitFlow",_,this),(0,I.Z)(this,"anonymousLoginFlow",b,this),(0,v.Z)(this,"exec",(async e=>{const{data:t,allowAnonymous:n}=e||{};if(!t)return!1;const o=await this.appInitFlow.init();try{const e=await this.projectRepository.loadBySlug(t);if(!o&&e.accessType===S.W.PRIVATE)return j.default.replace(N.Pr),!1;if(e.accessType===S.W.CLONEABLE||e.accessType===S.W.PUBLIC){if(o||!n)return!0;await this.anonymousLoginFlow.login();if(!(await this.appInitFlow.init()))return!1}const{userData:i}=this.globalAppState.user;if(e.collaborators&&e.collaborators.find((e=>{var t;return(null===(t=e.account)||void 0===t?void 0:t.id)===(null===i||void 0===i?void 0:i.id)})))return!0}catch(i){return j.default.replace(N.Pr),!1}return!0}))}},u=(0,w.Z)(p.prototype,"globalAppState",[o],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),h=(0,w.Z)(p.prototype,"authUserFlow",[i],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),y=(0,w.Z)(p.prototype,"sentryService",[s],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),m=(0,w.Z)(p.prototype,"requestMaker",[r],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),f=(0,w.Z)(p.prototype,"projectRepository",[a],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),g=(0,w.Z)(p.prototype,"workspacesRepository",[c],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),_=(0,w.Z)(p.prototype,"appInitFlow",[l],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),b=(0,w.Z)(p.prototype,"anonymousLoginFlow",[d],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),p)},831140:function(e,t,n){var o,i=n(777460),s=n(302503);(0,s.provide)("thirdPartyAssetsService")(o=class{constructor(){(0,i.Z)(this,"unsplashURL","https://api.unsplash.com"),(0,i.Z)(this,"unsplashToken","4f172bfc2f56c64a432d464953df8d1a010144bba788f10505845607fdba5cea"),(0,i.Z)(this,"pexelURL","https://api.pexels.com/v1"),(0,i.Z)(this,"pexelToken","ActpA0oRJWsfKxNStY8jXKzivUBLpuYa6UUXxLL7f16WAMN7rURD6VVg")}async getCuratedUnsplash(e=1,t=24){return(await fetch(`${this.unsplashURL}/photos?page=${e}&per_page=${t}&client_id=${this.unsplashToken}`)).json()}async searchUnsplash(e,t=1,n=24){return(await fetch(`${this.unsplashURL}/search/photos?query=${e}&page=${t}&per_page=${n}&client_id=${this.unsplashToken}`)).json()}async getUnsplashAPIDownloadUrl(e){return(await fetch(`${e}&client_id=${this.unsplashToken}`)).json()}async getCuratedPexel(e=1,t=10){return(await fetch(`${this.unsplashURL}/curated/?page=${e}&per_page=${t}`,{headers:{Authorization:this.pexelToken}})).json()}async searchPexelVideo(e,t=1,n=10){return(await fetch(`${this.pexelURL}/videos/search?query=${e}&page=${t}&per_page=${n}`,{headers:{Authorization:this.pexelToken}})).json()}async searchPexel(e,t=1,n=10){return(await fetch(`${this.pexelURL}/search?query=${e}&page=${t}&per_page=${n}`,{headers:{Authorization:this.pexelToken}})).json()}async getRandomUnsplash(e,t){return(await fetch(`${this.unsplashURL}/photos/random?query=${e}&count=${t}&client_id=${this.unsplashToken}`)).json()}})},476535:function(e,t,n){n.d(t,{W:function(){return c}});var o=n(656733),i=n(302503),s=n(255328);const r=()=>i.DIContainer.getInstance().getSingletonClassInstance("guardsService"),a=(async()=>null).constructor;function c(e,t,n){const i=n.value,c=i instanceof a;n.value=async function(...e){const t=r(),n=!(!e[0]||!e[0].doc);if(t.getGuard(o._.DISABLE_HISTORY)&&n)return i.apply(this,e);if(n)return c?t.executeAsyncFunctionGuarded(o._.DISABLE_HISTORY,(async()=>await i.apply(this,e))):t.executeFunctionGuarded(o._.DISABLE_HISTORY,(()=>i.apply(this,e)));return function(e,t,n,i){const a=new s.b,c=r();if(c.getGuard(o._.DISABLE_HISTORY))return a.getDocForSyncCallback(e,t,n);if(i)return new Promise((i=>{c.executeFunctionGuarded(o._.DISABLE_HISTORY,(async()=>{const o=await a.getDocForSyncCallback(e,t,n);return i(o)}))}));return c.executeFunctionGuarded(o._.DISABLE_HISTORY,(()=>a.getDocForSyncCallback(e,t,n)))}(i,e,this,c)}}},255328:function(e,t,n){n.d(t,{P:function(){return _},b:function(){return I}});var o,i,s,r,a,c,l,d,p,u=n(503348),h=n(918437),y=n(656733),m=n(302503),f=n(395942);const g=(async()=>null).constructor;function _(e,t,n){const o=n.value;n.value=o instanceof g?async function(...e){if(!(!e[0]||!e[0].doc))return o.apply(this,e);return b(o,e,this)}:function(...e){if(!(!e[0]||!e[0].doc))return o.apply(this,e);return b(o,e,this,!0)}}function b(e,t,n,o){const i=new I;return o?i.getDocForSyncCallback(e,t,n):i.getDocForAsyncCallback(e,t,n)}let I=(o=(0,m.inject)("projectDoc"),i=(0,m.inject)("projectUIState"),s=(0,m.inject)("sharedbProjectSyncService"),r=(0,m.inject)("guardsService"),a=class{constructor(){(0,u.Z)(this,"projectDoc",c,this),(0,u.Z)(this,"projectUIState",l,this),(0,u.Z)(this,"dbSync",d,this),(0,u.Z)(this,"guardsService",p,this)}async getDocForAsyncCallback(e,t,n){return new Promise((o=>{(this.projectUIState.localWork.nodesUnderLocalWork||this.guardsService.getGuard(y._.VIRTUAL_WORK)?f.mutate:this.dbSync.mutate)(this.projectDoc,(async i=>{"object"===typeof t[0]?t[0].doc=i:t.push(i);const s=await e.apply(n,t);o(s)}))}))}getDocForSyncCallback(e,t,n){let o;return(this.projectUIState.localWork.nodesUnderLocalWork||this.guardsService.getGuard(y._.VIRTUAL_WORK)?f.mutate:this.dbSync.mutate)(this.projectDoc,(i=>{"object"===typeof t[0]?t[0].doc=i:t.push(i),o=e.apply(n,t)})),o}},c=(0,h.Z)(a.prototype,"projectDoc",[o],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),l=(0,h.Z)(a.prototype,"projectUIState",[i],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),d=(0,h.Z)(a.prototype,"dbSync",[s],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),p=(0,h.Z)(a.prototype,"guardsService",[r],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),a)},254068:function(e,t,n){n.d(t,{j:function(){return y},u:function(){return g}});var o,i,s,r,a,c=n(503348),l=n(777460),d=n(918437),p=n(302503),u=n(255328);function h(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}let y;!function(e){e.UPDATE_STYLE_KEY="setStyleKey",e.UPDATE_ATTR_KEY="setAttrKey",e.UPDATE_CLASS_STYLE="updateClassStyle",e.OVERRIDE_STYLE="overrideStyle",e.ADD_ASSET_PRIMITIVE="addAssetPrimitive",e.DELETE_NODES="deleteNodes",e.ADD_NODES="addNodes",e.COPY_NODES="copyNodes",e.COPY_STYLES="copyStyles",e.MOVE_NODES="moveNodes"}(y||(y={}));const m=["width","height","backgroundImage","minWidth","minHeight","maxWidth","maxHeight","listStyleImage"],f=(async()=>null).constructor;function g(e){return function(t,n,o){const i=o.value;let s=[];o.value=i instanceof f?async function(...t){s=_.runPreOptimisations(e,t);const n=await i.apply(this,t);return _.runOptimisations(e,t,n,s),n}:function(...t){s=_.runPreOptimisations(e,t);const n=i.apply(this,t);return _.runOptimisations(e,t,n,s),n}}}const _=new(o=(0,p.inject)("imageOptimisationFlow"),i=(0,p.inject)("projectUIState"),s=class{constructor(){(0,c.Z)(this,"imageOptimisationFlow",r,this),(0,c.Z)(this,"projectUIState",a,this)}runPreOptimisations(e,t){if(Object.keys(this.projectUIState.localWork.nodesUnderLocalWork||{}).length)return[];switch(e){case y.MOVE_NODES:return this.imageOptimisationFlow.getAssetsLinkedToNodes({nodeIds:t[0].nodes.reduce(((e,n)=>{var o;return null===(o=t[0].doc)||void 0===o||o.nodes.bfs(n.id,(t=>{e.push(t.id)}),!0),e}),[]),doc:t[0].doc});case y.COPY_NODES:return this.imageOptimisationFlow.getAssetsLinkedToNodes({nodeIds:t[0].nodes.reduce(((e,n)=>{var o;return null===(o=t[0].doc)||void 0===o||o.nodes.bfs(n.id,(t=>{e.push(t.id)}),!0),e}),[]),doc:t[0].doc});case y.COPY_STYLES:const{targets:e,doc:o}=t[0];return this.imageOptimisationFlow.getAssetsLinkedToNodes({nodeIds:e,doc:o});case y.UPDATE_STYLE_KEY:const i=t[0],{nodeIds:s,doc:r,key:a}=i;return m.includes(a)?this.imageOptimisationFlow.getAssetsLinkedToNodes({nodeIds:s,doc:r}):[];case y.OVERRIDE_STYLE:return this.imageOptimisationFlow.getAssetsLinkedToNodes(function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?h(Object(n),!0).forEach((function(t){(0,l.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):h(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},t[0]));case y.UPDATE_ATTR_KEY:const c=t[0];if(!c.doc)return[];const d=c.doc.nodes.getById(c.nodeId);if(this.isUpdateAttrByKeyParams(c)&&c.propId&&d&&c.doc.nodes.nodeIsCompInstance(d)){var n;const e=null===(n=c.doc)||void 0===n?void 0:n.components.byId[d.compIdOfCompInstance],t=null===e||void 0===e?void 0:e.propDefinitions[c.propId];return this.imageOptimisationFlow.getAssetsLinkedToNodes({nodeIds:Object.keys((null===t||void 0===t?void 0:t.locations)||{}),doc:c.doc})}return this.imageOptimisationFlow.getAssetsLinkedToNodes({nodeIds:[c.nodeId],doc:c.doc});default:return[]}}runOptimisations(e,t,n,o){var i,s;if(Object.keys(this.projectUIState.localWork.nodesUnderLocalWork||{}).length)return;const r=null===(i=t[0])||void 0===i?void 0:i.doc;switch(e){case y.ADD_NODES:const e=t[0].nodes.map((e=>e.id));return this.runOptimisationForNodes({nodeIds:e,doc:r,unsplashOnly:!0});case y.ADD_ASSET_PRIMITIVE:return this.runOptimisationsForAssets({assetIds:n,doc:t[0].doc});case y.MOVE_NODES:case y.COPY_NODES:return this.runOptimisationsForAssets({assetIds:o,doc:r});case y.COPY_STYLES:const{targets:i,doc:a}=t[0],c=this.imageOptimisationFlow.getAssetsLinkedToNodes({nodeIds:i,doc:a}),l=Array.from(new Set([...c,...o]));return this.runOptimisationsForAssets({assetIds:l,doc:r});case y.UPDATE_STYLE_KEY:const d=t[0],{nodeIds:p,doc:u,key:h}=d;if(!m.includes(h))return[];const f=["width","height"].includes(h),g=this.imageOptimisationFlow.getAssetsLinkedToNodes({nodeIds:p,doc:u,withDescendants:f}),_=Array.from(new Set([...g,...o]));return this.runOptimisationForNodes({nodeIds:p,unsplashOnly:!0,recomputeChildren:f,doc:r}),this.runOptimisationsForAssets({assetIds:_,doc:r});case y.OVERRIDE_STYLE:const b=t[0].nodeIds,I=this.imageOptimisationFlow.getAssetsLinkedToNodes({nodeIds:b,withDescendants:!0});this.runOptimisationForNodes({nodeIds:b,unsplashOnly:!0,recomputeChildren:!0});const v=Array.from(new Set([...I,...o]));return this.runOptimisationsForAssets({assetIds:v,doc:r});case y.DELETE_NODES:return this.runOptimisationsForAssets({doc:null===(s=t[0])||void 0===s?void 0:s.doc,assetIds:o});case y.UPDATE_ATTR_KEY:const w=t[0];if(!r)return[];const O=r.nodes.getById(w.nodeId);if(this.isUpdateAttrByKeyParams(w)&&w.propId&&O&&r.nodes.nodeIsCompInstance(O)){const e=null===r||void 0===r?void 0:r.components.byId[O.compIdOfCompInstance],t=null===e||void 0===e?void 0:e.propDefinitions[w.propId],n=this.imageOptimisationFlow.getAssetsLinkedToNodes({nodeIds:Object.keys((null===t||void 0===t?void 0:t.locations)||{}),doc:r}),i=Array.from(new Set([...n,...o]));return this.runOptimisationForNodes({nodeIds:Object.keys((null===t||void 0===t?void 0:t.locations)||{}),unsplashOnly:!0,doc:r}),this.runOptimisationsForAssets({assetIds:i,doc:r})}this.runOptimisationForNodes({nodeIds:[w.nodeId],unsplashOnly:!0,doc:r});const j=this.imageOptimisationFlow.getAssetsLinkedToNodes({nodeIds:[w.nodeId],doc:r}),S=Array.from(new Set([...j,...o]));return this.runOptimisationsForAssets({assetIds:S,doc:r});case y.UPDATE_CLASS_STYLE:const N={classId:t[0].classId,recomputeChildren:!0};return void this.runOptimisationForClass(N);default:return}}runOptimisationsForAssets(e){const{assetIds:t,doc:n}=e;n&&t&&t.length&&t.forEach((e=>{this.imageOptimisationFlow.computeAssetSizeForComponent({assetId:e,doc:n})}))}runOptimisationForNodes(e){const{nodeIds:t,doc:n,recomputeChildren:o,unsplashOnly:i}=e;!this.projectUIState.localWork.nodesUnderLocalWork&&n&&(null===t||void 0===t||t.forEach((e=>{o?n.nodes.bfs(e,(e=>{this.imageOptimisationFlow.optimiseNodeImages({nodeId:e.id,doc:n,unsplashOnly:i})})):this.imageOptimisationFlow.optimiseNodeImages({nodeId:e,doc:n,unsplashOnly:i})})))}runOptimisationForClass(e){const{classId:t,doc:n}=e;if(!n)return;const o=n.classes.byId[t];"simple"===o.classType&&this.runOptimisationForNodes({nodeIds:Object.keys((null===o||void 0===o?void 0:o.usedInNodes)||{}),doc:n,recomputeChildren:!0})}isUpdateAttrByKeyParams(e){return void 0!==e.value}},r=(0,d.Z)(s.prototype,"imageOptimisationFlow",[o],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),a=(0,d.Z)(s.prototype,"projectUIState",[i],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),(0,d.Z)(s.prototype,"runOptimisationsForAssets",[u.P],Object.getOwnPropertyDescriptor(s.prototype,"runOptimisationsForAssets"),s.prototype),(0,d.Z)(s.prototype,"runOptimisationForNodes",[u.P],Object.getOwnPropertyDescriptor(s.prototype,"runOptimisationForNodes"),s.prototype),(0,d.Z)(s.prototype,"runOptimisationForClass",[u.P],Object.getOwnPropertyDescriptor(s.prototype,"runOptimisationForClass"),s.prototype),s);Object.freeze(_)},492080:function(e,t,n){n.d(t,{n1:function(){return o},LN:function(){return i},bo:function(){return s},y$:function(){return r},Wn:function(){return a},BT:function(){return c},qG:function(){return l},e3:function(){return d},BQ:function(){return p},O2:function(){return u},Xh:function(){return h},_C:function(){return y},cY:function(){return m},Vf:function(){return f},Wj:function(){return g}});const o=".js",i="new-file",s="new-folder",r="teleport-project-react",a=`${r}/public`,c=`${r}/src`,l=`${c}/index.js`,d=`${r}/index.html`,p=`${r}/teleport.config.json`,u=" ",h="src/teleporthq",y="public/playground_assets",m="main",f="-commited",g="-staged"},658358:function(e,t,n){let o;n.d(t,{kn:function(){return i},mY:function(){return s}}),function(e){e.Navigation="Navigation",e.Sections="Sections",e.StyledComponents="Styled Components"}(o||(o={}));const i=e=>`/static/img/styled-sections/${e}.jpg`;let s;!function(e){e.Headers="Headers",e.Footers="Footers",e.Sidebars="Sidebars",e.Hero="Hero Sections",e.Banners="Banners",e.Features="Features",e.Pricing="Pricing Sections",e.Galleries="Galleries",e.Testimonials="Testimonials",e.Blogs="Blog Posts",e.Stats="Stats",e.Steps="Steps",e.Social="Social Bar",e.Feature="Feature Card",e.Testimonial="Testimonial Card",e.Blog="Blog Card",e.Gallery="Gallery Card"}(s||(s={}));o.Navigation,s.Headers,s.Footers,s.Sidebars,o.Sections,s.Hero,s.Banners,s.Features,s.Pricing,s.Galleries,s.Testimonials,s.Blogs,s.Stats,s.Steps,s.Social,o.StyledComponents,s.Feature,s.Testimonial,s.Blog,s.Gallery,s.Headers,s.Footers,s.Sidebars,s.Hero,s.Banners,s.Features,s.Pricing,s.Galleries,s.Testimonials,s.Blogs,s.Social,s.Stats,s.Steps,s.Feature,s.Testimonial,s.Blog,s.Gallery},90895:function(e,t,n){n.d(t,{T:function(){return o},q:function(){return i}});const o={"#B23BDD":!1,"#60BA57":!1,"#A65088":!1,"#8085e9":!1,"#695033":!1,"#c58b23":!1,"#f15c80":!1,"#2b908f":!1,"#663E63":!1,"#DA3BDD":!1,"#4A0AF5":!1,"#782612":!1,"#669463":!1,"#5300ad":!1,"#19694A":!1,"#E32200":!1,"#919e04":!1,"#C40080":!1,"#4E6933":!1,"#2c3e8f":!1},i=Object.keys(o)},138502:function(e,t,n){n.d(t,{h:function(){return p}});var o=n(676422),i=n.n(o),s=(n(202784),n(438975)),r=n(68407),a=n(463251),c=n(638852),l=n(173541),d=n(552322);const p=e=>{const{onDismiss:t,onSubmit:n,customMessage:o,workspaceName:p,isWorkspaceOwner:u,limitReached:h,publishDestination:y,handleUpgradeClick:m}=e;return(0,d.jsxs)(s.P,{title:"This feature is not available on your current plan",submitButton:"Upgrade Now",dismissButton:"Cancel",onSubmit:n,onDismiss:t,hideSubmitButton:!0,secondSubmitButton:(0,d.jsx)(l.z,{id:"navbar-upgrade-button",onClick:()=>{c.Z.mixpanelEvent(c.Z.AnalyticsEvents.PROJECT_FEATURE_UNAVAILABLE_MODAL_UPGRADE),m()},title:"Upgrade",size:"medium",colorScheme:"orange-red",style:"solid",dataAttrs:{"data-tooltip-direction":"vertical"},children:"Upgrade Now"}),children:[(0,d.jsx)("p",{className:`jsx-${r.W.__hash} description`,children:h?"The limit was reached for the current plan.":u?"Your workspace is currently on a Free plan and this feature is not available.":"This project is part of a workspace that is currently on a Free plan."}),(0,d.jsx)("p",{className:`jsx-${r.W.__hash} description`,children:(0,d.jsx)("b",{className:`jsx-${r.W.__hash}`,children:o||(h?`Use this premium feature by upgrading '${p}' to another plan.`:u?y?`Publish this project to ${"vercel"===y?"Vercel":"your own custom domain"} by upgrading '${p}' to Professional.`:null:"Ask the workspace owner to upgrade to Professional to use this premium feature.")})}),(0,d.jsx)("a",{href:a.hD,target:"_blank",rel:"noopener noreferrer",className:`jsx-${r.W.__hash}`,children:(0,d.jsx)("p",{className:`jsx-${r.W.__hash} link`,children:(0,d.jsx)("b",{className:`jsx-${r.W.__hash}`,children:"Learn more about pricing"})})}),(0,d.jsx)(i(),{id:r.W.__hash,children:r.W})]})}},502250:function(e,t,n){n.d(t,{P:function(){return o},x:function(){return i}});const o=["title","name","displayName"],i=(e,t)=>{if(null===e||void 0===e||!e.length)return[];const n=[...t.content.refPath||[]];n.shift();const o=[];return e.forEach((e=>{const t=[...n];let i=e;for(;t.length;){const e=t.shift();e&&i&&(i=i[e])}i&&o.push({id:e.id,key:"string"===typeof i?i:JSON.stringify(i)})})),o}},260356:function(e,t,n){n.d(t,{CJ:function(){return o},Pg:function(){return i},eo:function(){return s},G6:function(){return r},Nk:function(){return a}});const o=(e,t)=>{if(!("attrs"in e))return;const n=e.attrs,o=n&&t in n?n[t]:void 0;if(o){if("dynamic"===o.type)throw new Error("Dynamic type for attribute is not handled");return o.content}},i=["string","boolean","number","relation"],s=["string","boolean","number"],r=["string","number","boolean","datetime"],a=["strapi"]},817374:function(e,t,n){n.d(t,{N:function(){return F}});var o,i,s,r,a,c,l,d,p,u,h,y=n(503348),m=n(777460),f=n(918437),g=n(302503),_=n(891173),b=n(555362),I=n(523689),v=n(2758),w=n(491463),O=n(233475),j=n(751433),S=n(502250),N=n(744914),D=n(85970),E=n(378888),T=n(829177),P=n(186338),C=n(476535),x=n(656733);const A={contentful:()=>n.e(51692).then(n.bind(n,951692)).then((e=>e.ContentfulContentBuilder.Instance)),strapi:()=>n.e(63741).then(n.bind(n,663741)).then((e=>e.StrapiContentBuilder.Instance)),flotiq:()=>n.e(89220).then(n.bind(n,89220)).then((e=>e.FlotiqContentBuilder.Instance)),wordpress:()=>n.e(70950).then(n.bind(n,170950)).then((e=>e.WordpressContentBuilder.Instance)),"caisy.io":()=>n.e(43738).then(n.bind(n,743738)).then((e=>e.CaisyContentBuilder.Instance))};let F=(o=(0,g.inject)("projectDoc"),i=(0,g.inject)("sharedbProjectSyncService"),s=(0,g.inject)("pageManagementFlow"),r=(0,g.inject)("guardsService"),h=u=class{constructor(){(0,y.Z)(this,"projectDoc",c,this),(0,y.Z)(this,"dbSync",l,this),(0,y.Z)(this,"pageManagementFlow",d,this),(0,y.Z)(this,"guardsService",p,this),(0,m.Z)(this,"selectedContentBuilderPromise",null),(0,m.Z)(this,"previoussSelectedCMS",null),(0,m.Z)(this,"generateDynamicNodesBasedOnContentTypeListPage",((e,t)=>{const n=new j.HX({primitiveType:O.sO.CONTAINER,semanticType:O.iX.DIV});n.styles={width:new I.F({content:"100%"}),display:new I.F({content:"flex"}),gap:new I.F({content:"12px"}),flexDirection:new I.F({content:"column"}),alignItems:new I.F({content:"center"})};const o=e.attributes,i=[],s=new Set;return Object.keys(o).forEach((e=>{if(!s.has(e)&&S.P.includes(e.toLowerCase())&&"string"===o[e].type){const n=(0,T.nP)(t,[e]);s.add(e),i.push(n)}})),Object.entries(o).forEach((([e,o])=>{if(!(i.length>2)&&("string"===o.type||"number"===o.type)){const o=(0,T.EW)(t,[e],n.id);i.push(o)}})),{dynamicNode:n,children:i}})),(0,m.Z)(this,"generateDynamicNodeBasedOnContentTypeDetailsPage",((e,t)=>{var n;const o=new j.HX({primitiveType:O.sO.CONTAINER,semanticType:O.iX.DIV});o.styles={width:new I.F({content:"100%"}),display:new I.F({content:"flex"}),flexDirection:new I.F({content:"column"}),gap:new I.F({content:"12px"})};const i=e.attributes,s=[],r=new Set;Object.keys(i).forEach((e=>{if(!r.has(e)&&S.P.includes(e.toLowerCase())&&"string"===i[e].type){const n=(0,T.nP)(t,[e]);r.add(e),s.push(n)}})),Object.entries(i).forEach((([e,n])=>{if(!(s.length>2||r.has(e))&&("string"===n.type||"number"===n.type)){const n=(0,T.EW)(t,[e]);r.add(e),s.push(n)}}));const a=null===(n=this.projectDoc.cms.cmsConnectionData)||void 0===n?void 0:n.cmsType;if(!a)throw new Error("Trying to generate a cms node but no selected cms");return Object.keys(i).forEach((e=>{if("richtext"===i[e].type){const n=(0,T.OT)(t,[e],a);r.add(e),s.push(n)}})),{dynamicNode:o,children:s}}))}static get Instance(){return this._instance||(this._instance=new this)}async setCMSProvider(e){if(this.previoussSelectedCMS!==e){if(this.previoussSelectedCMS=e,!A[e])throw new Error(`Trying to set CMS provider but the CMS type ${e} is not supported`);this.selectedContentBuilderPromise=A[e]()}}async getBuilder(){const e=this.projectDoc.cms.status;if("unset"===e||"unitialised"===e.state)throw new Error("Trying to get CMS provider but the CMS type is not set");return e.type!==this.previoussSelectedCMS&&await this.setCMSProvider(e.type),this.selectedContentBuilderPromise}async buildListPages(e){const t=await this.getBuilder();if(!t)return null;this.guardsService.executeFunctionGuarded(x._.DISABLE_HISTORY,(()=>this.dbSync.mutate(this.projectDoc,(n=>{var o,i;if(!(null===(o=n.cms)||void 0===o||null===(i=o.cmsConnectionData)||void 0===i?void 0:i.cmsType))throw new Error("No active content builder. Make sure CMS is active.");Object.keys(n.cmsPages.byId).length||(n.cmsPages=new v.g),this.generateCollectionListPages({doc:n,contentTypes:e,generateNodes:t.generateNodesForListPage||this.generateDynamicNodesBasedOnContentTypeListPage})}))))}async buildDetailPages(e){const t=await this.getBuilder();if(!t)return null;this.guardsService.executeFunctionGuarded(x._.DISABLE_HISTORY,(()=>this.dbSync.mutate(this.projectDoc,(n=>{var o,i,s;if(!(null===(o=this.projectDoc)||void 0===o||null===(i=o.cms)||void 0===i||null===(s=i.cmsConnectionData)||void 0===s?void 0:s.cmsType))throw new Error("No active content builder. Make sure CMS is active.");Object.keys(n.cmsPages.byId).length||(n.cmsPages=new v.g),this.generateDetailsListPages({doc:n,contentTypes:e,generateNodes:t.generateNodesForDetailsPage||this.generateDynamicNodeBasedOnContentTypeDetailsPage})}))))}generateCollectionListPages(e){var t;const{doc:n,contentTypes:o,generateNodes:i}=e;if(!n)throw new Error("No project doc provided");const s=this.projectDoc.cms.usedContentTypes,r=null===(t=this.projectDoc.cms.cmsConnectionData)||void 0===t?void 0:t.cmsType,a=this.projectDoc.cmsPages.byId;Object.keys(s).length&&r&&Object.keys(o).forEach((e=>{const t=s[e];if(!s[e])return;if(Object.values(a).find((t=>"cms-listing-page"===(null===t||void 0===t?void 0:t.type)&&t.contentType===e)))return void console.error(`List page for ${t.name} already exists`);const o=new D.i({title:t.name,contentType:t.uid});n.addPage({page:o});const c=(0,E.Ox)(),l=(0,E.Ox)(),d=new N.t({name:"Collection List",listCtxId:c,repeatableCtxId:l,resourceDefinition:{type:"external-cms-list",cmsType:r,contentType:t.uid,contentTypeName:t.name},attrs:{perPage:new I.F({content:"10"}),page:new I.F({content:"1"})}});o.mainNodeId=d.id,n.addPage({page:o});const p=(0,T.fp)("There was an error fetching the data"),u=(0,T.mZ)("Loading items...");if(!o.rootNodeId)throw new Error("Tried to create a CMS List page that has no root");n.addNodesToParentOrStage({parentId:o.rootNodeId,nodes:[d]}),n.addNodesToParentOrStage({parentId:d.stateNodeRoots.loading,nodes:[u]}),n.addNodesToParentOrStage({parentId:d.stateNodeRoots.error,nodes:[p]});const h=n.nodes.getById(d.stateNodeRoots.success),y=n.nodes.getById(Object.keys(h.childrenIds)[0]),{dynamicNode:m,children:f}=i(t,l);n.addNodesToParentOrStage({parentId:y.stateNodeRoots.list,nodes:[m]}),n.addNodesToParentOrStage({parentId:m.id,nodes:f})}))}generateDetailsListPages(e){var t;const{doc:n,contentTypes:o,generateNodes:i}=e;if(!n)throw new Error("No project doc provided");const s=this.projectDoc.cms.usedContentTypes,r=null===(t=this.projectDoc.cms.cmsConnectionData)||void 0===t?void 0:t.cmsType,a=this.projectDoc.cmsPages.byId;Object.keys(s).length&&r&&Object.keys(o).forEach((e=>{const t=s[e];if(!s[e])return;if(Object.values(a).find((t=>"cms-details-page"===(null===t||void 0===t?void 0:t.type)&&t.contentType===e)))return void console.error(`Details page for ${t.name} already exists`);const o=new P.b({title:t.name,contentType:t.uid,cmsDetailsPageAttributeDifferentiator:new b.P({content:{referenceType:"prop",defaultValue:"",id:"root",refPath:[(null===t||void 0===t?void 0:t.name)||"","id"]}}),settings:{staticUrl:new I.F({content:`/${(0,w.N0)(t.name)}`})}}),c=new _.n({resourceDefinition:{type:"external-cms-item",cmsType:r,contentType:t.uid,contentTypeName:t.name}});o.mainNodeId=c.id,n.addPage({page:o});const l=(0,T.fp)("There was an error reading this item"),d=(0,T.mZ)("Loading item...");if(!o.rootNodeId)throw new Error("Tried to create a CMS List page that has no root");n.addNodesToParentOrStage({parentId:o.rootNodeId,nodes:[c]}),n.addNodesToParentOrStage({parentId:c.stateNodeRoots.loading,nodes:[d]}),n.addNodesToParentOrStage({parentId:c.stateNodeRoots.error,nodes:[l]});const{dynamicNode:p,children:u}=i(t,c.ctxId);n.addNodesToParentOrStage({parentId:c.stateNodeRoots.success,nodes:[p]}),n.addNodesToParentOrStage({parentId:p.id,nodes:u})}))}deleteAllCollectionListPages(e){const{doc:t}=e;t&&t.cmsPages.byId&&Object.values(t.cmsPages.byId).forEach((e=>{e&&"cms-listing-page"===e.type&&this.pageManagementFlow.deleteCMSPageAndUpdateDependencies({doc:t,id:e.id})}))}deleteAllDetailsPages(e){const{doc:t}=e;t&&t.cmsPages.byId&&Object.values(t.cmsPages.byId).forEach((e=>{e&&"cms-details-page"===e.type&&this.pageManagementFlow.deleteCMSPageAndUpdateDependencies({doc:t,id:e.id})}))}},(0,m.Z)(u,"_instance",void 0),a=h,c=(0,f.Z)(a.prototype,"projectDoc",[o],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),l=(0,f.Z)(a.prototype,"dbSync",[i],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),d=(0,f.Z)(a.prototype,"pageManagementFlow",[s],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),p=(0,f.Z)(a.prototype,"guardsService",[r],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),(0,f.Z)(a.prototype,"generateCollectionListPages",[C.W],Object.getOwnPropertyDescriptor(a.prototype,"generateCollectionListPages"),a.prototype),(0,f.Z)(a.prototype,"generateDetailsListPages",[C.W],Object.getOwnPropertyDescriptor(a.prototype,"generateDetailsListPages"),a.prototype),(0,f.Z)(a.prototype,"deleteAllCollectionListPages",[C.W],Object.getOwnPropertyDescriptor(a.prototype,"deleteAllCollectionListPages"),a.prototype),(0,f.Z)(a.prototype,"deleteAllDetailsPages",[C.W],Object.getOwnPropertyDescriptor(a.prototype,"deleteAllDetailsPages"),a.prototype),a)},829177:function(e,t,n){n.d(t,{fp:function(){return c},mZ:function(){return l},nP:function(){return d},EW:function(){return p},OT:function(){return u}});var o=n(233475),i=n(555362),s=n(751433),r=n(869929),a=n(523689);const c=e=>{const t=new a.F({content:e});return new s.HX({semanticType:o.RY.SPAN,name:"Error",primitiveType:o.sO.TEXT,contentChildren:{[t.id]:t},styles:{padding:new a.F({content:"8px"})}})},l=e=>{const t=new a.F({content:e});return new s.HX({name:"Loading",semanticType:o.RY.SPAN,primitiveType:o.sO.TEXT,contentChildren:{[t.id]:t},styles:{padding:new a.F({content:"8px"})}})},d=(e,t)=>{const n=new i.P({content:{referenceType:"ctx",ctxId:e,refPath:t,id:"refPath"}});return new s.HX({semanticType:o.RY.HEADING1,primitiveType:o.sO.TEXT,contentChildren:{[n.id]:n}})},p=(e,t,n)=>{const r=new i.P({content:{referenceType:"ctx",ctxId:e,refPath:t,id:"refPath"}});return new s.HX({semanticType:o.RY.SPAN,primitiveType:o.sO.TEXT,parentId:n,contentChildren:{[r.id]:r}})},u=(e,t,n)=>{const o=new i.P({content:{referenceType:"ctx",ctxId:e,refPath:t,id:"refPath"}}),s=new r.D({html:o,cmsType:n});return s.styles={width:new a.F({content:"100%"}),alignSelf:new a.F({content:"stretch"})},s}},757156:function(e,t,n){n.d(t,{H:function(){return r}});var o=n(777460);function i(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function s(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?i(Object(n),!0).forEach((function(t){(0,o.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):i(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}class r{constructor(){(0,o.Z)(this,"status","unset"),(0,o.Z)(this,"cmsConnectionData",null),(0,o.Z)(this,"usedContentTypes",{}),(0,o.Z)(this,"componentTypes",{}),(0,o.Z)(this,"activeDetailPages",{}),(0,o.Z)(this,"entitiesByType",{}),(0,o.Z)(this,"previewCMSListPaginationState",{}),(0,o.Z)(this,"sortAttributes",{}),(0,o.Z)(this,"filterAttributes",{}),(0,o.Z)(this,"allowedDifferentiators",{}),(0,o.Z)(this,"mixedTypesInPreview",{}),(0,o.Z)(this,"showTabLoadingIndicator",!1),(0,o.Z)(this,"locales",void 0)}static get Instance(){return this._instance||(this._instance=new this)}getAllCMSTypes(){return s(s({},this.usedContentTypes),this.componentTypes)}}(0,o.Z)(r,"_instance",void 0)},344627:function(e,t,n){n.d(t,{c:function(){return ie}});var o=n(503348),i=n(777460),s=n(918437),r=n(302503),a=n(523689),c=n(395942),l=n(656733),d=n(817374),p=n(378888),u=n(687279),h=n(751433),y=n(255328),m=n(182312),f=n(930613),g=n(555362),_=n(738924),b=n(233475),I=n(686646),v=n(813244),w=n(757156),O=n(642112),j=n(260356);var S,N,D,E,T,P,C,x,A,F,k,R,M,U,Z,L,B,W,z,$,G,H,K,V,Y,J,X,q,Q,ee=n(455245),te=n(84615);function ne(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function oe(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ne(Object(n),!0).forEach((function(t){(0,i.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ne(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}let ie=(S=(0,r.inject)("projectDoc"),N=(0,r.inject)("projectUIState"),D=(0,r.inject)("sharedbProjectSyncService"),E=(0,r.inject)("guardsService"),T=(0,r.inject)("notificationsManagementFlow"),P=(0,r.inject)("nodeAttributeManagmentFlow"),C=(0,r.inject)("pageManagementFlow"),x=(0,r.inject)("nodeSelectionFlow"),A=(0,r.inject)("projectRepository"),F=(0,r.inject)("projectDownloadFlow"),k=(0,r.inject)("propDefinitionManagementFlow"),R=(0,r.inject)("stateDefinitionManagementFlow"),M=(0,r.inject)("componentCodeGenerationFlow"),Q=q=class{constructor(){(0,o.Z)(this,"projectDoc",Z,this),(0,o.Z)(this,"projectUIState",L,this),(0,o.Z)(this,"dbSync",B,this),(0,o.Z)(this,"guardsService",W,this),(0,o.Z)(this,"notificationsManagementFlow",z,this),(0,o.Z)(this,"nodeAttributeManagmentFlow",$,this),(0,o.Z)(this,"pageManagementFlow",G,this),(0,o.Z)(this,"nodeSelectionFlow",H,this),(0,o.Z)(this,"projectRepository",K,this),(0,o.Z)(this,"projectDownloadFlow",V,this),(0,o.Z)(this,"propDefinitionManagementFlow",Y,this),(0,o.Z)(this,"stateDefinitionManagementFlow",J,this),(0,o.Z)(this,"componentCodeGenerationFlow",X,this),(0,i.Z)(this,"initialContentBuilder",d.N.Instance),(0,i.Z)(this,"selectedCMSFlow",_.M.Instance),(0,i.Z)(this,"cmsUIState",w.H.Instance),(0,i.Z)(this,"setActiveCollectionItemIdForSelectedDetailsPage",((e,t)=>{this.cmsUIState.activeDetailPages[e]!==t&&(this.nodeSelectionFlow.resetNodeSelection(),(0,c.mutate)(this.cmsUIState,(n=>{n.activeDetailPages[e]=t})))})),(0,i.Z)(this,"syncContentTypes",(async()=>{(0,c.mutate)(this.cmsUIState,(e=>{e.showTabLoadingIndicator=!0}));try{const e=this.cmsUIState.getAllCMSTypes();await this.selectedCMSFlow.syncCMSTypesAndSettings();const t=((e,t)=>{for(const r in e){const a=t[r],c=e[r];if(!a)return!0;if("singleType"in c&&"singleType"in a&&c.singleType!==a.singleType)return!0;const l=e[r].attributes,d=t[r].attributes;for(const e in l){var n,o,i,s;const t=l[e],r=d[e];if(!r)return!0;if(t.type!==r.type)return!0;if("relation"!==t.type||"relation"!==r.type)continue;if(t.relationToAssetsType!==r.relationToAssetsType)return!0;if(t.relationType!==r.relationType)return!0;const a=[];a.push(...null!==(n=null===t||void 0===t?void 0:t.relationContentTypeIds)&&void 0!==n?n:[]),a.push(...null!==(o=t.relationComponentTypeIds)&&void 0!==o?o:[]);const c=[];if(c.push(...null!==(i=null===r||void 0===r?void 0:r.relationContentTypeIds)&&void 0!==i?i:[]),c.push(...null!==(s=null===r||void 0===r?void 0:r.relationComponentTypeIds)&&void 0!==s?s:[]),!a.every((e=>c.includes(e))))return!0}}return!1})(e,this.cmsUIState.getAllCMSTypes()),n=this.getAvailableSortAttributes(this.cmsUIState.usedContentTypes),o=this.getAvailableFilterAttributes(this.cmsUIState.usedContentTypes),i=this.getAllowedDifferentiators(this.cmsUIState.usedContentTypes);this.guardsService.executeFunctionGuarded(l._.DISABLE_HISTORY,(()=>this.dbSync.mutate(this.projectDoc,(e=>{e.cms.usedContentTypes=this.cmsUIState.usedContentTypes,e.cms.componentTypes=this.cmsUIState.componentTypes,e.cms.sortAttributes=n,e.cms.filterAttributes=o,e.cms.allowedDifferentiators=i,this.cmsUIState.locales&&(e.cms.locales={defaultLocale:this.cmsUIState.locales.defaultLocale,availableLocales:this.cmsUIState.locales.availableLocales})})))),t?this.notificationsManagementFlow.createNotification(I.k$.WARNING,"Some of your content types have changed. Please check affected CMS nodes and publish the project to apply changes."):this.notificationsManagementFlow.createNotification(I.k$.SUCCESS,"Data was successfully synced"),(0,c.mutate)(this.projectUIState,(e=>{const t=e.selection.componentId;e.selection.componentId=null,e.selection.componentId=t}))}catch(e){this.notificationsManagementFlow.handleError("There was an error while syncing content types. Please try again.")}finally{(0,c.mutate)(this.cmsUIState,(e=>{e.showTabLoadingIndicator=!1}))}})),(0,i.Z)(this,"getPublicUrl",(async()=>{var e;const t=null===(e=this.projectDoc.cms.cmsConnectionData)||void 0===e?void 0:e.cmsType;if(!t)throw new Error("Attempted to set CMS public URL while not connected to a CMS");switch(t){case"strapi":const e=await this.selectedCMSFlow.getPublicUrl();if(!e)throw new Error("Could not get public URL");this.guardsService.executeFunctionGuarded(l._.DISABLE_HISTORY,(()=>this.dbSync.mutate(this.projectDoc,(t=>{if(!t.cms.cmsConnectionData)throw new Error("CMS connection data is missing");t.cms.cmsConnectionData=oe(oe({},t.cms.cmsConnectionData),{},{publicUrl:e})}))))}})),(0,i.Z)(this,"getDetailsPageCollectionItemNode",(e=>{const t=this.projectDoc.cmsPages.byId[e];if(!t)throw new Error(`Tried getting page but could not find it: ${e}`);const n=t.mainNodeId;if(!n)throw new Error(`Tried to get main node for page: ${e} but id is not set`);const o=this.projectDoc.nodes.getById(n);if(!o)throw new Error(`Tried to get main node for page: ${e} but it doesn't exist in projectDoc`);return o}))}static get Instance(){return this._instance||(this._instance=new this)}isCMSDetailsPage(e){var t;return"cms-details-page"===(null===(t=this.projectDoc.cmsPages.byId[e])||void 0===t?void 0:t.type)}handleSetSelectedCMS(e){(0,c.mutate)(this.cmsUIState,(t=>{t.usedContentTypes={},t.componentTypes={},t.status={state:"unitialised",type:e},t.cmsConnectionData=null}))}async handleDisableCMSWebhook(){try{this.guardsService.executeFunctionGuarded(l._.DISABLE_HISTORY,(()=>{this.dbSync.mutate(this.projectDoc,(e=>{e.cms.webhook={config:{teleport:null,vercel:null},lastPublishedConfig:{teleport:null,vercel:null}}}))}))}catch(e){this.notificationsManagementFlow.handleError("Could not disable cms webhook.")}}async handleDisconnectCMS(e=!0,t=!1){try{(0,c.mutate)(this.cmsUIState,(e=>{e.showTabLoadingIndicator=!0})),e&&await this.projectRepository.disableCMS(this.projectDoc.id),this.guardsService.executeFunctionGuarded(l._.DISABLE_HISTORY,(()=>{this.dbSync.mutate(this.projectDoc,(e=>{e.cms.isEnabled=!1,e.cms.status="unset",e.cms.cmsConnectionData=null,e.cms.usedContentTypes={},e.cms.sortAttributes={},e.cms.componentTypes={},e.cms.filterAttributes={},e.cms.allowedDifferentiators={},e.cms.webhook={config:{teleport:null,vercel:null},lastPublishedConfig:{teleport:null,vercel:null}},Object.values(e.cmsPages.byId).forEach((t=>{t&&this.pageManagementFlow.deleteCMSPageAndUpdateDependencies({doc:e,id:t.id})})),Object.values(e.nodes.getAllNodes()).forEach((e=>{!e||"cms-collection-list-node"!==e.type&&"cms-collection-item-node"!==e.type||(e.resourceDefinition?e.resourceDefinition.type="uninitialised":e.resourceDefinition={type:"uninitialised"})}))}))})),(0,c.mutate)(this.cmsUIState,(e=>{e.activeDetailPages={},e.entitiesByType={},e.previewCMSListPaginationState={},e.sortAttributes={},e.filterAttributes={},e.allowedDifferentiators={},e.cmsConnectionData=null,e.status="unset",e.usedContentTypes={},e.showTabLoadingIndicator=!1})),t||this.notificationsManagementFlow.createNotification(I.k$.SUCCESS,"CMS disconnected successfully")}catch(n){this.notificationsManagementFlow.handleError("Could not disconnect CMS. Please try again.")}}async handleFinishConnection(e){try{await this.projectRepository.enableCMS(this.projectDoc.id),this.projectUIState.userPreferences.projectType!==ee.o.NEXT&&this.projectDownloadFlow.updateProjectType(ee.o.NEXT),this.projectUIState.userPreferences.codeType!==te.cd.REACT&&this.componentCodeGenerationFlow.updateCodeType(te.cd.REACT);const t=this.getAvailableSortAttributes(this.cmsUIState.usedContentTypes),n=this.getAvailableFilterAttributes(this.cmsUIState.usedContentTypes),o=this.getAllowedDifferentiators(this.cmsUIState.usedContentTypes);this.guardsService.executeFunctionGuarded(l._.DISABLE_HISTORY,(()=>this.dbSync.mutate(this.projectDoc,(e=>{if(e.cms.isEnabled=!0,"unset"===this.cmsUIState.status)throw new Error("We should have a CMS status when finish");e.cms.status={type:this.cmsUIState.status.type,state:"ready"},e.cms.cmsConnectionData=this.cmsUIState.cmsConnectionData,e.cms.usedContentTypes=this.cmsUIState.usedContentTypes,e.cms.componentTypes=this.cmsUIState.componentTypes,e.cms.sortAttributes=t,e.cms.filterAttributes=n,e.cms.allowedDifferentiators=o,e.cms.webhook={config:{teleport:null,vercel:null},lastPublishedConfig:{teleport:null,vercel:null}},this.cmsUIState.locales&&(e.cms.locales={defaultLocale:this.cmsUIState.locales.defaultLocale,availableLocales:this.cmsUIState.locales.availableLocales})})))),await this.resetAndGenerateNewCMSPages(e),await this.selectedCMSFlow.moveConnectionDataToSecrets();const{cmsConnectionData:i}=this.projectDoc.cms;(0,c.mutate)(this.cmsUIState,(e=>{e.cmsConnectionData=i}))}catch(t){this.notificationsManagementFlow.handleError(t.message)}}getAvailableSortAttributes(e){return Object.keys(e).reduce(((t,n)=>{var o;let i=null===(o=this.cmsUIState.sortAttributes)||void 0===o?void 0:o[n];return i||(i=Object.keys(e[n].attributes).reduce(((t,o)=>{const i=e[n].attributes[o];return"id"!==o&&j.G6.includes(i.type)&&(t[o]=i),t}),{})),t[n]=i,t}),{})}getAvailableFilterAttributes(e){return Object.keys(e).reduce(((t,n)=>{var o;const i=(null===(o=this.cmsUIState.filterAttributes)||void 0===o?void 0:o[n])||e[n].attributes;return t[n]=i,t}),{})}getAllowedDifferentiators(e){return Object.keys(e).reduce(((t,n)=>{var o;const i=(null===(o=this.cmsUIState.allowedDifferentiators)||void 0===o?void 0:o[n])||Object.keys(e[n].attributes);return t[n]=i,t}),{})}updateCollectionItemResourceContentType(e,t){this.dbSync.mutate(this.projectDoc,(n=>{var o;const i=n.nodes.getById(e),s=null===(o=this.projectDoc.cms.cmsConnectionData)||void 0===o?void 0:o.cmsType;if(!s)throw new Error("Attempted to set contentType on a resource while not connected to a CMS");if(!i||"cms-collection-item-node"!==i.type)throw new Error("updateCollectionItemResourceContentType only works with cms-collection-item-node, received: "+(null===i||void 0===i?void 0:i.type));const r=Object.values(n.cms.usedContentTypes).find((e=>e.name===t));if(!r)throw new Error(`updateCollectionItemResourceContentType could not set the selected content type ${t} because it does not exist in the CMS integration`);i.resourceDefinition&&"uninitialised"!==i.resourceDefinition.type?(i.resourceDefinition.contentType=r.uid,i.resourceDefinition.contentTypeName=r.name):i.resourceDefinition={type:"external-cms-item",contentType:r.uid,contentTypeName:r.name,cmsType:s}}))}updateCollectionListResourceContentType(e,t){let n;this.dbSync.mutate(this.projectDoc,(o=>{var i;const s=o.nodes.getById(e),r=null===(i=this.projectDoc.cms.cmsConnectionData)||void 0===i?void 0:i.cmsType;if(!r)throw new Error("Attempted to set contentType on a resource while not connected to a CMS");if(!s||"cms-collection-list-node"!==s.type)throw new Error("updateCollectionItemResourceContentType only works withcms-collection-list-node, received: "+(null===s||void 0===s?void 0:s.type));const a=Object.values(o.cms.usedContentTypes).find((e=>e.name===t));if(!s.resourceDefinition||!a)throw new Error("Could not update with selected content type");"uninitialised"!==s.resourceDefinition.type?(n=s.resourceDefinition.contentType,s.resourceDefinition.contentType=a.uid,s.resourceDefinition.contentTypeName=a.name):s.resourceDefinition={type:"external-cms-list",contentType:a.uid,contentTypeName:a.name,cmsType:r}})),(0,c.mutate)(this.projectUIState,(e=>{delete e.invalidDynamicProperties[n||""]}))}isMainNodeOfCMSPage(e){return this.projectDoc.isMainNodeOfCMSPage(e)}isNodeLinkedToSingleType(e){var t,n;const o=this.projectDoc.nodes.getById(e);if(!o)throw new Error("Selected node could not be found");if("cms-collection-list-node"!==o.type&&"cms-collection-item-node"!==o.type)return!1;if(!o.resourceDefinition||"uninitialised"===(null===(t=o.resourceDefinition)||void 0===t?void 0:t.type))return!1;const i=o.resourceDefinition.contentType,s=this.cmsUIState.usedContentTypes[i];return!!s&&(null!==(n=s.singleType)&&void 0!==n&&n)}removeSortingAttributeForNode(e,t){var n,o;const i=this.projectDoc.nodes.getById(e);if(!i||"cms-collection-list-node"!==i.type||"external-cms-list"!==(null===(n=i.resourceDefinition)||void 0===n?void 0:n.type))throw new Error("Selected node it not of type cms-list");const s=null===(o=i.attrs)||void 0===o?void 0:o.sort;if("dynamic"===(null===s||void 0===s?void 0:s.type))throw new Error("Dynamic attribute support is missing");if(!s)return;if(Array.isArray(s.content)){const e=s.content.findIndex((e=>e.attrName===t));e>-1&&s.content.splice(e,1)}const r=s.content;0!==r.length?this.nodeAttributeManagmentFlow.updateAttrByKey({nodeId:e,key:"sort",value:[...r]}):this.nodeAttributeManagmentFlow.removeAttrByKey({nodeId:e,key:"sort"})}addSortingAttributeForNode(e,t,n){var o,i,s;const r=this.projectDoc.nodes.getById(e);if(!r||"cms-collection-list-node"!==r.type||"external-cms-list"!==(null===(o=r.resourceDefinition)||void 0===o?void 0:o.type))throw new Error("Selected node it not of type cms-list");let c=null===(i=r.attrs)||void 0===i?void 0:i.sort;if("dynamic"===(null===(s=c)||void 0===s?void 0:s.type))throw new Error("Dynamic attribute support is missing");if(c&&Array.isArray(c.content))c.content.push({attrName:t,order:n});else{const e=[{attrName:t,order:n}];c=new a.F({content:e})}this.nodeAttributeManagmentFlow.updateAttrByKey({nodeId:e,key:"sort",value:c.content})}removeFilteringAttributeForNode(e,t){this.dbSync.mutate(this.projectDoc,(n=>{var o,i,s;const r=n.nodes.getById(e);if(!r||"cms-collection-list-node"!==r.type||"external-cms-list"!==(null===(o=r.resourceDefinition)||void 0===o?void 0:o.type))throw new Error("Selected node it not of type cms-list");const a=null===r||void 0===r||null===(i=r.attrs)||void 0===i?void 0:i.filter;if(!a)return;let c;if(Array.isArray(a.content)){var l;if(1===a.content.length)return void(null===(l=r.attrs)||void 0===l||delete l.filter);const e=a.content.findIndex((e=>e.path.every(((e,n)=>{const o="content"in e?e.content.toString():e.contentTypeName,i=t[n];return o===("content"in i?i.content.toString():i.contentTypeName)}))));e>-1&&(r.attrs.filter={type:"cms-filter",content:a.content.reduce(((t,n,o)=>o===e?(c=n,t):(t.push(n),t)),[])})}const d=a.content,p=null===(s=c)||void 0===s?void 0:s.value;if("dynamic"!==(null===p||void 0===p?void 0:p.type))return;!!d.find((e=>"dynamic"===e.value.type&&e.value.content.id===p.content.id))||this.removeStaticOrDynamicNodeFromPropOrStateLocation({dynamicNode:p,nodeId:e,doc:n})}))}togglePaginationForNode(e){this.dbSync.mutate(this.projectDoc,(t=>{var n,o;const i=t.nodes.getById(e);if(!i||"cms-collection-list-node"!==i.type)throw new Error("Selected node it not of type cms-list");const s=!i.paginated;if(s&&(null===(n=i.attrs)||void 0===n||!n.paginationQuery)){const n=(0,p.Ky)("_cPage");this.nodeAttributeManagmentFlow.updateAttrByKey({doc:t,nodeId:e,key:"paginationQuery",value:n})}if(!s&&null!==(o=i.attrs)&&void 0!==o&&o.paginationQuery&&this.nodeAttributeManagmentFlow.removeAttrByKey({doc:t,nodeId:e,key:"paginationQuery"}),i.paginated=s,i.paginated){const e=t.nodes.getById(i.stateNodeRoots.success),n=Object.keys((null===e||void 0===e?void 0:e.childrenIds)||{}).find((e=>{var n;return"cms-pagination-node"===(null===(n=t.nodes.getById(e))||void 0===n?void 0:n.type)}));if(n){return void(t.nodes.getById(n).disabled=!1)}this.createPaginationWidget({widgetParentId:i.stateNodeRoots.success,isMainNode:!!this.isMainNodeOfCMSPage(i.id),doc:t})}else this.disablePaginationWidget({widgetParentId:i.stateNodeRoots.success,doc:t})}))}getUsedContentTypesForListPages(){const e=this.projectDoc.cmsPages.byId;return Object.values(e).reduce(((e,t)=>t?("cms-listing-page"!==t.type||(e[t.contentType]=!0),e):e),{})}getUsedContentTypesForDetailsPages(){const e=this.projectDoc.cmsPages.byId;return Object.values(e).reduce(((e,t)=>t&&"cms-details-page"===t.type&&t.contentType?(e[t.contentType]=!0,e):e),{})}createPaginationWidget(e){const{widgetParentId:t,isMainNode:n,doc:o}=e;if(!o)return;if(!this.projectUIState.selection.componentId)throw new Error("Attempted to create a pagination widget for a CMS List node, but there is no selected page or component!");const i=new u.k({styles:{display:new a.F({content:"flex"})}});o.addNodesToParentOrStage({nodes:[i],parentId:t});const s=this.generateCMSNavigationButton("prev",n),r=this.generateCMSNavigationButton("next",n);o.addNodesToParentOrStage({nodes:[s,r],parentId:i.id});const c=new h.HX({primitiveType:b.sO.TEXT,contentChildren:{[(0,p.Ox)()]:new a.F({content:"Previous"})},parentId:s.id});o.addNodesToParentOrStage({nodes:[c],parentId:s.id});const l=new h.HX({primitiveType:b.sO.TEXT,contentChildren:{[(0,p.Ox)()]:new a.F({content:"Next"})},parentId:r.id});o.addNodesToParentOrStage({nodes:[l],parentId:r.id})}generateCMSNavigationButton(e,t){const n=this.projectUIState.selection.componentId;if(!n)throw new Error("Attempted to create a pagination widget for a CMS List node, but there is no selected page or component!");return new m.z({name:"prev"===e?"Previous":"Next",abilities:{link:{content:{type:t?`list-page-cms-${e}`:`cms-${e}`,pageOrCompId:n},type:f.RZ.CMS_NAVIGATION_BUTTON}},renderingConditions:this.generateRenderingConditionForCmsNavBtn(e,t),styles:{display:new a.F({content:"flex"})}})}generateRenderingConditionForCmsNavBtn(e,t){const n=`${t?"props?.pagination":"params?.meta?.pagination"}.${"prev"===e?"hasPrevPage":"hasNextPage"}`;return{type:"conditional",reference:new g.P({content:{referenceType:"expr",id:n}}),value:!0}}disablePaginationWidget(e){const{widgetParentId:t,doc:n}=e;if(!n)return;const o=n.nodes.getById(t),i=Object.keys((null===o||void 0===o?void 0:o.childrenIds)||{}).find((e=>{var t;return"cms-pagination-node"===(null===(t=n.nodes.getById(e))||void 0===t?void 0:t.type)})),s=n.nodes.getById(i||"");if(!s)throw new Error(`Pagination was toggled off for node but no pagination element existed! Node id: ${t}`);s.disabled=!0}addFilteringAttributeForNode(e,t,n,o){this.dbSync.mutate(this.projectDoc,(i=>{var s,r;const c=i.nodes.getById(e);if(!c||"cms-collection-list-node"!==c.type||"external-cms-list"!==(null===(s=c.resourceDefinition)||void 0===s?void 0:s.type))throw new Error("Selected node it not of type cms-list");const l=null===(r=c.attrs)||void 0===r?void 0:r.filter,d=t.map((e=>"relation"===e.type&&e.id?{type:"relation",contentTypeId:e.id,contentTypeName:e.key}:new a.F({content:e.key})));let p=o?[{path:d,value:n,operand:o}]:[{path:d,value:n}];l&&Array.isArray(l.content)&&(p=[...l.content,...p]),c.attrs?c.attrs.filter={type:"cms-filter",content:p}:c.attrs={filter:{type:"cms-filter",content:p}},"dynamic"===n.type&&("prop"===n.content.referenceType&&this.propDefinitionManagementFlow.addPropLocationForNode({doc:i,propId:n.content.id,location:{base:v.hD.CMS_LIST_FILTER},nodeId:c.id}),"state"===n.content.referenceType&&this.stateDefinitionManagementFlow.addStateLocationForNode({doc:i,stateId:n.content.id,location:{base:v.uw.CMS_LIST_FILTER},nodeId:c.id}))}))}createPropDefinitionToUseForFiltering(e){const{nodeId:t,defaultValue:n,doc:o}=e;if(!o)return null;const i=o.nodes.getById(t);if(!i)throw new Error(`Node that need to update attr is missing - ${t}`);const s=o.nodes.getComponentIdOf(t),r=o.components.byId[s];if(!r)throw new Error(`Comp that need to update attr is missing - ${s}`);return r.createPropDefinition({locations:{},name:`${i.name}_filter`,type:"string",defaultValue:n||"filterValue",id:(0,p.Ox)(),inputType:v.SO.TEXT})}setCMSNodeUIState(e,t){(0,c.mutate)(this.projectUIState,(n=>{n.selection.nodeStates[e]=t}))}toggleCMSNodeUIState(e){const t=this.projectDoc.nodes.getById(e);if(!t)throw new Error(`Tried to toggle CMS node UI state but node not found: ${e}`);(0,c.mutate)(this.projectUIState,(n=>{n.selection.nodeStates[e]?delete n.selection.nodeStates[e]:n.selection.nodeStates[e]="cms-array-mapper"===t.type?"list":"loading"}))}async resetAndGenerateNewCMSPages(e){await this.guardsService.executeAsyncFunctionGuarded(l._.DISABLE_HISTORY,(async()=>{await this.initialContentBuilder.deleteAllCollectionListPages({}),await this.initialContentBuilder.deleteAllDetailsPages({}),await this.initialContentBuilder.buildListPages(e),await this.initialContentBuilder.buildDetailPages(e)}))}unlinkPropOrStateFromFilteringAttributeForNodeIds(e){const{nodeIds:t,propOrStateId:n,defaultValue:o,doc:i}=e;i&&t.forEach((e=>{var t;const s=i.nodes.getById(e);if(!s||"cms-collection-list-node"!==s.type)throw new Error(`Tried to unlink prop from cms list filter but no list node found! Node id: ${e}`);const r=null===(t=s.attrs)||void 0===t?void 0:t.filter;r&&r.content.forEach((e=>{"dynamic"===e.value.type&&e.value.content.id===n&&(this.removeStaticOrDynamicNodeFromPropOrStateLocation({doc:i,nodeId:s.id,dynamicNode:e.value}),e.value=new a.F({content:o||""}))}))}))}removeStaticOrDynamicNodeFromPropOrStateLocation(e){const{nodeId:t,dynamicNode:n,doc:o}=e;"prop"===n.content.referenceType&&this.propDefinitionManagementFlow.removePropLocationForNode({doc:o,location:{base:v.hD.CMS_LIST_FILTER},nodeId:t,propId:n.id}),"state"===n.content.referenceType&&this.stateDefinitionManagementFlow.removeStateLocationForNode({doc:o,location:{base:v.uw.CMS_LIST_FILTER},nodeId:t,stateId:n.id})}resolveFilteringAttributeForNodeId(e){var t,n;const o=this.projectDoc.nodes.getById(e);if(!o||"cms-collection-list-node"!==o.type)return;const i=null===(t=o.attrs)||void 0===t||null===(n=t.filter)||void 0===n?void 0:n.content;let s=[];if(i&&Array.isArray(i)){const e=this.projectDoc.getProjectPageOrComponent(this.projectDoc.nodes.getComponentIdOf(o.id)||"");s=i.map((t=>{const n=t.path.reduce(((e,t,n)=>{const o="content"in t?t.content.toString():t.contentTypeName;return 0===n?o:`${e}.${o}`}),""),o=(0,O.f)({staticOrDynamicNode:t.value,pageOrComp:e}),i=(0,p.m4)(null===o||void 0===o?void 0:o.contentValue)?null===o||void 0===o?void 0:o.contentValue.name:null===o||void 0===o?void 0:o.contentValue;let s="";return"prop"===(null===o||void 0===o?void 0:o.referenceType)&&(s="props."),"ctx"===(null===o||void 0===o?void 0:o.referenceType)&&(s="context."),"state"===(null===o||void 0===o?void 0:o.referenceType)&&(s="state."),{path:n,value:`${s}${i}`,meta:{unresolvedPath:t.path,valueWithRefType:o},operand:t.operand}}))}return s}},(0,i.Z)(q,"_instance",void 0),U=Q,Z=(0,s.Z)(U.prototype,"projectDoc",[S],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),L=(0,s.Z)(U.prototype,"projectUIState",[N],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),B=(0,s.Z)(U.prototype,"dbSync",[D],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),W=(0,s.Z)(U.prototype,"guardsService",[E],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),z=(0,s.Z)(U.prototype,"notificationsManagementFlow",[T],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),$=(0,s.Z)(U.prototype,"nodeAttributeManagmentFlow",[P],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),G=(0,s.Z)(U.prototype,"pageManagementFlow",[C],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),H=(0,s.Z)(U.prototype,"nodeSelectionFlow",[x],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),K=(0,s.Z)(U.prototype,"projectRepository",[A],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),V=(0,s.Z)(U.prototype,"projectDownloadFlow",[F],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Y=(0,s.Z)(U.prototype,"propDefinitionManagementFlow",[k],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),J=(0,s.Z)(U.prototype,"stateDefinitionManagementFlow",[R],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),X=(0,s.Z)(U.prototype,"componentCodeGenerationFlow",[M],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),(0,s.Z)(U.prototype,"createPaginationWidget",[y.P],Object.getOwnPropertyDescriptor(U.prototype,"createPaginationWidget"),U.prototype),(0,s.Z)(U.prototype,"disablePaginationWidget",[y.P],Object.getOwnPropertyDescriptor(U.prototype,"disablePaginationWidget"),U.prototype),(0,s.Z)(U.prototype,"createPropDefinitionToUseForFiltering",[y.P],Object.getOwnPropertyDescriptor(U.prototype,"createPropDefinitionToUseForFiltering"),U.prototype),(0,s.Z)(U.prototype,"unlinkPropOrStateFromFilteringAttributeForNodeIds",[y.P],Object.getOwnPropertyDescriptor(U.prototype,"unlinkPropOrStateFromFilteringAttributeForNodeIds"),U.prototype),(0,s.Z)(U.prototype,"removeStaticOrDynamicNodeFromPropOrStateLocation",[y.P],Object.getOwnPropertyDescriptor(U.prototype,"removeStaticOrDynamicNodeFromPropOrStateLocation"),U.prototype),U)},738924:function(e,t,n){n.d(t,{M:function(){return h}});var o,i,s,r,a,c=n(503348),l=n(777460),d=n(918437),p=n(302503);const u={strapi:()=>Promise.all([n.e(6006),n.e(55417),n.e(68818)]).then(n.bind(n,855417)).then((e=>e.CMSFLow.Instance)),contentful:()=>Promise.all([n.e(86396),n.e(19112),n.e(41730)]).then(n.bind(n,619112)).then((e=>e.CMSFLow.Instance)),flotiq:()=>Promise.all([n.e(6006),n.e(40793),n.e(34777)]).then(n.bind(n,540793)).then((e=>e.CMSFLow.Instance)),wordpress:()=>Promise.all([n.e(34721),n.e(81453),n.e(19653)]).then(n.bind(n,581453)).then((e=>e.CMSFLow.Instance)),"caisy.io":()=>Promise.all([n.e(2399),n.e(85007)]).then(n.bind(n,402399)).then((e=>e.CMSFLow.Instance))};let h=(o=(0,p.inject)("projectDoc"),a=r=class{constructor(){(0,c.Z)(this,"projectDoc",s,this),(0,l.Z)(this,"selectedFlowInstancePromise",null),(0,l.Z)(this,"previoussSelectedCMS",null)}static get Instance(){return this._instance||(this._instance=new this)}async setCMSProvider(e){if(this.previoussSelectedCMS!==e){if(this.previoussSelectedCMS=e,!u[e])throw new Error(`Trying to set CMS provider but the CMS type ${e} is not supported`);this.selectedFlowInstancePromise=u[e]()}}async getSelectedInstance(){const e=this.projectDoc.cms.status;if("unset"===e||"unitialised"===e.state)throw new Error("Trying to get CMS provider but the CMS type is not set");return e.type!==this.previoussSelectedCMS&&await this.setCMSProvider(e.type),this.selectedFlowInstancePromise}async moveConnectionDataToSecrets(){const e=await this.getSelectedInstance();if(e)return await e.moveConnectionDataToSecrets()}async resolveExternalCMSItemResourceDefinition(e){const t=await this.getSelectedInstance();if(t)return await t.resourceDefinitionItemResolver(e)}async resolveExternalCMSListResourceDefinition(e){const t=await this.getSelectedInstance();if(t)return await t.resourceDefinitionListResolver(e)}async getEntitiesByType(e){const t=await this.getSelectedInstance();if(t)return await t.handleGetEntitiesByType(e)}async getEntityById(e,t){const n=await this.getSelectedInstance();if(n)return await n.handleGetEntityById(e,t)}async getMixedPrimitiveTypeId(e){const t=await this.getSelectedInstance();if(t)return t.getMixedPrimitiveTypeId(e)}async syncCMSTypesAndSettings(){const e=await this.getSelectedInstance();if(e)return await e.syncCMSTypesAndSettings()}async getPublicUrl(){const e=await this.getSelectedInstance();if(e)return await e.getPublicUrl()}},(0,l.Z)(r,"_instance",void 0),i=a,s=(0,d.Z)(i.prototype,"projectDoc",[o],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),i)},16004:function(e,t,n){n.d(t,{bL:function(){return o},ys:function(){return i},B:function(){return s},z:function(){return r},$P:function(){return a},NM:function(){return c},xe:function(){return l},Wu:function(){return d},xq:function(){return p},s5:function(){return u},oW:function(){return h}});const o=24,i=26,s=18,r=256,a=16,c=372,l=570,d=220,p=22,u=112,h=68},536997:function(e,t,n){n.d(t,{U:function(){return r}});var o=n(777460);function i(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function s(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?i(Object(n),!0).forEach((function(t){(0,o.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):i(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}class r{constructor(){(0,o.Z)(this,"preloadInProgress",!1),(0,o.Z)(this,"icons",{}),(0,o.Z)(this,"iconsMetadata",{}),(0,o.Z)(this,"onIconsLoaded",[]),(0,o.Z)(this,"iconsCountByKeyword",{}),(0,o.Z)(this,"iconsTypesByKeyword",{}),(0,o.Z)(this,"attachListener",(e=>{this.onIconsLoaded.push(e),Object.keys(this.iconsMetadata).length&&e()})),(0,o.Z)(this,"getCountOfIconsByKeyword",(async e=>{Object.keys(this.iconsMetadata).length||await this.preloadIconsMetadata();const t=e.toLowerCase();if(this.iconsCountByKeyword[t])return this.iconsCountByKeyword[t];const n=Object.keys(this.iconsMetadata).reduce(((e,n)=>e+this.iconsMetadata[n].filter((e=>e.includes(t))).length),0);return this.iconsCountByKeyword[t]=n,n})),(0,o.Z)(this,"searchTypesByKeyword",(async e=>{Object.keys(this.iconsMetadata).length||await this.preloadIconsMetadata();const t=e.toLowerCase();if(this.iconsTypesByKeyword[t])return this.iconsTypesByKeyword[t];const n=Object.keys(this.iconsMetadata).filter((e=>this.iconsMetadata[e].some((e=>e.includes(t))))).sort();return this.iconsTypesByKeyword[t]=n,n.sort()})),(0,o.Z)(this,"getIconTypes",(async()=>Object.keys(this.iconsMetadata).length?Object.keys(this.iconsMetadata).sort():new Promise((async e=>{this.attachListener((()=>{e(Object.keys(this.iconsMetadata).sort())}))})))),(0,o.Z)(this,"getIconsByType",(async(e,t)=>{var n;return null!==(n=this.icons[e])&&void 0!==n&&n.length?this.searchIconsByKeyword(this.icons[e],t):new Promise((async n=>{this.attachListener((async()=>{var o;await this.loadIconsByType(e);const i=this.searchIconsByKeyword(null!==(o=this.icons[e])&&void 0!==o?o:[],t);n(i)}))}))})),(0,o.Z)(this,"loadIconsByType",(async e=>{try{const t=await fetch(`https://icons.teleporthq.io//${e}.json`),n=await t.json();this.icons[e]=n.icons.map((e=>s(s({},e),{},{tags:e.tags.map((e=>e.toLowerCase()))})))}catch(t){console.error(`Could not load icons for type: ${e}`)}})),(0,o.Z)(this,"preloadIconsMetadata",(async()=>{if(this.preloadInProgress)return;this.preloadInProgress=!0;const e=await n.e(4800).then(n.bind(n,404800));this.iconsMetadata=Object.keys(e.ICONS_METADATA).reduce(((t,n)=>{const o=e.ICONS_METADATA[n];return t[n]=o.map((e=>e.toLowerCase())),t}),{}),this.onIconsLoaded.forEach((e=>e())),this.preloadInProgress=!1})),(0,o.Z)(this,"searchIconsByKeyword",((e,t)=>{if(null===t||void 0===t||!t.length)return[...e];const n=t.toLowerCase();return[...e].filter((e=>{var t;return null===(t=e.tags)||void 0===t?void 0:t.some((e=>e.includes(n)))}))}))}static get Instance(){return this._instance||(this._instance=new this)}}(0,o.Z)(r,"_instance",void 0)},61750:function(e,t,n){n.d(t,{gP:function(){return a},s_:function(){return c},AV:function(){return l},Y3:function(){return d},UO:function(){return p}});var o=n(329852),i=n(414326),s=n(781872),r=n(552322);let a;!function(e){e.REPLACE_SOURCE="replace",e.REPLACE_POSTER="replace-poster",e.ADD_CHILD="image-plus",e.ADD_SIBLING="add-sibling"}(a||(a={}));const c=e=>{switch(e){case a.ADD_CHILD:return"add asset to stage";case a.ADD_SIBLING:return"add sibling";case a.REPLACE_SOURCE:return"replace asset";case a.REPLACE_POSTER:return"replace poster";default:return"add"}},l=e=>{if(!e)return i.TV.add;switch(e){case a.ADD_CHILD:return i.TV["image-plus"];case a.ADD_SIBLING:return i.TV["add-sibling"];case a.REPLACE_SOURCE:case a.REPLACE_POSTER:return i.TV.replace;default:return i.TV.add}},d=(e,t,n)=>{if(!t)return e;return e.split(t).map(((e,t)=>{if(e)return(0,r.jsx)("span",{children:e},t)})).reduce(((e,o)=>null===e?o:(0,r.jsxs)(r.Fragment,{children:[e,(0,r.jsx)("span",{style:{backgroundColor:n?s.DM.ACCENT_400:s.DM.GRAY_400},children:t}),o]})))},p=(e,t)=>e===o.D.PRIVATE_ASSETS||e===o.D.PUBLIC_ASSETS?`folder-${e}`:t?"folder-open":"folder"},851913:function(e,t,n){n.d(t,{wY:function(){return i},vI:function(){return s},ay:function(){return r}});var o=n(777460);let i;!function(e){e.WHITE_CHESS="whiteChessboard",e.BLACK_CHESS="blackChessboard"}(i||(i={}));class s{constructor(){(0,o.Z)(this,"byId",{})}change(e,t){this.byId[e]=t}}i.WHITE_CHESS,i.BLACK_CHESS;const r={[i.WHITE_CHESS]:"linear-gradient(to right, rgba(255, 255, 255, 0.92), rgba(255, 255, 255, 0.92)),linear-gradient(to right, black 50%, white 50%),linear-gradient(to bottom, black 50%, white 50%)",[i.BLACK_CHESS]:"linear-gradient(to right, rgba(255, 255, 255, 0.2), rgba(255, 255, 255, 0.2)),linear-gradient(to right, #0e0e10 50%, #2f3234 50%),linear-gradient(to bottom, #0e0e10 50%, #2f3234 50%)"}},901275:function(e,t,n){let o;n.d(t,{S:function(){return o}}),function(e){e.PAGES="pages",e.COMPONENTS="components",e.COLLECTION_PAGES="cms-collection-pages",e.LIST_PAGES="cms-list-pages",e.DETAILS_PAGES="cms-details-pages"}(o||(o={}))},455245:function(e,t,n){n.d(t,{o:function(){return c}});var o,i=n(777460),s=n(84615);function r(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function a(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?r(Object(n),!0).forEach((function(t){(0,i.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):r(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}!function(e){e.UIDL="UIDL"}(o||(o={}));const c=a(a({},s.cd),o)},582626:function(e,t,n){n.d(t,{W:function(){return i}});var o=n(781872);const i=[".collaborator-section.jsx-3323460081{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;width:100%;margin-top:12px;}",".collaborator-line.jsx-3323460081{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;height:32px;-webkit-box-pack:justify;-webkit-justify-content:space-between;-ms-flex-pack:justify;justify-content:space-between;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;width:100%;}",".collaborator-permissions.jsx-3323460081{position:relative;}",".collab-info.jsx-3323460081{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;max-width:200px;}",".collab-info.jsx-3323460081 span.jsx-3323460081{text-overflow:ellipsis;white-space:nowrap;overflow:hidden;}",`.collab-img.jsx-3323460081{height:32px;width:32px;border-radius:50%;margin-right:${o.N_.TWO_UNITS};display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;text-align:center;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;}`,".collab-img-wrapper.jsx-3323460081{width:48px;}",".collab-email.jsx-3323460081{line-height:16px;text-align:left;text-overflow:ellipsis;white-space:nowrap;overflow:hidden;padding:0 8px;}",`.owner-label.jsx-3323460081{cursor:default;color:${o.DM.GRAY_700};}`];i.__hash="3323460081"},34802:function(e,t,n){n.d(t,{F:function(){return yt}});var o=n(503348),i=n(777460),s=n(918437),r=n(676422),a=n.n(r),c=n(202784),l=n(505892),d=n(414326),p=n(781872),u=n(5220);const h=[`.permission-value.jsx-3193042853{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;padding:${p.N_.UNIT} ${p.N_.UNIT};margin-right:-${p.N_.UNIT};border-radius:${p.n_.DEFAULT};}`,`.permission-value.jsx-3193042853:hover{background-color:${p.DM.GRAY_400};cursor:default;}`,`.permission-value.jsx-3193042853 .value.jsx-3193042853{margin-right:${p.N_.UNIT};}`,`.expanded-permission.jsx-3193042853{background-color:${p.DM.GRAY_400};}`,`.expanded-permission.jsx-3193042853:hover{background-color:${p.DM.GRAY_500};}`,`.permission-options.jsx-3193042853{position:absolute;top:40px;overflow:hidden;background-color:${p.DM.GRAY_400};padding:${p.N_.HALF_UNIT} 0;border-radius:${p.n_.DEFAULT};box-shadow:${p.E6.DARK_DROP_DOWN};z-index:${p.kg.MAX};}`,`.permission.jsx-3193042853{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;width:100%;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:justify;-webkit-justify-content:space-between;-ms-flex-pack:justify;justify-content:space-between;padding:${p.N_.UNIT} ${p.N_.FOUR_UNITS};border-radius:0;}`,`.permission.jsx-3193042853:hover{background-color:${p.DM.GRAY_500};cursor:default;}`,`.permission-divider.jsx-3193042853{height:1px;width:100%;margin:${p.N_.HALF_UNIT} 0;background:${p.DM.GRAY_500};}`,`.selected-permission-check.jsx-3193042853{position:absolute;left:${p.N_.ONE_AND_HALF};}`];h.__hash="3193042853";var y=n(686508),m=n(721403),f=n(552322);function g(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function _(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?g(Object(n),!0).forEach((function(t){(0,i.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):g(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}const b=e=>{const{options:t,value:n,width:o,centerContent:i=!1,style:s="transparent"}=e,{refAttrs:r,optionsRefAttrs:d,onChange:g,optionsWidth:b=o}=e,I=(0,c.useRef)(null),{0:v,1:w}=(0,c.useState)(!1);return(0,y.O)(v?I:null,(()=>w(!1))),(0,f.jsxs)("div",{ref:I,className:`jsx-${h.__hash} `+a().dynamic([["226890568",[i?"center":"space-between",o?`${o}px`:"auto","outline"===s?p.GC.LIGHT:"transparent",i?p.N_.UNIT:0,b?`${b}px`:"140px"]]]),children:[(0,f.jsxs)("span",_(_({},r),{},{onClick:()=>w(!v),className:`jsx-${h.__hash} `+a().dynamic([["226890568",[i?"center":"space-between",o?`${o}px`:"auto","outline"===s?p.GC.LIGHT:"transparent",i?p.N_.UNIT:0,b?`${b}px`:"140px"]]])+" permission-value "+(v?"expanded-permission":""),children:[(0,f.jsx)("span",{className:`jsx-${h.__hash} `+a().dynamic([["226890568",[i?"center":"space-between",o?`${o}px`:"auto","outline"===s?p.GC.LIGHT:"transparent",i?p.N_.UNIT:0,b?`${b}px`:"140px"]]])+" value",children:n}),(0,f.jsx)(l.J,{size:12,type:"expand"})]})),v&&(0,f.jsx)("div",_(_({},d),{},{className:`jsx-${h.__hash} `+a().dynamic([["226890568",[i?"center":"space-between",o?`${o}px`:"auto","outline"===s?p.GC.LIGHT:"transparent",i?p.N_.UNIT:0,b?`${b}px`:"140px"]]])+" "+(d&&null!=d.className&&d.className||"permission-options"),children:(0,f.jsx)(u.E,{noPadding:!0,onSelect:e=>{g&&g(t[+e].value),w(!1)},children:t.map(((e,t)=>(0,f.jsxs)(c.Fragment,{children:[(0,f.jsxs)("li",{"data-item-id":t,className:`jsx-${h.__hash} `+a().dynamic([["226890568",[i?"center":"space-between",o?`${o}px`:"auto","outline"===s?p.GC.LIGHT:"transparent",i?p.N_.UNIT:0,b?`${b}px`:"140px"]]])+" permission",children:[e.value===n&&(0,f.jsx)("span",{className:`jsx-${h.__hash} `+a().dynamic([["226890568",[i?"center":"space-between",o?`${o}px`:"auto","outline"===s?p.GC.LIGHT:"transparent",i?p.N_.UNIT:0,b?`${b}px`:"140px"]]])+" selected-permission-check",children:(0,f.jsx)(l.J,{type:"checkmark",size:8})}),(0,f.jsxs)("span",{className:`jsx-${h.__hash} `+a().dynamic([["226890568",[i?"center":"space-between",o?`${o}px`:"auto","outline"===s?p.GC.LIGHT:"transparent",i?p.N_.UNIT:0,b?`${b}px`:"140px"]]]),children:[" ",e.value]}),e.requiresProPlan&&!e.projectHasProPlan&&(0,f.jsx)(m.b,{text:"PRO"})]}),e.bottomDivider&&(0,f.jsx)("span",{className:`jsx-${h.__hash} `+a().dynamic([["226890568",[i?"center":"space-between",o?`${o}px`:"auto","outline"===s?p.GC.LIGHT:"transparent",i?p.N_.UNIT:0,b?`${b}px`:"140px"]]])+" permission-divider"})]},t)))})})),(0,f.jsx)(a(),{id:h.__hash,children:h}),(0,f.jsx)(a(),{id:"226890568",dynamic:[i?"center":"space-between",o?`${o}px`:"auto","outline"===s?p.GC.LIGHT:"transparent",i?p.N_.UNIT:0,b?`${b}px`:"140px"],children:[`.permission-value.__jsx-style-dynamic-selector{-webkit-box-pack:${i?"center":"space-between"};-webkit-justify-content:${i?"center":"space-between"};-ms-flex-pack:${i?"center":"space-between"};justify-content:${i?"center":"space-between"};width:${o?`${o}px`:"auto"};border:1px solid ${"outline"===s?p.GC.LIGHT:"transparent"};}`,`.value.__jsx-style-dynamic-selector{margin-right:${i?p.N_.UNIT:0};}`,`.permission-options.__jsx-style-dynamic-selector{width:${b?`${b}px`:"140px"};}`]})]})},I=[`.collaborators-modal-wrapper.jsx-1786644332{position:relative;width:512px;box-shadow:${p.E6.DARK_DROP_DOWN};}`,`.collaborators-modal-section.jsx-1786644332{padding:${p.N_.THREE_UNITS} ${p.N_.FOUR_UNITS};}`,".collaborators-header.jsx-1786644332{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-pack:justify;-webkit-justify-content:space-between;-ms-flex-pack:justify;justify-content:space-between;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;}",`.collaborators-modal-title.jsx-1786644332,.public-access-title.jsx-1786644332{cursor:default;color:${p.DM.GRAY_950};}`,".collaborators-modal-title.jsx-1786644332{font-size:14px;}",`.public-access-title.jsx-1786644332{margin-bottom:${p.N_.TWO_UNITS};}`,`.collaborators-modal-divider.jsx-1786644332{height:1px;background:${p.DM.GRAY_400};}`,".public-access-container.jsx-1786644332{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;}",`.public-access-icon.jsx-1786644332{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;margin-right:${p.N_.UNIT};}`,".public-access-options-container.jsx-1786644332{position:relative;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex:1;-ms-flex:1;flex:1;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;-webkit-align-items:flex-start;-webkit-box-align:flex-start;-ms-flex-align:flex-start;align-items:flex-start;}",`.public-option-description.jsx-1786644332{padding-bottom:6px;padding-top:${p.N_.HALF_UNIT};padding-left:${p.N_.UNIT};color:${p.DM.GRAY_700};cursor:default;}`,".public-access-copy-link.jsx-1786644332{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;}",`.upgrade-section.jsx-1786644332{padding:${p.N_.TWO_UNITS};margin:${p.N_.TWO_UNITS} ${p.N_.FOUR_UNITS} ${p.N_.UNIT} ${p.N_.FOUR_UNITS};font-size:14px;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-pack:justify;-webkit-justify-content:space-between;-ms-flex-pack:justify;justify-content:space-between;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;background-color:${p.DM.GRAY_400};border-radius:${p.n_.DEFAULT};}`,".upgrade-text.jsx-1786644332{width:70%;}"];I.__hash="1786644332";var v=n(422169),w=n(173541),O=n(393181);let j;!function(e){e.CAN_VIEW="Can view",e.PRIVATE="Private",e.CLONEABLE="Can clone"}(j||(j={}));const S={[O.W.PRIVATE]:j.PRIVATE,[O.W.PUBLIC]:j.CAN_VIEW,[O.W.CLONEABLE]:j.CLONEABLE},N={[j.CAN_VIEW]:O.W.PUBLIC,[j.PRIVATE]:O.W.PRIVATE,[j.CLONEABLE]:O.W.CLONEABLE},D={[j.CAN_VIEW]:"Anyone with the link can view, no sign-in required",[j.PRIVATE]:"Only collaborators can access",[j.CLONEABLE]:"Anyone with the link can use as a template"};var E=n(302503),T=n(686646),P=n(824497),C=n(638852),x=n(138502),A=n(395942),F=n(868231);const k=[`.collaboration-invite.jsx-2569766504{position:relative;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-pack:justify;-webkit-justify-content:space-between;-ms-flex-pack:justify;justify-content:space-between;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;padding-top:${p.N_.TWO_UNITS};}`,".validation-msg.jsx-2569766504{position:absolute;bottom:-24px;left:0;}",".collaborator-list.jsx-2569766504{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;}",".max_collabs_msg.jsx-2569766504{text-align:center;}",`.send-invite-btn.jsx-2569766504{margin-left:${p.N_.THREE_UNITS};}`];k.__hash="2569766504";var R=n(636201),M=n(405741),U=n(63193),Z=n(889371),L=n(735468),B=n(90895),W=n(582626),z=n(188681);const $="Remove",G=e=>e===P.Z.WRITE?z.u.EDITOR:z.u.VIEWER,H=e=>{const{id:t,email:n,name:o,picture:i,badgeColor:s,userAccessType:r}=e,{onDelete:l,onUpdateAccessType:d}=e,{0:p,1:u}=(0,c.useState)(G(e.accessType));(0,c.useEffect)((()=>{e.accessType&&u(G(e.accessType))}),[e.accessType]);const h=d?Object.values(z.u).map((e=>({value:e}))):[];return l&&(h.length&&(h[h.length-1].bottomDivider=!0),h.push({value:$})),(0,f.jsxs)("div",{className:`jsx-${W.W.__hash} collaborator-section`,children:[(0,f.jsxs)("div",{className:`jsx-${W.W.__hash} collaborator-line`,children:[(0,f.jsxs)("span",{"data-tooltip-name":n,className:`jsx-${W.W.__hash} collab-info`,children:[(0,f.jsxs)("div",{className:`jsx-${W.W.__hash} collab-img-wrapper`,children:[i&&(0,f.jsx)("img",{width:"32",height:"32",src:i,alt:"",className:`jsx-${W.W.__hash} collab-img`}),!i&&(0,f.jsx)("span",{style:{backgroundColor:s},className:`jsx-${W.W.__hash} collab-img`,children:(o?o[0]:n[0]).toUpperCase()})]}),(0,f.jsx)("span",{className:`jsx-${W.W.__hash} collaborator`,children:o||n})]}),(0,f.jsx)("div",{className:`jsx-${W.W.__hash} collaborator-permissions`,children:h.length&&r!==P.Z.READ&&e.permissionLevel===P.z.PROJECT?(0,f.jsx)(b,{centerContent:!0,options:h,value:p,onChange:e=>{if(e===$)return void(l&&l(t));if(!d)return;const o=e===z.u.VIEWER?P.Z.READ:P.Z.WRITE;d({id:t,accessType:o,email:n}),u(e)}}):(0,f.jsxs)("span",{className:`jsx-${W.W.__hash}`,children:[" ",e.accessType===P.Z.OWNER?"Owner":p]})})]}),(0,f.jsx)(a(),{id:W.W.__hash,children:W.W})]})};var K,V,Y,J,X,q,Q,ee,te,ne,oe,ie,se,re,ae,ce,le=n(205632),de=n(975350);function pe(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function ue(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?pe(Object(n),!0).forEach((function(t){(0,i.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):pe(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}let he=(K=(0,E.inject)("projectDoc"),V=(0,E.inject)("projectUIState"),Y=(0,E.inject)("globalAppState"),J=(0,E.inject)("collaboratorManagementFlow"),X=(0,E.inject)("modalManagementFlow"),q=(0,E.inject)("notificationsManagementFlow"),Q=(0,E.inject)("workspacesRepository"),ce=new WeakMap,ee=class extends c.PureComponent{constructor(...e){super(...e),(0,o.Z)(this,"projectDoc",te,this),(0,o.Z)(this,"projectUIState",ne,this),(0,o.Z)(this,"globalAppState",oe,this),(0,o.Z)(this,"collaboratorManagementFlow",ie,this),(0,o.Z)(this,"modalManagementFlow",se,this),(0,o.Z)(this,"notificationsManagementFlow",re,this),(0,o.Z)(this,"workspacesRepository",ae,this),ce.set(this,{writable:!0,value:[]}),(0,i.Z)(this,"state",{accessType:this.props.accessType}),(0,i.Z)(this,"removeCollaborator",(async e=>{if("write"===this.state.accessType){if(await this.workspacesRepository.eachPayingSeatHasCmsProject(this.projectUIState.workspace.id)){this.modalManagementFlow.hideModal();const t=this.projectDoc.collaborators.byId[e];return void le.default.push((0,de.r_)(this.projectUIState.workspace.slug,t,"delete"))}}this.collaboratorManagementFlow.delete(e)})),(0,i.Z)(this,"updateCollaboratorAccessType",(async e=>{const{id:t,accessType:n,email:o}=e;if(n){if("read"===n){if(await this.workspacesRepository.eachPayingSeatHasCmsProject(this.projectUIState.workspace.id)){this.modalManagementFlow.hideModal();const e=this.projectDoc.collaborators.byId[t];return void le.default.push((0,de.r_)(this.projectUIState.workspace.slug,e,"update"))}}this.collaboratorManagementFlow.addOrUpdateProjectCollaborator({accessType:n,action:"update",actionFnc:()=>this.collaboratorManagementFlow.changeAccess(e),collabEmail:o})}}))}componentDidMount(){const e=(0,A.select)(this.projectDoc,[`collaborators/byId/${this.props.id}/accessType`],(e=>{this.setState({accessType:e.collaborators.byId[this.props.id].accessType})}),"CollaboratorWrapperSelector");(0,L.Z)(this,ce).push((()=>e.dispose()))}componentWillUnmount(){(0,L.Z)(this,ce).forEach((e=>e())),(0,Z.Z)(this,ce,[])}render(){const{userAccessType:e,accessType:t}=this.props,n=e===P.Z.OWNER||e===P.Z.WRITE&&t===P.Z.READ;return(0,f.jsx)(H,ue(ue({},this.props),{},{onDelete:n?this.removeCollaborator:void 0,onUpdateAccessType:e===P.Z.OWNER?this.updateCollaboratorAccessType:void 0,accessType:this.state.accessType}))}},te=(0,s.Z)(ee.prototype,"projectDoc",[K],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ne=(0,s.Z)(ee.prototype,"projectUIState",[V],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),oe=(0,s.Z)(ee.prototype,"globalAppState",[Y],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ie=(0,s.Z)(ee.prototype,"collaboratorManagementFlow",[J],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),se=(0,s.Z)(ee.prototype,"modalManagementFlow",[X],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),re=(0,s.Z)(ee.prototype,"notificationsManagementFlow",[q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ae=(0,s.Z)(ee.prototype,"workspacesRepository",[Q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ee);var ye=n(376897);function me(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function fe(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?me(Object(n),!0).forEach((function(t){(0,i.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):me(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}const ge=e=>{const{collaborators:t,userAccessType:n}=e,o=[],i=[];t.forEach((e=>{e.permissionLevel===P.z.PROJECT?o.push(e):i.push(e)}));const s=e=>e.map(((e,t)=>{var o;const i=fe(fe({},e.account),{},{id:e.id,accessType:e.accessType,permissionLevel:e.permissionLevel,email:(null===(o=e.account)||void 0===o?void 0:o.email)||e.invitedEmail}),s=t++%B.q.length;return(0,f.jsx)(he,fe({badgeColor:B.q[s],userAccessType:n},i),e.id)}));return(0,f.jsxs)(f.Fragment,{children:[o.length?(0,f.jsxs)(f.Fragment,{children:[(0,f.jsxs)("div",{className:a().dynamic([["2315402216",[p.DM.GRAY_700,p.N_.THREE_UNITS,p.Xw.MEDIUM_600,p.N_.HALF_UNIT]]])+" section-title",children:[(0,f.jsx)("span",{className:a().dynamic([["2315402216",[p.DM.GRAY_700,p.N_.THREE_UNITS,p.Xw.MEDIUM_600,p.N_.HALF_UNIT]]]),children:"Project collaborators"}),(0,f.jsx)("div",{"data-tooltip-name":"project-collaborators",className:a().dynamic([["2315402216",[p.DM.GRAY_700,p.N_.THREE_UNITS,p.Xw.MEDIUM_600,p.N_.HALF_UNIT]]])+" info",children:(0,f.jsx)(l.J,{size:12,type:"info"})})]}),s(o),(0,f.jsx)(ye._,{name:"project-collaborators",children:(0,f.jsx)(f.Fragment,{children:"Can access only projects they\u2019re invited to. Can\u2019t create new projects in the workspace and other projects from the workspace aren\u2019t visibile for them."})})]}):null,i.length?(0,f.jsxs)(f.Fragment,{children:[(0,f.jsxs)("div",{className:a().dynamic([["2315402216",[p.DM.GRAY_700,p.N_.THREE_UNITS,p.Xw.MEDIUM_600,p.N_.HALF_UNIT]]])+" section-title",children:[(0,f.jsx)("span",{className:a().dynamic([["2315402216",[p.DM.GRAY_700,p.N_.THREE_UNITS,p.Xw.MEDIUM_600,p.N_.HALF_UNIT]]]),children:"Workspace collaborators"}),(0,f.jsx)("div",{"data-tooltip-name":"workspace-collaborators",className:a().dynamic([["2315402216",[p.DM.GRAY_700,p.N_.THREE_UNITS,p.Xw.MEDIUM_600,p.N_.HALF_UNIT]]])+" info",children:(0,f.jsx)(l.J,{size:12,type:"info"})})]}),s(i),(0,f.jsx)(ye._,{name:"workspace-collaborators",children:(0,f.jsx)(f.Fragment,{children:"Can access everything that\u2019s created in the workspace. Editor roles can create new projects. Manage your workspace collaborators from workspace settings."})})]}):null,(0,f.jsx)(a(),{id:"2315402216",dynamic:[p.DM.GRAY_700,p.N_.THREE_UNITS,p.Xw.MEDIUM_600,p.N_.HALF_UNIT],children:[`.section-title.__jsx-style-dynamic-selector{color:${p.DM.GRAY_700};margin-top:${p.N_.THREE_UNITS};font-weight:${p.Xw.MEDIUM_600};display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;}`,`.info.__jsx-style-dynamic-selector{padding-left:${p.N_.HALF_UNIT};display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;}`]})]})};var _e,be,Ie,ve,we,Oe,je,Se;let Ne=(_e=(0,E.inject)("collaboratorManagementFlow"),be=(0,E.inject)("projectDoc"),Ie=(0,E.inject)("projectUIState"),Se=new WeakMap,ve=class extends c.PureComponent{constructor(...e){super(...e),(0,o.Z)(this,"collaboratorManagementFlow",we,this),(0,o.Z)(this,"projectDoc",Oe,this),(0,o.Z)(this,"projectUIState",je,this),Se.set(this,{writable:!0,value:[]}),(0,i.Z)(this,"state",{collaborators:this.projectDoc.collaborators.getAll()})}componentDidMount(){const e=(0,A.select)(this.projectDoc,["collaborators/byId/*"],(e=>{this.setState({collaborators:e.collaborators.getAll()})}),"CollaboratorListWrapperSelector");(0,L.Z)(this,Se).push((()=>e.dispose()))}componentWillUnmount(){(0,L.Z)(this,Se).forEach((e=>e())),(0,Z.Z)(this,Se,[])}render(){const{collaborators:e}=this.state;return(0,f.jsx)(ge,{collaborators:e,userAccessType:this.props.userAccessType})}},we=(0,s.Z)(ve.prototype,"collaboratorManagementFlow",[_e],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Oe=(0,s.Z)(ve.prototype,"projectDoc",[be],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),je=(0,s.Z)(ve.prototype,"projectUIState",[Ie],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ve);var De=n(233724);function Ee(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function Te(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Ee(Object(n),!0).forEach((function(t){(0,i.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ee(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}const Pe=e=>e===P.Z.WRITE?[{value:z.u.VIEWER}]:Object.values(z.u).map((e=>({value:e}))),Ce=e=>{const{onSubmit:t,limitations:n,collaborators:o,userAccessType:i}=e,{0:s,1:r}=(0,c.useState)(""),{0:l,1:d}=(0,c.useState)(""),{0:u,1:h}=(0,c.useState)(Pe(i)[0].value),y=(0,c.useCallback)((e=>{e.key===F.KEY.ENTER&&(m(),e.preventDefault())}),[l,u]),m=(0,c.useCallback)((async()=>{const e=await t({email:l,accessType:"Editor"===u?P.Z.WRITE:P.Z.READ});e||d(""),r(e||"")}),[l,u]),g=(0,c.useCallback)((()=>o.length>=e.limitations.MAX_COLLABORATORS),[n]);return(0,f.jsxs)("div",{className:`jsx-${k.__hash}`,children:[i!==P.Z.READ?(0,f.jsx)("div",{className:`jsx-${k.__hash} collaboration-invite`,children:g()?(0,f.jsx)("span",{className:`jsx-${k.__hash} max_collabs_msg`,children:M.xE}):(0,f.jsxs)(f.Fragment,{children:[(0,f.jsxs)(U.h,{arrangement:"row",behavior:"none",children:[(0,f.jsx)(R.S,{onChange:e=>{d(e.target.value.toLowerCase().trim())},refAttrs:{style:{padding:`0 ${p.N_.UNIT}`}},"data-property":"email-input",value:l,onKeyDown:y,validationMessage:s,size:"flexible",style:"boxed",placeholder:"Add email"}),(0,f.jsx)(f.Fragment,{children:s&&(0,f.jsx)("div",{className:`jsx-${k.__hash} validation-msg`,children:(0,f.jsx)(De.B,{message:s})})}),(0,f.jsx)("div",{className:`jsx-${k.__hash}`,children:(0,f.jsx)(b,{centerContent:!0,options:Pe(i),value:u,width:80,optionsWidth:100,style:"outline",refAttrs:{style:{borderRadius:"0 4px 4px 0"}},onChange:h})})]}),(0,f.jsx)("div",{className:`jsx-${k.__hash} send-invite-btn`,children:(0,f.jsx)(w.z,{onClick:()=>{m()},dataAttrs:{"data-tooltip-name":"Invite Collaborator","data-tooltip-direction":"vertical"},children:"Send invite"})})]})}):null,(0,f.jsx)("div",{className:`jsx-${k.__hash} collaborator-list`,children:(0,f.jsx)(Ne,Te({},e))}),(0,f.jsx)(a(),{id:k.__hash,children:k})]})};var xe,Ae,Fe,ke,Re,Me,Ue,Ze,Le,Be,We,ze,$e,Ge,He,Ke,Ve;let Ye=(xe=(0,E.inject)("collaboratorManagementFlow"),Ae=(0,E.inject)("projectUIState"),Fe=(0,E.inject)("validationService"),ke=(0,E.inject)("globalAppState"),Re=(0,E.inject)("projectDoc"),Me=(0,E.inject)("projectInitFlow"),Ue=(0,E.inject)("modalManagementFlow"),Ze=(0,E.inject)("notificationsManagementFlow"),Le=class extends c.PureComponent{constructor(...e){super(...e),(0,o.Z)(this,"collaboratorManagementFlow",Be,this),(0,o.Z)(this,"projectUIState",We,this),(0,o.Z)(this,"validationService",ze,this),(0,o.Z)(this,"globalAppState",$e,this),(0,o.Z)(this,"projectDoc",Ge,this),(0,o.Z)(this,"projectInitFlow",He,this),(0,o.Z)(this,"modalManagementFlow",Ke,this),(0,o.Z)(this,"notificationsManagementFlow",Ve,this),(0,i.Z)(this,"unsubs",[]),(0,i.Z)(this,"state",{collaborators:this.projectDoc.collaborators.getAll()}),(0,i.Z)(this,"addCollaborator",(async e=>{const{email:t,accessType:n}=e,o=this.collaboratorManagementFlow.emailIsAlreadyInvited(t),{message:i,valid:s}=this.validationService.validateEmailForCollaboratorInvite({email:t,alreadyInvited:o});if(!s)return i;C.Z.mixpanelEvent(C.Z.AnalyticsEvents.PROJECT_SIDEBARS_TOP_SHARE_MENU_INVITE,{accessType:n}),this.collaboratorManagementFlow.addOrUpdateProjectCollaborator({accessType:n,action:"add",actionFnc:()=>this.collaboratorManagementFlow.add(e),collabEmail:t})}))}componentDidMount(){const e=(0,A.select)(this.projectDoc,["collaborators/byId/*"],(e=>{this.setState({collaborators:e.collaborators.getAll()})}),"CollaboratorsPanelWrapper");this.unsubs=[()=>e.dispose()]}componentWillUnmount(){this.unsubs.forEach((e=>e())),this.unsubs=[]}render(){const e=this.globalAppState.user.userData;if(!e)throw new Error("Attempted to render collaborators list without a logged in user!");return(0,f.jsx)(Ce,{loggedInUser:e,limitations:this.projectInitFlow.getProjectLimitations(),collaborators:this.state.collaborators,onSubmit:this.addCollaborator,userAccessType:this.props.userAccessType})}},Be=(0,s.Z)(Le.prototype,"collaboratorManagementFlow",[xe],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),We=(0,s.Z)(Le.prototype,"projectUIState",[Ae],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ze=(0,s.Z)(Le.prototype,"validationService",[Fe],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),$e=(0,s.Z)(Le.prototype,"globalAppState",[ke],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Ge=(0,s.Z)(Le.prototype,"projectDoc",[Re],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),He=(0,s.Z)(Le.prototype,"projectInitFlow",[Me],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Ke=(0,s.Z)(Le.prototype,"modalManagementFlow",[Ue],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Ve=(0,s.Z)(Le.prototype,"notificationsManagementFlow",[Ze],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Le);var Je,Xe,qe,Qe,et,tt,nt,ot,it,st,rt,at,ct,lt,dt,pt,ut;const ht={[j.CAN_VIEW]:(0,f.jsx)(l.J,{type:d.TV.globe,size:32,color:p.DM.ACCENT_500}),[j.PRIVATE]:(0,f.jsx)(l.J,{type:d.TV.private,size:32,color:"transparent"}),[j.CLONEABLE]:(0,f.jsx)(l.J,{type:d.TV.globe,size:32,color:p.DM.ACCENT_500})};let yt=(Je=(0,E.inject)("notificationsManagementFlow"),Xe=(0,E.inject)("projectDoc"),qe=(0,E.inject)("projectUIState"),Qe=(0,E.inject)("collaboratorManagementFlow"),et=(0,E.inject)("workspacesRepository"),tt=(0,E.inject)("globalAppState"),nt=(0,E.inject)("modalManagementFlow"),ot=(0,E.inject)("workspacesFlow"),it=class extends c.PureComponent{constructor(...e){super(...e),(0,o.Z)(this,"notificationsManagementFlow",st,this),(0,o.Z)(this,"projectDoc",rt,this),(0,o.Z)(this,"projectUIState",at,this),(0,o.Z)(this,"collaboratorManagementFlow",ct,this),(0,o.Z)(this,"workspacesRepository",lt,this),(0,o.Z)(this,"globalAppState",dt,this),(0,o.Z)(this,"modalManagementFlow",pt,this),(0,o.Z)(this,"workspacesFlow",ut,this),(0,i.Z)(this,"state",{loggedUserAccessType:null,accessType:S[this.projectDoc.accessType],readonlyProject:!!this.projectUIState.readonly}),(0,i.Z)(this,"unsubs",[]),(0,i.Z)(this,"onSubmitFeatureUnavailableModal",(()=>{C.Z.mixpanelEvent(C.Z.AnalyticsEvents.PROJECT_SIDEBARS_TOP_INVITE_MENU_PRIVATE_MODAL_UPGRADE)})),(0,i.Z)(this,"openUpgradeModal",(()=>{var e,t,n;const o=null===(e=this.projectDoc.collaborators.getWorkspaceOwner())||void 0===e||null===(t=e.account)||void 0===t?void 0:t.id,i=v.d.createCustomModal({Component:x.h,data:{workspaceName:this.projectUIState.workspace.name,workspaceSlug:this.projectUIState.workspace.slug,isWorkspaceOwner:o===(null===(n=this.globalAppState.user.userData)||void 0===n?void 0:n.id),handleUpgradeClick:this.handleUpgradeClick},onSubmit:this.onSubmitFeatureUnavailableModal});this.modalManagementFlow.showModal(i)})),(0,i.Z)(this,"handleUpgradeClick",(()=>{this.workspacesFlow.triggerUpgradeWorkspaceModal({})})),(0,i.Z)(this,"handleAccessTypeChange",(e=>{if(e!==this.state.accessType){if(!this.projectUIState.workspace.professionalSubscription&&e===j.PRIVATE)return C.Z.mixpanelEvent(C.Z.AnalyticsEvents.PROJECT_SIDEBARS_TOP_INVITE_MENU_PRIVATE_ACCESS),void this.openUpgradeModal();C.Z.mixpanelEvent(C.Z.AnalyticsEvents.PROJECT_SIDEBARS_TOP_SHARE_MENU_PUBLIC_ACCESS_SELECT,{accessType:e}),this.setState({accessType:e}),this.collaboratorManagementFlow.changeProjectAccessType(N[e])}})),(0,i.Z)(this,"copyCurrentLink",(()=>{navigator.clipboard.writeText(window.location.href),this.notificationsManagementFlow.createNotification(T.k$.INFO,"Link was copied in clipboard.")}))}componentDidMount(){this.setState({loggedUserAccessType:this.collaboratorManagementFlow.getLoggedInUserAccessType()});const e=(0,A.select)(this.projectUIState,["readonly"],(({readonly:e})=>{this.setState({readonlyProject:!!e})}),"readonly-sub");this.unsubs.push((()=>e.dispose()))}componentWillUnmount(){this.unsubs.forEach((e=>e())),this.unsubs=[]}render(){var e,t,n,o;const{accessType:i,loggedUserAccessType:s,readonlyProject:r}=this.state,{onDismiss:c}=this.props,d=this.projectUIState.workspace.professionalSubscription,p=(null===(e=this.globalAppState.user.userData)||void 0===e?void 0:e.isAnonymous)||!1,u=(null===(t=this.projectDoc.collaborators.getWorkspaceOwner())||void 0===t||null===(n=t.account)||void 0===n?void 0:n.id)===(null===(o=this.globalAppState.user.userData)||void 0===o?void 0:o.id),h=[{value:S.private,bottomDivider:!0,requiresProPlan:!0,projectHasProPlan:this.projectUIState.workspace.professionalSubscription},{value:S.public},{value:S.cloneable}];return(0,f.jsxs)("div",{className:`jsx-${I.__hash} collaborators-modal-wrapper`,children:[(0,f.jsxs)("div",{className:`jsx-${I.__hash} collaborators-modal-section`,children:[(0,f.jsxs)("div",{className:`jsx-${I.__hash} collaborators-header`,children:[(0,f.jsx)("p",{className:`jsx-${I.__hash} collaborators-modal-title`,children:"Collaborators"}),(0,f.jsx)(w.z,{onClick:c,size:"small",style:"transparent",children:(0,f.jsx)(l.J,{type:"actions/close",size:14})})]}),s?(0,f.jsx)(Ye,{userAccessType:s}):null]}),(0,f.jsx)("div",{className:`jsx-${I.__hash} collaborators-modal-divider`}),!d&&!r&&!p&&u&&(0,f.jsxs)("div",{className:`jsx-${I.__hash} upgrade-section`,children:[(0,f.jsxs)("div",{className:`jsx-${I.__hash} upgrade-text`,children:["Upgrade to ",(0,f.jsx)("b",{className:`jsx-${I.__hash}`,children:"PRO"})," to unlock private access and a whole lot of amazing features"]}),(0,f.jsx)(w.z,{onClick:()=>{C.Z.mixpanelEvent(C.Z.AnalyticsEvents.PROJECT_SIDEBARS_TOP_INVITE_MENU_UPGRADE),this.handleUpgradeClick()},title:"Upgrade Now",size:"medium",colorScheme:"orange-red",style:"solid",dataAttrs:{"data-tooltip-direction":"vertical"},children:"Upgrade Now"})]}),s!==P.Z.READ?(0,f.jsxs)("div",{className:`jsx-${I.__hash} collaborators-modal-section`,children:[(0,f.jsx)("p",{className:`jsx-${I.__hash} public-access-title`,children:"Public access"}),(0,f.jsxs)("div",{className:`jsx-${I.__hash} public-access-container`,children:[(0,f.jsx)("div",{className:`jsx-${I.__hash} public-access-icon`,children:ht[i]}),(0,f.jsxs)("div",{className:`jsx-${I.__hash} public-access-options-container`,children:[(0,f.jsx)(b,{options:h,value:i,onChange:this.handleAccessTypeChange}),(0,f.jsx)("span",{className:`jsx-${I.__hash} public-option-description`,children:D[i]})]}),i!==j.PRIVATE&&(0,f.jsx)("div",{className:`jsx-${I.__hash} public-access-copy-link`,children:(0,f.jsx)(w.z,{style:"outline",colorScheme:"neutral",onClick:this.copyCurrentLink,children:"Copy link"})})]})]}):null,(0,f.jsx)(a(),{id:I.__hash,children:I})]})}},st=(0,s.Z)(it.prototype,"notificationsManagementFlow",[Je],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),rt=(0,s.Z)(it.prototype,"projectDoc",[Xe],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),at=(0,s.Z)(it.prototype,"projectUIState",[qe],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ct=(0,s.Z)(it.prototype,"collaboratorManagementFlow",[Qe],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),lt=(0,s.Z)(it.prototype,"workspacesRepository",[et],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),dt=(0,s.Z)(it.prototype,"globalAppState",[tt],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),pt=(0,s.Z)(it.prototype,"modalManagementFlow",[nt],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ut=(0,s.Z)(it.prototype,"workspacesFlow",[ot],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),it)},188681:function(e,t,n){n.d(t,{u:function(){return o}});const o={EDITOR:"Editor",VIEWER:"Viewer"}},278702:function(e,t,n){n.d(t,{Uq:function(){return s},kd:function(){return r},b3:function(){return a},U2:function(){return c},Mv:function(){return l},xf:function(){return d},kS:function(){return p}});var o=n(925984),i=n(592681);const s=(e,t)=>{const n="attrs"in e?e.attrs:void 0;if(n&&t in n)return n[t]},r=(e,t)=>{var n;return null===(n=s(e,t))||void 0===n?void 0:n.content},a=(e,t)=>{const n=s(e,t),o="string"===typeof n?n:null===n||void 0===n?void 0:n.content;if(void 0!==o){if("dynamic"===(null===n||void 0===n?void 0:n.type)){var i;return`.${null===(i=(null===n||void 0===n?void 0:n.content).refPath)||void 0===i?void 0:i.join(".")}`}return o}},c=(e,t,n)=>e.nodes.getAncestors({nodeId:t,excludeRoot:!0,includePassedNode:!0}).map((t=>e.nodes.getById(t))).find((e=>{var t,i,s;return n?(null===(t=e&&"attrs"in e?null===e||void 0===e?void 0:e.attrs:{})||void 0===t||null===(i=t[o.AS])||void 0===i?void 0:i.content)===n:null===(s=e&&"attrs"in e?null===e||void 0===e?void 0:e.attrs:{})||void 0===s?void 0:s[o.AS]})),l=e=>"0"===(null===e||void 0===e?void 0:e.top)&&"100%"===(null===e||void 0===e?void 0:e.left)?"right":"0%"===(null===e||void 0===e?void 0:e.left)?"below":"0"===(null===e||void 0===e?void 0:e.top)&&"100%"===(null===e||void 0===e?void 0:e.right)?"left":"100%"===(null===e||void 0===e?void 0:e.bottom)?"above":"below",d=(e,t,n)=>{if(!t)return;const i="childrenIds"in t?Object.keys(t.childrenIds):[];for(const r of i){var s;const t=e.nodes.getById(r);if((null===(s=t.attrs[o.AS])||void 0===s?void 0:s.content)===n)return t;const i=d(e,t,n);if(i)return i}},p=e=>e&&i.Ze.INPUT_TYPE.options.includes(e.content)?e.content.toString():""},989993:function(e,t,n){function o(e){const t=[],n=/[,\(\)]/;let o=0,i="";if(null==e)return t;for(;e.length;){const s=n.exec(e);if(!s)break;let r=!1,a=!1;switch(s[0]){case",":o||(i?(t.push(i.trim()),i=""):a=!0,r=!0);break;case"(":o++;break;case")":o--}const c=s.index+1;i+=e.slice(0,r?c-1:c),e=e.slice(c),a&&(t.push(i.trim()),i="",r=!0)}return(i.length||e.length)&&t.push((i+e).trim()),t}function i(e){return e.replace(/^url\(["']?/,"").replace(/["']?\)$/,"")}n.d(t,{BQ:function(){return o},tH:function(){return i}})},764944:function(e,t,n){n.d(t,{FG:function(){return s},hm:function(){return r},sb:function(){return a},He:function(){return c},vS:function(){return l}});var o=n(916539),i=n(223924);const s=(e,t)=>{var n;return(null===(n=e.find((e=>(0,o.MU)(e)===t)))||void 0===n?void 0:n.value)||t},r=e=>{var t,n;return"referencedStyles"in e?null===(t=Object.values(e.referencedStyles||{}).find((e=>"design-language-referenced"===e.content.mapType)))||void 0===t||null===(n=t.content)||void 0===n?void 0:n.referenceId:null},a=e=>{const t=document.querySelector(`[data-section-title="${e?`${e.name}`:i.PN.TEXT_STYLES}"]`);return t?null===t||void 0===t?void 0:t.getBoundingClientRect():null},c=e=>{const t=document.querySelector(`[data-section-title="${e}"]`);return t?null===t||void 0===t?void 0:t.getBoundingClientRect():null},l=(e,t,n=!1)=>{if(e.matchedBreakpoint!==t.matchedBreakpoint)return!0;if(e.interactionStateMeta.state!==t.interactionStateMeta.state)return!0;if(!n)return!1;const o=e.selectionStyles,i=t.selectionStyles;return JSON.stringify(o)!==JSON.stringify(i)}},273526:function(e,t,n){n.d(t,{W:function(){return i}});var o=n(781872);const i=[".jsx-1577976121{--content-modal-header:48px;--content-modal-footer:64px;}",`.content-modal-header.jsx-1577976121{padding:0 ${o.N_.UNIT} 0 ${o.N_.TWO_UNITS} !important;height:var(--content-modal-header);display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:justify;-webkit-justify-content:space-between;-ms-flex-pack:justify;justify-content:space-between;border-bottom:1px solid ${o.DM.GRAY_400};}`,`.content-root.jsx-1577976121{padding:${o.N_.TWO_UNITS};gap:${o.N_.HALF_UNIT};display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;}`,`.content-modal-footer.jsx-1577976121{padding:0 ${o.N_.TWO_UNITS} 0 ${o.N_.TWO_UNITS} !important;height:var(--content-modal-footer);display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;border-top:1px solid ${o.DM.GRAY_400};gap:${o.N_.UNIT};-webkit-box-pack:justify;-webkit-justify-content:space-between;-ms-flex-pack:justify;justify-content:space-between;}`];i.__hash="1577976121"},405741:function(e,t,n){n.d(t,{xE:function(){return o},m5:function(){return i},_O:function(){return s},lH:function(){return r},qz:function(){return a},PX:function(){return c},Zu:function(){return l}});const o="Can't add collaborators. The maximum number allowed in the same time on a project has been reached.",i="Page name cannot be empty.",s="The page name cannot contain slashes",r="Each page should have a unique name to ensure your application works correctly.",a="Each page should have a unique URL to ensure your application works correctly.",c="This URL is reserved for the home page to ensure your application works correctly.",l="Cannot delete page URL, because the one that will be generated in its place is already in use."},412940:function(e,t,n){n.d(t,{aM:function(){return o},Bk:function(){return i},HN:function(){return s},m7:function(){return r},Or:function(){return a},eU:function(){return c}});const o={GENERAL_PAGE_NAME:"GENERAL_PAGE_NAME",GENERAL_URL:"GENERAL_URL",SEO_TITLE:"SEO_TITLE",SEO_DESCRIPTION:"SEO_DESCRIPTION",SEO_NO_INDEX:"SEO_NO_INDEX",SOCIAL_TITLE:"SOCIAL_TITLE",SOCIAL_DESCRIPTION:"SOCIAL_DESCRIPTION",SOCIAL_IMAGE:"SOCIAL_IMAGE"},i=1200,s=1e3,r={controlValues:{x:.5,y:.675,scale:1},stateValues:{contentBox:{width:0,height:0,top:0,left:0,bottom:0,right:0},stageBox:{width:0,height:0,top:0,left:0,bottom:0,right:0},translateXValue:0,translateYValue:0,logicalValues:{minX:0,maxX:0,minY:0,maxY:0},reverseScale:1}},a=["margin","padding","border","width","height","self","flex","position","top","left","right","bottom"],c={"How To":[{title:"1. Build your first website in TeleportHQ - part 1 ",url:"https://www.youtube.com/watch?v=BMMm85B5Qoo",imgSrc:"/static/img/tutorials/how-to/1.jpg"},{title:"2. Build your first website in TeleportHQ - part 2",url:"https://www.youtube.com/watch?v=ddo_Ij0Ytjw",imgSrc:"/static/img/tutorials/how-to/2.png"},{title:"3. Export your designs from Figma to code",url:"https://www.youtube.com/watch?v=kxW62eMsw0k",imgSrc:"/static/img/tutorials/how-to/3.jpg"},{title:"4. Create reusable UI components for your website",url:"https://www.youtube.com/watch?v=H-PkPKF2Tfk",imgSrc:"/static/img/tutorials/how-to/4.jpg"},{title:"5. Make a responsive navigation menu",url:"https://www.youtube.com/watch?v=itPw43q2ruI",imgSrc:"/static/img/tutorials/how-to/5.jpg"},{title:"6. Host a website for free using TeleportHQ",url:"https://www.youtube.com/watch?v=xBTq5ngwIJA",imgSrc:"/static/img/tutorials/how-to/6.jpg"}],Fundamentals:[{title:"1. Set up your design tokens",url:"https://www.youtube.com/watch?v=8-LZoc6Qedw",imgSrc:"/static/img/tutorials/fundamentals/1.jpg"},{title:"2. Add and edit elements",url:"https://www.youtube.com/watch?v=tztgXLi82gg",imgSrc:"/static/img/tutorials/fundamentals/2.jpg"},{title:"3. Add interaction states",url:"https://www.youtube.com/watch?v=OUH2r6dmbHo",imgSrc:"/static/img/tutorials/fundamentals/3.jpg"},{title:"4. Publish your first project",url:"https://www.youtube.com/watch?v=ULIoqVGu1Vo",imgSrc:"/static/img/tutorials/fundamentals/4.jpg"},{title:"5. View and export the generated code",url:"https://www.youtube.com/watch?v=6_Mg35if8ps",imgSrc:"/static/img/tutorials/fundamentals/5.jpg"}]}},319682:function(e,t,n){n.d(t,{_:function(){return s}});var o=n(777460),i=n(395942);class s{constructor(){(0,o.Z)(this,i.Patcher,!0),(0,o.Z)(this,"isEnabled",!1),(0,o.Z)(this,"status","unset"),(0,o.Z)(this,"cmsConnectionData",null),(0,o.Z)(this,"usedContentTypes",{}),(0,o.Z)(this,"componentTypes",{}),(0,o.Z)(this,"locales",void 0),(0,o.Z)(this,"sortAttributes",{}),(0,o.Z)(this,"filterAttributes",{}),(0,o.Z)(this,"allowedDifferentiators",{}),(0,o.Z)(this,"meta",{allowMultipleSorts:!0,allowSameAttributeFilter:!1}),(0,o.Z)(this,"webhook",{config:{teleport:null,vercel:null},lastPublishedConfig:{teleport:null,vercel:null}})}toJSON(){return{isEnabled:this.isEnabled,cmsConnectionData:this.cmsConnectionData,componentTypes:this.componentTypes,usedContentTypes:this.usedContentTypes,sortAttributes:this.sortAttributes,filterAttributes:this.filterAttributes,meta:this.meta,allowedDifferentiators:this.allowedDifferentiators,status:this.status,webhook:this.webhook,locales:this.locales}}fromJSON(e){const{isEnabled:t=!1,cmsConnectionData:n,usedContentTypes:o,componentTypes:i,sortAttributes:s=[],filterAttributes:r=[],allowedDifferentiators:a={},meta:c={allowMultipleSorts:!0,allowSameAttributeFilter:!1},status:l,webhook:d={config:{teleport:null,vercel:null},lastPublishedConfig:{teleport:null,vercel:null}}}=e;return n&&(this.cmsConnectionData=n),this.isEnabled=!!t,this.sortAttributes=s,this.filterAttributes=r,this.meta=c,this.allowedDifferentiators=a,this.status=l,"object"===typeof o&&o&&(this.usedContentTypes=o),"object"===typeof i&&i&&(this.componentTypes=i),this.webhook=d,this.locales=e.locales,this}applyPatch(e){const{op:t,pathArray:n,value:o}=e}}},461778:function(e,t,n){n.d(t,{n:function(){return w}});var o,i,s,r=n(503348),a=n(777460),c=n(918437),l=n(813244),d=n(302503),p=n(395942),u=n(491463),h=n(378888),y=n(858342),m=n(229187),f=n(971162),g=n(851913),_=n(278702),b=n(564651);function I(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function v(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?I(Object(n),!0).forEach((function(t){(0,a.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):I(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}let w=(o=(0,d.inject)("projectUIState"),i=class e{constructor(e={}){(0,a.Z)(this,p.Patcher,!0),(0,a.Z)(this,"type","component"),(0,a.Z)(this,"title",void 0),(0,a.Z)(this,"id",void 0),(0,a.Z)(this,"pos",void 0),(0,a.Z)(this,"rootNodeId",void 0),(0,a.Z)(this,"instantiatedByNodes",{}),(0,a.Z)(this,"usedComponents",{}),(0,a.Z)(this,"stateDefinitions",{}),(0,a.Z)(this,"propDefinitions",{}),(0,a.Z)(this,"sectionIds",{}),(0,a.Z)(this,"styleSetDefinitions",{}),(0,a.Z)(this,"checkerRenderStyle",void 0),(0,a.Z)(this,"slots",{}),(0,a.Z)(this,"customSectionType",void 0),(0,a.Z)(this,"contentGeneratedByAI",void 0),(0,a.Z)(this,"forPreviewOnly",void 0),(0,r.Z)(this,"projectUIState",s,this);const{title:t="",id:n,rootNodeId:o,pos:i,instantiatedByNodes:c,usedComponents:l,stateDefinitions:d,propDefinitions:u,sectionIds:y,styleSetDefinitions:m,checkerRenderStyle:f,customSectionType:_,contentGeneratedByAI:b,forPreviewOnly:I,slots:v}=e;this.title=t,this.id=null!==n&&void 0!==n?n:(0,h.Ox)(),this.rootNodeId=o,this.pos=null!==i&&void 0!==i?i:"0",this.instantiatedByNodes=c||{},this.usedComponents=l||{},this.stateDefinitions=d||{},this.propDefinitions=u||{},this.sectionIds=y||{},this.styleSetDefinitions=m||{},this.customSectionType=_,this.contentGeneratedByAI=b||!1,this.checkerRenderStyle=f||g.wY.WHITE_CHESS,this.forPreviewOnly=I||!1,this.slots=v}create(t){const n=(0,h.Ox)();return new e(v(v({},t),{},{id:n,instantiatedByNodes:{},usedComponents:{},stateDefinitions:{},propDefinitions:{},sectionIds:{},styleSetDefinitions:{},customSectionType:void 0,forPreviewOnly:!1,contentGeneratedByAI:!1,checkerRenderStyle:g.wY.WHITE_CHESS,slots:{}}))}changeRenderStyle(e){this.checkerRenderStyle=e.newRenderStyle}createPropDefinition(e){const t=Object.values(this.propDefinitions).map((e=>(0,b.createStateOrPropStoringValue)((0,h.Y$)(e.name)))),n="func"===e.type?e.name:(0,u.Zu)(t,(0,b.createStateOrPropStoringValue)((0,h.Y$)(e.name))),o=v(v({},e),{},{id:e.id||(0,h.Ox)(),name:n,declarationType:"prop"});return this.propDefinitions[o.id]=o,o}removePropDefinitionFromComp(e){e.forEach((e=>{delete this.propDefinitions[e]}))}updatePropDefinition(e,t){const n=this.propDefinitions[e];if(!n)throw new Error("Prop definition was not found");t.name&&this.propDefinitions[e].name!==t.name&&(t.name=this.getUniquePropDefinitionName(t.name)),this.propDefinitions[e]=v(v({},n),t)}createStateDefinition(e){const t=Object.values(this.stateDefinitions).map((e=>(0,b.createStateOrPropStoringValue)(e.name))),n=(0,y.Oe)(e.name),o=(0,u.Zu)(t,(0,b.createStateOrPropStoringValue)(n)),i=v(v({},e),{},{id:(0,h.Ox)(),name:o,declarationType:"state"});return this.stateDefinitions[i.id]=i,i}deleteStateDefinition(e){this.stateDefinitions[e]={},delete this.stateDefinitions[e]}updateStateDefinition(e,t){const n=this.stateDefinitions[e];if(!n)throw new Error("State definition was not found");t.name&&this.stateDefinitions[e].name!==t.name&&(t.name=this.getUniqueStateDefinitionName(t.name)),this.stateDefinitions[e]=v(v({},n),t)}getInlineConditionalStyleMapForClass(e,t){const n=this.styleSetDefinitions[t];if(n&&n.referencedStyles)return(0,f.YR)(n.referencedStyles,e)}getUniqueStyleSetName(e){const t=m.Q,n=Object.keys(this.instantiatedByNodes||{}).map((t=>{const n=e.nodes.getById(t);if(n&&"attrs"in n)return(0,_.kd)(n,m.Q)})).filter((e=>e)),o=[...Object.keys(this.styleSetDefinitions||{}),...n];if(-1===o.indexOf(t))return t;let i=1;for(;-1!==o.indexOf(`${t}${i}`);)i+=1;return`${t}${i}`}getInlineMatchedStyleSetIdsForClass(e,t){var n;const o=(null===(n=this.styleSetDefinitions[t])||void 0===n?void 0:n.referencedStyles)||{};return(0,f.uY)(o,e)}initStyleSetForClass(e){this.styleSetDefinitions&&Object.keys(this.styleSetDefinitions).length||(this.styleSetDefinitions={}),this.styleSetDefinitions[e]||(this.styleSetDefinitions[e]={usedByInstances:{},styles:{},referencedStyles:{}})}removePropDefinitionsForNodes(e){Object.keys(this.propDefinitions).filter((t=>{const n=this.propDefinitions[t];if(!Object.keys(n.locations).length)return!1;for(const o of e)n.locations[o]&&delete n.locations[o];return!1})).forEach((e=>delete this.propDefinitions[e]))}removeStateDefinitionsLocationsForNodes(e){Object.keys(this.stateDefinitions).forEach((t=>{const n=this.stateDefinitions[t];for(const o of e)n.locations[o]&&delete n.locations[o]}))}addLocationToPropDefinition(e,t,n){const o=this.propDefinitions[e];if(!o)return;const i=o.locations[t],s=(0,y.mZ)(n);i?o.locations[t][s]=n:o.locations=v(v({},o.locations),{},{[t]:{[s]:n}})}removeLocationFromPropDefinition(e,t,n){var o;const i=this.propDefinitions[e];if(!i)return;const s=(0,y.mZ)(n);if(!(null===(o=i.locations[t])||void 0===o?void 0:o[s]))return;const r=i.locations;1===Object.keys(r[t]).length?delete r[t]:delete r[t][s],i.locations=v({},r)}addLocationToStateDefinition(e,t,n){const o=this.stateDefinitions[e];o.locations||(o.locations={});const i=o.locations[t],s=(0,y.mZ)(n);i?o.locations[t][s]=n:o.locations[t]={[s]:n}}removeLocationFromStateDefinition(e,t,n){var o;const i=this.stateDefinitions[e],s=(0,y.mZ)(n);(null===(o=i.locations[t])||void 0===o?void 0:o[s])&&(1===Object.keys(i.locations[t]).length?delete i.locations[t]:delete i.locations[t][s])}getUniquePropDefinitionName(e){const t=Object.values(this.propDefinitions).map((e=>(0,b.createStateOrPropStoringValue)((null===e||void 0===e?void 0:e.name)||"")));return(0,u.Zu)(t,(0,b.createStateOrPropStoringValue)(e))}getUniqueStateDefinitionName(e){const t=Object.values(this.stateDefinitions).map((e=>(null===e||void 0===e?void 0:e.name)||""));return(0,u.Zu)(t,e)}mapStyleSetDefinitionsJsonToObject(e){return Object.keys(e||{}).reduce(((t,n)=>(t[n]=this.mapStyleSetContentJsonToObject(e[n]),t)),{})}mapStyleSetContentJsonToObject(e){return{styles:(0,f.bb)(e.styles),referencedStyles:(0,f.o0)(e.referencedStyles),usedByInstances:e.usedByInstances}}mapPropDefinitionsJsonToObject(e){return Object.keys(e||{}).reduce(((t,n)=>{var o,i;let s;switch(e[n].type){case"boolean":s=!1;break;case"number":s=0;break;case"string":s="";break;case"object":s={};case"array":s=[];default:s=""}return t[n]=v(v({},e[n]),{},{defaultValue:null!==(o=null===(i=e[n])||void 0===i?void 0:i.defaultValue)&&void 0!==o?o:s,declarationType:"prop"}),t}),{})}mapStateDefinitionsJsonToObject(e){return Object.keys(e||{}).reduce(((t,n)=>{var o;let i,s;switch(e[n].type){case"boolean":i=l.SO.BOOLEAN,s=!1;break;case"number":i=l.SO.NUMBER,s=0;break;case"string":i=l.SO.TEXT,s="";break;default:i=l.SO.TEXT,s=""}return t[n]=v(v({},e[n]),{},{declarationType:"state",inputType:i,defaultValue:null!==(o=e[n].defaultValue)&&void 0!==o?o:s,locations:e[n].locations||{}}),t}),{})}clone(){return new e({title:this.title,rootNodeId:this.rootNodeId,instantiatedByNodes:{},usedComponents:JSON.parse(JSON.stringify(this.usedComponents)),stateDefinitions:JSON.parse(JSON.stringify(this.stateDefinitions)),propDefinitions:JSON.parse(JSON.stringify(this.propDefinitions)),sectionIds:JSON.parse(JSON.stringify(this.sectionIds)),customSectionType:this.customSectionType,contentGeneratedByAI:this.contentGeneratedByAI})}fromJSON(e){const{title:t,id:n,rootNodeId:o,instantiatedByNodes:i,sectionIds:s,usedComponents:r,pos:a,checkerRenderStyle:c,customSectionType:l,contentGeneratedByAI:d,slots:p}=e,{stateDefinitions:u,propDefinitions:h,styleSetDefinitions:y}=e;return this.title=t,this.id=n,this.pos=a,this.rootNodeId=o,this.instantiatedByNodes=i,this.sectionIds=s||{},this.customSectionType=l||void 0,this.contentGeneratedByAI=d||!1,this.usedComponents=r,this.propDefinitions=this.mapPropDefinitionsJsonToObject(h),this.stateDefinitions=this.mapStateDefinitionsJsonToObject(u),this.styleSetDefinitions=this.mapStyleSetDefinitionsJsonToObject(y),this.checkerRenderStyle=c,this.slots=p,this}toJSON(){return{title:this.title,id:this.id,pos:this.pos,rootNodeId:this.rootNodeId,instantiatedByNodes:this.instantiatedByNodes,sectionIds:this.sectionIds,usedComponents:this.usedComponents,stateDefinitions:this.stateDefinitions,propDefinitions:this.propDefinitions,styleSetDefinitions:this.styleSetDefinitions,checkerRenderStyle:this.checkerRenderStyle,customSectionType:this.customSectionType,contentGeneratedByAI:this.contentGeneratedByAI,slots:this.slots}}applyPatch(e){const{op:t,pathArray:n,value:o}=e;switch(n[0]){case"title":return void(this.title=o);case"pos":return void(this.pos=o);case"rootNodeId":return void(this.rootNodeId=o);case"instantiatedByNodes":if(1===n.length)return void(this.instantiatedByNodes=o);if(2===n.length){if("add"===t||"replace"===t)return void(this.instantiatedByNodes[n[1]]=o);"remove"===t&&delete this.instantiatedByNodes[n[1]]}return;case"usedComponents":if(1===n.length)return void(this.usedComponents=o);if(2===n.length){if("add"===t||"replace"===t)return void(this.usedComponents[n[1]]=o);"remove"===t&&delete this.usedComponents[n[1]]}return;case"stateDefinitions":return void this.processStateDefinitionPatch(e);case"propDefinitions":return void this.processPropDefinitionPatch(e);case"slots":if(1===n.length)return"add"===t||"replace"===t?void(this.slots=o):void delete this.slots;if(2===n.length){if(this.slots||(this.slots={}),"add"===t||"replace"===t)return void(this.slots[n[1]]=o);if("remove"===t)return void delete this.slots[n[1]]}return;case"sectionIds":if(1===n.length)return void(this.sectionIds=o);if(2===n.length){if("add"===t||"replace"===t)return void(this.sectionIds[n[1]]=o);"remove"===t&&delete this.sectionIds[n[1]]}return;case"styleSetDefinitions":return void this.processStyleSetDefinitionPatch(e);default:return}}processStyleSetDefinitionPatch(e){const{pathArray:t,op:n,value:o}=e;if(1===t.length){if("add"===n||"replace"===n)return void(this.styleSetDefinitions=this.mapStyleSetDefinitionsJsonToObject(o));if("remove"===n)return void(this.styleSetDefinitions={})}const i=t[1];if(2===t.length){if("add"===n||"replace"===n)return void(this.styleSetDefinitions[i]=this.mapStyleSetContentJsonToObject(o));if("remove"===n)return void delete this.styleSetDefinitions[i]}if(3===t.length){if("styles"===t[2]){if("add"===n||"replace"===n)return void(this.styleSetDefinitions[i].styles=(0,f.bb)(o));"remove"===n&&(this.styleSetDefinitions[i].styles={})}if("usedByInstances"===t[2])return void(this.styleSetDefinitions[i].usedByInstances=o||{})}if(4===t.length&&"usedByInstances"===t[2]){if("add"===n||"replace"===n)return void(this.styleSetDefinitions[i].usedByInstances[t[3]]=o);if("remove"===n)return void delete this.styleSetDefinitions[i].usedByInstances[t[3]]}if(4===t.length&&"styles"===t[2]){if("add"===n||"replace"===n)return void(this.styleSetDefinitions[i].styles[t[3]]=(0,f.KC)(o));if("remove"===n)return void delete this.styleSetDefinitions[i].styles[t[3]]}if("referencedStyles"===t[2]){if(3===t.length){if("add"===n||"replace"===n)return void(this.styleSetDefinitions[i].referencedStyles=(0,f.o0)(o));if("remove"===n)return void(this.styleSetDefinitions[i].referencedStyles={})}if(4===t.length){if("remove"===n){const e=this.styleSetDefinitions[i].referencedStyles;return delete e[t[1]],void(this.styleSetDefinitions[i].referencedStyles=v({},e))}const e=(0,f.LA)(o);return void(e&&(this.styleSetDefinitions[i].referencedStyles[t[3]]=e))}if(7===t.length&&"styles"===t[5]){const{type:e,content:s}=this.styleSetDefinitions[i].referencedStyles[t[3]];if(("replace"===n||"add"===n)&&"style-map"===e&&"inlined"===s.mapType)return void(s.styles[t[6]]=(0,f.KC)(o))}}}processPropDefinitionPatch(e){const{pathArray:t,op:n,value:o}=e;if(1!==t.length){if(2===t.length){if("add"===n||"replace"===n)return void(this.propDefinitions[t[1]]=o);if("remove"===n)return void delete this.propDefinitions[t[1]]}if(3===t.length&&"locations"===t[2]){if("add"===n||"replace"===n)return void(this.propDefinitions[t[1]].locations=o);if("remove"===n)return void(this.propDefinitions[t[1]].locations={})}if(4===t.length&&"locations"===t[2]){if("add"===n||"replace"===n)return void(this.propDefinitions[t[1]].locations[t[3]]=o);if("remove"===n)return void delete this.propDefinitions[t[1]].locations[t[3]]}if(5===t.length&&"locations"===t[2]){if("add"===n||"replace"===n)return void(this.propDefinitions[t[1]].locations[t[3]][t[4]]=o);if("remove"===n)return void delete this.propDefinitions[t[1]].locations[t[3]][t[4]]}}else this.propDefinitions=o}processStateDefinitionPatch(e){const{pathArray:t,op:n,value:o}=e;if(1!==t.length){if(2===t.length){if("add"===n||"replace"===n)return void(this.stateDefinitions[t[1]]=o);if("remove"===n)return void delete this.stateDefinitions[t[1]]}if(4===t.length&&"locations"===t[2]){if("add"===n||"replace"===n)return void(this.stateDefinitions[t[1]].locations[t[3]]=o);if("remove"===n)return void delete this.stateDefinitions[t[1]].locations[t[3]]}if(5===t.length&&"locations"===t[2]){if("add"===n||"replace"===n)return void(this.stateDefinitions[t[1]].locations[t[3]][t[4]]=o);if("remove"===n)return void delete this.stateDefinitions[t[1]].locations[t[3]][t[4]]}}else this.stateDefinitions=o}},s=(0,c.Z)(i.prototype,"projectUIState",[o],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),i)},858342:function(e,t,n){n.d(t,{B1:function(){return s},_$:function(){return r},mZ:function(){return i},Oe:function(){return a}});const o=new Set(["state","setState","useState","componentDidMount","componentDidUpdate","componentWillUnmount","render","forceUpdate","props","children","key","ref","context","className","id","style","onClick","onChange","onSubmit","onMouseEnter","onKeyDown","window","document","location","history","fetch","console","Date","Math"]),i=e=>e.base+(e.sufix||""),s=e=>({[i(e)]:e}),r=e=>({[i(e)]:e}),a=e=>{let t=e.replace(/[^a-zA-Z0-9_]/g,"");return/^[0-9]/.test(t)&&(t="_"+t),o.has(t)&&(t+="_state"),t||"unnamedState"}},244658:function(e,t,n){n.d(t,{F:function(){return s}});var o=n(777460),i=n(395942);class s{constructor(e){(0,o.Z)(this,i.Patcher,void 0),(0,o.Z)(this,"id",void 0),(0,o.Z)(this,"path",void 0),(0,o.Z)(this,"name",void 0),(0,o.Z)(this,"type",void 0),(0,o.Z)(this,"properties",void 0),(0,o.Z)(this,"usedInNodes",{}),(0,o.Z)(this,"usedInClasses",{}),(0,o.Z)(this,"usedInTokens",{});const{id:t,path:n,name:s,type:r}=e;this.id=t,this.path=n||void 0,this.name=s,this.type=r||"system",this.usedInTokens=e.usedInTokens,this.usedInNodes=e.usedInNodes,this.usedInClasses=e.usedInClasses,null!==e&&void 0!==e&&e.properties&&(this.properties=e.properties)}fromJSON(e){const{id:t,name:n,path:o,usedInTokens:i,usedInNodes:s,usedInClasses:r,type:a,properties:c}=e;this.id=t,this.name=n,this.type=a||"system",this.path=o,this.usedInNodes=s,this.usedInClasses=r,this.usedInTokens=i,c&&(this.properties=c)}isGoogleOrLegacyCustomFont(){return"google"===this.type||"custom"===this.type&&!this.properties}toFontDecleration(e){if("custom"!==this.type)return null;const{properties:t}=this;if(!t)return null;const{fontWeight:n,fontStyle:o,fontFormat:i}=t;return`@font-face {\nfont-family: "${this.name}";\nfont-weight: ${n};\nfont-style: ${o};\nfont-display: swap;\nsrc: url("${null!==e&&void 0!==e?e:this.path}") format("${i}");\n}`.replaceAll("\n","")}toJSON(){return{id:this.id,name:this.name,path:this.path,type:this.type,properties:this.properties,usedInNodes:this.usedInNodes,usedInTokens:this.usedInTokens,usedInClasses:this.usedInClasses}}applyPatch(e){const{op:t,pathArray:n,value:o}=e;"add"!==t&&"replace"!==t||2!==n.length||!o||("usedInNodes"===n[0]&&(this.usedInNodes[n[1]]=o),"usedInClasses"===n[0]&&(this.usedInClasses[n[1]]=o),"usedInTokens"===n[0]&&(this.usedInTokens[n[1]]=!0)),"remove"!==t||2!==n.length||o||("usedInNodes"===n[0]&&delete this.usedInNodes[n[1]],"usedInClasses"===n[0]&&delete this.usedInClasses[n[1]],"usedInTokens"===n[0]&&delete this.usedInTokens[n[1]])}}},255031:function(e,t,n){n.d(t,{n:function(){return uo}});var o,i,s,r=n(503348),a=n(777460),c=n(918437),l=n(881649),d=n(302503),p=n(393181),u=n(329852),h=n(395942),y=n(142678),m=n(608872);let f=(o=(0,d.inject)("positioningService"),i=class{constructor(){(0,a.Z)(this,h.Patcher,!0),(0,r.Z)(this,"positioningService",s,this),(0,a.Z)(this,"byId",{})}add(e){this.byId[e.id]=e}getIds(){return Object.keys(this.byId)}getIdsInOrder(){return this.positioningService.orderEntities({entitiyCollection:this.byId})}getIdsOrderedByPageName(){return Object.keys(this.byId).sort(((e,t)=>{const n=this.byId[e],o=this.byId[t],i=n.title,s=o.title;return n.removeFromCodeGeneration&&!o.removeFromCodeGeneration?-1:!n.removeFromCodeGeneration&&o.removeFromCodeGeneration?1:(0,m.Eh)(i,s)}))}getOrderedPagesByPageName(){return Object.values(this.byId).sort(((e,t)=>{if(!e||!t)throw new Error("Could not sort pages as one of them was not found. ById should NEVER contain keys that have value undefined.");return(0,m.Eh)(e.title,t.title)}))}getHomePageId(){var e;const t=Object.values(this.byId).find((e=>null===e||void 0===e?void 0:e.isHomePage));return null!==(e=null===t||void 0===t?void 0:t.id)&&void 0!==e?e:null}getFallbackPageId(){var e;const t=Object.values(this.byId).find((e=>null===e||void 0===e?void 0:e.isFallbackPage));return null!==(e=null===t||void 0===t?void 0:t.id)&&void 0!==e?e:null}getPositionAfterPage(e){return this.positioningService.getPositionAfterEntity({entitiyCollection:this.byId,entity:e})}getPositionAfterLast(){return this.positioningService.getHighestAvailablePosition({entitiyCollection:this.byId})}clonePage(e){const t=this.byId[e];if(!t)throw new Error("Could not clone page as it was not found");return t.clone()}removePage(e){delete this.byId[e]}toJSON(){return{byId:Object.keys(this.byId).reduce(((e,t)=>{var n;return e[t]=null===(n=this.byId[t])||void 0===n?void 0:n.toJSON(),e}),{})}}fromJSON(e){this.byId={};const{byId:t={}}=e;if(!t||"object"!==typeof t)return;const n=Object.keys(t||{});let o="",i={};for(let s=0;s<n.length;s+=1)o=n[s],i=t[o],this.byId[o]=(new y.m).fromJSON(i)}applyPatch(e){const{pathArray:t,value:n}=e;2===t.length&&"byId"===t[0]&&(n?this.byId[t[1]]=(new y.m).fromJSON(n):delete this.byId[t[1]])}},s=(0,c.Z)(i.prototype,"positioningService",[o],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),i);var g,_,b,I=n(461778),v=n(491463);let w=(g=(0,d.inject)("positioningService"),_=class{constructor(){(0,a.Z)(this,h.Patcher,void 0),(0,r.Z)(this,"positioningService",b,this),(0,a.Z)(this,"byId",{})}create(e){const t=I.n.prototype.create(e);return this.byId[t.id]=t,t}add(e){this.byId[e.id]=e}getIds(){return Object.keys(this.byId)}getIdsInOrder(){return this.positioningService.orderEntities({entitiyCollection:this.byId})}getIdsOrderedByCompName(){return Object.keys(this.byId).sort(((e,t)=>(0,m.Eh)(this.byId[e].title,this.byId[t].title))).filter((e=>{var t;return!(null!==(t=this.byId[e])&&void 0!==t&&t.forPreviewOnly)}))}getComponentByName(e,t=!1){return Object.values(this.byId).find((n=>{var o;return t?(null===n||void 0===n||null===(o=n.title)||void 0===o?void 0:o.toLowerCase())===e.toLowerCase():(null===n||void 0===n?void 0:n.title)===e}))}getPositionAfterComp(e){return this.positioningService.getPositionAfterEntity({entitiyCollection:this.byId,entity:e})}getPositionAfterLast(){return this.positioningService.getHighestAvailablePosition({entitiyCollection:this.byId})}getIdsWithStateDefs(){return this.getIds().filter((e=>{const t=this.byId[e];return t&&Object.keys(t.propDefinitions).length}))}checkIfComponentsHaveCircularDependency(e,t){if(e===t)return!0;const n=this.byId[e];if(!n)throw new Error("Component to add was not found while checking circular dependency");return!(!n.usedComponents||!Object.keys(n.usedComponents).length)&&Object.keys(n.usedComponents||{}).some((e=>e===t||this.checkIfComponentsHaveCircularDependency(e,t)))}getUniqueCompName(e){const t=Object.values(this.byId).map((e=>(null===e||void 0===e?void 0:e.title)||""));return(0,v.Zu)(t,e)}cloneComponent(e){const t=this.byId[e];if(!t)throw new Error("Could not clone component as it was not found");return t.clone()}toJSON(){return{byId:Object.keys(this.byId).reduce(((e,t)=>{var n;return e[t]=null===(n=this.byId[t])||void 0===n?void 0:n.toJSON(),e}),{})}}fromJSON(e){this.byId={};const{byId:t={}}=e;if(!t||"object"!==typeof t)return;const n=Object.keys(t||{});let o="",i={};for(let s=0;s<n.length;s+=1)o=n[s],i=t[o],this.byId[o]=(new I.n).fromJSON(i)}applyPatch(e){const{pathArray:t,value:n,op:o}=e;var i;"remove"===o&&4===t.length&&"instantiatedByNodes"===t[2]&&(null===(i=this.byId[t[1]])||void 0===i||delete i.instantiatedByNodes[t[3]]);2===t.length&&"byId"===t[0]&&(n?this.byId[t[1]]=(new I.n).fromJSON(n):delete this.byId[t[1]])}},b=(0,c.Z)(_.prototype,"positioningService",[g],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),_);var O,j,S,N=n(971162),D=n(751433),E=n(233475),T=n(236711),P=n(255328);const C=new(O=(0,d.inject)("projectDoc"),j=class{constructor(){(0,r.Z)(this,"projectDoc",S,this)}cleanupMissingChildNode(e){const{doc:t,parentNodeId:n,missingChildId:o}=e;if(!t)return;const i=t.nodes.getById(n);i&&"childrenIds"in i&&delete i.childrenIds[o]}},S=(0,c.Z)(j.prototype,"projectDoc",[O],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),(0,c.Z)(j.prototype,"cleanupMissingChildNode",[P.P],Object.getOwnPropertyDescriptor(j.prototype,"cleanupMissingChildNode"),j.prototype),j);Object.freeze(C);var x,A,F,k,R,M,U=n(744914),Z=n(891173),L=n(869929),B=n(687279),W=n(182312),z=n(814371),$=n(440516),G=n(49657),H=n(254313);class K extends Error{constructor(e,t){super(JSON.stringify({parentNodeId:e,missingChildId:t}))}}let V=(x=(0,d.inject)("positioningService"),A=(0,d.inject)("sentryService"),F=function(e,t,n){const o=n.value;let i=0;n.value=function(...e){try{return o.apply(this,e)}catch(t){if(t instanceof K){const{parentNodeId:n,missingChildId:s}=JSON.parse(t.message);if(C.cleanupMissingChildNode({parentNodeId:n,missingChildId:s}),i>1e3)throw new Error("Too many missing children node ids");return i+=1,o.apply(this,e)}throw t}}},k=class{constructor(){(0,a.Z)(this,h.Patcher,!0),(0,r.Z)(this,"positioningService",R,this),(0,r.Z)(this,"sentryService",M,this),(0,a.Z)(this,"byId",{}),(0,a.Z)(this,"addMultiple",(e=>{e.forEach((e=>{this.add(e)}))})),(0,a.Z)(this,"getOrderedTopLevelNodes",(e=>{if(e.length<2)return e;const{compInstanceId:t,slotId:n}=this.getSlotAndCompInstanceIdForNodeById(e[0]),o=this.getAllPaths(this.getRootAndSlotIdOf(e[0]).rootId,[],t,n),i=new Set;return o.forEach((t=>{for(const n of t)if(e.includes(n)){i.add(n);break}})),[...i]})),(0,a.Z)(this,"getAllowedUserOpsForNodes",((e,t)=>{let n={move:!0,duplicate:!0,copy:!0,delete:!0,makeComponent:!0,style:!0,edit:!0,group:!0,ungroup:!0,rename:!0,interactWithPointer:!0,expandTreeviewNode:!0,hide:!0};e.forEach((e=>{const o=this.getById(e);if(!o)return void(n={move:!1,duplicate:!1,copy:!1,delete:!1,makeComponent:!1,style:!1,edit:!1,group:!1,ungroup:!1,interactWithPointer:!1,rename:!1,expandTreeviewNode:!0,hide:!1});const i=null!==o&&void 0!==o&&o.parentId?this.getById(o.parentId):void 0,s=null===o||void 0===o?void 0:o.getNodeAllowedOps(i,t);Object.keys(n).forEach((e=>{n[e]=n[e]&&s[e]}))})),n.ungroup=n.ungroup&&1===e.length,n.rename=n.rename&&1===e.length;const o=this.getOrderedTopLevelNodes(e);return n.group=n.group&&this.areNodesSiblings(o),n})),(0,a.Z)(this,"getAllPaths",((e,t=[],n,o)=>{t.push(e);const i=this.byId[e];if(!i)throw new Error(`No node with id ${e}!`);const s=this.getChildren(i,n);if(!s.length)return[t];const r=this.orderChildrenIds(s),a=[];return r.forEach((e=>{const i=this.getAllPaths(e,[...t],n,o);a.push(...i)})),a}))}getIds(){return Object.keys(this.byId)}getAllNodes(){return Object.values(this.byId)}getIdsWithEvents(){return this.getIds().filter((e=>{const t=this.byId[e];return t&&"events"in t?t&&Object.keys(t.events).length:0}))}getById(e){const t=this.byId[e];if(t&&"uninitialised"in t&&t.uninitialised)throw new Error(`Trying to get an uninitalised node from the nodes list! Id: ${e}`);return t}getNodeSubtreeIds(e){const t=[],n=[e];for(;n.length;){const e=n.pop();if(!e)continue;t.push(e);const o=this.byId[e];o&&n.push(...this.getChildren(o))}return t}removeNode(e,t){const n=this.byId[e];if(!n)return;const{parentId:o,compIdOfRootNode:i}=n,s=o?this.byId[o]:void 0;if(s&&"childrenIds"in s&&(null===s||void 0===s||delete s.childrenIds[e]),s&&"stateNodeRoots"in s){const e=Object.keys(s.stateNodeRoots).find((e=>s.stateNodeRoots[e]===n.id));delete s.stateNodeRoots[e]}const r=i?this.byId[i]:void 0;if(r&&"childrenIds"in r&&delete r.childrenIds[e],t){const e=this.getComponentIdOf(n.id);this.getChildren(n).forEach((t=>{const n=this.getById(t),o=this.getComponentIdOf(t);(null===n||void 0===n?void 0:n.primitiveType)===E.sO.SLOT&&o!==e||this.removeNode(t,!0)}))}delete this.byId[e]}getDescendents(e){const t=[],n=this.byId[e];if(!n)return[];if(!("childrenIds"in n))return[n];const o=Object.keys(n.childrenIds);return t.push(n),o.reduce(((e,t)=>(e.push(...this.getDescendents(t)),e)),t),t}getNodesDepthInTree(e){let t=0;const n=this.byId[e];if(!n||!n.getActualParentId())return t;let o=this.getSlotAndCompInstanceIdForNodeById(e).compInstanceId,i=[];for(i.push(n.getActualParentId());i.length>0;){t++;const e=this.byId[i[0]];if(!e||!e.getActualParentId())return i=[],t;if(e.primitiveType!==E.sO.SLOT)i=i.slice(1),i.push(e.getActualParentId());else{const e=this.byId[o||""];if(!e)return i=[],t;o=this.getSlotAndCompInstanceIdForNodeById(e.id).compInstanceId,i=i.slice(1),i.push(e.id)}}return t}bfs(e,t,n){const o=this.byId[e];if(!o)return;const i=this.getChildren(o);let s,r=0,a=t(o,r);s=n?i:this.orderChildrenIds(i),r++;let c=s[0],l=this.byId[c],d=[];for(;s.length&&!a;){if(c=s[0],l=this.byId[c],!l){const e=Object.values(this.byId).find((e=>!!e&&this.getChildren(e).includes(c)));if(!e){const e=new Error("Both parent and child nodes are missing!");throw this.sentryService.captureException(e),e}const t=new Error(`Requsted node is missing from the list - ${c}`);throw this.sentryService.captureException(t),new K(e.id,c)}a=t(l,r),s=s.slice(1),n?d.push(...this.getChildren(l)):d.push(...this.orderChildrenIds(this.getChildren(l))),0===s.length&&(s=d,d=[],r++)}}orderChildrenIds(e){return this.positioningService.orderEntities({entitiyCollection:this.byId,entitiesOfInterest:e})}getNextSibling(e){return this.getSibling(e,"next")}getPrevSibling(e){return this.getSibling(e,"prev")}getSibling(e,t){var n;if(e.slotId&&!e.compInstanceId)return null;const o=e.getActualParentId();if(!o||!this.byId[o])return null;if(e.slotId&&!e.compInstanceId)return null;const i=this.byId[o],s=this.getChildren(i,e.compInstanceId);var r;return"next"===t?null!==(r=this.positioningService.getNextEntity({entitiyCollection:this.byId,entitiesOfInterest:s,entity:e}))&&void 0!==r?r:null:null!==(n=this.positioningService.getPrevEntity({entitiyCollection:this.byId,entitiesOfInterest:s,entity:e}))&&void 0!==n?n:null}getFirstChild(e,t){const n=this.getChildren(e,t),o=this.orderChildrenIds(n);var i;return o.length&&null!==(i=this.byId[o[0]])&&void 0!==i?i:null}getLastChild(e,t){const n=this.getChildren(e,t),o=this.orderChildrenIds(n);var i;return o.length&&null!==(i=this.byId[o[o.length-1]])&&void 0!==i?i:null}getChildren(e,t){const n=this.byId[t||""];if(!e)return[];if(e.primitiveType===E.sO.SLOT)return n&&"component-instance-node"===n.type?Object.keys(n.slottedNodes[e.id]||{}):[];const o=[];return"slottedNodes"in e&&o.push(...Object.keys(e.slottedNodes||{})),"mappings"in e&&o.push(...Object.values(e.mappings||{}).map((e=>e.componentInstanceId)).filter((e=>e))),"stateNodeRoots"in e?o.push(...Object.values(e.stateNodeRoots||{})):o.push(...Object.keys("childrenIds"in e&&(null===e||void 0===e?void 0:e.childrenIds)||{})),o}getPositionAfterNode(e){const t=this.getNextSibling(e);return t?(0,N.Dd)(e.pos,t.pos):(parseFloat(e.pos)+Number.MAX_SAFE_INTEGER).toString()}getPositionBeforeNode(e){const t=this.getPrevSibling(e);return t?(0,N.Dd)(e.pos,t.pos):(0,N.Dd)(e.pos,"0")}setNodeAsLastChildInParentNode(e,t){const n=this.getLastChild(t);n&&(e.pos=this.getPositionAfterNode(n))}countDescendents(e){return this.getDescendents(e).length}add(e,t=!1){var n;let o=[];var i;"uninitialised"in e&&"initialiseSelf"in e&&e.uninitialised&&(o=null===(i=e.initialiseSelf)||void 0===i?void 0:i.call(e));if(this.byId[e.id]=e,null===(n=o)||void 0===n||n.forEach((e=>{this.add(e)})),e.parentId){const n=this.byId[e.parentId];n&&"childrenIds"in n&&(n.childrenIds[e.id]&&t&&(n.childrenIds[e.id]=!1,n.childrenIds[e.id]=!0),n.childrenIds[e.id]||(n.childrenIds[e.id]=!0))}}nodeIsCompInstance(e){return e.primitiveType===E.sO.COMPONENT}nodeIsDevCompInstance(e){return e.primitiveType===E.sO.DEV_COMPONENT}getSlotAndCompInstanceIdForNodeById(e){var t,n;let o=this.byId[e],i=null===(t=o)||void 0===t?void 0:t.slotId,s=null===(n=o)||void 0===n?void 0:n.compInstanceId;for(;null!==(r=o)&&void 0!==r&&r.parentId&&!i;){var r,a,c;o=this.byId[o.parentId],i=null===(a=o)||void 0===a?void 0:a.slotId,s=null===(c=o)||void 0===c?void 0:c.compInstanceId}return{slotId:i,compInstanceId:s}}getRootAndSlotIdOf(e){var t,n,o;let i=this.byId[e],s=(null===(t=i)||void 0===t?void 0:t.compInstanceId)||(null===(n=i)||void 0===n?void 0:n.parentId);if(!s)return{rootId:e};let r=null===(o=i)||void 0===o?void 0:o.slotId;for(;i&&s&&s!==i.id&&!r;){var a,c,l;i=this.byId[s],s=(null===(a=i)||void 0===a?void 0:a.compInstanceId)||(null===(c=i)||void 0===c?void 0:c.parentId)||s,r=null===(l=i)||void 0===l?void 0:l.slotId}return{rootId:s,slotId:r}}getComponentIdOf(e){var t;const{rootId:n,slotId:o}=this.getRootAndSlotIdOf(e),i=this.byId[n],s=this.byId[o||""];return s&&"compIdOfSlot"in s?s.compIdOfSlot||null:null!==(t=null===i||void 0===i?void 0:i.compIdOfRootNode)&&void 0!==t?t:null}areNodesSiblings(e){const t=this.byId[e[0]],n=null===t||void 0===t?void 0:t.compInstanceId,o=null===t||void 0===t?void 0:t.getActualParentId();for(let i=1;i<e.length;i++){const t=this.byId[e[i]];if(o!==(null===t||void 0===t?void 0:t.getActualParentId()))return!1;if(n!==(null===t||void 0===t?void 0:t.compInstanceId))return!1}return!0}getAncestors(e){const{nodeId:t,excludeRoot:n,includePassedNode:o,includeSlottedNodes:i,initialCompInstanceId:s}=e,r=[];let a=this.byId[t];if(o&&r.push(t),i){var c;let e=(null===(c=a)||void 0===c?void 0:c.compInstanceId)||s;for(;null!==(l=a)&&void 0!==l&&l.getActualParentId(e);){var l,d,p;r.push(a.getActualParentId(e)),a=this.byId[a.getActualParentId(e)],null!==(d=a)&&void 0!==d&&d.compInstanceId&&(e=a.compInstanceId),n&&null!==(p=a)&&void 0!==p&&p.compIdOfRootNode&&r.pop()}}else for(;null!==(u=a)&&void 0!==u&&u.parentId;){var u,h;r.push(a.parentId),a=this.byId[a.parentId],n&&null!==(h=a)&&void 0!==h&&h.compIdOfRootNode&&r.pop()}return r}findNodeByContextId(e,t){let n=this.byId[t];if(!n)return null;let o=null;for(;null!==(i=n)&&void 0!==i&&i.parentId&&!o;){var i;const t=this.byId[n.parentId];t&&"ctxId"in t&&t.ctxId===e?o=t:t&&"listCtxId"in t&&t.listCtxId===e||t&&"repeatableCtxId"in t&&t.repeatableCtxId===e?o=t:n=t}return o}getAvailableContextIdsForNode(e,t){let n=this.byId[e];const o=[];for(;null!==(i=n)&&void 0!==i&&i.getActualParentId(t);){var i,s;const e=this.byId[null===(s=n)||void 0===s?void 0:s.getActualParentId(t)];e&&"ctxId"in e&&o.push(e.ctxId),e&&"listCtxId"in e&&o.push(e.listCtxId),e&&"repeatableCtxId"in e&&o.push(e.repeatableCtxId),n.primitiveType===E.sO.SLOT&&e&&(t=this.getSlotAndCompInstanceIdForNodeById(e.id).compInstanceId),n=e}return o}getUsedContextIdsForNode(e){const t=[],n=this.byId[e];if(!n)return t;if("contentChildren"in n&&n.contentChildren){const e=Object.values(n.contentChildren)[0];e&&"dynamic"===e.type&&"ctx"===e.content.referenceType&&e.content.ctxId&&t.push(e.content.ctxId)}if("attrs"in n&&n.attrs)for(const o of Object.values(n.attrs))"dynamic"===o.type&&"ctx"===o.content.referenceType&&o.content.ctxId&&t.push(o.content.ctxId);return t}getInspectorTabsForNodes(e,t){let n={[$.dG.VISUAL]:!0,[$.dG.ADVANCED]:!0,[$.dG.EVENTS]:!0};return e.forEach((e=>{const o=this.getById(e);if(!o)return void(n={[$.dG.VISUAL]:!1,[$.dG.ADVANCED]:!1,[$.dG.EVENTS]:!1});if(t)return void(n={[$.dG.VISUAL]:!0,[$.dG.ADVANCED]:!1,[$.dG.EVENTS]:!1});const i=null===o||void 0===o?void 0:o.getInspectorTabsForNode();Object.keys(i).forEach((e=>{const t=e;n[t]=n[t]&&i[t]}))})),n}toJSON(){return{byId:Object.keys(this.byId).reduce(((e,t)=>{var n;return e[t]=null===(n=this.byId[t])||void 0===n?void 0:n.toJSON(),e}),{})}}fromJSON(e){this.byId={};const{byId:t={}}=e||{};t&&"object"===typeof t&&Object.keys(t).forEach((e=>{const n=(t||{})[e],o=this.getHierarchyNodeByType(n);o&&(this.byId[o.id]=o)}))}applyPatch(e){const{pathArray:t,op:n}=e,o=e.value;if(2===t.length&&"byId"===t[0]){if(("add"===n||"replace"===n)&&o){const e=this.getHierarchyNodeByType(o);return void(e&&this.add(e,!0))}if("remove"===n){const e=t[1],n=this.byId[e];if(!n)return;const{parentId:o}=n,i=this.byId[o||""];!i||!("childrenIds"in i)||null!==i&&void 0!==i&&i.childrenIds[e]||(i.childrenIds[e]=!0),this.removeNode(e)}}}getHierarchyNodeByType(e){let t;if((null===e||void 0===e?void 0:e.primitiveType)===E.sO.COMPONENT)return t=(new T.F).fromJSON(e),t;if((null===e||void 0===e?void 0:e.primitiveType)===E.sO.HTML_NODE)return t=(new L.b).fromJSON(e),t;switch(e.type){case"repeater":t=(new H.Z).fromJSON(e);break;case"cms-array-mapper":t=(new z.k).fromJSON(e);break;case"date-time-node":t=(new D.Z3).fromJSON(e);break;case"element-node":t=(new D.HX).fromJSON(e);break;case"cms-collection-list-node":t=(new U.t).fromJSON(e);break;case"cms-collection-item-node":t=(new Z.n).fromJSON(e);break;case"cms-mixed-type-node":t=(new G.U).fromJSON(e);break;case"html-node":t=(new L.b).fromJSON(e);break;case"cms-pagination-node":t=(new B.k).fromJSON(e);break;case"cms-html-node":t=(new L.D).fromJSON(e);break;case"cms-navigation-button":t=(new W.z).fromJSON(e);break;case"cms-collection-list-repeater-node":t=(new D.kf).fromJSON(e);break;default:t=(new D.HX).fromJSON(e)}return t}},R=(0,c.Z)(k.prototype,"positioningService",[x],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),M=(0,c.Z)(k.prototype,"sentryService",[A],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),(0,c.Z)(k.prototype,"bfs",[F],Object.getOwnPropertyDescriptor(k.prototype,"bfs"),k.prototype),k);var Y=n(918939),J=n(40835),X=n(774468),q=n(492080);function Q(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function ee(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Q(Object(n),!0).forEach((function(t){(0,a.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Q(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}class te{constructor(){(0,a.Z)(this,h.Patcher,void 0),(0,a.Z)(this,"byId",{})}create(e){const t=J.G.prototype.create(e);return this.byId[t.id]=t,t}add(e){this.byId[e.id]=e}remove(e){delete this.byId[e]}getSelectableIds(){return Object.keys(this.byId).filter((e=>![Y.K.FAVICON,Y.K.PAGE_OG_IMAGE,Y.K.PROJECT_OG_IMAGE].includes(this.byId[e].type)))}copyAssetsInNodeRelationToNode(e){const{sourceNodeId:t,targetNodeId:n}=e,o=this.getAssetsUsedInNode(t);o.length&&o.forEach((e=>{e.createNodeRelation(n)}))}removeAssetsRelationToNode(e){Object.values(this.byId).forEach((t=>{t.usedInNodes[e]&&t.removeNodeRelation(e)}))}getAssetsUsedInNode(e){return Object.values(this.byId).filter((t=>Object.keys(t.usedInNodes).some((t=>t===e))))}getAssetsUsedInProject(){return Object.values(this.byId).filter((e=>e.type!==Y.K.IMAGE||(Object.keys(e.usedInNodes).length>0||Object.keys(e.usedInClasses||{}).length>0)))}mapClassesAndNodesToOptimisedAssets(e,t=!1){const n={};return e.forEach((e=>{const o=e.usedInClasses||{};Object.keys(ee(ee({},e.usedInNodes),o)).forEach((o=>{n[o]||(n[o]=[]),n[o].push({localPath:`/${t?e.name:encodeURIComponent(e.name)}`,id:e.id,optimised:!e.skipOptimisations,folderPath:e.folderPath})}))})),n}changeParentFolder(e,t){e.forEach((e=>{this.byId[e].parentFolderId=t}))}getAssetsFromFolder(e){return Object.values(this.byId).filter((t=>t.parentFolderId===e&&(t.type===Y.K.IMAGE||t.type===Y.K.VIDEO||t.type===Y.K.EDITABLE_FILE||t.type===Y.K.FILE)))}getAssetsForCustomCode(){return Object.values(this.byId).reduce(((e,t)=>(e[`${q.Wn}${X.Bq}/${t.name}`]={code:t.remoteSrc},e)),{})}findAssetUsingName(e){return Object.values(this.byId).find((t=>t.name.toLocaleLowerCase()===e.toLocaleLowerCase()))}toJSON(){return{byId:Object.keys(this.byId).reduce(((e,t)=>(e[t]=this.byId[t].toJSON(),e)),{})}}fromJSON(e){this.byId={};const{byId:t={}}=e;if(!t||"object"!==typeof t)return;const n=Object.keys(t||{});let o="",i={};for(let s=0;s<n.length;s+=1)o=n[s],i=t[o],this.byId[o]=(new J.G).fromJSON(i)}applyPatch(e){const{pathArray:t,value:n}=e;2===t.length&&"byId"===t[0]&&(n?this.byId[t[1]]=(new J.G).fromJSON(n):delete this.byId[t[1]])}}var ne=n(523689),oe=n(930613),ie=n(588639),se=n(590196),re=n(256240),ae=n(244658);function ce(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}class le{constructor(){(0,a.Z)(this,h.Patcher,void 0),(0,a.Z)(this,"byId",{})}getById(){return this.byId}addFont(e){this.byId[e.id]=e}removeFont(e){delete this.byId[e]}updateFontUsageById(e,t,n="add"){const{tokens:o=[],nodeIds:i=[],classIds:s=[]}=t;if(this.byId[e])switch(this.byId[e].usedInClasses||(this.byId[e].usedInClasses={}),n){case"add":o.forEach((t=>{this.byId[e].usedInTokens[t]=!0})),i.forEach((t=>{this.byId[e].usedInNodes[t]?this.byId[e].usedInNodes[t]++:this.byId[e].usedInNodes[t]=1})),s.forEach((t=>{var n,o;null!==(n=this.byId[e])&&void 0!==n&&null!==(o=n.usedInClasses)&&void 0!==o&&o[t]?this.byId[e].usedInClasses[t]++:this.byId[e].usedInClasses[t]=1}));break;case"remove":o.forEach((t=>{delete this.byId[e].usedInTokens[t]})),i.forEach((t=>{this.byId[e].usedInNodes[t]&&(this.byId[e].usedInNodes[t]--,0===this.byId[e].usedInNodes[t]&&delete this.byId[e].usedInNodes[t])})),s.forEach((t=>{var n,o;null!==(n=this.byId[e])&&void 0!==n&&null!==(o=n.usedInClasses)&&void 0!==o&&o[t]&&(this.byId[e].usedInClasses[t]--,0===this.byId[e].usedInClasses[t]&&delete this.byId[e].usedInClasses[t])}))}}deleteNodeReferenceFromAllFonts(e){Object.values(this.byId).forEach((t=>{delete t.usedInNodes[e]}))}getFontByName(e){var t;return null!==(t=Object.values(this.byId).find((t=>t.name===e.replaceAll('"',""))))&&void 0!==t?t:null}fromJSON(e){this.byId={},null!==e&&void 0!==e&&e.byId&&Object.keys((null===e||void 0===e?void 0:e.byId)||{}).length>0&&Object.values(e.byId||{}).forEach((e=>{this.byId[e.id]=new ae.F(function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ce(Object(n),!0).forEach((function(t){(0,a.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ce(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({id:e.id,name:e.name,path:e.path||void 0,usedInNodes:e.usedInNodes,usedInTokens:e.usedInTokens,usedInClasses:e.usedInClasses,type:e.type||"system"},(null===e||void 0===e?void 0:e.properties)&&{properties:e.properties}))}))}toJSON(){return{byId:Object.values(this.byId).reduce(((e,t)=>(e[t.id]=t.toJSON(),e)),{})}}applyPatch(e){const{op:t,pathArray:n,value:o}=e;if("add"===t&&2===n.length){const t=e.value;this.byId[t.id]=new ae.F(t)}"remove"!==t||2!==n.length||o||delete this.byId[n[1]],"replace"===t&&2===n.length&&o&&(this.byId[n[1]].usedInNodes[n[3]]=o)}}var de=n(831149);const pe=new class{constructor(){(0,a.Z)(this,"execute",((e,t)=>{const{compId:n,nodeId:o,sectionId:i}=e,s=t.getProjectPageOrComponent(n);s&&(s.sectionIds[o]=i)}))}};Object.freeze(pe);const ue=new class{constructor(){(0,a.Z)(this,"execute",((e,t)=>{const{compId:n,nodeId:o}=e,i=t.getProjectPageOrComponent(n);(null===i||void 0===i?void 0:i.sectionIds[o])&&i&&delete i.sectionIds[o]}))}};Object.freeze(ue);var he=n(278702),ye=n(229187);const me=new class{constructor(){(0,a.Z)(this,"execute",((e,t)=>{const{nodeIds:n,withSubtree:o,deleteRoot:i,skipRestoreParentsFakeSize:s}=e,r=t.getComponentIdForNode(n[0]),a=[...n];for(const d of n){const n=t.nodes.getById(d);if(!n)continue;if(!i&&n.compIdOfRootNode)continue;s||(t.restoreBGColor(n),t.restoreParentNodesFakeSize(d));const p=o?t.nodes.getNodeSubtreeIds(d):[d];if(a.push(...p),t.deleteNodesInternationalizationReferences({nodeIds:[...new Set(a)]}),p.forEach((e=>{var n;const o=t.nodes.getById(e);if(!o)return;const i=t.getComponentIdForNode(e),s=t.getComponentIdForNode(e,!0);if(o.primitiveType===E.sO.SLOT&&i!==r)return;const a=null===(n=(0,he.kd)(o,"id"))||void 0===n?void 0:n.toString();if(r&&a&&(t.removeSectionIdFromComponent({compId:r,nodeId:e}),t.getNodesFromSelectedComponent().filter((e=>{if("abilities"in e){const t=e.abilities.link,n=null===t||void 0===t?void 0:t.content;return t&&n.section===a}return!1})).forEach((e=>{var t;"abilities"in e&&(null===e||void 0===e||(null===(t=e.abilities)||void 0===t||delete t.link))}))),t.nodes.nodeIsCompInstance(o)&&s){var c;const n=o.compIdOfCompInstance;t.removeUsedComponentRelation({toRemoveComponentId:s,linkedComponentId:n}),null===(c=t.components.byId[n])||void 0===c||delete c.instantiatedByNodes[e];const i=[];Object.values(o.attrs).forEach((e=>{"hierarchy"===e.type&&i.push(e.content)})),i.length&&this.execute({nodeIds:i,withSubtree:!0},t)}t.assets.removeAssetsRelationToNode(e),t.designLanguage.deleteNodeReferenceFromAllTokens(e),t.fonts.deleteNodeReferenceFromAllFonts(e),t.classes.deleteNodeReferenceFromSimpleClasses(e),t.tailwindCSS.deleteClassesForNode(e)})),n.parentId){const e=t.nodes.getById(n.parentId);if((null===e||void 0===e?void 0:e.primitiveType)===E.sO.BUTTON&&"childrenIds"in e&&1===Object.keys(e.childrenIds||{}).length&&(t.nodes.removeNode(n.parentId,!0),a.push(n.parentId)),"cms-mixed-type-node"===(null===e||void 0===e?void 0:e.type)){const t=Object.keys(e.mappings).find((t=>e.mappings[t].componentInstanceId===n.id));t&&delete e.mappings[t].componentInstanceId}}if(n.primitiveType===E.sO.SLOT&&"compIdOfSlot"in n&&n.compIdOfSlot){const e=t.components.byId[n.compIdOfSlot];var c;if(e)null===(c=e.slots)||void 0===c||delete c[n.id];Object.keys((null===e||void 0===e?void 0:e.instantiatedByNodes)||{}).forEach((e=>{const o=t.nodes.getById(e),i=[];o.slottedNodes[n.id]&&Object.keys(o.slottedNodes[n.id]||{}).forEach((e=>{i.push(e)})),this.execute({nodeIds:i,deletingSlot:!0,withSubtree:!0},t),o.cleanInstanceDataOnSlotRemove(n.id)}))}if("cms-mixed-type-node"===n.type){const e=[];Object.values(n.mappings).forEach((t=>{t.componentInstanceId&&e.push(t.componentInstanceId)})),this.execute({nodeIds:e,withSubtree:!0},t)}if("slottedNodes"in n){var l;const e=[];if(Object.keys(n.slottedNodes).forEach((t=>{Object.keys(n.slottedNodes[t]).forEach((t=>{e.push(t)}))})),this.execute({nodeIds:e,withSubtree:!0},t),t.nodes.nodeIsCompInstance(n)&&"string"===typeof(null===(l=n.attrs[ye.Q])||void 0===l?void 0:l.content)){const e=t.components.byId[n.compIdOfCompInstance];e&&delete e.styleSetDefinitions[n.attrs[ye.Q].content]}}if(n.slotId&&!e.deletingSlot){const e=n.compInstanceId||n.parentId;if(!e)throw new Error("Attempted to unslot node without an owner");t.removeNodeFromSlot({node:n,slotId:n.slotId,slotOwnerId:e})}if(n.primitiveType===E.IV.SLIDER_SLIDE&&n.parentId){const e=t.nodes.getById(n.parentId),o=t.nodes.getById(e.parentId),i=t.nodes.getChildren(o).find((e=>{const n=t.nodes.getById(e);if(n.primitiveType===E.IV.SLIDER_PAGINATION)return n})),s=t.nodes.getById(i),r=t.nodes.getChildren(e).indexOf(n.id),a=Object.keys(s.childrenIds)[r];t.nodes.removeNode(a,!0)}if(n.primitiveType===E.IV.SLIDER_PAGINATION_BULLET&&n.parentId){const e=t.nodes.getById(n.parentId),o=t.nodes.getById(e.parentId),i=t.nodes.getChildren(o).find((e=>{const n=t.nodes.getById(e);if(n.primitiveType===E.IV.SLIDER_WRAPPER)return n})),s=t.nodes.getById(i),r=t.nodes.getChildren(e).indexOf(n.id),a=Object.keys(s.childrenIds)[r];t.nodes.removeNode(a,!0)}t.nodes.removeNode(d,o),t.tailwindCSS.deleteClassesForNode(d)}if(r){const e=[...new Set(a)],n=t.components.byId[r];null===n||void 0===n||n.removePropDefinitionsForNodes(e),null===n||void 0===n||n.removeStateDefinitionsLocationsForNodes(e)}}))}};Object.freeze(me);const fe=new class{constructor(){(0,a.Z)(this,"execute",(e=>{const{node:t,component:n,doc:o}=e;if(!n)throw new Error("Component not provided to add default prop definitions");if(!t.parentId)return;if(t.slotId||o.nodes.getSlotAndCompInstanceIdForNodeById(t.parentId).slotId)return;const i=o.nodes.getById(t.parentId);if((null===i||void 0===i?void 0:i.primitiveType)!==E.sO.TEXT&&t.primitiveType!==E.sO.PREVIEW_ROOT){if(t.primitiveType===E.sO.IMAGE||t.primitiveType===E.sO.VIDEO){const e=(0,he.Uq)(t,"src"),i=(0,he.Uq)(t,"alt");e&&"static"===e.type&&o.addDefaultAttrPropDefinition({node:t,component:n,defaultValue:e.content,attrName:"src",doc:o}),i&&"static"===i.type&&o.addDefaultAttrPropDefinition({node:t,component:n,defaultValue:i.content,attrName:"alt",doc:o})}if(t instanceof D.HX&&(t.primitiveType===E.sO.TEXT||t.primitiveType===E.sO.BUTTON)){var s;const n=Object.values(t.contentChildren)[0],i="dynamic"===(null===n||void 0===n?void 0:n.type)&&"locale"===(null===n||void 0===n||null===(s=n.content)||void 0===s?void 0:s.referenceType);n&&("static"===n.type||i)&&o.addDefaultContentPropDefinition(e)}if(t instanceof D.HX&&t.primitiveType===E.sO.TEXT){var r;(null===(r=Object.keys(t.childrenIds))||void 0===r?void 0:r.length)&&o.addHierarchyPropDefinitionsForNode(e)}if(t.primitiveType===E.sO.TEXTAREA||t.primitiveType===E.sO.TEXTINPUT){const e=(0,he.Uq)(t,"placeholder");e&&"static"===e.type&&o.addDefaultAttrPropDefinition({node:t,component:n,defaultValue:(null===e||void 0===e?void 0:e.content)||"",attrName:"placeholder",doc:o})}"abilities"in t&&t.abilities&&"preview-root-node"!==t.type&&o.addDefaultLinkPropDefinition({node:t,comp:n})}}))}};Object.freeze(fe);var ge=n(813244),_e=n(858342),be=n(555362),Ie=n(965699),ve=n(81359);function we(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function Oe(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?we(Object(n),!0).forEach((function(t){(0,a.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):we(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}const je=new class{constructor(){(0,a.Z)(this,"execute",(e=>{var t;const{node:n,comp:o,type:i,defaultValue:s,meta:r}=e,a=(0,ve.rZ)(n),{link:c}=n.abilities;if(!c&&!i)return null;if(c&&"url"in c.content&&"string"!==typeof c.content.url&&"dynamic"===c.content.url.type&&"ctx"===(null===(t=c.content.url.content)||void 0===t?void 0:t.referenceType))return null;switch(i||c.type){case oe.RZ.NAVLINK:case oe.RZ.SECTION:return null;case oe.RZ.URL:const e=`${a.name}Url`,t=c?c.content.url:"",l=c?c.content.newTab:!!r&&r.openInNewTab,d=o.createPropDefinition(Oe(Oe({},a),{},{name:e,defaultValue:s||("string"===typeof t&&t||"https://www.teleporthq.io"),inputType:ge.SO.LINK,locations:{[n.id]:(0,_e.B1)({base:ge.hD.ABILITY,sufix:oe.RZ.URL})}})),p=new be.P({content:{referenceType:"prop",id:d.id}});return i?n.abilities.link=new Ie.G({type:i,content:{url:p,newTab:l}}):c.content.url=p,d;default:return null}}))}};Object.freeze(je);var Se=n(378888);function Ne(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function De(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Ne(Object(n),!0).forEach((function(t){(0,a.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ne(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}const Ee=new class{constructor(){(0,a.Z)(this,"execute",(e=>{const{node:t,component:n,defaultValue:o,inputType:i,attrName:s,doc:r}=e;if("element-node"!==t.type&&"component-instance-node"!==t.type||!t.attrs)return null;const a=(0,ve.rZ)(t);let c=t.compIdOfRootNode?`${n.title}_${s}`:`${a.name}_${s}`;if("component-instance-node"===t.type){const e=r.components.byId[t.compIdOfCompInstance];e&&(c=`${e.title}_${s}`)}let l="";if(i===ge.SO.RICH_TEXT&&t.attrs[s]){const e=t.attrs[s].content,o=null===r||void 0===r?void 0:r.cloneRichTextHierarchy({doc:r,rootNodeId:e,meta:{isPropRoot:{compId:n.id,prop:a.id}}});l=o||""}const d=n.createPropDefinition(De(De({},a),{},{name:c,defaultValue:o,defaultHierarchyRootId:l,type:ge.hi[null!==i&&void 0!==i?i:ge.SO.TEXT],inputType:i||("src"===s?ge.SO.IMAGE:ge.SO.TEXT),locations:{[t.id]:(0,_e.B1)({base:ge.hD.ATTR,sufix:s})}})),p=t.attrs[s];"hierarchy"===(null===p||void 0===p?void 0:p.type)&&r&&r.deleteNodesById({nodeIds:[p.content]}),Object.keys(n.instantiatedByNodes).forEach((e=>{const t=r.nodes.getById(e);if(!t||"component-instance-node"!==t.type)return;const n=r.cloneRichTextHierarchy({doc:r,rootNodeId:l,meta:{isAttributeRoot:{nodeId:t.id,attr:c}}});n&&(t.attrs[d.name]={id:(0,Se.Ox)(),type:"hierarchy",content:`${n}`,pristine:!0})}));const u=new be.P({content:{referenceType:"prop",id:d.id}});return t.attrs[s]=u,d}))}};Object.freeze(Ee);const Te=new class{constructor(){(0,a.Z)(this,"execute",((e,t)=>{let{nodeIds:n}=e;n=[].concat(n);const{translations:o}=t.internationalization;Object.keys(null!==o&&void 0!==o?o:{}).length&&n.forEach((e=>{var n,o,i;const s=t.nodes.getById(e);if(!s)return;if("component-instance-node"===s.type)return void Object.values(s.attrs).forEach((e=>{if("hierarchy"===e.type){const n=t.nodes.getNodeSubtreeIds(e.content.toString());this.execute({nodeIds:n},t)}}));if("element-node"!==(null===s||void 0===s?void 0:s.type)||!("contentChildren"in s))return;const r=Object.keys(null!==(n=s.contentChildren)&&void 0!==n?n:{})[0];if(!r)return;const a=null===(o=s.contentChildren)||void 0===o?void 0:o[r];if("dynamic"!==(null===a||void 0===a?void 0:a.type)||"locale"!==(null===a||void 0===a?void 0:a.content.referenceType))return;const c=null===(i=a.content.refPath)||void 0===i?void 0:i[0];if(!c)return;const l=Object.values(t.internationalization.translations).map((e=>{const t=e[c];return t&&"hierarchy"===(null===t||void 0===t?void 0:t.type)?t.content:null})).filter((e=>e));t.deleteNodesById({nodeIds:l}),t.internationalization.removeTranslation(c)}))}))}};function Pe(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function Ce(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Pe(Object(n),!0).forEach((function(t){(0,a.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Pe(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}Object.freeze(Te);const xe=new class{constructor(){(0,a.Z)(this,"execute",(e=>{const{doc:t,component:n,node:o,internationalizationFlow:i,createStringPropForTexts:s}=e;if("cms-html-node"===o.type){var r;const e=(0,ve.rZ)(o);o.html=new be.P({content:{referenceType:"prop",id:e.id}});return n.createPropDefinition(Ce(Ce({},e),{},{defaultValue:(null===o||void 0===o||null===(r=o.html)||void 0===r?void 0:r.getFallbackValue())||"Fallback value",inputType:ge.SO.CMS_RICH_TEXT,type:"string",locations:{[o.id]:(0,_e.B1)({base:ge.hD.HTML_CONTENT})}}))}if(!("contentChildren"in o)||!o.contentChildren||!Object.keys(o.contentChildren).length)return"text"===o.primitiveType&&"childrenIds"in o&&o.childrenIds&&Object.keys(o.childrenIds).length?t.addHierarchyPropDefinitionsForNode({node:o,component:n,doc:t}):null;const a=(0,ve.rZ)(o),c=Object.keys(o.contentChildren)[0],l=o.contentChildren[c],d=l.content,p="dynamic"===l.type&&"locale"===l.content.referenceType,u=o.getContentLangReferenceKey(),h=u?(null===i||void 0===i?void 0:i.getDefaultStaticTextValueForTranslationKey({key:u,doc:t}))||"":d;if(u&&s&&Te.execute({nodeIds:[o.id]},t),"date-time-node"===o.type||s){const e=n.createPropDefinition(Ce(Ce({},a),{},{defaultValue:h,locations:{[o.id]:(0,_e.B1)({base:ge.hD.CONTENT})}})),t=new be.P({content:{referenceType:"prop",id:a.id}});return delete o.contentChildren[c],o.contentChildren[t.id]=t,e}const y=(0,Se.Ox)(),m=new D.HX({id:y,semanticType:E.sO.FRAGMENT,primitiveType:E.sO.FRAGMENT,meta:{isPropRoot:{compId:n.id,prop:a.id}}}),f=new D.HX({id:(0,Se.Ox)(),primitiveType:"button"===o.primitiveType?E.sO.TEXT:o.primitiveType,parentId:m.id,contentChildren:{[y]:p?new be.P({id:y,content:Ce({},l.content)}):new ne.F({id:y,content:h})}});p||null===i||void 0===i||i.linkStaticNodesToTranslations({nodes:[f],doc:t}),t.addNode(m),t.addNode(f),Object.keys(o.contentChildren).forEach((e=>{o.contentChildren&&delete o.contentChildren[e]}));let g=o.id;const _=new be.P({content:{referenceType:"prop",id:a.id}});if("button"===o.primitiveType){const e=new D.HX({id:(0,Se.Ox)(),semanticType:E.RY.SPAN,primitiveType:E.sO.TEXT,parentId:o.id,contentChildren:{[_.id]:_}});t.addNode(e),o.childrenIds={[e.id]:!0},g=e.id}else o.contentChildren[_.id]=_;const b=n.createPropDefinition(Ce(Ce({},a),{},{defaultValue:h,inputType:ge.SO.RICH_TEXT,defaultHierarchyRootId:m.id,type:"richtext",locations:{[g]:(0,_e.B1)({base:ge.hD.CONTENT})}})),I=t.nodes.getById(m.id);return I&&(I.rootOfPropHierarchy=b.id),Object.keys(n.instantiatedByNodes).forEach((e=>{const n=t.nodes.getById(e);if(!n||"component-instance-node"!==n.type)return;const o=t.cloneRichTextHierarchy({doc:t,rootNodeId:m.id,meta:{isAttributeRoot:{nodeId:n.id,attr:b.name}}});o&&(n.attrs[b.name]={id:(0,Se.Ox)(),type:"hierarchy",content:`${o}`,pristine:!0})})),b}))}};Object.freeze(xe);var Ae=n(134055),Fe=n(53169);function ke(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function Re(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ke(Object(n),!0).forEach((function(t){(0,a.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ke(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}const Me=new class{execute(e){const{doc:t,sourceCompId:n,targetCompId:o,node:i,nodeClone:s,duplicatePropEvenIfItExists:r}=e,a=t.components.byId[n];if(!a)return;const c=t.components.byId[o];c&&Object.keys(a.propDefinitions).forEach((e=>{const n=a.propDefinitions[e];if(!n.locations[i.id])return;const l=Re({},n.locations[i.id]),d=Object.values(c.propDefinitions).find((e=>e.name===n.name));let p,u;if(d&&!r)d.locations=Re(Re({},d.locations),{},{[s.id]:l}),p=d.id;else{var h;if(u=Re(Re({},JSON.parse(JSON.stringify(n))),{},{id:(0,Se.Ox)(),locations:{[s.id]:l},name:c.getUniquePropDefinitionName(n.name)}),"richtext"===u.type)u.defaultHierarchyRootId=null!==(h=t.cloneRichTextHierarchy({doc:t,rootNodeId:n.defaultHierarchyRootId,meta:{isPropRoot:{compId:o,prop:u.id}}}))&&void 0!==h?h:void 0;c.propDefinitions[u.id]=u,p=u.id}Object.values(l).forEach((n=>{var o;const{base:a,sufix:l}=n;switch(a){case ge.hD.CONTENT:const n="contentChildren"in s?s.contentChildren:null;if(!n)return;Object.keys(n).forEach((t=>{const o=n[t];l&&t!==l||"dynamic"===o.type&&o.content.id===e&&(o.content.id=p)}));const a=Object.keys(c.instantiatedByNodes);if(d&&!r)break;if("richtext"!==(null===(o=u)||void 0===o?void 0:o.type))break;a.forEach((e=>{const n=t.nodes.getById(e);if(!n)return;const o="attrs"in n?n.attrs:null;if(!o)return;const s=c.propDefinitions[p];o[s.name]={type:"hierarchy",content:t.cloneRichTextHierarchy({doc:t,rootNodeId:s.defaultHierarchyRootId,meta:{isAttributeRoot:{nodeId:i.id,attr:s.name}}}),id:(0,Se.Ox)(),pristine:!0}}));break;case ge.hD.ATTR:const h="attrs"in s?s.attrs:null;if(!h)break;Object.keys(h).forEach((t=>{const n=h[t];l&&t!==l||"dynamic"===n.type&&n.content.id===e&&(n.content.id=p)}));break;case ge.hD.ABILITY:const y="abilities"in s?s.abilities:null;if(!y)break;Object.keys(y).forEach((t=>{const n=y[t],o=l;if(!(0,ve.Lu)(n,o))return;const{type:i,content:s}=n;switch(i){case Fe.R.URL:const t=s;"string"!==typeof t.url&&t.url.content.id===e&&(t.url.content.id=p);break;case Fe.R.PHONE:const n=s,{phone:o}=n;"string"!==typeof o&&o.content.id===e&&(o.content.id=p);break;case Fe.R.MAIL:const i=s,{body:r,mail:a,subject:c}=i;"string"!==typeof r&&(null===r||void 0===r?void 0:r.content.id)===e&&(r.content.id=p),"string"!==typeof a&&a.content.id===e&&(a.content.id=p),"string"!==typeof c&&(null===c||void 0===c?void 0:c.content.id)===e&&(c.content.id=p)}}));break;case ge.hD.STYLE:}}))}))}};Object.freeze(Me);const Ue=new class{execute(e){const{doc:t,targetCompId:n,node:o,nodeClone:i}=e,s=t.getProjectPageOrComponent(n);if(s&&"events"in i&&"events"in o&&Object.keys(o.events).length>0){const e=Object.values(o.events).reduce(((e,t)=>(e.push(...Object.values(t)),e)),[]),t=e.filter((e=>"stateChange"===e.type)).map((e=>e.id)),n=e.filter((e=>"propCall"===e.type)).map((e=>e.id)),r=Array.from(new Set(t)),a=Array.from(new Set(n)),c=Object.keys((null===s||void 0===s?void 0:s.stateDefinitions)||{}),l=Object.keys((null===s||void 0===s?void 0:s.propDefinitions)||{});r.forEach((e=>{if(!c.includes(e)){const t=r.indexOf(e);r.splice(t,1)}})),a.forEach((e=>{if(!l.includes(e)){const t=a.indexOf(e);a.splice(t,1)}}));const d={};Object.keys(o.events).forEach((e=>{d[e]={},Object.keys(o.events[e]).forEach((t=>{const n=o.events[e][t].id;(r.includes(n)||a.includes(n))&&(d[e][t]=JSON.parse(JSON.stringify(o.events[e][t])))}))})),i.events=d}}};Object.freeze(Ue);const Ze=new class{execute(e){const{doc:t,targetCompId:n,sourceCompId:o,node:i,nodeClone:s}=e,r=t.getProjectPageOrComponent(o);if(!r)return;const a=t.getProjectPageOrComponent(n);if(!a)return;if(!("renderingConditions"in s&&"renderingConditions"in i&&i.renderingConditions))return;const c=i.renderingConditions.reference.content.referenceType;switch(c){case"state":const e=i.renderingConditions.reference.id;if(e in a.stateDefinitions)s.renderingConditions=JSON.parse(JSON.stringify(i.renderingConditions));else if(e in r.stateDefinitions&&i.renderingConditions){const t=r.stateDefinitions[e],n=Object.values(a.stateDefinitions).find((e=>e.name===t.name));if(!n)return;s.renderingConditions=JSON.parse(JSON.stringify(i.renderingConditions)),s.renderingConditions.reference.id=n.id,s.renderingConditions.reference.content.id=n.id}break;case"prop":const t=i.renderingConditions.reference.id;if(t in a.propDefinitions)s.renderingConditions=JSON.parse(JSON.stringify(i.renderingConditions));else if(t in r.propDefinitions&&i.renderingConditions){const e=r.propDefinitions[t],n=Object.values(a.propDefinitions).find((t=>t.name===e.name));if(!n)return;s.renderingConditions=JSON.parse(JSON.stringify(i.renderingConditions)),s.renderingConditions.reference.id=n.id,s.renderingConditions.reference.content.id=n.id}break;default:throw new Error(`Could not duplicate node rendering conditions of type ${c}`)}}};Object.freeze(Ze);const Le=new class{execute(e){const{doc:t,targetCompId:n,sourceCompId:o,node:i,nodeClone:s}=e,r=t.getProjectPageOrComponent(o);if(!r)return;const a=t.getProjectPageOrComponent(n);if(!a)return;if(!("conditionalReferencedProjectStyles"in s&&"conditionalReferencedProjectStyles"in i&&i.conditionalReferencedProjectStyles))return;Object.entries(i.conditionalReferencedProjectStyles).forEach((([e,t])=>{const n=e,{reference:o}=t;switch(o.content.referenceType){case"state":const e=o.id;if(e in a.stateDefinitions)s.conditionalReferencedProjectStyles[n]=JSON.parse(JSON.stringify(t));else if(e in r.stateDefinitions){const o=r.stateDefinitions[e],i=Object.values(a.stateDefinitions).find((e=>e.name===o.name));if(!i)return;s.conditionalReferencedProjectStyles[n]=JSON.parse(JSON.stringify(t)),s.conditionalReferencedProjectStyles[n].reference.id=i.id,s.conditionalReferencedProjectStyles[n].reference.content.id=i.id}break;case"prop":const i=o.id;if(i in a.propDefinitions)s.conditionalReferencedProjectStyles[n]=JSON.parse(JSON.stringify(t));else if(i in r.propDefinitions){const e=r.propDefinitions[i],o=Object.values(a.propDefinitions).find((t=>t.name===e.name));if(!o)return;s.conditionalReferencedProjectStyles[n]=JSON.parse(JSON.stringify(t)),s.conditionalReferencedProjectStyles[n].reference.id=o.id,s.conditionalReferencedProjectStyles[n].reference.content.id=o.id}break;default:throw new Error(`Could not duplicate node rendering conditions of type ${o.content.referenceType}`)}}))}};Object.freeze(Le);const Be=new class{constructor(){(0,a.Z)(this,"execute",(e=>{const{rootNodeId:t,sourceCompId:n,targetCompId:o,doc:i,nodeInterceptor:s=(()=>null),duplicatePropEvenIfItExists:r}=e,a={},c={};if(!i.nodes.getById(t))throw new Error(`Could not clone hierarchy. Node does not exist - ${t}`);return i.nodes.bfs(t,(e=>{var l,d;if(e.primitiveType===E.sO.SLOT)return;const p=i.cloneNodeWithLangReferences({nodeId:e.id});if(!p)throw new Error(`Failed in cloning the node - ${e.id}`);if(p.name=e.name,p.pos=this.computeNewNodePosition(e,t,i),a[e.id]=p.id,"listCtxId"in e&&"listCtxId"in p&&(c[e.listCtxId]=p.listCtxId),e.parentId){const n=a[e.parentId];n?(this.createDuplicatedNodeToParentRelation({doc:i,newParentId:n,oldParentId:e.parentId,clonedNodeId:p.id,originalNodeId:e.id}),p.parentId=n):e.id===t&&(this.createDuplicatedNodeToParentRelation({doc:i,newParentId:e.parentId,oldParentId:e.parentId,clonedNodeId:p.id,originalNodeId:e.id}),p.parentId=e.parentId)}if(e.slotId&&(p.slotId=e.slotId,p.compInstanceId=e.compInstanceId,e.compInstanceId&&i.addNodeToSlot({slotOwnerId:e.compInstanceId,node:p,slotId:e.slotId})),Me.execute({node:e,nodeClone:p,sourceCompId:n,targetCompId:o,duplicatePropEvenIfItExists:r,doc:i}),Ue.execute({doc:i,targetCompId:o,node:e,nodeClone:p}),Ze.execute({doc:i,targetCompId:o,sourceCompId:n,node:e,nodeClone:p}),Le.execute({doc:i,node:e,nodeClone:p,sourceCompId:n,targetCompId:o}),"element-node"===p.type){var u,h;const e=Object.keys(null!==(u=p.contentChildren)&&void 0!==u?u:{})[0],t=null===(h=p.contentChildren)||void 0===h?void 0:h[e];var y;if("dynamic"===(null===t||void 0===t?void 0:t.type)&&null!==t&&void 0!==t&&t.content.ctxId&&c)t.content.ctxId=null!==(y=c[t.content.ctxId])&&void 0!==y?y:t.content.ctxId}i.addNode(p),i.nodes.nodeIsCompInstance(e)&&(i.updatePageAndComponentRelations({sourceNodeId:e.id,newNodeId:p.id,doc:i}),i.cloneSlottedNodes({sourceInstanceId:e.id,targetInstanceId:p.id,duplicatePropEvenIfItExists:r,doc:i}),this.duplicateNodeHierarchyAttributes(i,e,p)),i.assets.copyAssetsInNodeRelationToNode({sourceNodeId:e.id,targetNodeId:p.id});const m=null!==(l=null===(d=(0,he.b3)(e,"id"))||void 0===d?void 0:d.toString())&&void 0!==l?l:"";m&&pe.execute({sectionId:m,compId:o,nodeId:p.id},i),s(e,p)})),a})),(0,a.Z)(this,"duplicateNodeHierarchyAttributes",((e,t,n)=>{Object.keys(t.attrs).forEach((o=>{const i=t.attrs[o];if("hierarchy"!==i.type)return;const s=e.cloneRichTextHierarchy({doc:e,rootNodeId:i.content,meta:{isAttributeRoot:{nodeId:n.id,attr:o}}});s&&(n.attrs[o].content=s)}))}))}createDuplicatedNodeToParentRelation(e){const{doc:t,newParentId:n,oldParentId:o,originalNodeId:i,clonedNodeId:s}=e,r=t.nodes.getById(n),a=t.nodes.getById(o);if(!r)throw new Error("Attempted to create node-parent relation during cloning but did not find new parent");if(!a)throw new Error("Attempted to create node-parent relation during cloning but did not find old parent");if("childrenIds"in r&&!("stateNodeRoots"in r)&&(r.childrenIds[s]=!0),"stateNodeRoots"in r){if(!("stateNodeRoots"in a))throw new Error("Could not update node-parent relation in CMS node");const e=Object.keys(a.stateNodeRoots).find((e=>a.stateNodeRoots[e]===i));r.stateNodeRoots[e]=s}if("mappings"in r){if(!("mappings"in a))throw new Error("Could not update node-parent relation in CMS node");const e=Object.keys(a.mappings).find((e=>a.mappings[e].componentInstanceId===i));if(!e)throw new Error(`Duplicated a Mixed Type node but could not find mapping for its child by id ${i}`);r.mappings[e].componentInstanceId=s}}computeNewNodePosition(e,t,n){if(e.id!==t)return e.pos;const o=n.nodes.getNextSibling(e);return o?(0,N.Dd)(e.pos,o.pos):(parseFloat(e.pos)+Number.MAX_SAFE_INTEGER).toString()}};Object.freeze(Be);const We=new class{constructor(){(0,a.Z)(this,"execute",((e,t)=>{const n=t.components.byId[e];if(!n)throw new Error(`Could not find target component for duplicate operation - ${e}`);if(!n.rootNodeId)throw new Error(`Componnt does not have a root node id - ${e}`);const o=t.components.cloneComponent(e);return o.title=t.getUniqueCompOrPageName(o.title),o.pos=t.components.getPositionAfterComp(n),o.sectionIds={},o.propDefinitions={},t.addComponent({component:o}),Be.execute({doc:t,sourceCompId:n.id,targetCompId:o.id,rootNodeId:n.rootNodeId,nodeInterceptor:(e,i)=>{if(n.rootNodeId===e.id){t.components.byId[o.id].rootNodeId=i.id;const e=t.nodes.getById(i.id);e&&(e.compIdOfRootNode=o.id)}}}),o.id}))}};function ze(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function $e(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ze(Object(n),!0).forEach((function(t){(0,a.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ze(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}Object.freeze(We);const Ge=new class{constructor(){(0,a.Z)(this,"execute",(e=>{var t;const{pageId:n,duplicatedSocialImage:o,doc:i}=e,s=i.pages.byId[n];if(!s)throw new Error("Could not find target page for duplicate operation");o&&i.assets.add(o);const r=Object.values(i.pages.byId).map((e=>{var t;return null===e||void 0===e||null===(t=e.settings)||void 0===t?void 0:t.url})).filter((e=>e)),a=i.getUniqueCompOrPageName(s.title),c=`/${(0,v.N0)(a)}`;let l=null!==(t=s.settings)&&void 0!==t&&t.url?(0,v.Zu)(r,s.settings.url):void 0;!l&&r.includes(c)&&(l=(0,v.Zu)(r,c));const d=$e($e({},s.settings),{},{url:l,socialImage:null===o||void 0===o?void 0:o.id}),p=i.pages.clonePage(n);return p.pos=i.pages.getPositionAfterPage(s),p.title=a,p.settings=d,i.addPage({page:p}),s.rootNodeId&&Be.execute({doc:i,sourceCompId:s.id,targetCompId:p.id,rootNodeId:s.rootNodeId,nodeInterceptor:(e,t)=>{var n;s.rootNodeId===e.id&&(i.pages.byId[p.id].rootNodeId=t.id,i.nodes.getById(t.id).compIdOfRootNode=p.id);const o=null===(n=(0,he.b3)(e,"id"))||void 0===n?void 0:n.toString();o&&pe.execute({sectionId:o,compId:p.id,nodeId:t.id},i)}}),p.id}))}};Object.freeze(Ge);const He=new class{constructor(){(0,a.Z)(this,"execute",(e=>{var t;const{nodeId:n,doc:o}=e;if(!o)return null;const i=o.nodes.getById(n);if(!i||!o.nodes.nodeIsCompInstance(i))throw new Error("Component Instance to detach is non existent");const s=o.components.byId[i.compIdOfCompInstance];if(!s)throw new Error("Component Instance to detach not attached to a component");const r=Object.keys(s.slots||{}).map((e=>o.nodes.getById(e))),a=i.compIdOfCompInstance;if(!a)throw new Error("Component Id non existent");const c=o.components.byId[a];if(!c)throw new Error("Component non existent");const l=o.nodes.getById(c.rootNodeId);if(!l)throw new Error(`Root Node of the comppnent is missing from the nodes - ${c.rootNodeId}`);const d=[],p=null===(t=i.attrs[ye.Q])||void 0===t?void 0:t.content,u=i.getActualParentId();if(i.slotId&&i.compInstanceId&&o.removeNodeFromSlot({node:i,slotOwnerId:i.compInstanceId,slotId:i.slotId}),u){const e=o.copyNodesToTarget({targetId:u,nodes:[o.nodes.getById(l.id)],copyBefore:i,compInstanceId:i.compInstanceId});d.push(...e.copiedNodes),o.nodes.getById(e.nodeIdsMap[l.id]).compIdOfRootNode=null;const t=o.getComponentIdForNode(u);o.removeUsedComponentRelation({toRemoveComponentId:t,linkedComponentId:a}),Object.keys(e.nodeIdsMap).forEach((t=>{const n=d.find((n=>n.id===e.nodeIdsMap[t]));n&&"renderingConditions"in n&&n.renderingConditions&&(n.renderingConditions=null);const s=r.find((e=>(null===e||void 0===e?void 0:e.parentId)===t));if(s&&n){var a;const e=o.nodes.getNextSibling(s);o.moveNodesToTarget({nodes:Object.keys((null===(a=i.slottedNodes)||void 0===a?void 0:a[s.id])||{}).map((e=>o.nodes.getById(e))),targetId:n.id,nextSibling:e})}if(!n||!("attrs"in n))return;const l=(0,he.Uq)(n,"src");if(!l||!n)return;const p=Object.values(c.propDefinitions).find((e=>Object.values(e.locations[t]||{}).some((e=>"attr"===e.base&&"src"===e.sufix))));null!==p&&void 0!==p&&p.defaultValue&&o.syncAssetInNodeRelationByNewContent({oldContent:new ne.F({content:p.defaultValue}),newContent:l,node:n})}))}return o.assets.removeAssetsRelationToNode(i.id),o.deleteNodesInternationalizationReferences({nodeIds:[i.id]}),o.nodes.removeNode(i.id),delete s.instantiatedByNodes[i.id],"string"===typeof p&&delete s.styleSetDefinitions[p],d}))}};Object.freeze(He);var Ke=n(622794);const Ve=["parentNode","addedNodes","styleManagementFlow"];function Ye(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function Je(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Ye(Object(n),!0).forEach((function(t){(0,a.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ye(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}const Xe=new class{constructor(){(0,a.Z)(this,"execute",((e,t)=>{var n;const{parentNode:o,addedNodes:i,styleManagementFlow:s}=e,r=(0,Ke.Z)(e,Ve);if(!o||"element-node"!==o.type)return;if(!("styles"in o)||!("fakeSize"in o))throw new Error("Parent node does not have styles and fakeSize abilities");const a=(null===(n=o.styles[oe.X7.DISPLAY])||void 0===n?void 0:n.content.toString().indexOf("flex"))>-1,c=o.primitiveType===E.sO.COMPONENT;if(!a||!o.fakeSize||c)return;if(i.every((e=>"fixed"===s.getCurrentStyleValueByKeyForNode(e.id,["position"]).position)))return;const{widthBiggerOrEqualToDefault:l,heightBiggerOrEqualToDefault:d}=this.checkForBiggerThanDefaultElements(i,t);this.shouldDeleteFakeHeight(Je({parentNode:o,heightBiggerOrEqualToDefault:d},r))&&delete o.styles[oe.X7.HEIGHT],this.shouldDeleteFakeWidth(Je({parentNode:o,widthBiggerOrEqualToDefault:l},r))&&delete o.styles[oe.X7.WIDTH]})),(0,a.Z)(this,"checkForBiggerThanDefaultElements",((e,t)=>{let n=!1,o=!1;for(const l of e){var i,s;if(n&&o)break;if(!l)break;const e="styles"in l?l.styles:{};let d=null===(i=e[oe.X7.HEIGHT])||void 0===i?void 0:i.content,p=null===(s=e[oe.X7.WIDTH])||void 0===s?void 0:s.content;if(t.nodes.nodeIsCompInstance(l)){var r;const e=null===(r=t.components.byId[l.compIdOfCompInstance])||void 0===r?void 0:r.rootNodeId;if(e){var a,c;const n=t.nodes.getById(e);d=null===(a=n.styles[oe.X7.HEIGHT])||void 0===a?void 0:a.content,p=null===(c=n.styles[oe.X7.WIDTH])||void 0===c?void 0:c.content}}n||(d?n=Number.parseInt(d.toString().slice(0,-2),10)>=Number.parseInt(ie.xD.slice(0,-2),10):l.primitiveType===E.sO.IMAGE&&(n=!0)),p&&!o&&(o=Number.parseInt(p.toString().slice(0,-2),10)>=Number.parseInt(ie.pF.slice(0,-2),10))}return{widthBiggerOrEqualToDefault:o,heightBiggerOrEqualToDefault:n}})),(0,a.Z)(this,"shouldDeleteFakeHeight",(e=>{var t;const{heightBiggerOrEqualToDefault:n,parentNode:o,addingFirstChildren:i,dropPosition:s}=e;if(o.fakeSize)return!0;if(n)return!0;return"column"===(null===(t=o.styles[oe.X7.FLEX_DIRECTION])||void 0===t?void 0:t.content)&&i?!(s&&-1===s.indexOf("top")):void 0})),(0,a.Z)(this,"shouldDeleteFakeWidth",(e=>{var t,n;const{widthBiggerOrEqualToDefault:o,parentNode:i,addingFirstChildren:s,dropPosition:r}=e;if(i.fakeSize)return!0;if((null===(t=i.styles[oe.X7.WIDTH])||void 0===t?void 0:t.content)===ie.V0)return!1;if(o)return!0;if("row"===(null===(n=i.styles[oe.X7.FLEX_DIRECTION])||void 0===n?void 0:n.content)&&s){if(r&&-1===r.indexOf("left"))return;return!0}}))}};Object.freeze(Xe);const qe=new class{constructor(){(0,a.Z)(this,"execute",((e,t)=>{var n,o,i;const s=t.nodes.getById(e);if(!s||!s.parentId)return;const r=t.nodes.getById(s.parentId);if(!r||"element-node"!==r.type)return;if(!("styles"in r)||!("fakeSize"in r))throw new Error("Parent node does not have styles and fakeSize abilities");const a=Object.keys(r.childrenIds).length,c=(null===(n=r.styles[oe.X7.DISPLAY])||void 0===n?void 0:n.content.toString().indexOf("flex"))>-1;if(1!==a||!c||!r.fakeSize)return;const l=null===(o=r.styles[oe.X7.HEIGHT])||void 0===o?void 0:o.content,d=null===(i=r.styles[oe.X7.WIDTH])||void 0===i?void 0:i.content;l||(r.styles[oe.X7.HEIGHT]=new ne.F({content:r.primitiveType===E.sO.COMPONENT?ie.K3:ie.xD})),d||(r.styles[oe.X7.WIDTH]=new ne.F({content:ie.pF})),r.fakeSize=!0}))}};Object.freeze(qe);var Qe=n(107547),et=n(231545);function tt(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}const nt=new class{constructor(){(0,a.Z)(this,"execute",(e=>{var t;const{doc:n,nodeId:o,targetNodeId:i,sentryService:s}=e;if(!n)return null;const r=n.nodes.getById(o);if(!r||!("attrs"in r))return null;const c=null!==(t=(0,he.kd)(r,ye.Q))&&void 0!==t?t:"";let l="";if(n.nodes.nodeIsCompInstance(r)&&c&&i){const e=n.components.byId[r.compIdOfCompInstance];if(!e)return s.captureException(new Error(`Clone attributes skipped. Component by ${r.compIdOfCompInstance} not found`)),null;l=e.getUniqueStyleSetName(n);const t=n.cloneStyleSetDefinition({targetInstanceId:i,instanceId:o,className:c.toString(),doc:n,sentryService:s});t&&(e.styleSetDefinitions[l]=t)}return Object.keys(r.attrs||{}).reduce(((e,t)=>{const n=(0,he.Uq)(r,t);if(!n)return e;const o="clone"in n?n.clone():function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?tt(Object(n),!0).forEach((function(t){(0,a.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):tt(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},n);return e[t]=o,t.includes(ye.Q)&&(e[t].content=l),e}),{})}))}};function ot(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function it(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ot(Object(n),!0).forEach((function(t){(0,a.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ot(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}Object.freeze(nt);const st=new class{constructor(){(0,a.Z)(this,"execute",(e=>{var t,n,o,i,s;const{doc:r,nodeId:a,removeRootStatus:c,sentryService:l}=e;if(!r)return null;const d=r.nodes.getById(a);if(!d)return null;let p;switch(d.type){case"date-time-node":p=new D.Z3({primitiveType:d.primitiveType,compIdOfRootNode:c?null:d.compIdOfRootNode,semanticType:d.semanticType,contentChildren:Object.keys(d.contentChildren||{}).reduce(((e,t)=>{var n;if(null===(n=d.contentChildren)||void 0===n||!n[t])throw new Error(`Could not clone content children for node with id ${d.id}`);return e[t]=d.contentChildren[t].clone(),e}),{}),pos:d.pos,name:d.name,compIdOfSlot:d.compIdOfSlot,abilities:d.cloneAbilities()});break;case"element-node":p=new D.HX({primitiveType:d.primitiveType,meta:null!==(t=d.meta)&&void 0!==t?t:{},devComponentPath:d.devComponentPath||void 0,compIdOfRootNode:c?null:d.compIdOfRootNode,semanticType:d.semanticType,contentChildren:Object.keys(d.contentChildren||{}).reduce(((e,t)=>{var n;if(null===(n=d.contentChildren)||void 0===n||!n[t])throw new Error(`Could not clone content children for node with id ${d.id}`);return e[t]=d.contentChildren[t].clone(t),e}),{}),pos:d.pos,name:d.name,fakeSize:null!==(n=d.fakeSize)&&void 0!==n?n:void 0,compIdOfSlot:d.compIdOfSlot,abilities:d.cloneAbilities(),customCodeSnippet:d.customCodeSnippet,uninitialised:!1});break;case"html-node":p=new L.b({primitiveType:d.primitiveType,compIdOfRootNode:c?null:d.compIdOfRootNode,semanticType:d.semanticType,pos:d.pos,name:d.name,html:null!==(o=d.html)&&void 0!==o?o:void 0,uninitialised:!1});break;case"cms-html-node":p=new L.D({primitiveType:d.primitiveType,compIdOfRootNode:c?null:d.compIdOfRootNode,semanticType:d.semanticType,cmsType:null!==(i=d.cmsType)&&void 0!==i?i:void 0,pos:d.pos,name:d.name,html:null!==(s=d.html)&&void 0!==s?s:void 0,uninitialised:!1});break;case"component-instance-node":p=new T.F({primitiveType:d.primitiveType,compIdOfRootNode:c?null:d.compIdOfRootNode,semanticType:d.semanticType,pos:d.pos,name:d.name,compIdOfCompInstance:d.compIdOfCompInstance});break;case"cms-collection-list-node":p=new U.t({primitiveType:d.primitiveType,resourceDefinition:d.resourceDefinition?it({},d.resourceDefinition):void 0,pos:d.pos,paginated:d.paginated,repeatableCtxId:d.repeatableCtxId,listCtxId:d.listCtxId,uninitialised:!1});break;case"cms-navigation-button":p=new W.z({primitiveType:d.primitiveType,name:d.name,renderingConditions:it({},d.renderingConditions),abilities:d.cloneAbilities(),pos:d.pos,uninitialised:!1});break;case"cms-pagination-node":p=new B.k({primitiveType:d.primitiveType,name:d.name,pos:d.pos,disabled:d.disabled,uninitialised:!1});break;case"cms-collection-item-node":p=new Z.n({primitiveType:d.primitiveType,pos:d.pos,ctxId:d.ctxId,resourceDefinition:d.resourceDefinition?it({},d.resourceDefinition):void 0,uninitialised:!1});break;case"cms-collection-list-repeater-node":p=new D.kf({primitiveType:d.primitiveType,name:d.name,pos:d.pos,uninitialised:!1});break;case"cms-array-mapper":p=new z.k({primitiveType:d.primitiveType,name:d.name,pos:d.pos,repeatableCtxId:d.repeatableCtxId,listCtxId:d.listCtxId,attrs:d.attrs?it({},d.attrs):void 0,uninitialised:!1});break;case"cms-mixed-type-node":p=new G.U({primitiveType:d.primitiveType,name:d.name,pos:d.pos,ctxId:d.ctxId,mappings:JSON.parse(JSON.stringify(d.mappings)),uninitialised:!1});break;case"repeater":p=new H.Z({primitiveType:d.primitiveType,name:d.name,pos:d.pos,uninitialised:!1});break;default:throw new Error(`Unsupported node type ${d.type} for CloneElementNodeUseCase`)}if("attrs"in p){const e=nt.execute({nodeId:a,doc:r,targetNodeId:p.id,sentryService:l});e&&(p.attrs=e)}if("styles"in p){const e=Qe.S.execute({targetNodeId:p.id,nodeId:a,doc:r});e&&(p.styles=e)}if("referencedStyles"in p){const e=et.l.execute({targetNodeId:p.id,nodeId:a,doc:r});e&&(p.referencedStyles=e)}return p}))}};Object.freeze(st);var rt,at,ct,lt,dt,pt=n(686646);const ut=new(rt=(0,d.inject)("nodeStyleManagmentFlow"),at=(0,d.inject)("notificationsManagementFlow"),ct=class{constructor(){(0,r.Z)(this,"nodeStyleManagementFlow",lt,this),(0,r.Z)(this,"notificationsManagementFlow",dt,this),(0,a.Z)(this,"execute",(e=>{const{doc:t,nodes:n,targetId:o,nextSibling:i,dropPosition:s,ignoreAcceptanceCheck:r=!1,useContentAsNode:a=!1,targetCompInstanceId:c}=e,l=t.nodes.getById(o);if(!n.length)return;let d;if(i){const e=t.nodes.getPrevSibling(i);d=(0,N.Dd)(i.pos,(null===e||void 0===e?void 0:e.pos)||"0")}else{const e=t.nodes.getLastChild(l,c);d=(parseFloat((null===e||void 0===e?void 0:e.pos)||"0")+Number.MAX_SAFE_INTEGER).toString()}const p=a&&(0,N.j1)(t,l),u=!t.nodes.getFirstChild(l),h=n.map((e=>e.id)),y=t.nodes.getOrderedTopLevelNodes(h),m=[],f=t.getComponentIdForNode(h[0]),g=t.getComponentIdForNode(o);if(!f||!g)throw new Error("Target or Source component not found");const _=t.getProjectPageOrComponent(g),b=t.getProjectPageOrComponent(f);if(!_||!b)throw new Error("Target or source comp nout found");const v=_.id!==b.id;v&&b instanceof I.n&&h.forEach((e=>{t.nodes.bfs(e,(n=>{_ instanceof I.n?t.moveNodePropDefinitionToTarget({doc:t,sourceCompId:f,targetCompId:g,nodeId:n.id}):(Object.values(b.propDefinitions).forEach((o=>{o.locations[n.id]&&(t.replaceDynamicPropWithStaticNode({node:n,propDefinition:o,propId:o.id,newValue:o.defaultValue}),1===Object.keys(o.locations).length?delete b.propDefinitions[o.id]:delete o.locations[e])})),Object.values(b.stateDefinitions).forEach((o=>{o.locations[n.id]&&(t.replaceDynamicStateWithStaticNode({node:n,stateDefinition:o,stateId:o.id,staticValue:o.defaultValue}),delete o.locations[e])})))}))}));const w=t.nodes.getAvailableContextIdsForNode(o,c);if(y.forEach((e=>{const n=t.nodes.getById(e);if(!n)return;const s=t.nodes.getUsedContextIdsForNode(e);if(w.every((e=>!s.includes(e)))){t.nodes.getDescendents(e).forEach((e=>{t.replaceCtxReferenceWithStaticNode({node:e,targetAvailableCtxIds:w,doc:t})}))}if(t.nodes.nodeIsCompInstance(n)&&v){if(t.components.checkIfComponentsHaveCircularDependency(n.compIdOfCompInstance,_.id))return void this.notificationsManagementFlow.createNotification(pt.k$.ERROR,"Could not move component because it would create a circular dependency.");t.removeUsedComponentRelation({toRemoveComponentId:b.id,linkedComponentId:n.compIdOfCompInstance}),t.addUsedComponentRelation({toAddComponentId:_.id,linkedComponentId:n.compIdOfCompInstance})}if(!n.primitiveType||!r&&!t.isNodeAcceptingChild({node:l,child:n}))return;if(t.nodes.getDescendents(n.id).find((e=>e.id===o)))return;const a=n.getActualParentId();if(!a)throw new Error("Attempted to move a node without a parent! Could it be root?");t.restoreBGColor(n,l),t.restoreParentNodesFakeSize(e);const p=l.primitiveType===E.sO.SLOT,u=n.compInstanceId,h=t.nodes.getById(a);if(h.id!==l.id||c!==u)if(n.slotId?t.removeNodeFromSlot({node:n,slotOwnerId:u||n.parentId,slotId:n.slotId}):h.id!==l.id&&"childrenIds"in h&&delete h.childrenIds[n.id],p){if(!t.addNodeToSlot({node:n,slotOwnerId:c,slotId:l.id}))throw new Error(`Failed to add node to slot! NodeId: ${n.id}, slotId: ${l.id}`)}else h.id!==l.id&&"childrenIds"in l&&(l.childrenIds[n.id]=!0);p?(n.parentId=null,n.slotId=l.id,n.compInstanceId=c):(delete n.slotId,delete n.compInstanceId,n.parentId=o),n.pos=d,m.push(n),h.primitiveType!==E.sO.BUTTON||Object.keys(h.childrenIds).length||me.execute({nodeIds:[a],withSubtree:!1},t),d=i?(0,N.Dd)(n.pos,i.pos):(parseFloat(n.pos)+Number.MAX_SAFE_INTEGER).toString()})),t.removeDefaultBorder(u,l),m.length&&t.removeParentNodeFakeSize({parentNode:l,addedNodes:m,addingFirstChildren:u,dropPosition:s,styleManagementFlow:this.nodeStyleManagementFlow}),p){if("before"===s){const e=t.nodes.getLastChild(l,c);p.pos=(parseFloat((null===e||void 0===e?void 0:e.pos)||"0")+Number.MAX_SAFE_INTEGER).toString()}else{const e=t.nodes.getFirstChild(l,c);p.pos=(0,N.Dd)("0",(null===e||void 0===e?void 0:e.pos)||"0")}t.nodes.add(p)}}))}},lt=(0,c.Z)(ct.prototype,"nodeStyleManagementFlow",[rt],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),dt=(0,c.Z)(ct.prototype,"notificationsManagementFlow",[at],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ct);function ht(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function yt(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ht(Object(n),!0).forEach((function(t){(0,a.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ht(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}Object.freeze(ut);const mt=new class{constructor(){(0,a.Z)(this,"execute",(e=>{const{sourceCompId:t,targetCompId:n,nodeId:o,doc:i}=e,s=i.components.byId[t],r=i.components.byId[n];if(!s)throw new Error("Source comp was not found");if(!r)throw new Error("Target comp was not found");Object.keys(s.propDefinitions).forEach((e=>{const t=s.propDefinitions[e];if(t.locations[o]){let n="";if(t.defaultHierarchyRootId){if(!i.nodes.getById(o))throw new Error("Node was not found while moving prop definition to target");const s=i.nodes.getById(t.defaultHierarchyRootId);if(!s)throw new Error("Hierarchy root node was not found while moving prop definition to target");const r=i.cloneNodeWithLangReferences({nodeId:t.defaultHierarchyRootId});if(!r)throw new Error("Hierarchy root node was not cloned while moving prop definition to target");r.rootOfPropHierarchy=e,n=r.id,i.nodes.add(r);const a=Object.keys(s.childrenIds)[0],c=i.nodes.getById(a);if(!c)throw new Error("Semantic node was not found while moving prop definition to target");const l=i.cloneNodeWithLangReferences({nodeId:a});if(!l)throw new Error("Semantic node was not cloned while moving prop definition to target");l.parentId=r.id,Object.keys(c.childrenIds).forEach((e=>{const t=i.nodes.getById(e);if(!t)return;const n=i.cloneNodeWithLangReferences({nodeId:e});n&&(l.childrenIds[n.id]=!0,n.parentId=l.id,n.pos=t.pos,i.addNode(n))})),i.addNode(l)}const a=yt(yt({},JSON.parse(JSON.stringify(t))),{},{defaultHierarchyRootId:n,name:r.getUniquePropDefinitionName(t.name)});Object.keys(a.locations).forEach((e=>{e!==o&&delete a.locations[e]})),r.propDefinitions[e]=a,1===Object.keys(t.locations).length?delete s.propDefinitions[e]:delete t.locations[o]}}))}))}};Object.freeze(mt);var ft=n(824497);class gt{constructor(e){(0,a.Z)(this,h.Patcher,void 0),(0,a.Z)(this,"id",void 0),(0,a.Z)(this,"accessType",void 0),(0,a.Z)(this,"account",void 0),(0,a.Z)(this,"invitedEmail",void 0),(0,a.Z)(this,"permissionLevel",void 0),(0,a.Z)(this,"meta",void 0);const{id:t,accessType:n,account:o,invitedEmail:i,permissionLevel:s}=e||{};this.id=null!==t&&void 0!==t?t:(0,Se.Ox)(),this.accessType=n||ft.Z.WRITE,this.account=o||null,this.invitedEmail=i||"",this.permissionLevel=s||ft.z.PROJECT}fromJSON(e){const{id:t,accessType:n,permissionLevel:o,account:i,invitedEmail:s,meta:r}=e;return this.id=t,this.accessType=n,this.permissionLevel=o,this.account=i,this.invitedEmail=s,this.meta=r,this}toJSON(){return{id:this.id,accessType:this.accessType,permissionLevel:this.permissionLevel,account:this.account,invitedEmail:this.invitedEmail}}}function _t(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}class bt{constructor(){(0,a.Z)(this,h.Patcher,void 0),(0,a.Z)(this,"byId",{})}add(e){this.byId[e.id]=(new gt).fromJSON(function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?_t(Object(n),!0).forEach((function(t){(0,a.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):_t(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},e))}setAll(e){this.byId={},e.forEach((e=>{this.add(e)}))}remove(e){delete this.byId[e]}getAll(){return Object.values(this.byId)}getWorkspaceOwner(){return Object.values(this.byId).find((e=>e.accessType===ft.Z.OWNER))}getCollaboratorByAccountId(e){return Object.values(this.byId).find((t=>{var n;return(null===(n=t.account)||void 0===n?void 0:n.id)===e}))}toJSON(){return{byId:Object.keys(this.byId).reduce(((e,t)=>{var n;return null!==(n=this.byId[t])&&void 0!==n&&n.toJSON?e[t]=this.byId[t].toJSON():e[t]=JSON.parse(JSON.stringify(this.byId[t])),e}),{})}}fromJSON(e){if(this.byId={},!e)return;const{byId:t={}}=e;if(!t||"object"!==typeof t)return;const n=Object.keys(t||{});let o="",i={};for(let s=0;s<n.length;s+=1)o=n[s],i=t[o],this.byId[o]=(new gt).fromJSON(i)}applyPatch(e){const{pathArray:t,value:n}=e;2===t.length&&"byId"===t[0]&&(n?this.byId[t[1]]=(new gt).fromJSON(n):delete this.byId[t[1]])}}const It=(e,t,n)=>{if(e.styles.display=new ne.F({content:n.content}),!("styles"in t))throw new Error("Unhandled use case when grouping nodes that are children of a Fragment(like) parent");const o=t.styles.flexDirection;o instanceof ne.F&&(e.styles.flexDirection=new ne.F({content:o.content}));const i=t.styles.justifyContent;i instanceof ne.F&&(e.styles.justifyContent=new ne.F({content:i.content}));const s=t.styles.alignItems;s instanceof ne.F&&(e.styles.alignItems=new ne.F({content:s.content}))},vt=e=>{e.styles.display=new ne.F({content:"flex"}),e.styles.flexDirection=new ne.F({content:"column"}),e.styles.justifyContent=new ne.F({content:"center"}),e.styles.alignItems=new ne.F({content:"center"})},wt=new class{constructor(){(0,a.Z)(this,"execute",(e=>{const{nodeIds:t,doc:n,freestyleParams:o}=e;if(!n.nodes.areNodesSiblings(t))throw new Error("Attempted to group nodes that are not siblings");const i=n.nodes.orderChildrenIds(t).map((e=>n.nodes.getById(e))),s=i[0],r=s.getActualParentId(),{compInstanceId:a}=n.nodes.getSlotAndCompInstanceIdForNodeById(s.id);if(!s||!r)return null;const c=n.nodes.getById(r);if(!c)return null;if(!("styles"in c))throw new Error("Unhandled use case when grouping nodes that are children of a Fragment(like) parent");const l=new D.HX({semanticType:E.iX.DIV,primitiveType:E.sO.CONTAINER,fakeSize:!1});o&&(l.styles.position=new ne.F({content:"absolute"}),l.styles.left=new ne.F({content:`${o.left}px`}),l.styles.top=new ne.F({content:`${o.top}px`}),l.styles.width=new ne.F({content:`${o.width}px`}),l.styles.height=new ne.F({content:`${o.height}px`}));const d=c.styles.display;d instanceof ne.F&&"flex"===d.content&&It(l,c,d),d||vt(l);let p=!1,u=!1;i.forEach((e=>{var t,n;!p&&"styles"in e&&"100%"===(null===(t=e.styles.width)||void 0===t?void 0:t.content)&&(p=!0),!u&&"styles"in e&&"100%"===(null===(n=e.styles.height)||void 0===n?void 0:n.content)&&(u=!0)})),u&&(l.styles.height=new ne.F({content:"100%"})),p&&(l.styles.width=new ne.F({content:"100%"}));const h=n.nodes.getNextSibling(s)||null;return n.addNodesToParentOrStage({nodes:[l],parentId:c.id,nextSibling:h,compInstanceId:a}),ut.execute({nodes:i,targetId:l.id,targetCompInstanceId:a,doc:n}),l.id}))}};Object.freeze(wt);const Ot=new class{constructor(){(0,a.Z)(this,"execute",(e=>{const{nodeId:t,doc:n}=e,o=n.nodes.getById(t);if(!o)throw new Error("Node not found");const i=o.getActualParentId();if(!i)return;if(o.compIdOfRootNode)throw new Error("Attempted to ungroup component root");if(o.primitiveType!==E.sO.CONTAINER)throw new Error("Attempted to ungroup element that is not a container");const s=[];"childrenIds"in o&&Object.keys(null===o||void 0===o?void 0:o.childrenIds).forEach((e=>{const t=n.nodes.getById(e);t&&s.push(t)}));const r=n.nodes.getNextSibling(o);ut.execute({nodes:s,targetId:i,nextSibling:r,targetCompInstanceId:n.nodes.getSlotAndCompInstanceIdForNodeById(o.id).compInstanceId,doc:n}),n.deleteNodesById({nodeIds:[t],withSubtree:!1})}))}};Object.freeze(Ot);var jt=n(21023);function St(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function Nt(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?St(Object(n),!0).forEach((function(t){(0,a.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):St(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}class Dt{constructor(){(0,a.Z)(this,h.Patcher,void 0),(0,a.Z)(this,"remote",{}),(0,a.Z)(this,"staged",{[q.cY]:{byId:{}}}),(0,a.Z)(this,"local",{[q.cY]:{byId:{}}}),(0,a.Z)(this,"conflicts",{}),(0,a.Z)(this,"isAddingExternalDependency",null),(0,a.Z)(this,"lastSync",null),(0,a.Z)(this,"lastSave",null)}getNextFileId(e,t){const n=this.local[t].byId||{},o=Object.keys(n),i=o.indexOf(e);if(-1===i)return null;for(let s=i+1;s<o.length-1;s++){const e=o[s];if(e.split(".").length>1)return e}return null}getFirstFileId(e){const t=this.local[e].byId||{};return Object.keys(t).find((e=>e.split(".").length>1))||null}getUniqueName(e,t){const{byId:n={}}=this.local[t],o=Object.keys(n);let i="";const s=e.split("."),r=1===s.length;r||(i=s[s.length-1],e=s.slice(0,s.length-1).join("."));let a=1;for(;o.some((t=>t===(r?e:`${e}.${i}`)));)e+=a,a+=1;return r?e:`${e}.${i}`}getFileChildren(e,t){const{byId:n={}}=this.local[t];return Object.keys(n).filter((t=>t!==e&&0===t.indexOf(`${e}/`)))}getRemoteChildren(e,t){const{byId:n={}}=this.remote[t];return Object.keys(n).filter((t=>t!==e&&0===t.indexOf(`${e}/`)))}flatFiles(e){const{includeFolders:t=!1,assets:n={},branch:o}=e,{byId:i={}}=this.local[o]||{},s=Nt(Nt({},i),n);return Object.keys(s||{}).reduce(((e,n)=>{const o=(0,jt.parse)(n);return(t||o.ext)&&(e[n]=s[n].code),e}),{})}addConflict(e,t){this.conflicts[e]=t}pack(e){const{filesToPack:t,withContent:n=!0,toDeploy:o=!1,branch:i,assets:s,customFiles:r={}}=e||{};let a=t;if(!a){if(!i)throw new Error("Branch name must be provided if files to parse are not given");const{byId:e}=this.local[i]||{};a=Nt(Nt({},e),s)}if(!a)return null;const c=Object.keys(r||{}).reduce(((e,t)=>{const n=r[t];return e[(0,jt.join)(q.y$,n.path,n.name)]={code:n.content},e}),{});if(a=Nt(Nt({},a),c),!Object.keys(a).length)return null;return Object.keys(a).reduce(((e,t)=>{const i=t.split("/").filter((e=>e));i.shift();let s=e;return i.forEach(((e,r)=>{const c=(0,jt.parse)(e);if(c.ext){const e=c.name;if(r===i.length-1){var l;const i=null===(l=a)||void 0===l?void 0:l[t],r=c.ext.substring(1);return void s.files.push(Nt(Nt({},(n||o)&&{content:null===i||void 0===i?void 0:i.code}),{},{fileType:r,status:null===i||void 0===i?void 0:i.status,name:e},!o&&{isProtected:null===i||void 0===i?void 0:i.is_protected}))}}const d=s.subFolders.find((t=>t.name===e));if(d)s=d;else{const t={name:e,files:[],subFolders:[]};s.subFolders.push(t),s.subFolders.sort(((e,t)=>e.name.localeCompare(t.name))),s=t}})),e}),{name:q.y$,files:[],subFolders:[]})}toJSON(){return{local:JSON.parse(JSON.stringify(this.local)),remote:JSON.parse(JSON.stringify(this.remote)),staged:JSON.parse(JSON.stringify(this.staged)),conflicts:JSON.parse(JSON.stringify(this.conflicts)),isAddingExternalDependency:this.isAddingExternalDependency,lastSync:this.lastSync,lastSave:this.lastSave}}fromJSON(e){if(this.local={[q.cY]:{byId:{}}},this.remote={},!e)return;const{local:t={[q.cY]:{byId:{}}},staged:n={[q.cY]:{byId:{}}},conflicts:o={},remote:i={},lastSync:s=null,lastSave:r=null,isAddingExternalDependency:a}=e;t&&"object"===typeof t&&Object.keys(t||{}).length&&(this.local=t,this.staged=n,this.conflicts=o,this.isAddingExternalDependency=a||null,this.lastSync=s,this.lastSave=r,i&&"object"===typeof i&&Object.keys(i||{}).length&&(this.remote=i))}applyPatch(e){const{pathArray:t,value:n,op:o}=e;if(1===t.length){if("lastSave"===t[0])return void(this.lastSave=n||null);"isAddingExternalDependency"===t[0]&&(this.isAddingExternalDependency=n||null)}if("add"===o&&4===t.length){let e=null;for(let n=0;n<t.length-1;n++)e=e?e[t[n]]:this[t[n]];return e[t[t.length-1]]&&delete e[t[t.length-1]],void(e[t[t.length-1]]=n)}if("remove"===o&&4===t.length){let e=null;for(let n=0;n<t.length-1;n++)e=e?e[t[n]]:this[t[n]];return e[t[3]]={content:""},void delete e[t[3]]}if("remove"===o&&2===t.length&&"conflicts"===t[0]&&(this.conflicts[t[1]]={byId:{}},delete this.conflicts[t[1]]),"remove"===o&&3===t.length&&"actionInProgress"===t[2]&&(this.conflicts[t[1]].actionInProgress=!1),"replace"===o&&5===t.length&&"code"===t[4]){let e=null;for(let n=0;n<t.length-1;n++)e=e?e[t[n]]:this[t[n]];return delete e.code,void(e.code=`${n}`)}if("replace"!==o||2!==t.length||"conflicts"!==t[0]){if(("replace"===o||"add"===o)&&5===t.length&&"conflicts"===t[0]){if("replace"===o&&5===t.length){let e=null;for(let n=0;n<t.length-1;n++)e=e?e[t[n]]:this[t[n]];e[t[4]]=void 0,e[t[4]]=n}if("add"===o){let e=null,o=0;for(;o<t.length-1;)e=e?e[t[o]]:this[t[o]],o+=1;if(!e)return;return e[t[o]]=void 0,void(e[t[o]]=n)}if("replace"===o&&5===t.length){let e=null;for(let n=0;n<t.length-1;n++)e=e?e[t[n]]:this[t[n]];switch(t[4]){case"code":return delete e.code,void(e.code=`${n}`);case"synced_at":return void(e.synced_at=n);default:0}}}}else this.conflicts[t[1]]=n}}var Et,Tt,Pt,Ct,xt,At,Ft,kt=n(37794),Rt=n(328681),Mt=n(197488),Ut=n(497134),Zt=n(352541);function Lt(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function Bt(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Lt(Object(n),!0).forEach((function(t){(0,a.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Lt(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}let Wt=(Et=(0,d.inject)("positioningService"),Tt=(0,d.inject)("uidlToProjectMapper"),Pt=(0,d.inject)("fontsInProjectFlow"),Ct=class{constructor(){(0,a.Z)(this,h.Patcher,void 0),(0,r.Z)(this,"positioningService",xt,this),(0,r.Z)(this,"uidlToProjectMapper",At,this),(0,r.Z)(this,"fontsInProjectFlow",Ft,this),(0,a.Z)(this,"byId",{}),(0,a.Z)(this,"categoriesById",{})}init(e,t){if(Object.keys(this.categoriesById).length)return;kt.m8.forEach((e=>{this.categoriesById[e.id]=e}));const n=(0,kt.fE)(e);Object.entries(n).forEach((([e,t])=>{const n=new Rt.J({id:(0,Se.Ox)(),name:e,pos:this.positioningService.getHighestAvailablePosition({entitiyCollection:this.byId}),categoryId:kt.m8[0].id,usedInNodes:{},content:(0,N.bb)(t),isDefault:!0});this.byId[n.id]=n}));const o=(0,Ut.Bk)(t),{googleFonts:i}=(0,Ut.Os)(t,"light"),s=[],r=[],a={};Object.keys(o).forEach((t=>{const n=o[t];if(n.subselectors)return void(a[t]=n);this.uidlToProjectMapper.addDynamicNodesToClass(e,n);const i=(new Rt.J).fromJSON({id:(0,Se.Ox)(),name:t,pos:this.positioningService.getHighestAvailablePosition({entitiyCollection:this.byId}),categoryId:kt.m8[0].id,usedInNodes:{},conditions:n.conditions?n.conditions:[],content:n.content,isDefault:!0});t.includes("thq-heading")&&s.push(i.id),t.includes("thq-body")&&r.push(i.id),this.byId[i.id]=i})),this.fontsInProjectFlow.addFont({fontName:i.headings,classIds:s}),this.fontsInProjectFlow.addFont({fontName:i.body,classIds:r}),Object.keys(a).forEach((t=>{const n=a[t];this.uidlToProjectMapper.addDynamicNodesToClass(e,n);const o=n.className,i=n.subselectors,s=Object.values(this.byId).find((e=>"simple"===e.classType&&e.getName()===o));if(!s)return;const r=(new Mt.a).fromJSON({id:(0,Se.Ox)(),pos:this.positioningService.getHighestAvailablePosition({entitiyCollection:this.byId}),categoryId:kt.m8[0].id,usedInNodes:{},conditions:n.conditions?n.conditions:[],content:n.content,subselectors:i,rootClassId:s.id,className:o,isDefault:!0});this.byId[r.id]=r}))}getAll(){return Object.values(this.byId||{})}getSortedClassesListByPos(){return this.positioningService.orderEntities({entitiyCollection:this.byId}).reduce(((e,t)=>(e[t]=this.byId[t],e)),{})}getSortedClassesListByName(){return Object.values(this.byId).sort(((e,t)=>e.getName(this.byId).toLowerCase()>t.getName(this.byId).toLowerCase()?1:-1)).reduce(((e,t)=>(e[t.id]=t,e)),{})}getClassesGrouppedByCategory(){const e=Object.values(this.byId).reduce(((e,t)=>{var n;const o=(null===(n=this.categoriesById[t.categoryId])||void 0===n?void 0:n.id)||"Uncategorized";return e[o]||(e[o]=[]),e[o].push(t),e}),{});return Object.keys(this.categoriesById).forEach((t=>{e[t]||(e[t]=[])})),e}getSimpleClasses(){return Object.values(this.byId||{}).filter((e=>"simple"===e.classType))}getCompoundClasses(){return Object.values(this.byId||{}).filter((e=>"compound"===e.classType))}addProjectClass(e){this.byId[e.id]=e}getUniqueClassName(e){const t=Object.values(this.byId).map((e=>(null===e||void 0===e?void 0:e.getName(this.byId))||""));return(0,v.Zu)(t,e)}getUniqueClassSubselector(e,t){const n=this.getCompoundClasses().filter((t=>t.rootClassId===e.rootClassId)).map((e=>(null===e||void 0===e?void 0:e.getSubselectors())||""));return(0,v.Zu)(n,t)}deleteNodeReferenceFromSimpleClasses(e){Object.values(this.byId).forEach((t=>{"simple"===t.classType&&t.usedInNodes[e]&&delete t.usedInNodes[e]}))}getCompoundClassesForSimpleClass(e){return Object.values(this.byId).filter((e=>"compound"===e.classType)).filter((t=>t.rootClassId===e))}fromJSON(e){(null!==e&&void 0!==e&&e.byId||null!==e&&void 0!==e&&e.categoriesById)&&(this.byId={},this.categoriesById={},Object.values(e.byId||{}).forEach((e=>{const t=this.buildClassBasedOnClassType(e);this.byId[t.id]=t})),Object.values(e.categoriesById||{}).forEach((e=>{this.categoriesById[e.id]=e})))}buildClassBasedOnClassType(e){switch(e.classType){case"compound":return new Mt.a(Bt(Bt({},e),{},{content:(0,N.bb)(e.content),conditions:this.mapOverConditions(e.conditions)}));case"simple":default:return new Rt.J(Bt(Bt({},e),{},{content:(0,N.bb)(e.content),conditions:this.mapOverConditions(e.conditions)}))}}mapOverConditions(e){return Object.values(e).reduce(((e,t)=>(e[t.id]=Bt(Bt({},t),{},{content:(0,N.bb)(t.content)}),e)),{})}toUIDL(e,t,n,o){return Object.values(this.getSortedClassesListByPos()).filter((e=>{if(n)return!0;switch(e.classType){case"simple":{const n=Object.keys(e.usedInNodes);if(e.getName()===kt.aG)return!0;if(null!==o&&void 0!==o&&o.length){if(!o.some((e=>n.includes(e))))return!1}return n.forEach((n=>{null!==t&&void 0!==t&&t.nodes.getById(n)||Zt.j.removeUsedInNodeFromCssClass(e.id,n)})),Object.keys(e.usedInNodes).length>0}case"compound":{const t=this.byId[e.rootClassId];if(null!==o&&void 0!==o&&o.length){if(!o.some((e=>Object.keys(t.usedInNodes).includes(e))))return!1}return Object.keys(t.usedInNodes).length>0}default:return!1}})).reduce(((n,o)=>{const i=o.toUIDL(this.byId,null===e||void 0===e?void 0:e[o.id],t);return n[o.getName(this.byId)]=i,n}),{})}toJSON(){return JSON.parse(JSON.stringify({byId:this.byId,categoriesById:this.categoriesById}))}applyPatch(e){const{op:t,pathArray:n,value:o}=e;switch(t){case"replace":case"add":if(2===n.length&&"byId"===n[0]&&o){const e=o,t=this.buildClassBasedOnClassType(e);return void(this.byId[t.id]=t)}if(2===n.length&&"categoriesById"===n[0]&&o){const e=o;return void(this.categoriesById[e.id]=e)}if(3===n.length&&"categoriesById"===n[0]&&o){const e=o;return void(this.categoriesById[n[1]].name=e)}return;case"remove":if(2===n.length&&"byId"===n[0])return void delete this.byId[n[1]];if(2===n.length&&"categoriesById"===n[0])return void delete this.categoriesById[n[1]];default:return}}},xt=(0,c.Z)(Ct.prototype,"positioningService",[Et],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),At=(0,c.Z)(Ct.prototype,"uidlToProjectMapper",[Tt],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Ft=(0,c.Z)(Ct.prototype,"fontsInProjectFlow",[Pt],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Ct);var zt=n(276635),$t=n.n(zt),Gt=n(649715);function Ht(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function Kt(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Ht(Object(n),!0).forEach((function(t){(0,a.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ht(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}const Vt=new class{constructor(){(0,a.Z)(this,"execute",(e=>{const{node:t,component:n,defaultValue:o="() => {}",supportedEvent:i,propDefName:s,pos:r}=e,a=s||`handle${Gt.H[i]}`;if(!("events"in t))return;let c=Object.values(n.propDefinitions).find((e=>e.name===a));c?n.addLocationToPropDefinition(c.id,t.id,{base:ge.hD.EVENT,sufix:i}):c=n.createPropDefinition({id:(0,Se.Ox)(),name:a,type:"func",defaultValue:o,inputType:ge.SO.FUNCTION,locations:{[t.id]:(0,_e.B1)({base:ge.hD.EVENT,sufix:i})}});const l=(0,Se.Ox)(),d={id:c.id,type:"propCall",calls:a,pos:r};t.events=Kt(Kt({},t.events),{},{[i]:Kt(Kt({},t.events[i]),{},{[l]:Kt({},d)})})}))}};Object.freeze(Vt);var Yt,Jt,Xt,qt=n(651174);const Qt=new(Yt=(0,d.inject)("nodeStyleManagmentFlow"),Jt=class{constructor(){(0,r.Z)(this,"nodeStyleManagementFlow",Xt,this),this.execute=this.execute.bind(this),this.getNumericValueInPixels=this.getNumericValueInPixels.bind(this)}execute(e){var t,n,o,i,s;const{key:r,nodeId:a,doc:c}=e,l=oe.ou.Cg,d=oe.ou.yL,p=c.nodes.getById(a);if(!p)return l;const u=this.nodeStyleManagementFlow.getAllStyleValuesForKey({nodeId:a,key:r});let h=[],y=[];p.compIdOfRootNode||(h=this.nodeStyleManagementFlow.getAllStyleValuesForKey({nodeId:a,key:`max${(0,zt.capitalize)(r)}`}),y=this.nodeStyleManagementFlow.getAllStyleValuesForKey({nodeId:a,key:`min${(0,zt.capitalize)(r)}`}));const m=p.parentId?c.nodes.getById(p.parentId):null,f=(0,he.b3)(p,r);if("string"===typeof f&&u.push(f),!u.length&&!h.length&&!y.length)return m?this.execute({key:r,nodeId:m.id,doc:c}):d;const g=u.map((e=>this.getNumericValueInPixels(e,r,m,c))).sort(((e,t)=>t-e)),_=h.map((e=>this.getNumericValueInPixels(e,r,m,c))).sort(((e,t)=>t-e)),b=y.map((e=>this.getNumericValueInPixels(e,r,m,c))).sort(((e,t)=>t-e)),I=null!==(t=null!==(n=null!==(o=g[0])&&void 0!==o?o:_[0])&&void 0!==n?n:b[0])&&void 0!==t?t:l;return Math.max(null!==(i=b[0])&&void 0!==i?i:0,Math.min(null!==(s=_[0])&&void 0!==s?s:Number.MAX_SAFE_INTEGER,I))}getNumericValueInPixels(e,t,n,o){const i=oe.ou.Cg,s=oe.ou.yL,r=e.replace(/[0-9]/g,""),a=parseInt(e,10);switch(r){case"":case"px":return a>s?a:s;case"vw":const e=i*a/100;return e>s?e:s;case"%":if(!n){const e=i*a/100;return e>s?e:s}const r=this.execute({key:t,nodeId:n.id,doc:o})*a/100;return r>s?r:s;default:return a?i:s}}},Xt=(0,c.Z)(Jt.prototype,"nodeStyleManagementFlow",[Yt],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Jt);Object.freeze(Qt);var en=n(85413);const tn=new class{constructor(){(0,a.Z)(this,"execute",(e=>{const{doc:t,sourceInstanceId:n,targetInstanceId:o,duplicatePropEvenIfItExists:i}=e,s=t.nodes.getById(n);t.nodes.orderChildrenIds(Object.keys((null===s||void 0===s?void 0:s.slottedNodes)||{})).forEach((e=>{const n=t.nodes.orderChildrenIds(Object.keys((null===s||void 0===s?void 0:s.slottedNodes[e])||{})).map((e=>t.nodes.getById(e))).filter((e=>e));t.copyNodesToTarget({nodes:n,targetId:e,compInstanceId:o,duplicatePropEvenIfItExists:i})}))}))}};Object.freeze(tn);class nn{constructor(){(0,a.Z)(this,h.Patcher,!0),(0,a.Z)(this,"byId",{})}getUrlList(e){return this.byId[e]||{}}saveComponent(e){const{id:t,component:n,path:o}=e;this.byId[t]?this.byId[t][o]=n:this.byId[t]={[o]:n}}fromJSON(e){this.byId=(null===e||void 0===e?void 0:e.byId)||{}}toJSON(){return{byId:this.byId}}applyPatch(e){const{pathArray:t,op:n,value:o}=e;2===t.length&&"add"===n&&o&&(this.byId[t[1]]=o),2===t.length&&"remove"===n&&delete this.byId[t[1]],3===t.length&&"replace"===n&&o&&(this.byId[t[1]][t[2]]=o),3===t.length&&"remove"===n&&delete this.byId[t[1]][t[2]]}}class on{constructor(e){(0,a.Z)(this,h.Patcher,void 0),(0,a.Z)(this,"id",void 0),(0,a.Z)(this,"name",void 0),(0,a.Z)(this,"content",void 0),(0,a.Z)(this,"path",void 0);const{id:t,name:n,content:o="",path:i=""}=e;this.name=n,this.content=o,this.path=i,this.id=t||(0,Se.Ox)()}applyPatch(e){const{op:t,pathArray:n,value:o}=e;"content"===n[0]&&("add"!==t&&"replace"!==t||(this.content=o))}}class sn{constructor(){(0,a.Z)(this,h.Patcher,void 0),(0,a.Z)(this,"byId",{})}createFile(e){const t=new on(e);return this.byId[t.id]=t,t}deleteFile(e){delete this.byId[e]}length(){return Object.keys(this.byId).length}fromJSON(e){e&&0!==Object.keys(null===e||void 0===e?void 0:e.byId).length&&Object.values(e.byId).forEach((e=>{this.byId[e.id]=new on(e)}))}toJSON(){return{byId:this.byId}}applyPatch(e){const{op:t,value:n,pathArray:o}=e;if("add"===t){const e=new on(n);this.byId[e.id]=e}"remove"===t&&delete this.byId[o[1]]}}class rn{constructor(){(0,a.Z)(this,h.Patcher,void 0),(0,a.Z)(this,"byId",{})}getTailwindClassesForNode(e){return this.byId[e]||{}}addTailwindClassToNode(e,t){this.byId[e]||(this.byId[e]={}),t.forEach((t=>{t&&(this.byId[e][(0,Se.Ox)()]=t)}))}deleteClassesForNode(e,t){t?delete this.byId[e][t]:delete this.byId[e]}cloneTailwindCSSFromNode(e,t){this.byId[t]={};const n=this.getTailwindClassesForNode(e);Object.values(n).forEach((e=>{this.byId[t][(0,Se.Ox)()]=e}))}toJSON(){return{byId:JSON.parse(JSON.stringify(this.byId))}}fromJSON(e){this.byId=(null===e||void 0===e?void 0:e.byId)||{}}applyPatch(e){const{pathArray:t,value:n}=e;if(3===t.length&&"byId"===t[0]){const e=t[1],o=t[2];n?this.byId[e][o]=n:delete this.byId[e][o]}}}var an=n(140278),cn=n(432322);const ln=new class{constructor(){(0,a.Z)(this,"execute",(e=>{const{instanceId:t,targetInstanceId:n,className:o,doc:i,sentryService:s}=e;if(!i)return null;const r=i.nodes.getById(t);if(!r||!i.nodes.nodeIsCompInstance(r))return null;const a=i.components.byId[r.compIdOfCompInstance];if(!a)return s.captureException(new Error(`CloneStyleSetDefinition skipped. Component by ${r.compIdOfCompInstance} was not found`)),null;const c=a.styleSetDefinitions[o],l={styles:{},referencedStyles:{},usedByInstances:{[n]:!0}};return l.styles=an.l.execute({targetNodeId:n,doc:i,styles:null===c||void 0===c?void 0:c.styles}),l.referencedStyles=cn.T.execute({targetNodeId:n,styles:null===c||void 0===c?void 0:c.referencedStyles,doc:i}),l}))}};function dn(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function pn(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?dn(Object(n),!0).forEach((function(t){(0,a.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):dn(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}Object.freeze(ln);const un=new class{constructor(){(0,a.Z)(this,"execute",(e=>{const{node:t,component:n,supportedEvent:o,modifies:i,pos:s}=e;let{newState:r}=e;const a=Object.values(n.stateDefinitions).find((e=>e.name===i));if(!a)throw new Error(`State definition "${i}" not present in referenced component`);"toggle"===r&&(r="$toggle");const c=(0,Se.Ox)(),l={id:a.id,type:"stateChange",modifies:i,newState:r,pos:s};"events"in t&&(t.events=pn(pn({},t.events),{},{[o]:pn(pn({},t.events[o]),{},{[c]:pn({},l)})}))}))}};Object.freeze(un);var hn=n(698156);const yn=new class{constructor(){(0,a.Z)(this,"execute",(e=>{const{node:t,stateId:n,stateDefinition:o,staticValue:i}=e;Object.values(o.locations).forEach((e=>{Object.values(e).forEach((e=>{var o;const{base:s,sufix:r}=e;switch(s){case ge.uw.CONTENT:const e="contentChildren"in t?t.contentChildren:void 0;if(!e)return;Object.keys(e).forEach((t=>{const o=e[t];r&&t!==r||"dynamic"===o.type&&o.content.id===n&&(e[t]=new ne.F({content:i,id:t}))}));break;case ge.uw.ATTR:if(!("attrs"in t))return;Object.keys(null!==(o=t.attrs)&&void 0!==o?o:{}).forEach((e=>{const o=(0,he.Uq)(t,e);r&&e!==r||!o||"dynamic"===o.type&&o.content.id===n&&("element-node"!==t.type&&"component-instance-node"!==t.type||(t.attrs[e]=new ne.F({content:i})))}))}}))}))}))}};Object.freeze(yn);const mn=new class{constructor(){(0,a.Z)(this,"execute",(e=>{var t,n,o;const{node:i,targetAvailableCtxIds:s}=e;if("cms-collection-list-node"!==i.type||null===(t=i.attrs)||void 0===t||!t.filter)return;const r=(null===(n=i.attrs)||void 0===n||null===(o=n.filter)||void 0===o?void 0:o.content)||[],a=[];var c;(r.forEach((e=>{const t=e.value;"dynamic"===t.type&&"ctx"===t.content.referenceType&&t.content.ctxId&&!s.includes(t.content.ctxId)||a.push(e)})),a.length)?i.attrs.filter={type:"cms-filter",content:a}:null===(c=i.attrs)||void 0===c||delete c.filter}))}};const fn=new class{constructor(){(0,a.Z)(this,"execute",(e=>{var t,n;const{node:o,targetAvailableCtxIds:i,doc:s}=e;if(!this.nodeHasGlobalContextRepeaterParent(o,s)){if("contentChildren"in o){const e=Object.values(o.contentChildren||{})[0];if(e&&"dynamic"===e.type&&"ctx"===e.content.referenceType&&e.content.ctxId&&!i.includes(e.content.ctxId)){const e=new ne.F({content:o instanceof D.Z3?(new Date).toISOString():"text"});o.contentChildren={[e.id]:e}}}if("attrs"in o&&o.attrs&&Object.keys(o.attrs).forEach((t=>{var n,s;const r=null===(n=o.attrs)||void 0===n?void 0:n[t];if("cms-filter"!==(null===r||void 0===r?void 0:r.type)){if("dynamic"===(null===r||void 0===r?void 0:r.type)&&"ctx"===r.content.referenceType&&r.content.ctxId&&!i.includes(r.content.ctxId))switch(t){case"src":o.attrs[t]=new ne.F({content:"https://play.teleporthq.io/static/svg/default-img.svg"});break;case"alt":o.attrs[t]=new ne.F({content:"image"});break;default:null===(s=o.attrs)||void 0===s||delete s[t]}}else mn.execute(e)})),s.nodes.nodeIsCompInstance(o)&&Object.keys(o.attrs).forEach((e=>{const t=o.attrs[e];"dynamic"===t.type&&"ctx"===t.content.referenceType&&t.content.ctxId&&!i.includes(t.content.ctxId)&&delete o.attrs[e]})),"abilities"in o&&o.abilities){var r;const e=null===(r=o.abilities.link)||void 0===r?void 0:r.content;e&&("url"in e&&"string"!==typeof e.url&&e.url&&"dynamic"===e.url.type&&"ctx"===e.url.content.referenceType&&(o.abilities={}),"contentType"in e&&(o.abilities={}))}"html"in o&&"dynamic"===(null===(t=o.html)||void 0===t?void 0:t.type)&&"ctx"===(null===(n=o.html)||void 0===n?void 0:n.content.referenceType)&&!i.includes(o.html.content.ctxId)&&(o.html=new ne.F({content:""}))}})),(0,a.Z)(this,"nodeHasGlobalContextRepeaterParent",((e,t)=>{var n,o,i,s;const r=t.nodes.getById(null!==(n=e.parentId)&&void 0!==n?n:"");if(!r||"element-node"!==r.type)return!1;const a=t.nodes.getById(null!==(o=r.parentId)&&void 0!==o?o:"");if(!a||"repeater"!==a.type||!(Object.keys(null!==(i=a.attrs)&&void 0!==i?i:{}).length>0))return!1;const c=null===(s=a.attrs)||void 0===s?void 0:s.array;return!(!c||"dynamic"!==c.type)&&"global"===c.content.referenceType}))}};Object.freeze(fn);var gn=n(319682),_n=n(186338),bn=n(2758),In=n(85970);function vn(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function wn(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?vn(Object(n),!0).forEach((function(t){(0,a.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):vn(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}const On=new class{constructor(){(0,a.Z)(this,"execute",(e=>{const{node:t,component:n,defaultValue:o,attrName:i}=e;if("cms-collection-item-node"!==t.type||!t.attrs)return null;const s=(0,ve.rZ)(t),r=`${s.name}_${i}`,a=n.createPropDefinition(wn(wn({},s),{},{name:r,defaultValue:o,inputType:ge.SO.TEXT,locations:{[t.id]:(0,_e.B1)({base:ge.hD.ATTR,sufix:i})}}));return t.attrs[i]=new be.P({content:{referenceType:"prop",id:a.id}}),a}))}};function jn(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function Sn(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?jn(Object(n),!0).forEach((function(t){(0,a.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):jn(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}Object.freeze(On);const Nn=new class{constructor(){(0,a.Z)(this,"execute",(e=>{const{node:t,component:n,defaultValue:o,attrName:i}=e;if("filter"===i)return null;if("cms-collection-list-node"!==t.type||!t.attrs)return null;const s=(0,ve.rZ)(t),r=`${s.name}_${i}`,a=n.createPropDefinition(Sn(Sn({},s),{},{name:r,defaultValue:o,inputType:ge.SO.TEXT,type:"paginationQuery"===i?"string":"number",locations:{[t.id]:(0,_e.B1)({base:ge.hD.ATTR,sufix:i})}}));return t.attrs[i]=new be.P({content:{referenceType:"prop",id:a.id}}),a}))}};Object.freeze(Nn);var Dn=n(189603);function En(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function Tn(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?En(Object(n),!0).forEach((function(t){(0,a.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):En(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}const Pn=new class{constructor(){(0,a.Z)(this,"execute",(e=>{const{node:t,component:n,attrName:o}=e;if("cms-mixed-type-node"!==t.type||!t.attrs)return null;const i=(0,ve.rZ)(t),s=`${i.name}_${o}`,r=n.createPropDefinition(Tn(Tn({},i),{},{name:s,defaultValue:{},inputType:ge.SO.OBJECT,type:"object",locations:{[t.id]:(0,_e.B1)({base:ge.hD.ATTR,sufix:o})}}));return t.attrs[o]=new be.P({content:{referenceType:"prop",id:r.id}}),r}))}};function Cn(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function xn(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Cn(Object(n),!0).forEach((function(t){(0,a.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Cn(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}Object.freeze(Pn);const An=new class{constructor(){(0,a.Z)(this,"execute",(e=>{const{node:t,component:n,defaultValue:o=[]}=e;if("cms-array-mapper"!==t.type||!t.attrs)return null;const i=(0,ve.rZ)(t),s="array",r=`${i.name}_array`,a=n.createPropDefinition(xn(xn({},i),{},{name:r,defaultValue:o,inputType:ge.SO.ARRAY,type:"array",locations:{[t.id]:(0,_e.B1)({base:ge.hD.ATTR,sufix:s})}}));return t.attrs.array=new be.P({content:{referenceType:"prop",id:a.id}}),a}))}};Object.freeze(An);const Fn=new class{constructor(){(0,a.Z)(this,"execute",(e=>{const{doc:t,node:n}=e,o=t.components.byId[n.compIdOfCompInstance];if(!o)return;const i=Object.values(o.propDefinitions).filter((e=>e.inputType===ge.SO.RICH_TEXT));if(i.length)for(const s of i){if(!s.defaultHierarchyRootId)continue;const e=t.cloneRichTextHierarchy({doc:t,rootNodeId:s.defaultHierarchyRootId,meta:{isAttributeRoot:{nodeId:n.id,attr:s.name}}});e&&(n.attrs[s.name]={id:(0,Se.Ox)(),type:"hierarchy",content:`${e}`,pristine:!0})}}))}};Object.freeze(Fn);const kn=new class{constructor(){(0,a.Z)(this,"execute",(e=>{const{doc:t,rootNodeId:n}=e,o=t.nodes.getById(n);if(!o||!("childrenIds"in o))return null;const i=t.nodes.getById(Object.keys(o.childrenIds)[0]);if(!i)return null;const s=t.cloneNode({nodeId:o.id}),r=t.cloneNodeWithLangReferences({nodeId:i.id});if(!r)return null;if(!s||!r||!("childrenIds"in r))return null;if(s.meta=e.meta,r.parentId=`${s.id}`,"childrenIds"in s&&(s.childrenIds[r.id]=!0),"childrenIds"in i)for(const a in i.childrenIds){const e=t.nodes.getById(a);if(!e)continue;const n=t.cloneNode({nodeId:e.id});n&&(r.childrenIds[n.id]=!0,n.parentId=r.id,t.addNode(n))}return t.addNode(s),t.addNode(r),s.id}))}};Object.freeze(kn);class Rn{constructor(){(0,a.Z)(this,"execute",(e=>{var t;const{doc:n,rootNodeId:o,newParentId:i}=e,s=n.nodes.getById(o);if(!s||!("childrenIds"in s))return null;const r=n.nodes.getById(Object.keys(s.childrenIds)[0]);if(!r)return null;const a=n.cloneNodeWithLangReferences({nodeId:r.id});if(!a||!("childrenIds"in a))return null;const c=[];if("childrenIds"in r)for(const u in r.childrenIds){const e=n.nodes.getById(u);if(!e)continue;const t=n.cloneNodeWithLangReferences({nodeId:e.id});t&&(t.parentId=i,n.addNode(t),c.push(t.id))}let l=null;if(!c.length&&"contentChildren"in r&&Object.keys(null!==(t=r.contentChildren)&&void 0!==t?t:{}).length){var d,p;const e=Object.keys(null!==(d=r.contentChildren)&&void 0!==d?d:{})[0],t=null===(p=r.contentChildren)||void 0===p?void 0:p[e];t&&(l=t.content)}return{copiedNodeIds:c,defaultStaticValue:l,copiedContentFromNodeId:r.id}}))}}const Mn=new Rn;function Un(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function Zn(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Un(Object(n),!0).forEach((function(t){(0,a.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Un(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}Object.freeze(Rn);const Ln=new class{constructor(){(0,a.Z)(this,"execute",(e=>{const{doc:t,component:n,node:o}=e;if(!("childrenIds"in o)||!o.childrenIds||!Object.keys(o.childrenIds).length)return null;const i=(0,Se.Ox)(),s=(0,ve.rZ)(o),r=new D.HX({id:i,semanticType:E.sO.FRAGMENT,primitiveType:E.sO.FRAGMENT,meta:{isPropRoot:{compId:n.id,prop:s.id}}}),a=t.cloneNode({nodeId:o.id});if(!a||!("contentChildren"in a))return null;a.primitiveType="button"===o.primitiveType?E.sO.TEXT:o.primitiveType,a.parentId=r.id,a.childrenIds=Zn({},o.childrenIds),a.semanticType=null,t.addNode(r),t.addNode(a);let c=o.id,l=a.id;if("button"===o.primitiveType){const e=new D.HX({id:(0,Se.Ox)(),semanticType:E.RY.SPAN,primitiveType:E.sO.TEXT,parentId:o.id,childrenIds:{[a.id]:!0}});t.addNode(e),o.childrenIds={[e.id]:!0},c=e.id,l=e.id}Object.keys(o.childrenIds).forEach((e=>{const n=t.nodes.getById(e);n&&(n.parentId=l),delete o.childrenIds[e]}));const d=new be.P({content:{referenceType:"prop",id:s.id}});if("button"===o.primitiveType){const e=new D.HX({id:(0,Se.Ox)(),semanticType:E.RY.SPAN,primitiveType:E.sO.TEXT,parentId:o.id,contentChildren:{[d.id]:d}});t.addNode(e),o.childrenIds={[e.id]:!0},c=e.id}else o.contentChildren[d.id]=d;const p=n.createPropDefinition(Zn(Zn({},s),{},{defaultValue:"Default value",inputType:ge.SO.RICH_TEXT,defaultHierarchyRootId:r.id,type:"richtext",locations:{[c]:(0,_e.B1)({base:ge.hD.CONTENT})}})),u=t.nodes.getById(r.id);return u&&(u.rootOfPropHierarchy=p.id),Object.keys(n.instantiatedByNodes).forEach((e=>{const n=t.nodes.getById(e);if(!n||"component-instance-node"!==n.type)return;const o=t.cloneRichTextHierarchy({doc:t,rootNodeId:r.id,meta:{isAttributeRoot:{nodeId:c,attr:p.name}}});o&&(n.attrs[p.name]={id:(0,Se.Ox)(),type:"hierarchy",content:`${o}`,pristine:!0})})),p}))}};Object.freeze(Ln);const Bn=new class{constructor(){(0,a.Z)(this,"execute",(e=>{const{doc:t,pageOrComponentId:n,primitiveType:o}=e;if(!t)return[];const i=t.components.byId[n]||t.pages.byId[n]||t.cmsPages.byId[n];if(!i||!i.rootNodeId)return[];return this.getNodesOfType(t,i.rootNodeId,n,o)})),(0,a.Z)(this,"getNodesOfType",((e,t,n,o,i)=>{const s=[];return e.nodes.bfs(t,(t=>{if(t.primitiveType===o&&s.push({id:t.id,sourceCompId:n,instanceId:i}),"component"===t.primitiveType&&"compIdOfCompInstance"in t){const n=e.components.byId[t.compIdOfCompInstance];if(n&&n.rootNodeId){const i=this.getNodesOfType(e,n.rootNodeId,n.id,o,t.id);s.push(...i)}}})),s}))}};var Wn=n(436035),zn=n(239031),$n=n(37164);const Gn=new class{execute(e){var t;const{doc:n,nodeId:o,removeRootStatus:i}=e,s=n.nodes.getById(o);if(!s||!n.internationalization)return null;const r=n.cloneNode({nodeId:o,removeRootStatus:i});if("element-node"!==s.type)return r;if(!r||"element-node"!==r.type||!("contentChildren"in r))return r;const a=s.getContentLangReferenceKey();if(!a)return r;const{availableLanguages:c={}}=n.internationalization,l=`${null!==(t=r.name)&&void 0!==t?t:"text"}_${(0,$n.x0)(6)}`;Object.keys(c).forEach((e=>{const t=n.internationalization.getTranslationRootHierarchyNodeId(e,a);if(!t)return;const o={},i={};let s=null;n.nodes.bfs(t,(e=>{const r=n.cloneNode({nodeId:e.id});if(!r)throw new Error(`Failed in cloning the lang references for node - ${e.id}`);if(o[e.id]=r.id,e.id===t&&(s=r.id),e.parentId){var a;const t=o[e.parentId];var c,l;if(t&&(r.parentId=t),i[null!==(a=r.parentId)&&void 0!==a?a:""])i[null!==(c=r.parentId)&&void 0!==c?c:""].childrenIds[r.id]=!0,delete i[null!==(l=r.parentId)&&void 0!==l?l:""].childrenIds[e.id]}i[r.id]=r})),Object.values(i).forEach((e=>{n.addNode(e)})),s&&(n.internationalization.translations[e][l]={type:"hierarchy",content:s})}));const d=new be.P({content:{id:(0,Se.Ox)(),referenceType:"locale",refPath:[l]}});return r.contentChildren={},r.contentChildren[d.id]=d,r}};Object.freeze(Gn);const Hn=new class{constructor(){(0,a.Z)(this,"execute",(e=>{const{translationRef:t,doc:n}=e;if(!t)return null;const{availableLanguages:o,translations:i}=n.internationalization;let s=null;return Object.keys(o).forEach((e=>{const o=i[e][t];if(!o||"hierarchy"!==o.type)return;const r={},a=o.content,c={};let l=null;n.nodes.bfs(a,(e=>{const t=n.cloneNode({nodeId:e.id});if(!t)throw new Error(`Failed in duplicating the lang references for node - ${e.id}`);var o;(r[e.id]=t.id,e.id===a)&&(l=t.id,s||(s=`${null!==(o=t.name)&&void 0!==o?o:"text"}_${(0,$n.x0)(6)}`));if(e.parentId){var i;const n=r[e.parentId];var d,p;if(n&&(t.parentId=n),c[null!==(i=t.parentId)&&void 0!==i?i:""])c[null!==(d=t.parentId)&&void 0!==d?d:""].childrenIds[t.id]=!0,delete c[null!==(p=t.parentId)&&void 0!==p?p:""].childrenIds[e.id]}c[t.id]=t})),Object.values(c).forEach((e=>{n.addNode(e)})),l&&(n.internationalization.translations[e][s]={type:"hierarchy",content:l})})),s}))}};Object.freeze(Hn);var Kn,Vn,Yn,Jn,Xn,qn,Qn,eo,to,no,oo,io,so,ro,ao,co=n(110071);function lo(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function po(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?lo(Object(n),!0).forEach((function(t){(0,a.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):lo(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}let uo=(Kn=(0,d.provide)("projectDoc"),Vn=(0,d.inject)("projectUIState"),Yn=(0,d.inject)("webRTCState"),Jn=(0,d.inject)("nodeStyleManagmentFlow"),Xn=(0,d.inject)("projectClassManagementFlow"),qn=(0,d.inject)("notificationsManagementFlow"),Qn=(0,d.inject)("sentryService"),Kn((to=class{constructor(e){(0,a.Z)(this,h.Patcher,!0),(0,a.Z)(this,"id",""),(0,a.Z)(this,"accessType",p.W.PUBLIC),(0,a.Z)(this,"settings",{}),(0,a.Z)(this,"stats",{}),(0,a.Z)(this,"cms",new gn._),(0,a.Z)(this,"fonts",new le),(0,a.Z)(this,"folders",new u.$),(0,a.Z)(this,"pages",new f),(0,a.Z)(this,"cmsPages",new bn.g),(0,a.Z)(this,"components",new w),(0,a.Z)(this,"nodes",new V),(0,a.Z)(this,"assets",new te),(0,a.Z)(this,"collaborators",new bt),(0,a.Z)(this,"projectFiles",new Dt),(0,a.Z)(this,"classes",new Wt),(0,a.Z)(this,"cloudComponents",new nn),(0,a.Z)(this,"mediaQueryBreakpoints",new l.s),(0,a.Z)(this,"customFiles",new sn),(0,a.Z)(this,"tailwindCSS",new rn),(0,a.Z)(this,"resourceDefinitions",new hn.f),(0,a.Z)(this,"selectedTheme",null),(0,a.Z)(this,"internationalization",new Wn.Q),(0,a.Z)(this,"designLanguage",void 0),(0,a.Z)(this,"migrationsThatHaveRun",void 0),(0,r.Z)(this,"projectUIState",no,this),(0,r.Z)(this,"webRTCState",oo,this),(0,r.Z)(this,"nodeStyleManagementFlow",io,this),(0,r.Z)(this,"projectClassManagementFlow",so,this),(0,r.Z)(this,"notificationsManagementFlow",ro,this),(0,r.Z)(this,"sentryService",ao,this),(0,a.Z)(this,"internationalizationFlow",zn.q.Instance),(0,a.Z)(this,"addAttributesFromPropsUseCase",Fn.execute),(0,a.Z)(this,"addDefaultPropsDefinitionForNode",fe.execute),(0,a.Z)(this,"addDefaultLinkPropDefinition",je.execute),(0,a.Z)(this,"addDefaultAttrPropDefinition",Ee.execute),(0,a.Z)(this,"addDefaultCMSItemPropDefinition",On.execute),(0,a.Z)(this,"addDefaultCMSListPropDefinition",Nn.execute),(0,a.Z)(this,"addDefaultCMSMixedContentPropDefinition",Pn.execute),(0,a.Z)(this,"addDefaultCMSArrayMapperPropDefinition",An.execute),(0,a.Z)(this,"addPropCallEvent",Vt.execute),(0,a.Z)(this,"addStateChangeEvent",un.execute),(0,a.Z)(this,"replaceDynamicStateWithStaticNode",yn.execute),(0,a.Z)(this,"replaceCtxReferenceWithStaticNode",fn.execute),(0,a.Z)(this,"duplicateNodeInstanceHierarchy",Be.execute),(0,a.Z)(this,"moveNodePropDefinitionToTarget",mt.execute),(0,a.Z)(this,"cloneSlottedNodes",tn.execute),(0,a.Z)(this,"cloneRichTextBaseHierarchy",Mn.execute),(0,a.Z)(this,"cloneRichTextHierarchy",kn.execute),(0,a.Z)(this,"duplicateComponent",We.execute),(0,a.Z)(this,"duplicatePage",Ge.execute),(0,a.Z)(this,"detachComponentInstance",He.execute),(0,a.Z)(this,"cloneStyleSetDefinition",ln.execute),(0,a.Z)(this,"addDefaultContentPropDefinition",(e=>xe.execute(po(po({},e),{},{internationalizationFlow:this.internationalizationFlow})))),(0,a.Z)(this,"getParentNodeIdentifierFromContextAndNodeId",((e,t)=>{let n=this.nodes.getById(t),o=null;for(;null!==(i=n)&&void 0!==i&&i.parentId&&!o;){var i;const t=this.nodes.getById(n.parentId);if(t&&"ctxId"in t&&t.ctxId===e){o=t;break}if(t&&"listCtxId"in t&&t.listCtxId===e){o=t;break}if(t&&"repeatableCtxId"in t&&t.repeatableCtxId===e){o=t;break}n=t}if(!o)return null;var s,r;if(!this.isMainNodeOfCMSPage(o.id))return"cms-array-mapper"!==o.type&&"cms-mixed-type-node"!==o.type||null===(s=o.attrs)||void 0===s||!s.contextName?null!==(r=o.name)&&void 0!==r?r:null:o.attrs.contextName.content.toString();if(!("resourceDefinition"in o)||!o.resourceDefinition||"uninitialised"===o.resourceDefinition.type)throw new Error(`Could not get CMS identifier for node ${o.id}`);const a=this.getProjectPageOrComponent(this.getComponentIdForNode(o.id)||"");if(!a)throw new Error("Could not find page related to main CMS node");const c=this.cms.usedContentTypes[o.resourceDefinition.contentType];return(0,Dn.zj)(c,a.type)}));const t=null===e||void 0===e?void 0:e.theme;null!==e&&void 0!==e&&e.isNewProject&&(this.migrationsThatHaveRun={assets:!0,primaryCategoryToThqDefault:!0,richTextProps:!0}),this.designLanguage=new re.Lr({theme:t}),t&&(this.selectedTheme={name:t.name,variant:t.variant,overrideColors:!1,customColors:{}})}deleteNodesInternationalizationReferences(e){return Te.execute(e,this)}replaceDynamicPropWithStaticNode(e){return Ae.X.execute(po(po({},e),{},{doc:this}))}duplicateTranslationNodesByRef(e){return Hn.execute(po(po({},e),{},{doc:this}))}cloneNodeWithLangReferences(e){return Gn.execute(po(po({},e),{},{doc:this}))}getAllNodesOfType(e){return Bn.execute(po(po({},e),{},{doc:this}))}addHierarchyPropDefinitionsForNode(e){return Ln.execute(po({},e))}getOwnerIdOfDependentNode(e){var t;const n=this.nodes.getById(e),o=this.nodes.getById((null===n||void 0===n?void 0:n.parentId)||"");if((null===o||void 0===o?void 0:o.primitiveType)===E.sO.FRAGMENT&&"meta"in o&&null!==(t=o.meta)&&void 0!==t&&t.isAttributeRoot){const t=this.nodes.getById(o.meta.isAttributeRoot.nodeId);if(!t)return e;const n=this.components.byId[t.compIdOfCompInstance],i=Object.values((null===n||void 0===n?void 0:n.propDefinitions)||{}).find((e=>{var t,n;return e.name===(null===(t=o.meta)||void 0===t||null===(n=t.isAttributeRoot)||void 0===n?void 0:n.attr)})),s=null===i||void 0===i?void 0:i.defaultHierarchyRootId;if(!s)return e;const r=this.nodes.getById(s);if(r&&"childrenIds"in r)return Object.keys(r.childrenIds)[0]}return e}addPage(e){const{page:t,folderId:n}=e;if(!t.rootNodeId){const e=new D.HX({primitiveType:E.sO.CONTAINER,semanticType:E.iX.DIV});e.styles={width:new ne.F({content:"100%"}),minHeight:new ne.F({content:"100vh"}),display:new ne.F({content:"flex"}),flexDirection:new ne.F({content:"column"}),alignItems:new ne.F({content:"center"})},t.rootNodeId=e.id,e.compIdOfRootNode=t.id,this.nodes.add(e)}"project-page"===t.type?this.pages.add(t):this.cmsPages.add(t),this.folders.add(null!==n&&void 0!==n?n:"pages",{id:t.id,type:"page"})}addComponent(e){const{component:t,folderId:n,hasDefaultStyles:o}=e;if(!t.rootNodeId){const e=new D.HX({primitiveType:E.sO.CONTAINER,semanticType:E.iX.DIV});e.styles={display:new ne.F({content:"flex"}),position:new ne.F({content:"relative"})},o&&(e.styles.height=new ne.F({content:"400px"}),e.styles.width=new ne.F({content:"100%"}),e.styles.alignItems=new ne.F({content:"flex-start"}),e.styles.flexDirection=new ne.F({content:"column"})),t.rootNodeId=e.id,e.compIdOfRootNode=t.id,this.nodes.add(e)}return this.components.add(t),this.folders.add(null!==n&&void 0!==n?n:"components",{id:t.id,type:"component"}),t}addNode(e){e.primitiveType===E.sO.CONTAINER&&setTimeout((()=>{const t=this.nodes.getById(e.id);t&&"childrenIds"in t&&Object.keys(t.childrenIds).length||this.notificationsManagementFlow.createLimitedUseNotification(pt.CS.ADD_CONTAINER)}),100);const t=this.components.byId[this.getComponentIdForNode(e.parentId||"")||""];if(e.primitiveType===E.sO.SLOT&&"compIdOfSlot"in e){if(!t)throw new Error("Tried to add a slot in a page");t.slots||(t.slots={}),t.slots[e.id]={width:qt.Q.WIDTH,height:qt.Q.HEIGHT},e.compIdOfSlot=t.id}this.nodes.add(e)}addAsset(e){this.assets.add(e)}removeComponent(e){const t=this.components.byId[e];if(!t)throw new Error(`Component requested is missing - ${e}`);const n=t.rootNodeId;if(!n)throw new Error(`Component's root node is missing - ${t}`);const o=[...Object.values(t.propDefinitions).map((e=>"richtext"===e.type?e.defaultHierarchyRootId:null)).filter((e=>e)),...Object.keys((null===t||void 0===t?void 0:t.instantiatedByNodes)||{}),n];this.deleteNodesById({nodeIds:o,deleteRoot:!0,skipRestoreParentsFakeSize:!0,withSubtree:!0}),delete this.components.byId[e],delete this.folders.byId.components.children[e],Object.values(po(po(po({},this.pages.byId),this.cmsPages.byId),this.components.byId)).forEach((t=>{null===t||void 0===t||delete t.usedComponents[e]}))}moveNodesToTarget(e){ut.execute(po(po({},e),{},{doc:this}))}copyNodesHierarchyToTarget(e){const{nodes:t}=e,n=t.map((e=>e.id)),o=this.nodes.getOrderedTopLevelNodes(n).map((e=>this.nodes.getById(e)));return this.copyNodesToTarget(po(po({},e),{},{nodes:o}))}syncAssetInNodeRelationByNewContent(e){var t;const{oldContent:n,newContent:o,node:i}=e,s=Object.values(this.assets.byId);if("dynamic"===(null===n||void 0===n?void 0:n.type)&&"dynamic"===(null===o||void 0===o?void 0:o.type)&&n.content.id===o.content.id)return;let r,a;if("dynamic"===(null===n||void 0===n?void 0:n.type)){var c;const e=this.getComponentIdForNode(i.id),t=null===(c=this.components.byId[e])||void 0===c?void 0:c.propDefinitions[n.content.id];r=s.find((e=>(null===t||void 0===t?void 0:t.defaultValue)===e.id))}if("dynamic"===(null===o||void 0===o?void 0:o.type)){var l;const e=this.getComponentIdForNode(i.id),t=null===(l=this.components.byId[e])||void 0===l?void 0:l.propDefinitions[o.content.id];a=s.find((e=>(null===t||void 0===t?void 0:t.defaultValue)===e.id))}var d,p;r!==a&&(null===(d=r)||void 0===d||d.removeNodeRelation(i.id),null===(p=a)||void 0===p||p.createNodeRelation(i.id));if((null===n||void 0===n?void 0:n.content)===(null===o||void 0===o?void 0:o.content))return;const u=null===n||void 0===n?void 0:n.content,h=null===o||void 0===o?void 0:o.content;"string"!==typeof u||this.nodes.nodeIsCompInstance(i)&&Object.values(null!==(t=i.attrs)&&void 0!==t?t:{}).some((e=>"static"===e.type&&e.content===(null===n||void 0===n?void 0:n.content)))||s.forEach((e=>{"string"!==typeof h&&"undefined"!==typeof h||null!==h&&void 0!==h&&h.includes(e.id)||u.includes(e.id)&&e.removeNodeRelation(i.id)})),"string"===typeof h&&s.forEach((e=>{"undefined"!==typeof u&&"string"!==typeof u||null!==u&&void 0!==u&&u.includes(e.id)||h.includes(e.id)&&e.createNodeRelation(i.id)}))}updatePageAndComponentRelations(e){const{sourceNodeId:t,newNodeId:n,doc:o}=e;if(!o)return;const i=o.nodes.getById(t);if(!i)throw new Error("Attempting to add a relation without the source node");if(!this.nodes.nodeIsCompInstance(i))throw new Error("Attempting to update relation when source is not component");if(i.parentId){const e=this.getComponentIdForNode(i.id);if(!e)throw new Error("Target page to add the component is not found");this.addUsedComponentRelation({toAddComponentId:e,linkedComponentId:i.compIdOfCompInstance})}const s=o.components.byId[i.compIdOfCompInstance];if(!s)throw new Error("Trying to duplicate a component instance but the componet is missing");s.instantiatedByNodes[n]=!0}getSlotNodesForComp(e){const t=this.components.byId[e];if(!t||!t.rootNodeId)return[];const n=[];return this.nodes.bfs(t.rootNodeId,(e=>{e instanceof D.HX&&e.primitiveType===E.sO.SLOT&&this.getComponentIdForNode(e.id)===t.id&&n.push(e)})),n}getUniqueSlotNameForComp(e,t){const n=this.getSlotNodesForComp(e);return(0,v.Zu)(n.map((e=>e.name)),t)}addNodesToParentOrStage(e){const{nodes:t,parentId:n,nextSibling:o,keepOriginalParent:i,allowDefaultPropsCreation:s=!0,dropPosition:r,nodePosition:a,compInstanceId:c,translateStaticContent:l=!0}=e,d=this.nodes.getById(n),p=(null===d||void 0===d?void 0:d.primitiveType)===E.sO.SLOT;if(p&&!c)return;let u;if(l&&this.internationalizationFlow.linkStaticNodesToTranslations({nodes:t,doc:this}),a)u=a;else if(o){const e=this.nodes.getPrevSibling(o);u=(0,N.Dd)(o.pos,(null===e||void 0===e?void 0:e.pos)||"0")}else{const e=d&&this.nodes.getLastChild(d,c);u=(parseFloat((null===e||void 0===e?void 0:e.pos)||"0")+Number.MAX_SAFE_INTEGER).toString()}const{useContentAsNode:h=!1}=e,y=h&&d&&(0,N.j1)(this,d);y&&(r&&"after"!==r?t.push(y):t.unshift(y));const m=!!d&&!this.nodes.getFirstChild(d,c),f=this.getComponentIdForNode(n)||this.projectUIState.selection.componentId,g=f?this.getProjectPageOrComponent(f):void 0;if(!g)throw new Error("Tried to add node but no accepting component found!");t.forEach((e=>{if(e.primitiveType===E.sO.SLOT){const t=this.nodes.getComponentIdOf(n);if(!t)return;if(t!==this.projectUIState.selection.componentId){const t=this.projectUIState.selection.componentId,o=this.components.byId[t||""],{compInstanceId:i}=this.nodes.getSlotAndCompInstanceIdForNodeById(n);if(o&&0===Object.keys(o.slots||{}).length){if(!i)return;const t=this.nodes.getById(i);if(!t)return;return e.parentId=t.parentId,void this.addNode(e)}}const o=this.components.byId[t];if(o&&Object.keys(o.slots||{}).length)return void this.notificationsManagementFlow.createNotification(pt.k$.INFO,"Only one slot per component is currently supported.")}if(this.nodes.nodeIsCompInstance(e)){if(this.components.checkIfComponentsHaveCircularDependency(e.compIdOfCompInstance,g.id))return void this.notificationsManagementFlow.createNotification(pt.k$.ERROR,"Could not add component because it would create a circular dependency.");this.addUsedComponentRelation({toAddComponentId:g.id,linkedComponentId:e.compIdOfCompInstance}),this.addAttributesFromPropsUseCase({doc:this,node:e})}if(p){if(!i||!e.getActualParentId()){const t=this.nodes.getById(c);if(!t)throw new Error("Tried to slot a node with no instance provided!");t.slotNode(e.id,d.id),e.slotId=d.id,e.compInstanceId=c}}else i&&e.getActualParentId()||(e.parentId=n);if(e.getActualParentId()===n)e.pos=u,u=null!==o&&void 0!==o&&o.pos?(0,N.Dd)(e.pos,o.pos):u=(parseFloat(e.pos)+Number.MAX_SAFE_INTEGER).toString();else{const t=this.nodes.getById(e.getActualParentId()),n=this.nodes.getLastChild(t,c);e.pos=(parseFloat((null===n||void 0===n?void 0:n.pos)||"0")+Number.MAX_SAFE_INTEGER).toString()}d&&(this.adjustAddedNodeWidth(e,d),s&&this.initializeComponentTypeNode(e,d)),this.projectClassManagementFlow.bindDefaultClassByNodePrimitive({node:e,doc:this}),this.addNode(e),"uninitialised"in e&&!e.uninitialised||this.initializeListTypeNodeChildren(e)})),d&&(this.removeDefaultBorder(m,d),"fakeSize"in d&&this.removeParentNodeFakeSize({parentNode:d,addedNodes:t,addingFirstChildren:m,dropPosition:r,styleManagementFlow:this.nodeStyleManagementFlow}))}deleteNodesById(e){const{nodeIds:t,withSubtree:n=!0,skipRestoreParentsFakeSize:o=!1,deleteRoot:i=!1}=e,s=Object.values(this.webRTCState.editedNodes||{}).reduce(((e,t)=>{var n;return e.concat(null!==(n=t.nodeIds)&&void 0!==n?n:[])}),[]);let r=!1;for(const c of t)this.nodes.bfs(c,(e=>{-1===s.indexOf(e.id)||(r=!0)}));var a;r?null===(a=this.notificationsManagementFlow)||void 0===a||a.handleError("Could not delete node because another user is editing something inside it."):me.execute({nodeIds:t,withSubtree:n,skipRestoreParentsFakeSize:o,deleteRoot:i},this)}copyNodesToTarget(e){const{nodes:t,targetId:n,copyBefore:o,dropPosition:i,useContentAsNode:s=!1,compInstanceId:r,newNodePositions:a,duplicatePropEvenIfItExists:c}=e;let l=!1;const d=[],p=[],u={},h={},y=this.nodes.getById(n);if(!y)throw new Error("Attempted to copy inside a node that does not exist");const m=y.primitiveType===E.sO.SLOT,f=s&&(0,N.j1)(this,y);if(f){const e=this.getComponentIdForNode(n),t=this.components.byId[e];t&&this.projectUIState.userPreferences.automaticallyCreateOverrides&&!m&&this.addDefaultPropsDefinitionForNode({node:f,component:t,doc:this,createStringPropForTexts:this.projectUIState.userPreferences.createSimpleTextProps}),this.addNode(f)}const g=this.getComponentIdForNode(n)||this.projectUIState.selection.componentId,_=this.getProjectPageOrComponent(g),b=this.nodes.getAvailableContextIdsForNode(n,r);if(t.forEach(((e,t)=>{const i={};this.nodes.bfs(e.id,(s=>{if(s.primitiveType===E.sO.SLOT)return;let f=s.pos;if(_&&this.nodes.nodeIsCompInstance(s)&&this.components.checkIfComponentsHaveCircularDependency(s.compIdOfCompInstance,_.id))return void this.notificationsManagementFlow.createNotification(pt.k$.ERROR,"Could not copy component because it would create a circular dependency.");if(s.id===e.id){if(!e.primitiveType||!this.isNodeAcceptingChild({node:y,child:e}))return;const i=p.length?p[p.length-1]:this.nodes.getLastChild(y,r);if(null!==a&&void 0!==a&&a[t])f=null===a||void 0===a?void 0:a[t];else if(o){const e=p.length?p[p.length-1]:this.nodes.getPrevSibling(o);f=e?(0,N.Dd)(o.pos,e.pos):(0,N.Dd)(o.pos,"0")}else f=(parseFloat((null===i||void 0===i?void 0:i.pos)||"0")+Number.MAX_SAFE_INTEGER).toString();if(0===t){const e=this.nodes.getById(n);e&&(l=!this.nodes.getFirstChild(e,r))}}const g=this.cloneNodeWithLangReferences({nodeId:s.id,removeRootStatus:!0});if(!g)throw new Error(`Failed in cloning node - ${s.id}`);g.pos=f,i[s.id]=g.id;const b=s.getActualParentId();if(b.length>0){const t=i[b];t?g.parentId=t:s.id===e.id&&"slotId"in g&&(m&&r?(g.slotId=n,g.compInstanceId=r):g.parentId=n)}else m&&r&&"slotId"in g?(g.slotId=n,g.compInstanceId=r):g.parentId=n;if(this.nodes.nodeIsCompInstance(s)&&_){this.addUsedComponentRelation({toAddComponentId:_.id,linkedComponentId:s.compIdOfCompInstance});const e=this.components.byId[s.compIdOfCompInstance];if(!e)throw new Error("Trying to duplicate a component instance but the component is missing");e.instantiatedByNodes[g.id]=!0,h[g.id]=s.id}d.push(g),s.id===e.id&&p.push(g),this.assets.copyAssetsInNodeRelationToNode({sourceNodeId:s.id,targetNodeId:g.id}),this.copyPropDefinitionsForCopiedNode({node:s,copiedNode:g,targetNodeId:n,initialNode:o,compInstanceId:r,duplicatePropEvenIfItExists:c}),this.copyNodeEventsForCopiedNode({node:s,copiedNode:g,targetNodeId:n,compInstanceId:r}),this.copyNodeRenderingConditionsForCopiedNode({node:s,copiedNode:g,targetNodeId:n,compInstanceId:r}),this.copyNodeRenderingConditionsforCssClassesForCopiedNode({node:s,copiedNode:g,targetNodeId:n,compInstanceId:r}),this.replaceStateDefinitionsWithStaticValuesForCopiedNode({node:s,copiedNode:g,targetNodeId:n,initialNode:o,compInstanceId:r}),this.nodes.nodeIsCompInstance(g)&&this.copyHierarchyAttributesForCopiedNode({newNode:g}),Object.assign(u,po({},i))})),this.addSectionIdToComponent(i)})),d.forEach((e=>{if("slotId"in e&&e.slotId&&e.compInstanceId&&this.addNodeToSlot({slotOwnerId:e.compInstanceId,slotId:e.slotId,node:e}),this.addNode(e),e.parentId&&!e.slotId){const t=this.nodes.getById(e.parentId);if(t&&"childrenIds"in t&&(t.childrenIds[e.id]=!0),t&&"stateNodeRoots"in t){const n=Object.keys(u).find((t=>u[t]===e.id)),o=this.nodes.getById(n||""),i=this.nodes.getById((null===o||void 0===o?void 0:o.parentId)||"");if(!i||!("stateNodeRoots"in i))return;const s=Object.keys(i.stateNodeRoots).find((e=>i.stateNodeRoots[e]===n));if(!s)return;t.stateNodeRoots[s]=e.id}if(t&&"mappings"in t){const n=Object.keys(u).find((t=>u[t]===e.id)),o=this.nodes.getById(n||""),i=this.nodes.getById((null===o||void 0===o?void 0:o.parentId)||"");if(!i||!("mappings"in i))return;const s=Object.keys(i.mappings).find((e=>i.mappings[e].componentInstanceId===n));if(!s)throw new Error(`Duplicated a Mixed Type node but could not find mapping for its child by id ${n}`);t.mappings[s].componentInstanceId=e.id}}h[e.id]&&this.cloneSlottedNodes({sourceInstanceId:h[e.id],targetInstanceId:e.id,doc:this});const t=this.nodes.getAvailableContextIdsForNode(e.id,r);this.replaceCtxReferenceWithStaticNode({node:e,targetAvailableCtxIds:[...t,...b],doc:this})})),f&&i){const e=this.nodes.getById(f.id);if("before"===i&&e){const t=d[d.length-1];e.pos=(parseFloat((null===t||void 0===t?void 0:t.pos)||"0")+Number.MAX_SAFE_INTEGER).toString()}}return d.length&&(this.removeDefaultBorder(l,y),this.removeParentNodeFakeSize({parentNode:y,addedNodes:d,addingFirstChildren:l,styleManagementFlow:this.nodeStyleManagementFlow})),{copiedNodes:d,nodeIdsMap:u}}groupNodes(e){return wt.execute(po({doc:this},e))}ungroupNodeChildren(e){return Ot.execute(po({doc:this},e))}isNodePageRoot(e){var t;const n=null===(t=this.nodes.getById(e))||void 0===t?void 0:t.compIdOfRootNode;return!!n&&!!this.pages.byId[n]}isNodeRoot(e){var t;return!(null===(t=this.nodes.getById(e))||void 0===t||!t.compIdOfRootNode)}isResizeAllowedForNode(e){var t;if(this.isNodePageRoot(e))return!1;const n=this.nodes.getById(e);if(!n)throw new Error("Node not found");if(this.nodes.nodeIsCompInstance(n)||this.nodes.nodeIsDevCompInstance(n)||!n.getNodeAllowedOps().style)return!1;const o="styles"in n?null===(t=n.styles.display)||void 0===t?void 0:t.content:null;if(o)return"inline"!==o;return"inline"!==(de.bC[n.semanticType||""]||de.bC[n.primitiveType])}isMarginAndPaddingAdjustAllowedForNode(e,t){var n;if(this.isNodePageRoot(e)||t)return!1;const o=this.nodes.getById(e);if(!o)throw new Error("Node not found");if(!o.getNodeAllowedOps().style)return!1;if(this.nodes.nodeIsCompInstance(o)||this.nodes.nodeIsDevCompInstance(o))return!1;const i="styles"in o?null===(n=o.styles.display)||void 0===n?void 0:n.content:null;if(i)return"inline"!==i;return"inline"!==(de.bC[o.semanticType||""]||de.bC[o.primitiveType])}getProjectPageOrComponent(e){if(!e)return null;const t=this.pages.byId[e]||this.components.byId[e]||this.cmsPages.byId[e];return t||null}getComponentIdForNode(e,t){var n;const o=this.nodes.getById(e);if(!o)return null;if(!o.parentId&&"rootOfPropHierarchy"in o&&o.rootOfPropHierarchy)return this.pages.getHomePageId();if(o.primitiveType===E.sO.FRAGMENT&&"meta"in o&&null!==(n=o.meta)&&void 0!==n&&n.isPropRoot)return o.meta.isPropRoot.compId||null;if(o.parentId)return this.getComponentIdForNode(o.parentId,t);if("slotId"in o&&o.slotId){const{compInstanceId:n}=this.nodes.getSlotAndCompInstanceIdForNodeById(e);return n?t?this.nodes.getById(n).compIdOfCompInstance:this.getComponentIdForNode(n,t):null}return o.compIdOfRootNode}getRootNodeIdForPageOrComponent(e){var t;if(!e)return null;const n=this.getProjectPageOrComponent(e);return n&&null!==(t=null===n||void 0===n?void 0:n.rootNodeId)&&void 0!==t?t:null}getNodesFromSelectedComponent(){var e;const t=this.projectUIState.selection.componentId;if(!t)return[];const n=null===(e=this.getProjectPageOrComponent(t))||void 0===e?void 0:e.rootNodeId;return n?this.nodes.getDescendents(n):[]}removeAsset(e){delete this.assets.byId[e]}removeSectionIdFromComponent(e){ue.execute(po({},e),this)}estimateNodeDimensionInPxByStyle(e,t){return Qt.execute({key:e,nodeId:t,doc:this})}removeParentNodeFakeSize(e){Xe.execute(e,this)}restoreParentNodesFakeSize(e){qe.execute(e,this)}cloneNode(e){return st.execute(po(po({},e),{},{doc:this,sentryService:this.sentryService}))}getLocalWorkClone(e){const{nodeId:t}=e,n=this.nodes.getById(t);if(!n)throw new Error(`Referring element for clone is missing - ${t}`);const o=new D.HX({id:n.id,fakeSize:"fakeSize"in n?n.fakeSize:null,contentChildren:"contentChildren"in n?po({},n.contentChildren):{},abilities:"cloneAbilities"in n?n.cloneAbilities():{}}),i=nt.execute({nodeId:t,doc:this,sentryService:this.sentryService});i&&(o.attrs=i);const s=Qe.S.execute({targetNodeId:o.id,nodeId:t,doc:this});s&&(o.styles=s);const r=et.l.execute({targetNodeId:o.id,nodeId:t,doc:this});return r&&(o.referencedStyles=r),o}copyStylesFromSourceNode(e){const t=this.nodes.getById(e.targetId);if(t&&"styles"in t){const n=Qe.S.execute({targetNodeId:t.id,nodeId:e.sourceId,doc:this});n&&(t.styles=n)}if(t&&"referencedStyles"in t){const n=et.l.execute({targetNodeId:t.id,nodeId:e.sourceId,doc:this});n&&(t.referencedStyles=n)}}getUsedProjectClassesForNodesByPos(e){let t=new Array;return e.forEach(((e,n)=>{const o=this.nodes.getById(e),i=new Array;o&&"referencedStyles"in o&&Object.values((null===o||void 0===o?void 0:o.referencedStyles)||{}).forEach((t=>{if("project-referenced"===t.content.mapType){var n;const o=this.classes.byId[t.content.referenceId];if(!o){const e=new Error(`Project Class ${t.content.referenceId} is missing from doc`);return void this.sentryService.captureException(e)}if("simple"!==o.classType){const e=new Error(`Project Class ${t.content.referenceId} is used on a node despite being compound`);return void this.sentryService.captureException(e)}i.push({id:o.id,name:o.getName(),pos:o.pos,isDefault:o.isDefault,isDisabled:null===(n=o.disabledInNodes)||void 0===n?void 0:n[e]})}})),t=0===n?t.concat(i):$t().intersectionWith(t,i,$t().isEqual)})),Object.values(t).sort(((e,t)=>(0,N.F0)(parseFloat(e.pos))-(0,N.F0)(parseFloat(t.pos))))}restoreBGColor(e,t){var n;if(!e.parentId)return;const o=this.nodes.getById(e.parentId);if(!o||!o.parentId||o.primitiveType!==E.sO.CONTAINER)return;const i="childrenIds"in o?Object.keys(o.childrenIds).length:0;1!==i||1===i&&t&&e.parentId===t.id||!("styles"in o)||null!==(n=o.styles[oe.X7.BORDER])&&void 0!==n&&n.content||(o.styles[oe.X7.BORDER]=new ne.F({content:se.Ln}))}removeDefaultBorder(e,t){const n="styles"in t?t.styles:null,o=n?n.border:null;n&&e&&"static"===(null===o||void 0===o?void 0:o.type)&&(null===o||void 0===o?void 0:o.content)===se.Ln&&delete n.border}isNodeAcceptingChildByElementType(e,t){if(!e||!e.primitiveType)return!1;const n=E.y7[e.primitiveType];if(!n)return"development"===co.env.NODENODE_ENV&&console.error(`Node ${e.id} of type ${e.primitiveType} doesn't accept ${t}`),!1;if(t===E.sO.SLOT){if(!this.components.byId[this.getComponentIdForNode(e.id)||""])return!1}return n.includes(t)}isNodeAcceptingChild(e){const{node:t,child:n}=e;if(!t||!n.primitiveType)return!1;if("childrenIds"in t&&t.childrenIds[n.id])return!0;if("compIdOfSlot"in t&&t.compIdOfSlot===this.projectUIState.selection.componentId)return!1;if(this.nodes.nodeIsCompInstance(n)&&"compIdOfSlot"in t){if(t.primitiveType===E.sO.SLOT&&t.compIdOfSlot===n.compIdOfCompInstance)return!1;if(this.nodes.getSlotAndCompInstanceIdForNodeById(t.id)){const e=this.nodes.getById(t.id);if(e&&"compIdOfSlot"in e&&e.compIdOfSlot===n.compIdOfCompInstance)return!1}}return this.isNodeAcceptingChildByElementType(t,n.primitiveType)}isMainNodeOfCMSPage(e){const t=this.getComponentIdForNode(e),n=this.getProjectPageOrComponent(t||"");return!(!n||!("mainNodeId"in n))&&n.mainNodeId===e}isNodeOrAnyChildProtected(e){if(this.isNodeProtected(e))return!0;let t=!1;return this.nodes.bfs(e,(e=>{if(this.isNodeProtected(e.id))return t=!0,!0}),!0),t}isNodeProtected(e){return this.isMainNodeOfCMSPage(e)}isNodeAcceptingChildren(e){return!(!e||null===e||void 0===e||!e.primitiveType)&&!!E.y7[e.primitiveType].length}addNodeToSlot(e){const{slotOwnerId:t,slotId:n,node:o}=e,i=this.nodes.getById(t);if(!i||!("slottedNodes"in i))throw new Error("Attempted to slot node in a node that does not accept slots!");return"slotNode"in i?i.slotNode(o.id,n):i.stateNodeRoots[n][o.id]=!0,!0}removeNodeFromSlot(e){const{slotOwnerId:t,slotId:n,node:o}=e,i=this.nodes.getById(t);if(i&&"slottedNodes"in i)"unslotNode"in i?i.unslotNode(o.id,n):delete i.stateNodeRoots[n][o.id];else{const e="Attempted to unslot node from another without slots!";this.sentryService.captureException(e)}}addUsedComponentRelation(e){const{toAddComponentId:t,linkedComponentId:n}=e,o=this.getProjectPageOrComponent(t);if(!o)throw new Error("Did not find component to add relation to");o.usedComponents[n]?o.usedComponents[n]+=1:o.usedComponents[n]=1}removeUsedComponentRelation(e){const{toRemoveComponentId:t,linkedComponentId:n}=e,o=this.getProjectPageOrComponent(t);if(!o)throw new Error("Did not find component to remove relation from");1!==o.usedComponents[n]?o.usedComponents[n]&&(o.usedComponents[n]-=1):delete o.usedComponents[n]}copyHierarchyAttributesForCopiedNode(e){const{newNode:t}=e;"attrs"in t&&Object.keys(t.attrs||{}).forEach((e=>{const n=t.attrs[e];if("hierarchy"!==n.type)return;const o=this.cloneRichTextHierarchy({rootNodeId:n.content,doc:this,meta:{isAttributeRoot:{nodeId:t.id,attr:e}}});o&&(t.attrs[e]=po(po({},n),{},{content:o}))}))}copyPropDefinitionsForCopiedNode(e){const{node:t,copiedNode:n,initialNode:o,targetNodeId:i,compInstanceId:s,duplicatePropEvenIfItExists:r}=e,a=this.getComponentIdForNode(t.id);if(!a)throw new Error(`Component not found for source node - ${t.id}`);const c=this.getComponentIdForNode(s||"")||this.getComponentIdForNode(i);if(!c)throw new Error(`Component not found for target node - ${c}`);const l=this.getProjectPageOrComponent(a),d=this.getProjectPageOrComponent(c),p=this.projectUIState.userPreferences.automaticallyCreateOverrides,u=d instanceof y.m||d instanceof _n.b||d instanceof In.i;l instanceof I.n&&u&&Object.keys(l.propDefinitions).forEach((e=>{const i=l.propDefinitions[e];if(!i.locations[t.id])return;const s=(0,ve.PJ)(i,this),r=o?(0,he.Uq)(o,i.name):void 0,a=r&&"static"===r.type?r.content:"richtext"===i.type?this.internationalizationFlow.getDefaultStaticTextValueForTranslationKey({key:null!==s&&void 0!==s?s:"",doc:this}):i.defaultValue;if("hierarchy"===(null===r||void 0===r?void 0:r.type)&&"contentChildren"in n&&!s)return void this.extractContentFromHierarchyPropDefinition({prop:i,propValue:r,copiedNode:n});const c=i.defaultHierarchyRootId,d=c?this.nodes.getById(c):null;if(d&&"element-node"===d.type){const e=Object.keys(d.childrenIds||{})[0],t=this.nodes.getById(e);if(t&&"element-node"===t.type){const e=Object.values(t.contentChildren||{})[0];if("static"===e.type)return void this.replaceDynamicPropWithStaticNode({node:n,propDefinition:i,newValue:e.content,propId:i.id})}}this.replaceDynamicPropWithStaticNode({node:n,propDefinition:i,newValue:a||i.defaultValue,propId:i.id})})),l instanceof I.n&&d instanceof I.n?Me.execute({node:t,nodeClone:n,sourceCompId:a,targetCompId:c,doc:this,duplicatePropEvenIfItExists:r}):l instanceof y.m&&d instanceof I.n&&p&&this.addDefaultPropsDefinitionForNode({node:n,component:d,doc:this,createStringPropForTexts:this.projectUIState.userPreferences.createSimpleTextProps})}copyNodeEventsForCopiedNode(e){const{node:t,copiedNode:n,targetNodeId:o,compInstanceId:i}=e,s=this.getComponentIdForNode(i||"")||this.getComponentIdForNode(o);if(!s)throw new Error(`Component not found for target node - ${s}`);Ue.execute({node:t,nodeClone:n,targetCompId:s,doc:this})}copyNodeRenderingConditionsForCopiedNode(e){const{node:t,copiedNode:n,targetNodeId:o,compInstanceId:i}=e,s=this.getComponentIdForNode(t.id);if(!s)throw new Error(`Component not found for source node - ${t.id}`);const r=this.getComponentIdForNode(i||"")||this.getComponentIdForNode(o);if(!r)throw new Error(`Component not found for target node - ${r}`);Ze.execute({node:t,nodeClone:n,targetCompId:r,sourceCompId:s,doc:this})}copyNodeRenderingConditionsforCssClassesForCopiedNode(e){const{node:t,copiedNode:n,targetNodeId:o,compInstanceId:i}=e,s=this.getComponentIdForNode(t.id);if(!s)throw new Error(`Component not found for source node - ${t.id}`);const r=this.getComponentIdForNode(i||"")||this.getComponentIdForNode(o);if(!r)throw new Error(`Component not found for target node - ${r}`);Le.execute({node:t,nodeClone:n,sourceCompId:s,targetCompId:r,doc:this})}extractContentFromHierarchyPropDefinition(e){const{propValue:t,copiedNode:n,prop:o}=e,i=this.cloneRichTextBaseHierarchy({rootNodeId:t.content,doc:this,newParentId:n.id});if(!i)return;const{copiedNodeIds:s,defaultStaticValue:r,copiedContentFromNodeId:a}=i;null!==s&&void 0!==s&&s.length&&(n.childrenIds=s.reduce(((e,t)=>(e[t]=!0,e)),{}),n.contentChildren={});const c=et.l.execute({targetNodeId:n.id,nodeId:a,doc:this});c&&(n.referencedStyles=po(po({},n.referencedStyles),c));const l=Qe.S.execute({targetNodeId:n.id,nodeId:a,doc:this});l&&(n.styles=po(po({},n.styles),l)),r&&this.replaceDynamicPropWithStaticNode({node:n,propDefinition:o,newValue:r,propId:o.id})}replaceStateDefinitionsWithStaticValuesForCopiedNode(e){const{node:t,copiedNode:n,initialNode:o,targetNodeId:i,compInstanceId:s}=e,r=this.getComponentIdForNode(t.id);if(!r)throw new Error(`Component not found for source node - ${t.id}`);const a=this.getComponentIdForNode(s||"")||this.getComponentIdForNode(i);if(!a)throw new Error(`Component not found for target node - ${a}`);const c=this.getProjectPageOrComponent(r);c&&c instanceof I.n&&Object.keys(c.stateDefinitions).forEach((e=>{const i=c.stateDefinitions[e];if(!i.locations[t.id])return;const s=o?(0,he.Uq)(o,i.name):void 0,r=s&&"static"===s.type?s.content:i.defaultValue;this.replaceDynamicStateWithStaticNode({node:n,stateDefinition:i,staticValue:r,stateId:i.id})}))}addSectionIdToComponent(e){const t=this.projectUIState.selection.componentId;Object.entries(e).forEach((([e,n])=>{var o,i;const s=this.nodes.getById(e);if(s instanceof class{constructor(e){(0,a.Z)(this,h.Patcher,!0),(0,a.Z)(this,"type","context-node"),(0,a.Z)(this,"primitiveType",E.sO.CONTEXT),(0,a.Z)(this,"semanticType",null),(0,a.Z)(this,"id",void 0),(0,a.Z)(this,"ctxId",void 0),(0,a.Z)(this,"pos",void 0),(0,a.Z)(this,"name",void 0),(0,a.Z)(this,"parentId",null),(0,a.Z)(this,"compIdOfRootNode",void 0),(0,a.Z)(this,"compInstanceId",void 0),(0,a.Z)(this,"slotId",void 0),(0,a.Z)(this,"childrenIds",void 0),(0,a.Z)(this,"attrs",{}),(0,a.Z)(this,"isNodeAcceptingChildByElementType",(()=>!0));const{id:t,ctxId:n,pos:o,name:i,attrs:s,parentId:r,compIdOfRootNode:c}=e;this.id=null!==t&&void 0!==t?t:(0,Se.Ox)(),this.ctxId=null!==n&&void 0!==n?n:(0,Se.Ox)(),this.pos=null!==o&&void 0!==o?o:"",this.name=null!==i&&void 0!==i?i:(0,Se.Ky)("context"),this.parentId=null!==r&&void 0!==r?r:null,this.attrs=null!==s&&void 0!==s?s:{},this.compIdOfRootNode=null!==c&&void 0!==c?c:null,this.childrenIds={}}get canBeMappedToUIDL(){return!0}getActualParentId(){return this.parentId||this.slotId||""}getDynamicProperties(){return{}}toJSON(){const e={};for(const t in this){if(t===h.Patcher)continue;const n=this[t];e[t]="object"===typeof n&&null!==n&&"toJSON"in n?n.toJSON():n}return e}getInspectorTabsForNode(){throw new Error("Sections not implemented for Context node")}getInspectorSectionsForNode(){throw new Error("Sections not implemented for Repeater node")}getNodeAllowedOps(e){throw new Error("getNodeAllowedOps not implemented on context node")}getChildNodeAllowedOps(){throw new Error("getChildNodeAllowedOps not implemented on context node")}fromJSON(e){var t,n,o;const{id:i,ctxId:s,pos:r,name:a,parentId:c,compIdOfRootNode:l,attrs:d,childrenIds:p}=e;this.id=i,this.ctxId=s,this.pos=null!==(t=r)&&void 0!==t?t:null,this.name=a,this.parentId=null!==(n=c)&&void 0!==n?n:null,this.attrs=(0,N.qn)(d||{})||{},this.compIdOfRootNode=null!==(o=l)&&void 0!==o?o:null,this.childrenIds=p||{}}}||s instanceof class{constructor(e){var t,n,o,i,s,r;(0,a.Z)(this,"type","data-fetcher"),(0,a.Z)(this,"semanticType",E.sO.FRAGMENT),(0,a.Z)(this,"primitiveType",E.sO.DATA_FETCHER),(0,a.Z)(this,"id",void 0),(0,a.Z)(this,"pos",void 0),(0,a.Z)(this,"name",void 0),(0,a.Z)(this,"parentId",void 0),(0,a.Z)(this,"compIdOfRootNode",void 0),(0,a.Z)(this,"slotId",void 0),(0,a.Z)(this,"compInstanceId",void 0),(0,a.Z)(this,"childrenIds",void 0),(0,a.Z)(this,"contextName",void 0),(0,a.Z)(this,"slottedNodes",void 0),(0,a.Z)(this,"resourceDefinition",void 0),this.id=e.id||(0,Se.Ox)(),this.parentId=null!==(t=e.parentId)&&void 0!==t?t:null,this.compIdOfRootNode=null!==(n=e.compIdOfRootNode)&&void 0!==n?n:null,this.pos=null!==(o=e.pos)&&void 0!==o?o:"0",this.name=null!==(i=e.name)&&void 0!==i?i:null,this.contextName=(null!==(s=e.contextName)&&void 0!==s?s:e.name)?`context-${e.name}`:(0,Se.Ky)("context"),this.slotId=e.slotId,this.compInstanceId=e.compInstanceId,this.slottedNodes=null!==(r=e.slottedNodes)&&void 0!==r?r:{success:{},error:{},loading:{}},this.resourceDefinition=e.resourceDefinition,this.childrenIds={}}getInspectorSectionsForNode(){throw new Error("Sections not implemented for Repeater node")}getActualParentId(){return this.parentId||this.slotId||""}getInspectorTabsForNode(){throw new Error("Sections not implemented for Data Fetcher node")}isNodeAcceptingChildByElementType(){throw new Error("isNodeAcceptingChildByElementType not yet imlpemented on Data Fetcher Node")}getDynamicProperties(){return{}}toJSON(){return{}}get canBeMappedToUIDL(){return!0}getNodeAllowedOps(e){throw new Error("getNodeAllowedOps not implemented on data fetche node")}getChildNodeAllowedOps(){throw new Error("getChildNodeAllowedOps not implemented on data fetcher node")}fromJSON(){throw new Error("fromJSON not yet imlpemented on Data Fetcher Node")}})return;const r=null===s||void 0===s||null===(o=s.attrs)||void 0===o||null===(i=o.id)||void 0===i?void 0:i.content;r&&t&&pe.execute({compId:t,nodeId:n,sectionId:r},this)}))}adjustAddedNodeWidth(e,t){var n;if(e.primitiveType===E.sO.CONTAINER&&"styles"in e&&"styles"in t&&(null===(n=e.styles[oe.X7.FLEX_DIRECTION])||void 0===n?void 0:n.content)===se.sO.ROW){var o,i;const n="column"===(null===(o=t.styles[oe.X7.FLEX_DIRECTION])||void 0===o?void 0:o.content),s=(null===(i=t.styles[oe.X7.WIDTH])||void 0===i?void 0:i.content)===ie.pF;n&&!s&&(e.styles[oe.X7.WIDTH]=new ne.F({content:ie.V0}))}}initializeComponentTypeNode(e,t){if(this.nodes.nodeIsCompInstance(e)&&(this.components.byId[e.compIdOfCompInstance].instantiatedByNodes[e.id]=!0),t.primitiveType===E.sO.SLOT)return;const n=this.getComponentIdForNode(t.id),o=this.components.byId[n];o&&this.projectUIState.userPreferences.automaticallyCreateOverrides&&this.addDefaultPropsDefinitionForNode({node:e,component:o,doc:this,createStringPropForTexts:this.projectUIState.userPreferences.createSimpleTextProps})}initializeListTypeNodeChildren(e){if(e.primitiveType===E.sO.LIST){let t=0;for(;t<E.SD;){const n=(0,en.a)({stencilKey:se.sO.LISTITEM});n.parentId=e.id,n.pos=(t+1).toString(),this.projectClassManagementFlow.bindDefaultClassByNodePrimitive({node:n}),this.addNode(n),this.initializeListItemNodeChildren(n),this.internationalizationFlow.linkStaticNodesToTranslations({nodes:[n],doc:this}),t++}}e.primitiveType===E.sO.LISTITEM&&e instanceof D.HX&&this.initializeListItemNodeChildren(e)}initializeListItemNodeChildren(e){const t=(0,en.a)({stencilKey:se.sO.TEXT});t.parentId=e.id,this.internationalizationFlow.linkStaticNodesToTranslations({nodes:[t],doc:this}),this.addNode(t)}addNewOptionItem(e){const{parentNodeId:t,pos:n,defaultValue:o}=e,i={value:o||""};"0"===n&&(i.selected="");const s=(0,en.a)({stencilKey:se.sO.OPTION,attrs:i,defaultValue:o});n&&(s.pos=n),s.parentId=t,this.addNode(s)}updateHtmlForNode(e){const{node:t,staticValue:n,dynamicNode:o}=e;"cms-html-node"!==t.type&&"html-node"!==t.type||(o?t.html=o:n&&(t.html=new ne.F({content:n})))}nodeCanBeMappedToUIDL(e){const t=this.nodes.getById(e);if(!t)return!1;if("cms-collection-item-node"===t.type||"cms-collection-list-node"===t.type){const e=t.resourceDefinition;return t.canBeMappedToUIDL&&"uninitialised"!==(null===e||void 0===e?void 0:e.type)&&!!this.cms.usedContentTypes[(null===e||void 0===e?void 0:e.contentType)||""]}return t.canBeMappedToUIDL}getUniqueCompOrPageName(e){const t=[...Object.values(this.pages.byId).map((e=>(null===e||void 0===e?void 0:e.title)||"")),...Object.values(this.components.byId).map((e=>(null===e||void 0===e?void 0:e.title)||"")),...Object.values(this.cmsPages.byId).map((e=>(null===e||void 0===e?void 0:e.title)||""))];return(0,v.Zu)(t,e)}applyPatch(e){const{pathArray:t,value:n,op:o}=e;if(2===t.length&&"deployments"===t[1]&&(this.stats.deployments=po(po({},this.stats.deployments),n)),1===t.length&&"settings"===t[0]&&(this.settings=n),2===t.length&&"selectedTheme"===t[0]){if(!this.selectedTheme)return;"replace"!==o&&"add"!==o||(this.selectedTheme.overrideColors=n),"remove"===o&&(this.selectedTheme.overrideColors=!1)}}getNameOfComponentOrPageById(e){const t=this.getProjectPageOrComponent(e);return t?t.title:null}fromJSON(e){const{settings:t,folders:n,pages:o,cmsPages:i={},components:s,nodes:r,assets:a,fonts:c,designLanguage:l,stats:d,collaborators:p,classes:u,projectFiles:h,cloudComponents:y,mediaQueryBreakpoints:m,customFiles:f,tailwindCSS:g,resourceDefinitions:_,internationalization:b,cms:I,selectedTheme:v,migrationsThatHaveRun:w}=e||{};this.stats=d,this.settings=t,this.internationalization.fromJSON(b),this.fonts.fromJSON(c),this.folders.fromJSON(n),this.pages.fromJSON(o),this.cmsPages.fromJSON(i),this.components.fromJSON(s),this.nodes.fromJSON(r),this.assets.fromJSON(a),this.designLanguage.fromJSON(l),this.collaborators.fromJSON(p),this.projectFiles.fromJSON(h),this.classes.fromJSON(u),this.cloudComponents.fromJSON(y),this.mediaQueryBreakpoints.fromJSON(m),this.customFiles.fromJSON(f),this.tailwindCSS.fromJSON(g),this.resourceDefinitions.fromJSON((null===_||void 0===_?void 0:_.byId)||{}),this.cms.fromJSON(I||{}),this.selectedTheme=v,this.migrationsThatHaveRun=w}toJSON(){return{settings:this.settings,folders:this.folders.toJSON(),pages:this.pages.toJSON(),cmsPages:this.cmsPages.toJSON(),components:this.components.toJSON(),nodes:this.nodes.toJSON(),assets:this.assets.toJSON(),designLanguage:this.designLanguage.toJSON(),fonts:this.fonts.toJSON(),collaborators:this.collaborators.toJSON(),internationalization:this.internationalization.toJSON(),stats:this.stats,projectFiles:this.projectFiles.toJSON(),classes:this.classes.toJSON(),cloudComponents:this.cloudComponents.toJSON(),mediaQueryBreakpoints:this.mediaQueryBreakpoints.toJSON(),customFiles:this.customFiles.toJSON(),tailwindCSS:this.tailwindCSS.toJSON(),cms:this.cms.toJSON(),selectedTheme:this.selectedTheme,migrationsThatHaveRun:this.migrationsThatHaveRun}}},no=(0,c.Z)(to.prototype,"projectUIState",[Vn],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),oo=(0,c.Z)(to.prototype,"webRTCState",[Yn],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),io=(0,c.Z)(to.prototype,"nodeStyleManagementFlow",[Jn],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),so=(0,c.Z)(to.prototype,"projectClassManagementFlow",[Xn],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ro=(0,c.Z)(to.prototype,"notificationsManagementFlow",[qn],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ao=(0,c.Z)(to.prototype,"sentryService",[Qn],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),eo=to))||eo)},436035:function(e,t,n){n.d(t,{P:function(){return r},Q:function(){return a}});var o=n(777460),i=n(395942);function s(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}const r={short:"en",name:"English"};class a{constructor(e){(0,o.Z)(this,i.Patcher,void 0),(0,o.Z)(this,"mainLanguage",null),(0,o.Z)(this,"availableLanguages",{}),(0,o.Z)(this,"translations",{}),(0,o.Z)(this,"enabled",!1),e&&(this.mainLanguage=e,this.availableLanguages[this.mainLanguage.short]=this.mainLanguage.name,this.translations[this.mainLanguage.short]={}),this.enabled=!1}addLanguage(e,t){this.availableLanguages[e.short]&&this.translations[e.short]||(this.availableLanguages[e.short]=e.name,this.translations[e.short]=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?s(Object(n),!0).forEach((function(t){(0,o.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):s(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},t))}removeLanguage(e){var t;e!==(null===(t=this.mainLanguage)||void 0===t?void 0:t.short)&&(delete this.availableLanguages[e],delete this.translations[e])}addTranslation(e,t,n){this.translations[e]||(this.translations[e]={}),this.translations[e][t]=n}removeTranslation(e){Object.keys(this.translations).forEach((t=>{this.translations[t]&&delete this.translations[t][e]}))}getTranslationRootHierarchyNodeId(e,t){var n,o;const i=null===(n=this.translations)||void 0===n||null===(o=n[e])||void 0===o?void 0:o[t];return i&&"hierarchy"===i.type?i.content:null}fromJSON(e={}){var t,n;this.mainLanguage=e.mainLanguage,this.availableLanguages=e.availableLanguages,this.translations=null!==(t=e.translations)&&void 0!==t?t:{},this.enabled=null!==(n=e.enabled)&&void 0!==n&&n}toJSON(){return{mainLanguage:this.mainLanguage,availableLanguages:this.availableLanguages,translations:this.translations,enabled:this.enabled}}applyPatch(e){const{op:t,pathArray:n,value:o}=e;"remove"!==t||2!==n.length?"add"!==t||2!==n.length||this.addLanguage({short:n[1],name:o},{}):this.removeLanguage(n[1])}}},541109:function(e,t,n){n.d(t,{z4:function(){return s},UL:function(){return r},vn:function(){return a}});var o=n(414326),i=n(378888);const s={[o.yy["viewport/mobile"]]:479,[o.yy["viewport/mobile-landscape"]]:767,[o.yy["viewport/tablet"]]:991,[o.yy["viewport/laptop"]]:1200,[o.yy["viewport/desktop"]]:1600,[o.yy["viewport/ultrawide"]]:1920},r=5,a=[{id:(0,i.Ox)(),icon:o.yy["viewport/mobile"],maxWidth:s[o.yy["viewport/mobile"]]},{id:(0,i.Ox)(),icon:o.yy["viewport/mobile-landscape"],maxWidth:s[o.yy["viewport/mobile-landscape"]]},{id:(0,i.Ox)(),icon:o.yy["viewport/tablet"],maxWidth:s[o.yy["viewport/tablet"]]},{id:(0,i.Ox)(),icon:o.yy["viewport/laptop"],maxWidth:s[o.yy["viewport/laptop"]],isDefault:!0},{id:(0,i.Ox)(),icon:o.yy["viewport/desktop"],maxWidth:s[o.yy["viewport/desktop"]],isDisabled:!0},{id:(0,i.Ox)(),icon:o.yy["viewport/ultrawide"],maxWidth:s[o.yy["viewport/ultrawide"]],isDisabled:!0}]},881649:function(e,t,n){n.d(t,{s:function(){return p}});var o=n(777460),i=n(395942),s=n(414326),r=n(378888),a=n(557149);class c{constructor(e){var t;(0,o.Z)(this,i.Patcher,void 0),(0,o.Z)(this,"id",void 0),(0,o.Z)(this,"maxWidth",void 0),(0,o.Z)(this,"icon",void 0),(0,o.Z)(this,"isDefault",void 0),(0,o.Z)(this,"isDisabled",void 0),this.id=(null===e||void 0===e?void 0:e.id)||(0,r.Ox)(),this.maxWidth=null!==(t=null===e||void 0===e?void 0:e.maxWidth)&&void 0!==t?t:a.MIN_STAGE_WIDTH,this.icon=(null===e||void 0===e?void 0:e.icon)||s.yy["viewport/desktop"],this.isDefault=null===e||void 0===e?void 0:e.isDefault,this.isDisabled=null===e||void 0===e?void 0:e.isDisabled}getName(){return s.lJ[this.icon]}getColor(){return s.dr[this.icon]}fromJSON(e){const{id:t,maxWidth:n,isDefault:o,icon:i,isDisabled:s}=e;return this.id=t,this.maxWidth=n,this.icon=i,this.isDefault=o,this.isDisabled=s,this}toJSON(){return{id:this.id,maxWidth:this.maxWidth,icon:this.icon,isDefault:this.isDefault,isDisabled:this.isDisabled}}applyPatch(e){const{pathArray:t,value:n}=e;"maxWidth"!==t[0]?"icon"!==t[0]?"isDefault"!==t[0]?"isDisabled"!==t[0]||(this.isDisabled=n):this.isDefault=n:this.icon=n:this.maxWidth=n}}function l(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function d(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?l(Object(n),!0).forEach((function(t){(0,o.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):l(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}class p{constructor(){(0,o.Z)(this,i.Patcher,void 0),(0,o.Z)(this,"byId",{})}getNonDefaultActiveMQBreakpointsInOrder(e){return this.getAllMediaQueriesInOrder(e).filter((e=>!e.isDefault&&!e.isDisabled))}getDefaultMediaQuery(){return Object.values(this.byId).find((e=>e.isDefault))}getActiveMediaQueriesInOrder(e){return this.getAllMediaQueriesInOrder(e).filter((e=>!e.isDisabled))}getAllMediaQueriesInOrder(e){return Object.values(this.byId).sort(((t,n)=>e?s.Lp.findIndex((e=>e===n.icon))-s.Lp.findIndex((e=>e===t.icon)):s.Lp.findIndex((e=>e===t.icon))-s.Lp.findIndex((e=>e===n.icon))))}create(e){const{id:t}=e,n=t||(0,r.Ox)();return this.byId[n]=new c(d(d({},e),{},{id:n})),this.byId[n]}remove(e){delete this.byId[e]}toJSON(){return{byId:Object.keys(this.byId).reduce(((e,t)=>{var n;return e[t]=null===(n=this.byId[t])||void 0===n?void 0:n.toJSON(),e}),{})}}fromJSON(e){this.byId={};const{byId:t={}}=e||{};if(t&&"object"===typeof t)return Object.keys(t).forEach((e=>{const n=(t||{})[e],o=(new c).fromJSON(n);this.byId[o.id]=o})),this}applyPatch(e){const{pathArray:t,value:n}=e;2===t.length&&"byId"===t[0]&&(n?this.byId[t[1]]=(new c).fromJSON(n):delete this.byId[t[1]])}}},182312:function(e,t,n){n.d(t,{z:function(){return l}});var o=n(777460),i=n(233475),s=n(751433),r=n(223924);function a(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function c(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?a(Object(n),!0).forEach((function(t){(0,o.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):a(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}class l extends s.aw{constructor(...e){super(...e),(0,o.Z)(this,"type","cms-navigation-button"),(0,o.Z)(this,"primitiveType",i.Pu.CMS_NAVIGATION_BUTTON),(0,o.Z)(this,"semanticType",i.iX.DIV)}getInspectorSectionsForNode(){return[...r.Uv,r.bQ.BACKGROUND]}getNodeAllowedOps(e){const t=(null===e||void 0===e?void 0:e.getChildNodeAllowedOps(this))||{delete:!0,duplicate:!0,move:!0,makeComponent:!0,copy:!0,style:!0,edit:!1,group:!0,rename:!1,ungroup:!1,interactWithPointer:!0,expandTreeviewNode:!0,hide:!0};return this.compIdOfRootNode&&(t.move=!1),t.delete=!1,t.duplicate=!1,t.makeComponent=!1,t.copy=!1,t.group=!1,t.ungroup=!1,t.rename=!1,t}toJSON(){return c(c({},super.toJSON()),{},{type:this.type})}fromJSON(e){return super.fromJSON(e),this.type=e.type,this}}},687279:function(e,t,n){n.d(t,{k:function(){return l}});var o=n(777460),i=n(233475),s=n(751433),r=n(223924);function a(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function c(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?a(Object(n),!0).forEach((function(t){(0,o.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):a(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}class l extends s.aw{constructor(e={}){super(e),(0,o.Z)(this,"type","cms-pagination-node"),(0,o.Z)(this,"primitiveType",i.Pu.CMS_PAGINATION_NODE),(0,o.Z)(this,"semanticType",i.iX.DIV),(0,o.Z)(this,"disabled",void 0),this.disabled=e.disabled}get canBeMappedToUIDL(){return!this.uninitialised&&!this.disabled}getInspectorSectionsForNode(){return[...r.Uv,r.bQ.BACKGROUND]}getNodeAllowedOps(e){const t=(null===e||void 0===e?void 0:e.getChildNodeAllowedOps(this))||{delete:!0,duplicate:!0,move:!0,makeComponent:!0,copy:!0,style:!0,edit:!1,group:!0,ungroup:!1,rename:!1,hide:!1,interactWithPointer:!0,expandTreeviewNode:!0};return this.compIdOfRootNode&&(t.move=!1),t.edit=!1,t.delete=!1,t.duplicate=!1,t.makeComponent=!1,t.copy=!1,t.group=!1,t.ungroup=!1,t.rename=!1,t.hide=!1,t}getChildNodeAllowedOps(){return{delete:!0,duplicate:!0,move:!0,makeComponent:!0,copy:!0,style:!0,edit:!0,group:!0,ungroup:!0,interactWithPointer:!0,rename:!0,expandTreeviewNode:!0,hide:!0}}toJSON(){return c(c({},super.toJSON()),{},{type:this.type,disabled:this.disabled})}fromJSON(e){return super.fromJSON(e),this.disabled=e.disabled,this}applyPatch(e){const{pathArray:t,value:n}=e;switch(super.applyPatch(e),t[0]){case"disabled":return void(this.disabled=n)}}}},236711:function(e,t,n){n.d(t,{F:function(){return u}});var o=n(777460),i=n(233475),s=n(751433),r=n(651174),a=n(223924),c=n(555362),l=n(930613);function d(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function p(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?d(Object(n),!0).forEach((function(t){(0,o.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):d(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}class u extends s.aw{constructor(e={}){super(e),(0,o.Z)(this,"type","component-instance-node"),(0,o.Z)(this,"previewSize",void 0),(0,o.Z)(this,"slottedNodes",void 0),(0,o.Z)(this,"primitiveType",void 0),(0,o.Z)(this,"slotsWithHiddenPreview",void 0),(0,o.Z)(this,"compIdOfCompInstance",void 0),(0,o.Z)(this,"previewReplaceWithSection",void 0),(0,o.Z)(this,"isPreviewComponent",void 0),this.previewSize=e.previewSize||{},this.slottedNodes=e.slottedNodes||{},this.slotsWithHiddenPreview=e.slotsWithHiddenPreview||{},this.primitiveType=i.sO.COMPONENT,this.compIdOfCompInstance=e.compIdOfCompInstance||"",this.previewReplaceWithSection=null,this.isPreviewComponent=e.isPreviewComponent||!1}getNodeAllowedOps(e,t){const n=super.getNodeAllowedOps(e,t);return n.makeComponent=!1,n}getDynamicProperties(){const e={};return Object.values(this.attrs||{}).forEach((t=>{if("dynamic"===t.type){const n=t.content.id;e[n]=t}})),Object.values(this.contentChildren||{}).forEach((t=>{if("dynamic"===t.type){const n=t.content.id;e[n]=t}})),Object.values(this.abilities||{}).forEach((t=>{if(t.type,t.type===l.RZ.URL){const n=t.content.url;if(n instanceof c.P){const t=n.content.id;e[t]=n}}})),e}getInspectorSectionsForNode(){return[a.bQ.BACKGROUND,a.bQ.TEXT_COLOR,a.bQ.SIZE,a.bQ.POSITION,a.bQ.MARGIN,a.bQ.PADDING,a.bQ.VISIBILITY,a.bQ.COMPONENT_LINKS,a.bQ.COMPONENT_PROPS,a.bQ.COMPONENT_STATE,a.bQ.CONDITIONAL_RENDERING]}toJSON(){return p(p({},super.toJSON()),{},{previewSize:this.previewSize,slottedNodes:this.slottedNodes,slotsWithHiddenPreview:this.slotsWithHiddenPreview,compIdOfCompInstance:this.compIdOfCompInstance})}slotNode(e,t){this.slottedNodes[t]||(this.slottedNodes[t]={[e]:!0}),this.slottedNodes[t][e]=!0}unslotNode(e,t){var n,o;null===(n=this.slottedNodes)||void 0===n||(null===(o=n[t])||void 0===o||delete o[e])}setPreviewSize(e,t,n){this.previewSize[n]={width:e,height:t}}getPreviewSizeForSlot(e){return this.previewSize[e]}cleanInstanceDataOnSlotRemove(e){var t;delete this.slottedNodes[e],delete this.previewSize[e],null===(t=this.slotsWithHiddenPreview)||void 0===t||delete t[e]}fromJSON(e){super.fromJSON(e);const{previewSize:t,slottedNodes:n,compIdOfCompInstance:o,slotsWithHiddenPreview:i}=e;return this.previewSize=t||{root:{width:r.Q.WIDTH,height:r.Q.HEIGHT}},this.compIdOfCompInstance=o,this.slottedNodes=n||{},this.slotsWithHiddenPreview=i||{},this}applyPatch(e){super.applyPatch(e);const{op:t,pathArray:n,value:o}=e;switch(n[0]){case"compIdOfCompInstance":return void("add"!==t&&"replace"!==t||(this.compIdOfCompInstance=o));case"previewSize":if(1===n.length){if("add"===t||"replace"===t)return void(this.previewSize=o);if("remove"===t)return void(this.previewSize={root:{width:r.Q.WIDTH,height:r.Q.HEIGHT}})}if(2===n.length){if("add"===t||"replace"===t)return this.previewSize||(this.previewSize={[n[1]]:o}),void(this.previewSize[n[1]]=o);if("remove"===t){var i;if("root"!==n[1])null===(i=this.previewSize)||void 0===i||delete i[n[1]];return}}if(3===n.length&&("add"===t||"replace"===t))return this.previewSize||(this.previewSize={[n[1]]:{width:r.Q.WIDTH,height:r.Q.HEIGHT}}),this.previewSize[n[1]]||(this.previewSize[n[1]]={width:r.Q.WIDTH,height:r.Q.HEIGHT}),void(this.previewSize[n[1]][n[2]]=o);case"slottedNodes":if(1===n.length){if("add"===t||"replace"===t)return void(this.slottedNodes=o);if("remove"===t)return void(this.slottedNodes={})}if(2===n.length){if("add"===t||"replace"===t)return void(this.slottedNodes[n[1]]=o);var s;if("remove"===t)return void(null===(s=this.slottedNodes)||void 0===s||delete s[n[1]])}if(3===n.length){if("add"===t||"replace"===t)return void(this.slottedNodes[n[1]][n[2]]=o);var a,c;if("remove"===t)return void(null===(a=this.slottedNodes)||void 0===a||(null===(c=a[n[1]])||void 0===c||delete c[n[2]]))}case"slotsWithHiddenPreview":if("add"===t||"replace"===t)return void(this.slotsWithHiddenPreview[n[1]]=o);if("remove"===t)return void delete this.slotsWithHiddenPreview[n[1]]}}}},463012:function(e,t,n){n.d(t,{v:function(){return s}});var o=n(777460),i=n(395942);class s{constructor(e){(0,o.Z)(this,i.Patcher,!0),(0,o.Z)(this,"type","conditional"),(0,o.Z)(this,"reference",void 0),(0,o.Z)(this,"condition",void 0),(0,o.Z)(this,"value",void 0);const{reference:t,condition:n,value:s}=e;this.reference=t,this.condition=n,this.value=s}}},651174:function(e,t,n){n.d(t,{Q:function(){return o}});const o={WIDTH:"150px",HEIGHT:"100px"}},649715:function(e,t,n){n.d(t,{H:function(){return o}});const o={click:"onClick",focus:"onFocus",blur:"onBlur",change:"onChange",submit:"onSubmit",keydown:"onKeyDown",keyup:"onKeyUp",keypress:"onKeyPress",mouseenter:"onMouseEnter",mouseleave:"onMouseLeave",mouseover:"onMouseOver",select:"onSelect",touchstart:"onTouchStart",touchend:"onTouchEnd",scroll:"onScroll",load:"onLoad"}},761328:function(e,t,n){let o;n.d(t,{F:function(){return o}}),function(e){e.focus="focus",e.hover="hover",e.active="active",e.disabled="disabled",e.checked="checked",e["focus-within"]="focus-within",e["focus-visible"]="focus-visible"}(o||(o={}))},2758:function(e,t,n){n.d(t,{g:function(){return h}});var o,i,s,r=n(503348),a=n(777460),c=n(918437),l=n(302503),d=n(395942),p=n(186338),u=n(85970);let h=(o=(0,l.inject)("positioningService"),i=class{constructor(){(0,a.Z)(this,d.Patcher,!0),(0,r.Z)(this,"positioningService",s,this),(0,a.Z)(this,"byId",{})}add(e){this.byId[e.id]=e}getIds(){return Object.keys(this.byId)}getIdsInOrder(){return this.positioningService.orderEntities({entitiyCollection:this.byId})}getIdsOrderedByPageName(){return Object.keys(this.byId).sort(((e,t)=>{const n=this.byId[e],o=this.byId[t],i=n.title,s=o.title;return i.localeCompare(s)}))}getOrderedDetailsPagesByPageName(){return this.getOrderedPagesOfTypeByPageName("cms-details-page")}getOrderedListingPagesByPageName(){return this.getOrderedPagesOfTypeByPageName("cms-listing-page")}getOrderedPagesOfTypeByPageName(e){return Object.values(this.byId).filter((t=>(null===t||void 0===t?void 0:t.type)===e)).sort(((e,t)=>{if(!e||!t)throw new Error("Could not sort pages as one of them was not found. ById should NEVER contain keys that have value undefined.");const n=e.title,o=t.title;return n.localeCompare(o)}))}getCollectionListPagesIds(){if(!this.byId)return[];return Object.values(this.byId).filter((e=>"cms-listing-page"===(null===e||void 0===e?void 0:e.type))).map((e=>null===e||void 0===e?void 0:e.id))}getDetailsListPagesIds(){if(!this.byId)return[];return Object.values(this.byId).filter((e=>"cms-details-page"===(null===e||void 0===e?void 0:e.type))).map((e=>null===e||void 0===e?void 0:e.id))}clonePage(e){const t=this.byId[e];if(!t)throw new Error("Could not clone CMS page as it was not found");return t.clone()}toJSON(){return{byId:Object.keys(this.byId).reduce(((e,t)=>{var n;return e[t]=null===(n=this.byId[t])||void 0===n?void 0:n.toJSON(),e}),{})}}fromJSON(e){this.byId={};const{byId:t={}}=e;if(!t||"object"!==typeof t)return;const n=Object.keys(t||{});let o="",i={};for(let s=0;s<n.length;s+=1)switch(o=n[s],i=t[o],i.type){case"cms-listing-page":this.byId[o]=(new u.i).fromJSON(i);break;case"cms-details-page":this.byId[o]=(new p.b).fromJSON(i);break;default:throw new Error(`Unknown page type ${i.type}`)}}applyPatch(e){const{pathArray:t,value:n}=e;2===t.length&&"byId"===t[0]&&(n?this.byId[t[1]]=(new p.b).fromJSON(n):delete this.byId[t[1]])}},s=(0,c.Z)(i.prototype,"positioningService",[o],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),i)},863111:function(e,t,n){n.d(t,{l4:function(){return l},Tb:function(){return d}});var o=n(777460),i=n(378888),s=n(395942),r=n(491463);function a(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function c(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?a(Object(n),!0).forEach((function(t){(0,o.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):a(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}let l;!function(e){e.OBJECT="object",e.ARRAY="array",e.STRING="string",e.NUMBER="number",e.BOOLEAN="boolean"}(l||(l={}));class d{constructor(e={}){(0,o.Z)(this,s.Patcher,!0),(0,o.Z)(this,"id",void 0),(0,o.Z)(this,"pos",void 0),(0,o.Z)(this,"rootNodeId",void 0),(0,o.Z)(this,"isHomePage",void 0),(0,o.Z)(this,"isFallbackPage",void 0),(0,o.Z)(this,"sectionIds",{}),(0,o.Z)(this,"usedComponents",{}),(0,o.Z)(this,"propDefinitions",void 0),(0,o.Z)(this,"stateDefinitions",void 0),(0,o.Z)(this,"aiGeneratedSummaries",void 0),(0,o.Z)(this,"isAIPage",void 0),(0,o.Z)(this,"removeFromCodeGeneration",void 0);const{id:t,rootNodeId:n,isHomePage:r,isFallbackPage:a,sectionIds:c,propDefinitions:l,stateDefinitions:d,usedComponents:p,isAIPage:u=!1,aiGeneratedSummaries:h,pos:y,removeFromCodeGeneration:m=!1}=e;this.id=null!==t&&void 0!==t?t:(0,i.Ox)(),this.pos=null!==y&&void 0!==y?y:"0",this.rootNodeId=n,this.isHomePage=r||!1,this.isFallbackPage=a||!1,this.sectionIds=c||{},this.usedComponents=p||{},this.propDefinitions=l||{},this.stateDefinitions=d||{},this.aiGeneratedSummaries=h||{},this.isAIPage=u,this.removeFromCodeGeneration=m}fromJSON(e){const{id:t,rootNodeId:n,isHomePage:o,sectionIds:i,usedComponents:s,pos:r,propDefinitions:a,stateDefinitions:c,isFallbackPage:l,aiGeneratedSummaries:d,isAIPage:h=!1,removeFromCodeGeneration:y=!1}=e;return this.id=t,this.isHomePage=o,this.rootNodeId=n,this.pos=r,this.sectionIds=i||{},this.usedComponents=s||{},this.isFallbackPage=l,this.aiGeneratedSummaries=d,this.isAIPage=h,this.removeFromCodeGeneration=y,this.propDefinitions=p(a),this.stateDefinitions=u(c),this}createPropDefinition(e){const{name:t,defaultValue:n,type:o=l.OBJECT}=e;this.propDefinitions||(this.propDefinitions={});const s=Object.values(this.propDefinitions||{}).map((e=>e.name)),a=(0,r.Zu)(s,t),c={id:(0,i.Ox)(),name:a,defaultValue:n,type:o};return this.propDefinitions||(this.propDefinitions={}),this.propDefinitions[c.id]=c,c}createStateDefinition(e){this.stateDefinitions||(this.stateDefinitions={});const{name:t,defaultValue:n,type:o}=e,s=Object.values(this.stateDefinitions||{}).map((e=>e.name)),a=(0,r.Zu)(s,t),c={id:(0,i.Ox)(),name:a,defaultValue:n,type:o};return this.stateDefinitions[c.id]=c,c}toJSON(){return{id:this.id,pos:this.pos,isAIPage:this.isAIPage,isHomePage:this.isHomePage,rootNodeId:this.rootNodeId,sectionIds:this.sectionIds,usedComponents:this.usedComponents,isFallbackPage:this.isFallbackPage,propDefinitions:this.propDefinitions,stateDefinitions:this.stateDefinitions,aiGeneratedSummaries:this.aiGeneratedSummaries,removeFromCodeGeneration:this.removeFromCodeGeneration}}applyPatch(e){const{pathArray:t,value:n,op:o}=e;switch(t[0]){case"isHomePage":return void(this.isHomePage=n);case"isFallbackPage":return void(this.isFallbackPage=n);case"rootNodeId":return void(this.rootNodeId=n);case"pos":return void(this.pos=n);case"sectionIds":if(1===t.length)return void(this.sectionIds=n);if(2===t.length){if("add"===o||"replace"===o)return void(this.sectionIds[t[1]]=n);"remove"===o&&delete this.sectionIds[t[1]]}return;case"propDefinitions":return void this.processPropDefinitionPatch(e);case"stateDefinitions":return void this.processStateDefinitionPatch(e);case"usedComponents":if(1===t.length)return void(this.usedComponents=n);if(2===t.length){if("add"===o||"replace"===o)return void(this.usedComponents[t[1]]=n);"remove"===o&&delete this.usedComponents[t[1]]}return;case"ignoreFromCodeGeneration":return void(this.removeFromCodeGeneration=n);default:return}}processPropDefinitionPatch(e){const{pathArray:t,op:n,value:o}=e;if(1!==t.length){if(2===t.length){if("add"===n||"replace"===n)return void(this.propDefinitions[t[1]]=o);if("remove"===n)return void delete this.propDefinitions[t[1]]}}else this.propDefinitions=o}processStateDefinitionPatch(e){const{pathArray:t,op:n,value:o}=e;if(1!==t.length){if(2===t.length){if("add"===n||"replace"===n)return void(this.stateDefinitions[t[1]]=o);if("remove"===n)return void delete this.stateDefinitions[t[1]]}}else this.stateDefinitions=o}}const p=e=>Object.keys(e||{}).reduce(((t,n)=>(t[n]=c({},e[n]),t)),{}),u=e=>Object.keys(e||{}).reduce(((t,n)=>(t[n]=c({},e[n]),t)),{})},186338:function(e,t,n){n.d(t,{b:function(){return c}});var o=n(777460),i=n(863111),s=n(491463);function r(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function a(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?r(Object(n),!0).forEach((function(t){(0,o.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):r(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}class c extends i.Tb{constructor(e={}){super(e),(0,o.Z)(this,"type","cms-details-page"),(0,o.Z)(this,"title",void 0),(0,o.Z)(this,"settings",void 0),(0,o.Z)(this,"contentType",void 0),(0,o.Z)(this,"cmsDetailsPageAttributeDifferentiator",void 0),(0,o.Z)(this,"mainNodeId",void 0);const{title:t="",settings:n,contentType:i,mainNodeId:s,cmsDetailsPageAttributeDifferentiator:r}=e;this.title=t,this.settings=n||{},this.contentType=i,this.mainNodeId=s,this.cmsDetailsPageAttributeDifferentiator=r}create(e){return new c(a({},e))}getStaticUrl(){var e;const t=null===(e=this.settings.staticUrl)||void 0===e?void 0:e.content;if("string"!==typeof t&&"undefined"!==typeof t)throw new Error("An initialised details page URL must always be a string!");return t}generateStaticUrl(e){const t=e[this.contentType];return t?(0,s.N0)(t.name):""}clone(){return new c({title:this.title,rootNodeId:this.rootNodeId,isHomePage:!1,settings:JSON.parse(JSON.stringify(this.settings)),sectionIds:{},usedComponents:JSON.parse(JSON.stringify(this.usedComponents)),contentType:this.contentType,mainNodeId:this.mainNodeId,cmsDetailsPageAttributeDifferentiator:this.cmsDetailsPageAttributeDifferentiator})}fromJSON(e){super.fromJSON(e);const{title:t,settings:n,contentType:o,mainNodeId:i,cmsDetailsPageAttributeDifferentiator:s}=e;return this.title=t,this.settings=n,this.contentType=o,this.mainNodeId=i,this.cmsDetailsPageAttributeDifferentiator=s,this}toJSON(){return a(a({},super.toJSON()),{},{type:this.type,title:this.title,settings:this.settings,contentType:this.contentType,mainNodeId:this.mainNodeId,cmsDetailsPageAttributeDifferentiator:this.cmsDetailsPageAttributeDifferentiator})}applyPatch(e){super.applyPatch(e);const{pathArray:t,value:n}=e;switch(t[0]){case"title":return void(this.title=n.toString());case"contentType":return void(this.contentType=n);case"cmsDetailsPageMainNodeId":return void(this.mainNodeId=n);case"cmsDetailsPageAttributeDifferentiator":return void(this.cmsDetailsPageAttributeDifferentiator=n);case"settings":return 1===t.length&&(this.settings=n),void(2===t.length&&(this.settings=a(a({},this.settings),{},{[t[1]]:n})));default:return}}}},85970:function(e,t,n){n.d(t,{i:function(){return c}});var o=n(777460),i=n(863111),s=n(491463);function r(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function a(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?r(Object(n),!0).forEach((function(t){(0,o.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):r(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}class c extends i.Tb{constructor(e={}){super(e),(0,o.Z)(this,"type","cms-listing-page"),(0,o.Z)(this,"title",void 0),(0,o.Z)(this,"settings",void 0),(0,o.Z)(this,"contentType",void 0),(0,o.Z)(this,"mainNodeId",void 0);const{title:t="",mainNodeId:n="",settings:i,contentType:s=""}=e;this.title=t,this.settings=i||{},this.contentType=s,this.mainNodeId=n}create(e){return new c(a({},e))}getStaticUrl(){return this.settings.url}generateStaticUrl(e){const t=e[this.contentType];return t?(0,s.N0)(t.name):""}clone(){return new c({title:this.title,rootNodeId:this.rootNodeId,isHomePage:!1,settings:JSON.parse(JSON.stringify(this.settings)),sectionIds:{},mainNodeId:this.mainNodeId,usedComponents:JSON.parse(JSON.stringify(this.usedComponents)),contentType:this.contentType})}fromJSON(e){super.fromJSON(e);const{title:t,settings:n,contentType:o,mainNodeId:i}=e;return this.title=t,this.settings=n,this.contentType=o,this.mainNodeId=i,this}toJSON(){return a(a({},super.toJSON()),{},{type:this.type,title:this.title,settings:this.settings,contentType:this.contentType,mainNodeId:this.mainNodeId})}applyPatch(e){super.applyPatch(e);const{pathArray:t,value:n}=e;switch(t[0]){case"title":return void(this.title=n);case"contentType":return void(this.contentType=n);case"settings":return 1===t.length&&(this.settings=n),void(2===t.length&&(this.settings=a(a({},this.settings),{},{[t[1]]:n})));default:return}}}},142678:function(e,t,n){n.d(t,{m:function(){return c}});var o=n(777460),i=n(863111),s=n(491463);function r(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function a(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?r(Object(n),!0).forEach((function(t){(0,o.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):r(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}class c extends i.Tb{constructor(e={}){super(e),(0,o.Z)(this,"type","project-page"),(0,o.Z)(this,"title",void 0),(0,o.Z)(this,"settings",void 0);const{title:t="",settings:n}=e;this.title=t,this.settings=n||{}}get resolvedUrl(){return this.settings.url?this.settings.url:this.isHomePage?"/":`/${(0,s.N0)(this.title)}`}create(e){return new c(a({},e))}clone(){return new c({title:this.title,rootNodeId:this.rootNodeId,isHomePage:!1,settings:JSON.parse(JSON.stringify(this.settings)),sectionIds:{},usedComponents:JSON.parse(JSON.stringify(this.usedComponents))})}fromJSON(e){super.fromJSON(e);const{title:t,settings:n}=e;return this.title=t,this.settings=n,this}toJSON(){return a(a({},super.toJSON()),{},{type:this.type,title:this.title,settings:this.settings})}applyPatch(e){super.applyPatch(e);const{pathArray:t,value:n}=e;switch(t[0]){case"title":return void(this.title=n);case"settings":return 1===t.length&&(this.settings=n),void(2===t.length&&(this.settings=a(a({},this.settings),{},{[t[1]]:n})));default:return}}}},37794:function(e,t,n){n.d(t,{m8:function(){return a},aG:function(){return h},VM:function(){return y},fE:function(){return m}});var o=n(523689),i=n(694829),s=n(555362),r=n(233475);const a=[{id:(0,n(378888).Ox)(),name:"Teleport Default Classes",isDefault:!0}],c="button",l="input",d="textarea",p="list",u="list-item",h="teleport-show",y={[r.sO.BUTTON]:c,[r.Pu.CMS_NAVIGATION_BUTTON]:c,[r.sO.TEXTINPUT]:l,[r.sO.TEXTAREA]:d,[r.sO.LIST]:p,[r.sO.LISTITEM]:u},m=e=>{const t=Object.values(e.tokensById||{}).find((e=>"background-color"===e.role)),n=Object.values(e.tokensById||{}).find((e=>"foreground-color"===e.role)),r={},a={display:new o.F({content:"inline-block"}),backgroundColor:t?new s.P({content:{referenceType:"token",id:t.id}}):new o.F({content:i.d3.backgroundColor}),color:n?new s.P({content:{referenceType:"token",id:n.id}}):new o.F({content:i.d3.color}),borderRadius:new o.F({content:i.d3.borderRadius}),borderColor:n?new s.P({content:{referenceType:"token",id:n.id}}):new o.F({content:i.d3.primaryColor}),borderWidth:new o.F({content:i.d3.borderWidth}),padding:new o.F({content:"0.5rem 1rem"})};r.button=a;const c={backgroundColor:t?new s.P({content:{referenceType:"token",id:t.id}}):new o.F({content:i.d3.backgroundColor}),borderColor:n?new s.P({content:{referenceType:"token",id:n.id}}):new o.F({content:i.d3.primaryColor}),color:n?new s.P({content:{referenceType:"token",id:n.id}}):new o.F({content:i.d3.color}),borderWidth:new o.F({content:i.d3.borderWidth}),borderRadius:new o.F({content:i.d3.borderRadius}),padding:new o.F({content:"0.5rem 1rem"}),cursor:new o.F({content:"auto"})};r.input=c;const l={backgroundColor:t?new s.P({content:{referenceType:"token",id:t.id}}):new o.F({content:i.d3.backgroundColor}),borderColor:n?new s.P({content:{referenceType:"token",id:n.id}}):new o.F({content:i.d3.primaryColor}),color:n?new s.P({content:{referenceType:"token",id:n.id}}):new o.F({content:i.d3.color}),borderWidth:new o.F({content:i.d3.borderWidth}),borderRadius:new o.F({content:i.d3.borderRadius}),padding:new o.F({content:"0.5rem"}),cursor:new o.F({content:"auto"})};r.textarea=l;const d={display:new o.F({content:"block"}),listStyleType:new o.F({content:"none"}),listStylePosition:new o.F({content:"outside"}),margin:new o.F({content:"1em 0px 1em 0px"}),padding:new o.F({content:"0px 0px 0px 1.5rem"}),width:new o.F({content:"100%"})};r.list=d;const p={display:new o.F({content:"list-item"})};r["list-item"]=p;const u={display:new o.F({content:"flex !important"}),transform:new o.F({content:"none !important"})};return r[h]=u,r}},101802:function(e,t,n){n.d(t,{C:function(){return m}});var o=n(777460),i=n(378888),s=n(395942),r=n(555362),a=n(523689),c=n(761328),l=n(971162),d=n(825504),p=n(989993),u=n(120998);function h(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function y(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?h(Object(n),!0).forEach((function(t){(0,o.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):h(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}class m{constructor(e){(0,o.Z)(this,s.Patcher,void 0),(0,o.Z)(this,"id",void 0),(0,o.Z)(this,"type","reusable-project-style-map"),(0,o.Z)(this,"pos",void 0),(0,o.Z)(this,"conditions",{}),(0,o.Z)(this,"content",{}),(0,o.Z)(this,"linkedTextStyles",{}),(0,o.Z)(this,"categoryId",void 0);const{id:t,conditions:n={},content:r={},categoryId:a,pos:c,linkedTextStyles:l={}}=e||{};this.id=t||(0,i.Ox)(),this.linkedTextStyles=l,this.conditions=n,this.content=r,this.categoryId=a,this.pos=c}addPropertyToContent(e){const{key:t,value:n,tokenId:o}=e;this.content[t]=o?new r.P({content:{referenceType:"token",id:o}}):new a.F({content:n})}addPropertyToMediaCondition(e){const{key:t,value:n,tokenId:o,viewPort:s}=e,c=Object.values(this.conditions).find((e=>"screen-size"===e.type&&e.meta.maxWidth===s));if(c)this.conditions[c.id].content[t]=o?new r.P({content:{referenceType:"token",id:o}}):new a.F({content:n});else{const e={id:(0,i.Ox)(),type:"screen-size",meta:{maxWidth:Number(s)},content:{[t]:o?new r.P({content:{referenceType:"token",id:o}}):new a.F({content:n})}};this.conditions[e.id]=e}}addPropertyToStateCondition(e){const{key:t,value:n,tokenId:o,identifier:s}=e,c=Object.values(this.conditions).find((e=>"element-state"===e.type&&e.meta.state===s));if(c)this.conditions[c.id].content[t]=o?new r.P({content:{referenceType:"token",id:o}}):new a.F({content:n});else{const e={id:(0,i.Ox)(),type:"element-state",meta:{state:s},content:{[t]:o?new r.P({content:{referenceType:"token",id:o}}):new a.F({content:n})}};this.conditions[e.id]=e}}deletePropertyByKey(e,t){var n;const o=null===(n=this.content[e])||void 0===n?void 0:n.content;"string"===typeof o&&u.H.includes(e)&&(0,p.BQ)(o).forEach((e=>{var n;return null===(n=t.byId[e])||void 0===n?void 0:n.removeClassRelation(this.id)})),delete this.content[e]}deletePropertyFromMediaCondition(e,t,n){const o=Object.values(this.conditions).find((e=>"screen-size"===e.type&&e.meta.maxWidth===t));if(!o)return;const i=this.conditions[o.id].content[e];"string"===typeof i&&u.H.includes(e)&&(0,p.BQ)(i).forEach((e=>{var t;return null===(t=n.byId[e])||void 0===t?void 0:t.removeClassRelation(this.id)})),delete this.conditions[o.id].content[e]}deletePropertyFromStateCondition(e,t,n){const o=Object.values(this.conditions).find((e=>"element-state"===e.type&&e.meta.state===t));if(!o)return;const i=this.conditions[o.id].content[e];"string"===typeof i&&u.H.includes(e)&&(0,p.BQ)(i).forEach((e=>{var t;return null===(t=n.byId[e])||void 0===t?void 0:t.removeClassRelation(this.id)})),delete this.conditions[o.id].content[e]}togglePropertyByKey(e){this.content[e].content&&(this.content[e].disabled=!this.content[e].disabled)}togglePropertyFromMediaCondition(e,t){const n=Object.values(this.conditions).find((e=>"screen-size"===e.type&&e.meta.maxWidth===t));n&&(this.conditions[n.id].content[e].disabled=!this.conditions[n.id].content[e].disabled)}togglePropertyFromStateCondition(e,t){const n=Object.values(this.conditions).find((e=>"element-state"===e.type&&e.meta.state===t));n&&(this.conditions[n.id].content[e].disabled=!this.conditions[n.id].content[e].disabled)}getStateConditions(){return Object.values(this.conditions||{}).reduce(((e,t)=>("element-state"===t.type&&(e[t.id]=t),e)),{})}getMissingStates(){const e=new Set(Object.values(c.F));return Object.values(this.conditions||{}).forEach((t=>{"element-state"===t.type&&e.has(t.meta.state)&&e.delete(t.meta.state)})),Array.from(e)}getMatchedScreenSizeStyleSetIds(e){return(0,l.I2)(this.conditions,e)}toUIDL(e,t,n){return{type:"reusable-project-style-map",content:(0,d.q)(this.content||{},t,n),conditions:Object.values(this.conditions||{}).reduce(((e,o)=>{if("screen-size"===o.type){const i={type:"screen-size",content:(0,d.q)(o.content||{},t,n),meta:{maxWidth:Number(o.meta.maxWidth)}};e.push(i)}if("element-state"===o.type){const i={type:"element-state",content:(0,d.q)(o.content||{},t,n),meta:{state:o.meta.state}};e.push(i)}return e}),[])}}toJSON(){return{id:this.id,type:this.type,conditions:this.conditions,content:this.content,categoryId:this.categoryId,linkedTextStyles:this.linkedTextStyles,pos:this.pos}}fromJSON(e){const{id:t,conditions:n={},content:o={},categoryId:i,pos:s,linkedTextStyles:r={}}=e;return this.id=t,this.categoryId=i||"",this.type="reusable-project-style-map",this.pos=s,this.linkedTextStyles=r,this.content=this.mapOverStyles(o),this.conditions=this.mapOverConditions(n),this}mapOverStyles(e){return Object.keys(e||{}).reduce(((t,n)=>{const o=e[n];return"static"===o.type&&(t[n]=new a.F(y({},o))),"dynamic"===o.type&&(t[n]=new r.P(y({},o))),t}),{})}cloneConditions(e,t){return Object.values(e||{}).reduce(((e,n)=>{switch(n.type){case"screen-size":{const o={id:(0,i.Ox)(),type:"screen-size",content:this.cloneStylesObject(n.content,t),meta:{maxWidth:n.meta.maxWidth}};e[o.id]=o;break}case"element-state":{const o={id:(0,i.Ox)(),type:"element-state",content:this.cloneStylesObject(n.content,t),meta:{state:n.meta.state}};e[o.id]=o;break}}return e}),{})}cloneStylesObject(e,t){return Object.keys(e||{}).reduce(((n,o)=>{const i=e[o];return n[o]=i.clone(),t&&"dynamic"===i.type&&"token"===i.content.referenceType&&(t[i.content.id]?t[i.content.id]++:t[i.content.id]=1),n}),{})}mapOverConditions(e){return e.reduce(((e,t)=>{const n=(0,i.Ox)();if("screen-size"===t.type){const o={id:n,type:t.type,content:this.mapOverStyles(t.content),meta:{maxWidth:t.meta.maxWidth}};e[n]=o}if("element-state"===t.type){const o={id:n,type:t.type,content:this.mapOverStyles(t.content),meta:{state:t.meta.state}};e[n]=o}return e}),{})}applyPatch(e){const{op:t,pathArray:n,value:o}=e;switch(n[0]){case"content":return"add"===t&&2===n.length&&n[1].length>0?void(this.content[n[1]]=(0,l.KC)(e.value)):("remove"===t&&2===n.length&&delete this.content[n[1]],"replace"===t&&1===n.length&&o&&(this.content=(0,l.bb)(o)),void("replace"===t&&2===n.length&&o&&(this.content[n[1]]=(0,l.KC)(o))));case"linkedTextStyles":return"add"===t&&2===n.length?void(this.linkedTextStyles[n[1]]=!0):void("remove"===t&&2===n.length&&delete this.linkedTextStyles[n[1]]);case"conditions":if("add"===t&&2===n.length){const t=e.value;return void(this.conditions[t.id]=y(y({},t),{},{content:(0,l.bb)(t.content)}))}if("add"===t&&4===n.length)return void(this.conditions[n[1]].content[n[3]]=(0,l.KC)(e.value));if("remove"===t&&4===n.length)return void delete this.conditions[n[1]].content[n[3]];if("replace"===t&&3===n.length&&o)return void(this.conditions[n[1]].content=(0,l.bb)(o));if("replace"===t&&4===n.length&&o)return void(this.conditions[n[1]].content[n[3]]=(0,l.KC)(o));case"categoryId":if("add"===t||"replace"===t)return void(this.categoryId=o);if("remove"===t)return void(this.categoryId="");default:return}}}},197488:function(e,t,n){n.d(t,{a:function(){return c}});var o=n(777460),i=n(395942),s=n(101802);function r(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function a(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?r(Object(n),!0).forEach((function(t){(0,o.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):r(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}class c extends s.C{getName(e){return`${e[this.rootClassId].getName(e)}${this.getSubselectors(!0)}`}getRootClassName(e){return e[this.rootClassId].getName(e)}getSubselectors(e){return`${![".",":"].includes(this.subselectors[0])&&e?" ":""}${this.subselectors}`}getIdentifier(e){const t=e[this.rootClassId],n=this.getSubselectors(!0);if(n.startsWith(".")){const o=Object.values(e).find((e=>"simple"===e.classType&&n.includes(e.getName())));if(o&&"simple"===o.classType){if(o.getName()===n.replace(".",""))return`${t.getIdentifier(e)}.${o.getIdentifier()}`;const i=n.replace(o.getName(),"").replace(".","");return`${t.getIdentifier(e)}.${o.getIdentifier()}${i}`}}return`${t.getIdentifier(e)}${this.getSubselectors(!0)}`}constructor(e){var t,n;super(e),(0,o.Z)(this,i.Patcher,void 0),(0,o.Z)(this,"isDefault",!1),(0,o.Z)(this,"rootClassId",void 0),(0,o.Z)(this,"subselectors",void 0),(0,o.Z)(this,"classType","compound"),this.subselectors=null!==(t=null===e||void 0===e?void 0:e.subselectors)&&void 0!==t?t:"",this.rootClassId=null!==(n=null===e||void 0===e?void 0:e.rootClassId)&&void 0!==n?n:""}updateSubselectors(e){this.subselectors=e}updateRootClassId(e){this.rootClassId=e}clone(){const e=this.cloneStylesObject(this.content),t=this.cloneConditions(this.conditions),n=a({},this.linkedTextStyles);return new c({pos:"",content:e,conditions:t,linkedTextStyles:n,categoryId:this.categoryId,rootClassId:this.rootClassId,subselectors:this.subselectors})}toUIDL(e,t,n){const o=super.toUIDL(e,t,n);return o.className=this.getRootClassName(e),o.subselectors=this.getSubselectors(!0),o}toJSON(){return a(a({},super.toJSON()),{},{classType:this.classType,subselectors:this.subselectors,rootClassId:this.rootClassId})}fromJSON(e){super.fromJSON(e);const{subselectors:t,rootClassId:n}=e;return this.subselectors=t,this.rootClassId=n,this}applyPatch(e){super.applyPatch(e);const{op:t,pathArray:n,value:o}=e;switch(n[0]){case"subselectors":return"add"!==t&&"replace"!==t||(this.subselectors=o),void("remove"===t&&(this.subselectors=""));case"rootClassId":if("add"===t||"replace"===t)return void(this.rootClassId=o);"remove"===t&&(this.rootClassId="")}}}},328681:function(e,t,n){n.d(t,{J:function(){return l}});var o=n(777460),i=n(378888),s=n(395942),r=n(101802);function a(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function c(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?a(Object(n),!0).forEach((function(t){(0,o.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):a(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}class l extends r.C{constructor(e){var t;super(e),(0,o.Z)(this,s.Patcher,void 0),(0,o.Z)(this,"name",void 0),(0,o.Z)(this,"identifier",void 0),(0,o.Z)(this,"usedInNodes",{}),(0,o.Z)(this,"disabledInNodes",{}),(0,o.Z)(this,"isDefault",void 0),(0,o.Z)(this,"classType","simple"),this.usedInNodes=null!==(t=null===e||void 0===e?void 0:e.usedInNodes)&&void 0!==t?t:{},this.disabledInNodes=null===e||void 0===e?void 0:e.disabledInNodes,this.name=(null===e||void 0===e?void 0:e.name)||"",this.identifier=(0,i.Ky)(this.name),this.isDefault=(null===e||void 0===e?void 0:e.isDefault)||!1}getIdentifier(){return this.identifier}getName(){return this.name}clone(e){const t=this.cloneStylesObject(this.content),n=this.cloneConditions(this.conditions),o=c({},this.linkedTextStyles);return new l({pos:"",content:t,conditions:n,name:e||(0,i.Ky)(this.name),linkedTextStyles:o,categoryId:this.categoryId})}updateName(e){this.name=e}toJSON(){return c(c({},super.toJSON()),{},{name:this.name,isDefault:this.isDefault,usedInNodes:this.usedInNodes,identifier:this.identifier,classType:this.classType})}fromJSON(e){super.fromJSON(e);const{name:t,usedInNodes:n={},disabledInNodes:o,isDefault:s}=e;return this.usedInNodes=JSON.parse(JSON.stringify(n)),this.name=t,this.identifier=(0,i.Ky)(t),this.isDefault=s,this.disabledInNodes=o,this}applyPatch(e){super.applyPatch(e);const{op:t,pathArray:n,value:o}=e;switch(n[0]){case"name":return"add"!==t&&"replace"!==t||(this.name=o),void("remove"===t&&(this.name=""));case"usedInNodes":if("add"===t&&2===n.length)return void(this.usedInNodes[n[1]]=!0);"remove"===t&&2===n.length&&delete this.usedInNodes[n[1]]}}}},333408:function(e,t,n){let o,i;n.d(t,{B:function(){return o},E:function(){return i}}),function(e){e.ADDING="adding",e.SUCCESS="success",e.FAILED="failed"}(o||(o={})),function(e){e.ADDED="added",e.NEW="new",e.MODIFIED="modified",e.REMOVED="removed",e.STAGED="staged",e.RENAMED="renamed",e.CONFLICT="conflict",e.RESOLVED="resolved"}(i||(i={}))},698156:function(e,t,n){n.d(t,{f:function(){return w}});var o=n(777460),i=n(395942),s=n(378888),r=n(830195);let a,c,l;!function(e){e.GET="GET",e.POST="POST",e.PUT="PUT",e.PATCH="PATCH",e.DELETE="DELETE",e.OPTIONS="OPTIONS",e.TRACE="TRACE"}(a||(a={})),function(e){e.NO_AUTH="NO_AUTH",e.API_KEY="API_KEY",e.BEARER="BEARER",e.BASIC="BASIC"}(c||(c={})),function(e){e.NONE="NONE",e.FORM_DATA="FORM_DATA",e.X_WWW_FORM_URLENCODED="X_WWW_FORM_URLENCODED",e.RAW="RAW",e.GRAPH_QL="GRAPH_QL"}(l||(l={}));const d=r.z.object({type:r.z.literal(c.NO_AUTH)}),p=r.z.object({type:r.z.literal(c.API_KEY),key:r.z.string(),value:r.z.string(),addTo:r.z.enum(["Header","Query"])}),u=r.z.object({type:r.z.literal(c.BEARER),token:r.z.string()}),h=r.z.object({type:r.z.literal(c.BASIC),username:r.z.string(),password:r.z.string()}),y=r.z.object({type:r.z.literal(l.NONE)}),m=r.z.object({type:r.z.literal(l.FORM_DATA),data:r.z.record(r.z.string())}),f=r.z.object({type:r.z.literal(l.X_WWW_FORM_URLENCODED),data:r.z.record(r.z.string())}),g=r.z.object({type:r.z.literal(l.RAW),data:r.z.string()}),_=r.z.object({type:r.z.literal(l.GRAPH_QL),query:r.z.string(),variables:r.z.string()}),b=r.z.discriminatedUnion("type",[d,p,u,h]),I=r.z.discriminatedUnion("type",[y,m,f,g,_]);r.z.object({url:r.z.string(),method:r.z.nativeEnum(a).optional(),headers:r.z.record(r.z.string()).optional(),query:r.z.record(r.z.string()).optional(),timeout:r.z.number().optional(),authentication:b.optional(),body:I.optional()});class v{constructor(e){(0,o.Z)(this,i.Patcher,!0),(0,o.Z)(this,"id",void 0),(0,o.Z)(this,"url",void 0),(0,o.Z)(this,"method",void 0),(0,o.Z)(this,"headers",void 0),(0,o.Z)(this,"query",void 0),(0,o.Z)(this,"authentication",void 0),(0,o.Z)(this,"body",void 0),(0,o.Z)(this,"usedInNodes",void 0);const{id:t,url:n,method:r=a.GET,headers:c,query:l,authentication:d,body:p,usedInNodes:u={}}=e;this.id=null!==t&&void 0!==t?t:(0,s.Ox)(),this.url=n,this.method=r,this.headers=c,this.query=l,this.authentication=d,this.body=p,this.usedInNodes=u}toJSON(){return{id:this.id,url:this.url,method:this.method,headers:this.headers,query:this.query,authentication:this.authentication,usedInNodes:this.usedInNodes}}fromJSON(e){const{id:t,url:n,method:o,headers:i,query:s,authentication:r,usedInNodes:a}=e;return this.id=t,this.url=n,this.method=o,this.headers=i,this.query=s,this.authentication=r,this.usedInNodes=a,this}applyPatch(){}}class w{constructor(){(0,o.Z)(this,i.Patcher,!0),(0,o.Z)(this,"byId",{})}add(e){this.byId[e.id]=e}toJSON(){return{byId:Object.keys(this.byId).reduce(((e,t)=>(e[t]=this.byId[t].toJSON(),e)),{})}}fromJSON(e){this.byId={};const{byId:t={}}=e;t&&"object"===typeof t&&Object.keys(t).forEach((e=>{this.byId[e]=new v(t[e])}))}}},432322:function(e,t,n){n.d(t,{T:function(){return r}});var o=n(777460),i=n(378888);function s(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}const r=new class{constructor(){(0,o.Z)(this,"execute",(e=>{const{doc:t,targetNodeId:n,styles:r}=e;return Object.keys(r||{}).reduce(((e,a)=>{const c=r[a],{type:l,content:d}=c;if("style-map"===l&&"inlined"===d.mapType){const r=d.conditions.map((e=>function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?s(Object(n),!0).forEach((function(t){(0,o.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):s(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},e))),a=(0,i.Ox)();e[a]={id:a,type:"style-map",content:{mapType:"inlined",conditions:r,styles:Object.keys(d.styles||{}).reduce(((e,o)=>{const i=d.styles[o];if("static"===i.type&&(e[o]=i.clone(),"fontFamily"===o&&n)){const o=t.fonts.getFontByName(i.content);if(!o)return e;t.fonts.byId[o.id].usedInNodes[n]?t.fonts.byId[o.id].usedInNodes[n]+=1:t.fonts.byId[o.id].usedInNodes[n]=1}if("dynamic"===i.type&&(e[o]=i.clone(),"token"===i.content.referenceType&&i.content.id&&n)){const o=t.designLanguage.tokensById[i.content.id];if(!o)return e;o.usedInNodes[n]?o.usedInNodes[n]++:o.usedInNodes[n]=1}return e}),{})}}}if("style-map"===l&&"design-language-referenced"===d.mapType){const o=(0,i.Ox)();e[o]={id:o,type:"style-map",content:{mapType:"design-language-referenced",referenceId:d.referenceId}};const s=t.designLanguage.textStyleSetsById[d.referenceId];if(!s||!n)return e;s.usedInNodes[n]=!0}if("style-map"===l&&"project-referenced"===d.mapType){const o=d.referenceId;e[o]={id:o,type:"style-map",content:{mapType:"project-referenced",referenceId:d.referenceId}};const i=t.classes.byId[d.referenceId];if(!i||!n||!("usedInNodes"in i))return e;i.usedInNodes[n]=!0}return"style-map"===l&&"component-referenced"===d.mapType&&"static"===d.content.type&&(e[a]=c),e}),{})}))}};Object.freeze(r)},231545:function(e,t,n){n.d(t,{l:function(){return s}});var o=n(777460),i=n(432322);const s=new class{constructor(){(0,o.Z)(this,"execute",(e=>{const{doc:t,targetNodeId:n,nodeId:o}=e;if(!t)return null;const s=t.nodes.getById(o);if(!s)throw new Error("Node to clone referencedStyles is missing");if(!("referencedStyles"in s))throw new Error("Node does not have referencedStyles abilities");return i.T.execute({targetNodeId:n,styles:s.referencedStyles,doc:t})}))}};Object.freeze(s)},140278:function(e,t,n){n.d(t,{l:function(){return o}});const o=new class{execute(e){const{styles:t,targetNodeId:n,doc:o}=e;return Object.keys(t||{}).reduce(((e,i)=>{const s=t[i];if("static"===s.type&&s.content&&(e[i]=s.clone(),"fontFamily"===i&&n)){const t=o.fonts.getFontByName(s.content.toString());if(!t)return e;o.fonts.byId[t.id].usedInNodes[n]?o.fonts.byId[t.id].usedInNodes[n]+=1:o.fonts.byId[t.id].usedInNodes[n]=1}if("dynamic"===s.type&&(e[i]=s.clone(),"token"===s.content.referenceType&&s.content.id&&n)){const t=o.designLanguage.tokensById[s.content.id];if(!t)return e;t.usedInNodes[n]?t.usedInNodes[n]++:t.usedInNodes[n]=1}return e}),{})}};Object.freeze(o)},107547:function(e,t,n){n.d(t,{S:function(){return s}});var o=n(777460),i=n(140278);const s=new class{constructor(){(0,o.Z)(this,"execute",(e=>{const{nodeId:t,doc:n,targetNodeId:o}=e,s=n.nodes.getById(t);if(!s)throw new Error("Source node is missing");if(!("styles"in s))throw new Error("Node does not have styles abilities");return i.l.execute({styles:s.styles,targetNodeId:o,doc:n})}))}};Object.freeze(s)},134055:function(e,t,n){n.d(t,{X:function(){return d}});var o=n(777460),i=n(930613),s=n(278702),r=n(813244),a=n(523689),c=n(81359),l=n(555362);const d=new class{constructor(){(0,o.Z)(this,"execute",(e=>{const{node:t,propId:n,propDefinition:o,newValue:i,doc:d}=e;d&&Object.values(o.locations).forEach((e=>{Object.values(e).forEach((e=>{var p;const{base:u,sufix:h}=e;switch(u){case r.hD.CONTENT:const e="contentChildren"in t?t.contentChildren:void 0;if(!e)return;Object.keys(e).forEach((t=>{const s=e[t];if((!h||t===h)&&"dynamic"===s.type)if("locale"!==(null===i||void 0===i?void 0:i.referenceType)){if(s.content.id===n){const n=(0,c.PJ)(o,d);if(!n)return void(e[t]=new a.F({content:i,id:t}));const s=null===d||void 0===d?void 0:d.duplicateTranslationNodesByRef({translationRef:n});if(!s)return;e[t]=new l.P({id:t,content:{refPath:[s],referenceType:"locale",id:t}})}var r;if("dynamic"===s.type&&s.content.id===n)e[t]=new a.F({content:null!==(r=i)&&void 0!==r?r:(0,c.yO)(o,s.content.refPath),id:t})}else{var p;const n=null===(p=i.refPath)||void 0===p?void 0:p[0];if(!n)return;const o=d.duplicateTranslationNodesByRef({translationRef:n});if(!o)return;e[t]=new l.P({id:t,content:{refPath:[o],referenceType:"locale",id:t}})}}));break;case r.hD.ATTR:if(!("attrs"in t))return;Object.keys(null!==(p=t.attrs)&&void 0!==p?p:{}).forEach((e=>{const r=(0,s.Uq)(t,e);if((!h||e===h)&&r&&"dynamic"===r.type&&r.content.id===n&&("element-node"===t.type||"component-instance-node"===t.type||"cms-array-mapper"===t.type)){var l;if(!t.attrs)return;t.attrs[e]=new a.F({content:null!==(l=i)&&void 0!==l?l:(0,c.yO)(o,r.content.refPath)})}}));break;case r.hD.ABILITY:"abilities"in t&&Object.keys(t.abilities).forEach((e=>{const s=t.abilities[e],r=h;if(!(0,c.Lu)(s,r))return;const a=this.replaceDynamicAbilityWithStatic({ability:s,propId:n,staticValue:i,propDefinition:o});a&&(t.abilities[e]=a)}));break;case r.hD.STYLE:}}))}))})),(0,o.Z)(this,"replaceDynamicAbilityWithStatic",(e=>{const{ability:t,propId:n,propDefinition:o,staticValue:s}=e,{type:r,content:a}=t;if("string"!==typeof s)throw new Error("staticValue must be a string");switch(r){case i.RZ.URL:const e=a;"string"!==typeof e.url&&e.url.content.id===n&&(e.url=null!==s&&void 0!==s?s:(0,c.yO)(o,e.url.content.refPath).toString());break;case i.RZ.PHONE:const t=a,{phone:r}=t;"string"!==typeof r&&r.content.id===n&&(t.phone=null!==s&&void 0!==s?s:(0,c.yO)(o,r.content.refPath).toString());break;case i.RZ.MAIL:const l=a,{body:d,mail:p,subject:u}=l;"string"!==typeof d&&(null===d||void 0===d?void 0:d.content.id)===n&&(l.body=null!==s&&void 0!==s?s:(0,c.yO)(o,d.content.refPath).toString()),"string"!==typeof p&&p.content.id===n&&(l.mail=null!==s&&void 0!==s?s:(0,c.yO)(o,p.content.refPath).toString()),"string"!==typeof u&&(null===u||void 0===u?void 0:u.content.id)===n&&(l.subject=null!==s&&void 0!==s?s:(0,c.yO)(o,u.content.refPath).toString())}return t}))}};Object.freeze(d)},81359:function(e,t,n){n.d(t,{PJ:function(){return c},rZ:function(){return l},yO:function(){return d},Lu:function(){return p}});var o=n(930613),i=n(233475),s=n(378888),r=n(813244);const a={[i.RY.HEADING1]:"heading",[i.RY.HEADING2]:"heading",[i.RY.HEADING3]:"heading",[i.RY.HEADING4]:"heading",[i.RY.HEADING5]:"heading",[i.RY.HEADING6]:"heading"},c=(e,t)=>{let n=null;if("richtext"===e.type){var o,i;const s=null===t||void 0===t?void 0:t.nodes.getById(null!==(o=e.defaultHierarchyRootId)&&void 0!==o?o:""),r=null===t||void 0===t?void 0:t.nodes.getById(Object.keys(null!==(i=s.childrenIds)&&void 0!==i?i:{})[0]);n=null===r||void 0===r?void 0:r.getContentLangReferenceKey()}return n},l=e=>{const t=e.semanticType?a[e.semanticType]:e.semanticType;return{id:(0,s.Ox)(),name:(0,s.Y$)(e.name||t||e.primitiveType||"")||"new_prop",type:"string",inputType:r.SO.TEXT}},d=(e,t)=>{let n=e.defaultValue;if(null===t||void 0===t||!t.length)return n;for(const i of t){var o;n=(null===(o=n)||void 0===o?void 0:o[i])||n}return n},p=(e,t)=>{const{type:n}=e;return!!t&&(n!==o.RZ.NAVLINK&&n!==o.RZ.SECTION&&((n!==o.RZ.URL||"url"===t)&&((n!==o.RZ.PHONE||"phone"===t)&&!(n===o.RZ.MAIL&&"mail"!==t&&"subject"!==t))))}},932433:function(e,t,n){n.d(t,{K:function(){return w}});var o,i,s,r=n(777460),a=n(302503),c=n(503348),l=n(918437),d=n(412940),p=n(829470);let u=(o=(0,a.inject)("mediaQueryBreakpointManagementFlow"),i=class{constructor(e){(0,r.Z)(this,"pan",void 0),(0,r.Z)(this,"loaded",void 0),(0,r.Z)(this,"currentWidth",void 0),(0,r.Z)(this,"currentHeight",void 0),(0,r.Z)(this,"matchedBreakpoint",void 0),(0,r.Z)(this,"interactionState",{state:null}),(0,r.Z)(this,"mediaQueryModeEnabled",void 0),(0,r.Z)(this,"webComp",void 0),(0,r.Z)(this,"pagesAndComponentsScrollPosition",{}),(0,c.Z)(this,"mediaQueryBreakpointManagementFlow",s,this),(0,r.Z)(this,"getPercentageYForPixels",(e=>{const t=this.webComp.stateValues.logicalValues;return(0,p.iq)(e,t.minY,t.maxY)}));const{pan:t,loaded:n,webComp:o,currentWidth:i,currentHeight:a}=e||{pan:!1,loaded:!1,currentWidth:d.Bk,currentHeight:d.HN,webComp:JSON.parse(JSON.stringify(d.m7))};this.pan=t,this.loaded=n,this.webComp=o,this.setCurrentWidth(i),this.setCurrentHeight(a)}getCurrentWidth(){return this.currentWidth}setCurrentWidth(e){this.currentWidth=e;const t=this.mediaQueryBreakpointManagementFlow.getActiveMediaQueriesInOrder().filter((t=>e<=(null===t||void 0===t?void 0:t.maxWidth)))[0];this.mediaQueryModeEnabled=!(!t&&this.mediaQueryModeEnabled),this.matchedBreakpoint=null===t||void 0===t?void 0:t.id}getCurrentHeight(){return this.currentHeight}setCurrentHeight(e){this.currentHeight=e}setInteractionState(e,t){this.interactionState=e?{state:e,classId:t}:{state:null}}fromJSON(e){const{pan:t,loaded:n,currentWidth:o,currentHeight:i,webComp:s}=e;return this.loaded=n,this.pan=t,this.webComp=s,this.setCurrentWidth(o),this.setCurrentHeight(i),this.pagesAndComponentsScrollPosition=e.pagesAndComponentsScrollPosition,this}toJSON(){return{pan:this.pan,loaded:this.loaded,currentWidth:this.currentWidth,currentHeight:this.currentHeight,webComp:this.webComp,matchedBreakpoint:this.matchedBreakpoint,mediaQueryModeEnabled:this.mediaQueryModeEnabled}}},s=(0,l.Z)(i.prototype,"mediaQueryBreakpointManagementFlow",[o],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),i);var h,y=n(440516),m=n(84615),f=n(658358),g=n(851913),_=n(492080),b=n(329852),I=n(455245),v=n(901275);let w=(0,a.provide)("projectUIState")(h=class{constructor(){(0,r.Z)(this,"title",""),(0,r.Z)(this,"slug",""),(0,r.Z)(this,"teleportVercelAlias",""),(0,r.Z)(this,"projectAnalyticsConfig",{}),(0,r.Z)(this,"isAIProject",!1),(0,r.Z)(this,"AIProjectPrompts",[]),(0,r.Z)(this,"nodesHistory",{}),(0,r.Z)(this,"workspace",{id:"",slug:"",name:"",professionalSubscription:!1,subscriptionPlanType:null,payingSeats:0,projectsWithCMSEnabled:0,meta:{aiTextGenerationCount:0,codeGenerationCount:0,customDomainsLimit:3,customLanguagesLimit:2}}),(0,r.Z)(this,"socketStatus","disconnected"),(0,r.Z)(this,"rendererInternals",{contextByNodeInstanceId:{}}),(0,r.Z)(this,"tokens",{githubToken:null,vercelToken:null}),(0,r.Z)(this,"secrets",{}),(0,r.Z)(this,"pageList",{pageUnderLocalWork:null,isSettingsPanelOpen:!1,pageUnderCreate:{sectionsGenerationStatus:null,creationStatus:null}}),(0,r.Z)(this,"componentList",{componentUnderLocalWork:null,currentComponentSearch:"",stateValues:{},propValues:{}}),(0,r.Z)(this,"layersSearchText",""),(0,r.Z)(this,"nodesList",{renamedNodeId:null}),(0,r.Z)(this,"internationalization",{currentLanguage:{name:"English",short:"en"}}),(0,r.Z)(this,"localWork",{nodesUnderLocalWork:null,changedStyles:null,changedAttrs:null,changedContent:null,initialPropValues:null}),(0,r.Z)(this,"assetsList",{assetUnderLocalWork:{asset:null,location:null},assetUploading:{},assetsDownloading:{},toggledIconLibraries:{},currentIconSearch:"",currentUnsplashSearch:"",currentUploadsSearch:"",selected:{entities:{},location:null}}),(0,r.Z)(this,"isLeavingProject",!1),(0,r.Z)(this,"commandPalette",{opened:!1,actionCommandActive:!1}),(0,r.Z)(this,"designLanguage",{currentlyEditedCategoryName:"",sidebarPanel:null}),(0,r.Z)(this,"invalidDynamicProperties",{}),(0,r.Z)(this,"folders",{folderUnderEdit:{folderId:null,location:null},expandedFolders:{[b.D.PRIVATE_ASSETS]:!0,[b.D.PUBLIC_ASSETS]:!0},selected:{entities:{},location:null},explorer:{source:null,panel:null},showPrivateFileWarning:!0,orderType:"name"}),(0,r.Z)(this,"layout",{sidebarPanel:y.tI.FILES,mainPanel:y.iW.STAGE,designLanguageTab:y.Xd.COLOR,visibleInspector:y.dG.VISUAL,selectedAssetsTab:y.Zs.UNSPLASH,shortcutsVisible:!1,helpBubbleVisible:!1,projectMenuOpen:!1,selectedSectionTemplatesGroup:f.mY.Headers,selectedComponentSetupTab:y.wU.PROPS}),(0,r.Z)(this,"stageElementsInView",{widthLabel:!0}),(0,r.Z)(this,"treeviewSearch",{searchTerm:""}),(0,r.Z)(this,"currentTextInClipboard",""),(0,r.Z)(this,"drag",{draggingFiles:!1,draggingFilesOverAssetFolder:{folderId:"",location:null},draggedEntity:null,currentMousePosition:null,initialMousePosition:null,dragInAbsolutePosition:{absDraggedElements:{},absDraggedElementsParents:{},clonePlaceholders:{}}}),(0,r.Z)(this,"dropFlowStates",{treeView:{dropAnchor:null,acceptedDropTarget:null,dropAllowed:!0},flexContainer:{acceptedDropTarget:null,childAnchoringDrop:null,newWrapperFlexDirection:null,dropPosition:null,dropOutsideTarget:null,dropIsDisabled:!1},unknownContainer:{acceptedDropTarget:null,childAnchoringDrop:null,newWrapperFlexDirection:null,dropPosition:null,dropOutsideTarget:null,dropIsDisabled:!1},blockInlineContainer:{acceptedDropTarget:null,childAnchoringDrop:null,newWrapperFlexDirection:null,dropPosition:null,dropOutsideTarget:null,dropIsDisabled:!1},tokenCategory:{dropAnchor:null,acceptedDropTarget:null,closestTokenElement:null},button:{acceptedDropTarget:null,dropPosition:null,childAnchoringDrop:null,dropOutsideTarget:null,dropIsDisabled:!1,newWrapperFlexDirection:null},list:{acceptedDropTarget:null,dropPosition:null,childAnchoringDrop:null,dropOutsideTarget:null,dropIsDisabled:!1,newWrapperFlexDirection:null},slot:{acceptedDropTarget:null,dropPosition:null,childAnchoringDrop:null,dropOutsideTarget:null,dropIsDisabled:!1,newWrapperFlexDirection:null},navbar:{acceptingTab:null,dropPosition:null},folder:{acceptedDropTarget:null},assetFolder:{acceptedDropTarget:null}}),(0,r.Z)(this,"selection",{componentId:null,classId:null,nodes:{},nodeInstanceIds:{},sidebarClassId:null,inspectorClassId:null,expandedTreeNodes:{},nodeStates:{},dragSelection:null,compInstanceId:null,interactiveElementRoot:{nodeId:null,nodeInstanceId:null},nodesWithUtilityClasses:{},persistSelectionOnNodeId:null,forceRenderSelection:null}),(0,r.Z)(this,"tailwind",{building:!1}),(0,r.Z)(this,"devMode",{selectedFile:null,previouslySelectedFile:null,bundlerStatus:null,navigation:{},expandedFolders:{},pathUnderRename:null,devComponents:{},devStyles:{},sidebarSettings:{panel:y.Xk.FILES,gridTemplateColumns:"286px 0px 1fr",width:"286px"},showPreviewer:!0,showConsole:!1,loadingPackages:!1,fileUnderUpdate:!1,selectedDiffingFile:null,selectedStagedFile:null,selectedCommitFile:null,selectedCommitFilesHistory:{},selectedConflictFile:null,githubCommits:{},selectedBranch:_.cY,githubInitializing:!1,githubBranches:{byId:{},underRename:null,underCreationSource:null},hasAccessToGithubRepo:!0,githubTokenValid:!0,githubOperationInProgress:null,conflictModalOpened:!1,fileUnderExternalUpdate:null,packageExports:null}),(0,r.Z)(this,"lastVisitedPage",null),(0,r.Z)(this,"lastVisitedComponent",null),(0,r.Z)(this,"previousSelectedPageOrCompId",null),(0,r.Z)(this,"hover",{componentLinkedNodeInstanceIds:{}}),(0,r.Z)(this,"mediaQueryBreakpoints",{showManagementPanel:!1,defaultBreakpoint:d.Bk}),(0,r.Z)(this,"projectPublish",{[y.Fb.TELEPORT]:{status:"initial"},[y.Fb.VERCEL]:{status:"initial"},[y.Fb.CUSTOM_DOMAIN]:{status:"initial"}}),(0,r.Z)(this,"projectDeployments",{deploymentsResponse:null,deploymentsUnderWork:{}}),(0,r.Z)(this,"projectDownload",{zip:{status:"initial"},codesandbox:{status:"initial"},github:{status:"initial"}}),(0,r.Z)(this,"userPreferences",{projectType:I.o.REACT,projectExportType:y.iW.STAGE,codeType:m.cd.REACT,codeStyleVariation:m.cx.CSSModules,highlightParent:!0,persistViewportSize:!0,viewportSize:d.Bk,persistZoomLevel:!0,zoomLevel:1,layoutStructureVisible:!1,keepAspectRatio:!1,highlightMarginAndPadding:!0,mediaQueryOnRichText:!0,automaticallyCreateOverrides:!0,duplicatePropsWhenDuplicatingNode:!0,createSimpleTextProps:!1,classesInTreeView:!0,showElementTag:!1,applyForegroundColorAsIconFill:!0,automaticallyTranslateTextElements:!0,showMediaQueryGuideLines:!0,useAIForSectionsContent:!0,exportUnusedClasses:!0,displayColorTokensAs:"grid",devPreviewerType:y.jK.INSIDE,devFileViewState:{local:{},diffing:{},commit:{},staged:{}},links:{openInNewTab:!0},inspectorSettings:{componentProps:{openByDefault:!1}},selection:{showParentLabelsForNodesInCompInstances:!1,showAddSectionBelowButton:!0}}),(0,r.Z)(this,"sidebarSettings",{expanded:{[v.S.PAGES]:!0,[v.S.COMPONENTS]:!0,[v.S.COLLECTION_PAGES]:!0,[v.S.DETAILS_PAGES]:!0,[v.S.LIST_PAGES]:!0},filesGridTemplateRows:"1fr 10px 1fr",width:256}),(0,r.Z)(this,"userInteractions",{undo:0,redo:0,pressedKeys:{},clipboard:{copiedNodes:null,cutNodesEnabled:!1,copiedUIDL:null},resizeInProgress:!1,zoomInProgress:!1,focusedImgAttr:null,focusedBgImgIndex:null,UploadedAssetType:null,cursorProperty:"auto",isNodeInPreviewMode:!1,publishInProgress:!1,sectionUnderReplace:null}),(0,r.Z)(this,"projectStatus",null),(0,r.Z)(this,"projectLoaded",!1),(0,r.Z)(this,"stage",new u),(0,r.Z)(this,"tutorials",{currentStep:null,tutorialInProgress:null}),(0,r.Z)(this,"staticNodeInterationsData",{selectionStyles:null,selectedText:null,editingNodeInstanceId:{},isSettingLink:!1,activeSelection:null,editingCompInstanceId:null}),(0,r.Z)(this,"dynamicNodeInteractionsData",{isManagingState:!1,isManagingProps:!1,autofocusDefaultValue:!1}),(0,r.Z)(this,"navbar",{tabs:{},devModeTabs:{}}),(0,r.Z)(this,"readonly",null),(0,r.Z)(this,"cloneable",null),(0,r.Z)(this,"componentRenderStyleList",new g.vI),(0,r.Z)(this,"aiGeneration",{generationInProgress:!1,sections:null})}})||h},51261:function(e,t,n){n.d(t,{g:function(){return r}});var o,i=n(777460),s=n(302503);let r=(0,s.provide)("webRTCState")(o=class{constructor(){(0,i.Z)(this,"editedNodes",{}),(0,i.Z)(this,"selectedNodes",{}),(0,i.Z)(this,"selectedComp",{}),(0,i.Z)(this,"connectedPeers",{}),(0,i.Z)(this,"nodesUnderTranslation",{}),(0,i.Z)(this,"pageSettingsUnderTranslation",{}),(0,i.Z)(this,"followedUserId",null),(0,i.Z)(this,"prevSelectedLockedNodeIds",{}),(0,i.Z)(this,"isLoadingPeers",!1),(0,i.Z)(this,"devData",{})}})||o},628422:function(e,t,n){var o,i,s,r,a,c,l,d,p,u,h,y,m,f,g,_,b,I,v,w,O,j,S,N,D,E,T,P,C,x=n(503348),A=n(777460),F=n(918437),k=n(395942),R=n(302503),M=n(40835),U=n(422169),Z=n(774468),L=n(255328),B=n(656733),W=n(918939),z=n(491463),$=n(686646),G=n(329852),H=n(785978);function K(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function V(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?K(Object(n),!0).forEach((function(t){(0,A.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):K(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}o=(0,R.provide)("assetsEditFlow"),i=(0,R.inject)("assetsSelectionFlow"),s=(0,R.inject)("sharedbProjectSyncService"),r=(0,R.inject)("projectDoc"),a=(0,R.inject)("projectUIState"),c=(0,R.inject)("modalManagementFlow"),l=(0,R.inject)("nodeAttributeManagmentFlow"),d=(0,R.inject)("nodeStyleManagmentFlow"),p=(0,R.inject)("guardsService"),u=(0,R.inject)("assetsRepository"),h=(0,R.inject)("notificationsManagementFlow"),y=(0,R.inject)("projectClassManagementFlow"),m=(0,R.inject)("assetsService"),f=(0,R.inject)("sentryService"),o((_=class{constructor(){(0,x.Z)(this,"assetsSelectionFlow",b,this),(0,x.Z)(this,"dbSync",I,this),(0,x.Z)(this,"projectDoc",v,this),(0,x.Z)(this,"projectUIState",w,this),(0,x.Z)(this,"modalManagementFlow",O,this),(0,x.Z)(this,"nodeAttributeManagmentFlow",j,this),(0,x.Z)(this,"nodeStyleManagmentFlow",S,this),(0,x.Z)(this,"guardsService",N,this),(0,x.Z)(this,"assetsRepository",D,this),(0,x.Z)(this,"notificationsManagementFlow",E,this),(0,x.Z)(this,"projectClassManagementFlow",T,this),(0,x.Z)(this,"assetsService",P,this),(0,x.Z)(this,"sentryService",C,this),(0,A.Z)(this,"replaceAssetAbsoluteSrcWithLocal",(e=>{if(!e)return"";const t=this.findAssetByAbsolutePath(e);return t?`/${t.name}`:e})),(0,A.Z)(this,"replaceAssetLocalSrcWithAbsolute",((e,t)=>{if(!e)return"";const n=this.findAssetByLocalPath(e);return n?t?n.getRemoteSrcForComp(t):n.remoteSrc:e})),(0,A.Z)(this,"getAssetBySrc",(e=>{if(e)return this.findAssetByAbsolutePath(e)||this.findAssetByLocalPath(e)})),(0,A.Z)(this,"isCustomFontDependency",(e=>Object.values(this.projectDoc.fonts.byId).filter((e=>"custom"===e.type)).map((e=>e.path.split("/").pop())).includes(e))),(0,A.Z)(this,"parentIsFontsFolder",(e=>this.projectDoc.folders.byId[this.projectDoc.assets.byId[e].parentFolderId].name===G.D.FONTS&&this.projectDoc.folders.byId[this.projectDoc.assets.byId[e].parentFolderId].parentId===G.D.PUBLIC_ASSETS))}beginEditing(e,t){if(!e||!this.projectDoc.assets.byId[e])return;this.isCustomFontDependency(e)?this.notificationsManagementFlow.createNotification($.k$.ERROR,"Custom fonts files cannot be renamed."):(0,k.mutate)(this.projectUIState,(n=>{n.assetsList.assetUnderLocalWork.asset=(new M.G).fromJSON(this.projectDoc.assets.byId[e].toJSON()),n.assetsList.assetUnderLocalWork.location=t}))}stopEditing(){(0,k.mutate)(this.projectUIState,(e=>{e.assetsList.assetUnderLocalWork.asset=null,e.assetsList.assetUnderLocalWork.location=null}))}createAssetInNodeRelation(e){const{assetId:t,nodeId:n,doc:o}=e;if(!o)return;const i=o.assets.byId[t];i&&i.createNodeRelation(n)}removeAssetInNodeRelation(e){const{assetId:t,nodeId:n}=e;this.dbSync.mutate(this.projectDoc,(e=>{const o=e.assets.byId[t];o&&o.removeNodeRelation(n)}))}rename(e,t,n=!1){if(!e||!t||!t.length)return;const o=this.projectDoc.assets.byId[e];if(!o)throw new Error("Tried to rename an asset that doesn't exist");if(o.name===t)return void this.stopEditing();t=this.getAssetUniqueName(t);const{isValid:i,error:s}=this.assetsService.nameIsValid(t);if(!i)return n&&this.stopEditing(),void this.notificationsManagementFlow.handleError(s);this.dbSync.mutate(this.projectDoc,(n=>{n.assets.byId[e].name=t})),this.stopEditing()}getAssetUniqueName(e){const t=Object.values(this.projectDoc.assets.byId).map((e=>e.name));return(0,z._x)(t,e)}deleteSelectedAssets(){const e=Object.keys(this.projectUIState.assetsList.selected.entities);this.deleteWithConfirmation(e)}checkIfAssetIsUsed(e){const t=this.projectDoc.assets.byId[e];return t.type!==W.K.IMAGE&&t.type!==W.K.VIDEO||(Object.keys(t.usedInClasses||{}).length>0||Object.keys(t.usedInNodes||{}).length>0)}deleteAllUnusedAssets(){const e=Object.keys(this.projectDoc.assets.byId).reduce(((e,t)=>(this.checkIfAssetIsUsed(t)||e.push(t),e)),[]);e.length&&this.deleteWithConfirmation(e)}deleteWithConfirmation(e){let t="asset";Array.isArray(e)&&e.length>1&&(t="assets");const n=U.d.createDeleteModal({deletedEntity:t,onSubmit:async()=>{await this.delete(e)&&(0,k.mutate)(this.projectUIState,(t=>{Array.isArray(e)?e.forEach((e=>delete t.assetsList.selected.entities[e])):delete t.assetsList.selected.entities[e]}))}});this.modalManagementFlow.showModal(n)}async delete(e,t){if(!e||Array.isArray(e)&&!e.length)return!1;const n=[].concat(e);if(n.find((e=>this.isCustomFontDependency(e))))return this.notificationsManagementFlow.createNotification($.k$.ERROR,"Custom fonts files can only be deleted from project settings."),!1;const o=n.map((e=>{var t;return null===(t=this.projectDoc.assets.byId[e])||void 0===t?void 0:t.path})).filter((e=>e));if(!o.length)return!1;if(!t)try{await this.assetsRepository.delete(this.projectDoc.id,o)}catch(i){return this.notificationsManagementFlow.handleError(H.N9.COULD_NOT_DELETE),!1}return this.guardsService.executeFunctionGuarded(B._.DISABLE_HISTORY,(()=>this.dbSync.mutate(this.projectDoc,(e=>{this.removeAssetsFromNodes({doc:e,assetIds:n}),this.removeAssetsFromClasses({doc:e,assetIds:n}),n.forEach((t=>{const n=e.assets.byId[t];n&&(n.parentFolderId&&e.folders.removeChildFromFolder({child:{[n.id]:"asset"},folderId:n.parentFolderId}),e.assets.remove(t))}))})))),!0}removeAssetsFromNodes(e){const{assetIds:t,doc:n}=e;if(n)for(const o of t){const e=n.assets.byId[o];if(!Object.keys(e.usedInNodes).length)continue;Object.keys(e.usedInNodes).map((t=>{const o=n.nodes.getById(t);if(!o)return null;return{nodeId:t,nodeInstance:o,assetSrc:e.id}})).forEach((e=>{if(!e)return;const{nodeInstance:t,assetSrc:o,nodeId:i}=e;this.removeAssetSourceFromNodeAttrs({doc:n,nodeInstance:t,assetSrc:o,nodeId:i}),this.removeAssetFromNodeStyle({doc:n,nodeInstance:t,assetSrc:o,nodeId:i})}))}}removeAssetsFromClasses(e){const{assetIds:t,doc:n}=e;if(n)for(const o of t){const e=n.assets.byId[o];if(!Object.keys(e.usedInClasses||{}).length)continue;Object.keys(e.usedInClasses||{}).map((t=>({classId:t,assetSrc:e.id}))).forEach((e=>{if(!e)return;const{assetSrc:t,classId:o}=e;this.removeAssetFromClassStyle({doc:n,assetSrc:t,classId:o})}))}}validateAssetIsUsedInNode(e,t){const n=this.projectDoc.assets.byId[e];if(!n)return;const o=n.usedInClasses;Object.keys(o||{}).reduce(((e,t)=>{const n=this.projectDoc.classes.byId[t];return n&&"simple"===n.classType?V(V({},e),n.usedInNodes):e}),V({},n.usedInNodes))[t]||this.sentryService.captureException(`Asset ${n.id} appears on node ${t} but does not have a usedInNodes relation with it!`)}removeAssetSourceFromNodeAttrs(e){var t;const{doc:n,nodeInstance:o,assetSrc:i,nodeId:s}=e;if(!n)return;const r="attrs"in o&&null!==(t=o.attrs)&&void 0!==t?t:{};Object.keys(r).forEach((e=>{const t=r[e];if(t&&"comp-style"!==t.type){if("dynamic"===t.type&&"prop"===t.content.referenceType){const e=n.components.byId[n.getComponentIdForNode(s)||""];if(!e)throw new Error(`Could not find source component for node ${s}`);const o=e.propDefinitions[t.content.id];if((null===o||void 0===o?void 0:o.defaultValue)!==i)return}"number"!==typeof t.content&&("static"!==t.type||"string"!==typeof t.content&&"number"!==typeof t.content||-1!==t.content.indexOf(i)||t.content===Z.i$)&&this.nodeAttributeManagmentFlow.updateAttrByKey({doc:n,nodeId:s,key:e,value:Z.i$})}}))}removeAssetFromNodeStyle(e){const{doc:t,nodeInstance:n,assetSrc:o,nodeId:i}=e;if(!t||!("styles"in n))return;const s=n.styles;Object.keys(s).forEach((e=>{const n=s[e];if("static"!==n.type||"string"!==typeof n.content)return;if(-1===n.content.indexOf(o))return;const r=this.nodeStyleManagmentFlow.replaceRemovedAssetFromBgImg(o,n.content);r?this.nodeStyleManagmentFlow.setStyleByKey({doc:t,nodeIds:[i],key:e,value:r}):this.nodeStyleManagmentFlow.removeStyleByKey({doc:t,nodeIds:[i],key:e})}));const r=n.referencedStyles;Object.keys(r).forEach((e=>{if("inlined"!==r[e].content.mapType)return;const n=r[e],s=n.content.styles;Object.keys(s).forEach((e=>{const r=s[e];if("static"!==r.type||"string"!==typeof r.content)return;if(-1===r.content.indexOf(o))return;const a=n.content.conditions[0];if(!a)return;const c=this.nodeStyleManagmentFlow.replaceRemovedAssetFromBgImg(o,r.content);c?this.nodeStyleManagmentFlow.setConditionalInlineStyleByKey({doc:t,nodeIds:[i],key:e,value:c,condition:a}):this.nodeStyleManagmentFlow.removeConditionalInlineStyleByKey({doc:t,nodeIds:[i],key:e,condition:a})}))}))}removeAssetFromClassStyle(e){const{doc:t,assetSrc:n,classId:o}=e;if(!t)return;const i=t.classes.byId[o],s=i.content;Object.keys(s).forEach((e=>{const i=s[e];"static"===i.type&&"string"===typeof i.content&&-1!==i.content.indexOf(n)&&this.projectClassManagementFlow.addOrUpdate({doc:t,classId:o,key:e,identifier:"desktop",value:`url("${Z.i$}")`})}));const r=i.conditions;Object.keys(r).forEach((e=>{const i=r[e];let s;s="screen-size"===i.type?i.meta.maxWidth:i.meta.state,Object.keys(i.content||{}).forEach((e=>{const r=i.content[e];"static"===r.type&&"string"===typeof r.content&&-1!==r.content.indexOf(n)&&this.projectClassManagementFlow.addOrUpdate({doc:t,classId:o,key:e,identifier:s,value:`url("${Z.i$}")`})}))}))}findAssetByAbsolutePath(e){if(null!==e&&void 0!==e&&e.includes(Z.rq)||null!==e&&void 0!==e&&e.includes(Z.Sf))return Object.values(this.projectDoc.assets.byId).find((t=>-1!==e.indexOf(t.path)))}findAssetByLocalPath(e){if("/"!==e[0])return;const t=Object.values(this.projectDoc.assets.byId),n=e.split("/"),o=n[n.length-1];return t.find((e=>-1!==o.indexOf(e.name)))}},b=(0,F.Z)(_.prototype,"assetsSelectionFlow",[i],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),I=(0,F.Z)(_.prototype,"dbSync",[s],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),v=(0,F.Z)(_.prototype,"projectDoc",[r],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),w=(0,F.Z)(_.prototype,"projectUIState",[a],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),O=(0,F.Z)(_.prototype,"modalManagementFlow",[c],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),j=(0,F.Z)(_.prototype,"nodeAttributeManagmentFlow",[l],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),S=(0,F.Z)(_.prototype,"nodeStyleManagmentFlow",[d],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),N=(0,F.Z)(_.prototype,"guardsService",[p],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),D=(0,F.Z)(_.prototype,"assetsRepository",[u],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),E=(0,F.Z)(_.prototype,"notificationsManagementFlow",[h],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),T=(0,F.Z)(_.prototype,"projectClassManagementFlow",[y],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),P=(0,F.Z)(_.prototype,"assetsService",[m],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),C=(0,F.Z)(_.prototype,"sentryService",[f],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),(0,F.Z)(_.prototype,"createAssetInNodeRelation",[L.P],Object.getOwnPropertyDescriptor(_.prototype,"createAssetInNodeRelation"),_.prototype),(0,F.Z)(_.prototype,"removeAssetsFromNodes",[L.P],Object.getOwnPropertyDescriptor(_.prototype,"removeAssetsFromNodes"),_.prototype),(0,F.Z)(_.prototype,"removeAssetsFromClasses",[L.P],Object.getOwnPropertyDescriptor(_.prototype,"removeAssetsFromClasses"),_.prototype),(0,F.Z)(_.prototype,"removeAssetSourceFromNodeAttrs",[L.P],Object.getOwnPropertyDescriptor(_.prototype,"removeAssetSourceFromNodeAttrs"),_.prototype),(0,F.Z)(_.prototype,"removeAssetFromClassStyle",[L.P],Object.getOwnPropertyDescriptor(_.prototype,"removeAssetFromClassStyle"),_.prototype),g=_))},358614:function(e,t,n){var o,i,s,r,a,c=n(503348),l=n(777460),d=n(918437),p=n(302503),u=n(85413),h=n(590196),y=n(686646),m=n(918939),f=n(930613),g=n(233475),_=n(813244),b=n(785978),I=n(255328),v=n(491463),w=n(1297),O=n.n(w),j=n(395942),S=n(638852),N=n(329852),D=n(422169),E=n(202784),T=n(975901),P=n(21023),C=n(552322);let x=(o=(0,p.inject)("workersProvider"),i=(0,p.inject)("notificationsManagementFlow"),s=class extends E.PureComponent{constructor(...e){super(...e),(0,c.Z)(this,"workersProvider",r,this),(0,c.Z)(this,"notificationsManagementFlow",a,this),(0,l.Z)(this,"state",{code:this.props.code||"",isSubmitting:!1,isFormatting:!1}),(0,l.Z)(this,"handleSubmit",(async()=>{this.setState({isSubmitting:!0}),await this.props.onSubmit(this.state.code),this.setState({isSubmitting:!1})})),(0,l.Z)(this,"handleChange",(e=>{this.setState({code:e})})),(0,l.Z)(this,"handlePrettify",(async()=>{this.setState({isFormatting:!0}),this.workersProvider.prettify(this.state.code,this.props.title||"text.json",(async e=>{this.setState({code:e,isFormatting:!1})}),(()=>{this.notificationsManagementFlow.createNotification(y.k$.ERROR,"Failed to run prettier, please check the syntax."),this.setState({isFormatting:!1})}))}))}render(){const{onDismiss:e,title:t}=this.props,{code:n,isSubmitting:o,isFormatting:i}=this.state,s=(0,P.extname)(null!==t&&void 0!==t?t:"").substring(1);return(0,C.jsx)(T.I,{title:t||"File Editor",submitButton:"Save",submitButtonState:{loading:o,colorScheme:"accent",style:"solid"},code:n,language:s,onSubmit:this.handleSubmit,onDismiss:e,onChange:this.handleChange,onFormat:this.handlePrettify,isFormatting:i})}},r=(0,d.Z)(s.prototype,"workersProvider",[o],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),a=(0,d.Z)(s.prototype,"notificationsManagementFlow",[i],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),s);var A,F,k,R,M,U,Z,L,B,W,z,$,G,H,K,V,Y,J,X,q,Q,ee,te,ne,oe,ie,se,re,ae,ce,le,de,pe,ue,he,ye,me,fe,ge,_e,be,Ie,ve,we,Oe=n(774468),je=n(327089),Se=n(559196);A=(0,p.provide)("assetsManagementFlow"),F=(0,p.inject)("projectDoc"),k=(0,p.inject)("projectUIState"),R=(0,p.inject)("assetsEditFlow"),M=(0,p.inject)("nodeStyleManagmentFlow"),U=(0,p.inject)("nodeManagementFlow"),Z=(0,p.inject)("nodeAttributeManagmentFlow"),L=(0,p.inject)("unsplashFlow"),B=(0,p.inject)("notificationsManagementFlow"),W=(0,p.inject)("assetsRepository"),z=(0,p.inject)("projectInitFlow"),$=(0,p.inject)("assetsService"),G=(0,p.inject)("imageOptimisationFlow"),H=(0,p.inject)("sentryService"),K=(0,p.inject)("fileDownloadService"),V=(0,p.inject)("assetFoldersFlow"),Y=(0,p.inject)("modalManagementFlow"),J=(0,p.inject)("assetsUploadFlow"),X=(0,p.inject)("nodeSelectionFlow"),q=(0,je.G)(Se.l.REMOVE_CLASS_RELATION_FROM_ASSET),Q=(0,je.G)(Se.l.REMOVE_NODE_RELATION_FROM_ASSET),ee=(0,je.G)(Se.l.TOGGLE_ASSET_OPTIMIZATION),te=(0,je.G)(Se.l.ADD_ASSET_AFTER_SELECTED_NODE),ne=(0,je.G)(Se.l.ADD_ASSET_IN_NODE),A((ie=class{constructor(){(0,c.Z)(this,"projectDoc",se,this),(0,c.Z)(this,"projectUIState",re,this),(0,c.Z)(this,"assetsEditFlow",ae,this),(0,c.Z)(this,"nodeStyleManagmentFlow",ce,this),(0,c.Z)(this,"nodeManagementFlow",le,this),(0,c.Z)(this,"nodeAttributeManagmentFlow",de,this),(0,c.Z)(this,"unsplashFlow",pe,this),(0,c.Z)(this,"notificationsManagementFlow",ue,this),(0,c.Z)(this,"assetsRepository",he,this),(0,c.Z)(this,"projectInitFlow",ye,this),(0,c.Z)(this,"assetsService",me,this),(0,c.Z)(this,"imageOptimisationFlow",fe,this),(0,c.Z)(this,"sentryService",ge,this),(0,c.Z)(this,"fileDownloadService",_e,this),(0,c.Z)(this,"assetFoldersFlow",be,this),(0,c.Z)(this,"modalManagementFlow",Ie,this),(0,c.Z)(this,"assetsUploadFlow",ve,this),(0,c.Z)(this,"nodeSelectionFlow",we,this),(0,l.Z)(this,"editTxtFile",(async e=>{let t="";try{const n=this.projectDoc.assets.byId[e],o=Date.now(),i=await fetch(n.remoteSrc+"?dummy="+o,{headers:{accept:Oe.un,"Cache-Control":"no-cache",pragma:"no-cache"}}),s=await i.blob();t=await s.text();const r=D.d.createCustomModal({data:{code:t,title:`Editing: ${n.name}`},Component:x,onSubmit:async t=>{const o=new Blob([t],{type:s.type}),i=new File([o],n.name,{type:s.type});this.modalManagementFlow.hideModal(),await this.assetsUploadFlow.upload({files:[i],parentFolderId:N.D.PUBLIC_ASSETS,assetType:m.K.EDITABLE_FILE,assetId:e})}});this.modalManagementFlow.showModal(r,{padding:"0px"})}catch(n){n.message=`Failed to fetch asset: ${n.message}`,this.sentryService.captureException(n)}})),(0,l.Z)(this,"getPropNameAndTargetNodeForImageInComp",(e=>{var t;let n=this.projectUIState.selection.compInstanceId||e,o=(null===(t=this.projectUIState.userInteractions.focusedImgAttr)||void 0===t?void 0:t.attrName)||"";const i=this.projectDoc.nodes.getById(e);if(i&&i.id!==n&&"attrs"in i&&"element-node"===i.type){var s;const t=null===(s=i.attrs)||void 0===s?void 0:s.src;if(t&&"dynamic"===t.type&&"prop"===t.content.referenceType){const e=this.projectDoc.components.byId[this.projectDoc.getComponentIdForNode(i.id)||""],n=null===e||void 0===e?void 0:e.propDefinitions[t.content.id];o=(null===n||void 0===n?void 0:n.name)||o}else n=e,o="src"}const r=this.projectDoc.nodes.getById(n);if(!r)throw new Error("No node found for node id");if(this.projectDoc.nodes.nodeIsCompInstance(r)&&(null===i||void 0===i?void 0:i.id)===r.id){var a;const e=r.compIdOfCompInstance;if(!e)throw new Error("No comp id found for comp instance");const t=(null===(a=this.projectDoc.components.byId[e])||void 0===a?void 0:a.propDefinitions)||{},i=Object.values(t).find((e=>o?e.name===o:e.inputType===_.SO.IMAGE))||Object.values(t).find((e=>e.inputType===_.SO.IMAGE));if(i&&(o&&o===i.name||(o=i.name)),!o)return{targetNodeId:n,propName:""}}return{propName:o,targetNodeId:n}})),(0,l.Z)(this,"setPosterForSelectedNode",(async(e,t)=>{const n=this.nodeSelectionFlow.getSelectedNodesIds()[0],o=this.projectDoc.nodes.getById(n),i=this.projectUIState.selection.compInstanceId||n;let s=this.projectDoc.nodes.getById(i);if(!s||!o)return;let r="poster";if(i!==(null===o||void 0===o?void 0:o.id)&&"component-instance-node"===s.type){const e=(o&&"element-node"===o.type?o.attrs:{})[r];if(e&&"dynamic"===e.type&&"prop"===e.content.referenceType){const t=this.projectDoc.components.byId[s.compIdOfCompInstance],n=null===t||void 0===t?void 0:t.propDefinitions[e.content.id];r=(null===n||void 0===n?void 0:n.name)||r}else s=o}const a=await this.getAssetSrc(e,{targetNodeId:n,downloadLink:t});this.nodeAttributeManagmentFlow.updateAttrByKey({nodeId:s.id,key:r,value:a})})),(0,l.Z)(this,"setSrcForSelectedNode",(async(e,t)=>{const n=this.nodeSelectionFlow.getSelectedNodesIds()[0],o=this.projectDoc.nodes.getById(n);if(!o)return;const{propName:i,targetNodeId:s}=this.getPropNameAndTargetNodeForImageInComp(o.id),r=this.projectDoc.nodes.getById(s);if(!r)return;const a=await this.getAssetSrc(e,{targetNodeId:s,downloadLink:t}),c=r.primitiveType===g.sO.COMPONENT;c&&-1!==i.indexOf("bgImage")&&-1!==i.indexOf(s)?this.setBgImageForSelectedNode(e,t):this.nodeAttributeManagmentFlow.updateAttrByKey({nodeId:s,key:c?i:"src",value:a})})),(0,l.Z)(this,"filterDescendantsFromSelected",((e,t)=>{let n=[];const o=this.assetFoldersFlow.getMultipleFoldersDescendants(e),i=e.filter((e=>!o.includes(e)));if(t){const e=this.assetFoldersFlow.getAssetIdsFromFolders([...i,...o]);n=t.filter((t=>!e.includes(t)))}return{filteredFolderIds:i,filteredAssetIds:n}})),(0,l.Z)(this,"setBgImageForSelectedNode",(async(e,t)=>{const n=this.nodeSelectionFlow.getSelectedNodesIds()[0];if(!n)return;let o=await this.getAssetSrc(e,{targetNodeId:n,downloadLink:t});this.projectDoc.assets.byId[o]||(o=`url("${o}")`);const i=this.nodeStyleManagmentFlow.getNewBackgroundImageValue(o,n),s={backgroundImage:{value:i}};i===o&&(s.backgroundSize={value:"cover"}),this.nodeStyleManagmentFlow.setMultipleStylesByKeyForCurrentBreakpoint({nodeIds:[n],styleMap:s})})),(0,l.Z)(this,"setListStyleImageForSelectedNode",(async(e,t)=>{const n=this.nodeSelectionFlow.getSelectedNodesIds()[0],o=this.projectDoc.nodes.getById(n);if(!o)return;let i=await this.getAssetSrc(e,{targetNodeId:n,downloadLink:t});this.projectDoc.assets.byId[i]||(i=`url("${i}")`);const s=this.nodeStyleManagmentFlow.getNewBackgroundImageValue(i,n);this.nodeStyleManagmentFlow.setStyleByKeyBasedOnCurrentBreakpoint({nodeIds:[o.id],key:"listStyleImage",value:s})})),(0,l.Z)(this,"addAssetAfterSelectedNode",(async(e,t)=>{const n=this.nodeSelectionFlow.getSelectedNodesIds()[0],o=this.projectDoc.assets.byId[e],i=await this.getAssetSrc(e,{downloadLink:t,targetNodeId:n}),s=(null===o||void 0===o?void 0:o.type)===m.K.VIDEO,r=(0,u.a)({stencilKey:s?h.sO.VIDEO:h.sO.IMAGE,attrs:{src:i}});this.addNodeAfterSelectedNode({nodeToAdd:r,asset:o})})),(0,l.Z)(this,"addAssetOrContainerToSelectedNode",(async(e,t,n)=>{const o=this.nodeSelectionFlow.getSelectedNodesIds()[0],i=await this.getAssetSrc(e,{downloadLink:t,targetNodeId:o}),s=this.projectDoc.assets.byId[i],r=(null===s||void 0===s?void 0:s.type)===m.K.VIDEO,a=n?(0,u.a)({stencilKey:h.sO.ROW,styles:{backgroundImage:s?i:`url("${i}")`,backgroundSize:"cover"}}):(0,u.a)({stencilKey:r?h.sO.VIDEO:h.sO.IMAGE,attrs:{src:i}});this.addAssetInNode({nodeToCreate:a,asset:s})})),(0,l.Z)(this,"getAssetSrc",(async(e,t)=>{const n=this.projectDoc.assets.byId[e];if(n)return n.id;if(null===t||void 0===t||!t.downloadLink)return e;this.triggerUnsplashDownload(t.downloadLink);const o=`&w=${f.ou.yL}`;return e+(t&&t.targetNodeId?this.estimateNodeDimensions(t.targetNodeId):o)})),(0,l.Z)(this,"triggerUnsplashDownload",(async e=>{try{return await this.unsplashFlow.getAPIDownloadUrl(e)}catch(t){this.notificationsManagementFlow.createNotification(y.k$.ERROR,"There was a problem when getting the image")}})),(0,l.Z)(this,"estimateNodeDimensions",(e=>{let t=this.projectDoc.estimateNodeDimensionInPxByStyle("width",e),n=this.projectDoc.estimateNodeDimensionInPxByStyle("height",e);const o=f.ou.I1;t=t>f.ou.nq?f.ou.nq:t,n=n>f.ou.nq?f.ou.nq:n;const i=Math.ceil(t/o)*o,s=Math.ceil(n/o)*o;return t>n?`&w=${i}`:`&h=${s}`})),(0,l.Z)(this,"getAssetsStats",(()=>({count:Object.keys(this.projectDoc.assets.byId).length,size:Object.values(this.projectDoc.assets.byId).reduce(((e,t)=>e+parseInt(t.size.toString())),0)}))),(0,l.Z)(this,"getImageAssetNames",(()=>Object.values(this.projectDoc.assets.byId).filter((e=>e.type===m.K.IMAGE)).map((e=>e.name))))}downloadSelectedAsset(){this.downloadAssetsLocally(Object.keys(this.projectUIState.assetsList.selected.entities))}async zipAssetsInFolder(e,t){const n=this.projectDoc.folders.getChildFoldersOfFolder(e.id),o=this.projectDoc.assets.getAssetsFromFolder(e.id),i=t.folder(e.name);if(!i)return;for(const r in n)await this.zipAssetsInFolder(n[r],i);const s=o.map((async e=>({blob:await this.assetsService.fetchImageFromUrlAsBlob(e.remoteSrc),name:e.name})));(await Promise.all(s)).forEach((e=>i.file(e.name,e.blob)))}async donwloadAssetsFolderHierarchy(e,t){const{filteredFolderIds:n,filteredAssetIds:o}=this.filterDescendantsFromSelected(e,t),i=new(O());try{if(t)for(const e of o){const t=this.projectDoc.assets.byId[e];t.type!==m.K.IMAGE&&t.type!==m.K.VIDEO||t.type!==m.K.IMAGE&&t.type!==m.K.VIDEO&&t.type!==m.K.EDITABLE_FILE&&t.type!==m.K.FILE||await fetch(t.remoteSrc,{headers:{accept:Oe.un}}).then((e=>e.blob())).then((e=>{i.file(t.name,e)}))}for(const e of n){const t=this.projectDoc.folders.byId[e];await this.zipAssetsInFolder(t,i)}i.generateAsync({type:"blob"}).then((e=>{this.fileDownloadService.promptDownload(e,"assets.zip")}))}catch(s){s.message=`Failed to download assets locally: ${s.message}`,this.sentryService.captureException(s)}}async downloadAssetsLocally(e){(0,j.mutate)(this.projectUIState,(t=>{e.forEach((e=>{t.assetsList.assetsDownloading[e]=!0}))}));const t=new(O());try{const n=e.map((async e=>{const t=this.projectDoc.assets.byId[e];return{blob:await this.assetsService.fetchImageFromUrlAsBlob(t.remoteSrc),name:t.name}})),o=await Promise.all(n);if(1===o.length)return void this.fileDownloadService.promptDownload(o[0].blob,o[0].name);o.forEach((e=>{t.file(e.name,e.blob)}));const i=await t.generateAsync({type:"blob"});this.fileDownloadService.promptDownload(i,"assets.zip")}catch(n){n.message=`Failed to download assets locally: ${n.message}`,this.sentryService.captureException(n)}finally{(0,j.mutate)(this.projectUIState,(t=>{e.forEach((e=>{delete t.assetsList.assetsDownloading[e]}))}))}}async duplicateAssets(e){const t=this.projectInitFlow.getProjectLimitations(),{size:n,count:o}=this.getAssetsStats();if(e.length+o>t.MAX_ASSETS_FOR_PROJECT)throw new Error(`${b.N9.MAXIMUM_LIMIT_REACHED}: ${t.MAX_ASSETS_FOR_PROJECT}`);let i=0;const s={};if(e.forEach((e=>{i+=parseInt(e.size.toString()),s[e.path]={name:e.name,type:e.type,parentFolderId:e.parentFolderId}})),n+i>t.MAX_ASSETS_SIZE_FOR_PROJECT)throw S.Z.mixpanelEvent(S.Z.AnalyticsEvents.WORKSPACE_LIMIT_ASSETS_REACHED),new Error(b.N9.MAXIMUM_SIZE_LIMIT_REACHED);const r=await this.assetsRepository.duplicate(this.projectDoc.id,s);if(r&&r.length){const e=Object.values(this.projectDoc.assets.byId).map((e=>e.name));r.forEach((t=>{t.name=(0,v._x)(e,t.name),e.push(t.name)}))}return r}removeClassRelationsFromAssets(e){const{doc:t,classId:n}=e;t&&Object.values(t.assets.byId).forEach((e=>{var t;null===(t=e.usedInClasses)||void 0===t||delete t[n]}))}removeNodeRelationsFromAssets(e){const{doc:t,nodeId:n}=e;t&&Object.values(t.assets.byId).forEach((e=>{var t;null===(t=e.usedInNodes)||void 0===t||delete t[n]}))}toggleAssetOptimisation(e){const{doc:t,assetId:n}=e;if(!t)return;const o=t.assets.byId[n];if(o.skipOptimisations)return delete o.skipOptimisations,void(o.sizePerComponent=this.imageOptimisationFlow.computeAssetSizePerComponent([o])[o.id]);o.skipOptimisations=!0,delete o.sizePerComponent}checkIfOptimisationDisabled(e){var t;return!(null===(t=this.projectDoc.assets.byId[e])||void 0===t||!t.skipOptimisations)}addNodeAfterSelectedNode(e){const{doc:t,nodeToAdd:n,asset:o}=e;if(!t)return;const i=this.nodeSelectionFlow.getSelectedNodesIds()[0],s=this.projectDoc.nodes.getById(i),r=null===s||void 0===s?void 0:s.parentId;if(!s||!r)throw new Error("Selected node or parent not found");t.addNodesToParentOrStage({nodes:[n],parentId:r,nextSibling:t.nodes.getNextSibling(s)}),o&&n&&(this.assetsEditFlow.createAssetInNodeRelation({nodeId:n.id,assetId:o.id,doc:t}),this.imageOptimisationFlow.computeAssetSizeForComponent({assetId:o.id,doc:t}))}addAssetInNode(e){const{doc:t,nodeToCreate:n,asset:o}=e;t&&(this.nodeManagementFlow.addPrimitivesToSelNodeSelectAndScroll({primitives:[n],doc:t}),o&&n&&(this.assetsEditFlow.createAssetInNodeRelation({nodeId:n.id,assetId:o.id,doc:t}),this.imageOptimisationFlow.computeAssetSizeForComponent({assetId:o.id,doc:t})))}enableOptimisationsForAllImages(e){const{doc:t}=e;t&&Object.values(t.assets.byId).forEach((e=>{e.type===m.K.IMAGE&&delete e.skipOptimisations}))}disableOptimisationsForAllImages(e){const{doc:t}=e;t&&Object.values(t.assets.byId).forEach((e=>{e.type===m.K.IMAGE&&(e.skipOptimisations=!0)}))}async getOptimisedUsedAssets(){const e=this.projectDoc.assets.getAssetsUsedInProject();return await this.assetsService.createOptimisedAssets(e)}},se=(0,d.Z)(ie.prototype,"projectDoc",[F],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),re=(0,d.Z)(ie.prototype,"projectUIState",[k],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ae=(0,d.Z)(ie.prototype,"assetsEditFlow",[R],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ce=(0,d.Z)(ie.prototype,"nodeStyleManagmentFlow",[M],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),le=(0,d.Z)(ie.prototype,"nodeManagementFlow",[U],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),de=(0,d.Z)(ie.prototype,"nodeAttributeManagmentFlow",[Z],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),pe=(0,d.Z)(ie.prototype,"unsplashFlow",[L],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ue=(0,d.Z)(ie.prototype,"notificationsManagementFlow",[B],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),he=(0,d.Z)(ie.prototype,"assetsRepository",[W],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ye=(0,d.Z)(ie.prototype,"projectInitFlow",[z],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),me=(0,d.Z)(ie.prototype,"assetsService",[$],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),fe=(0,d.Z)(ie.prototype,"imageOptimisationFlow",[G],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ge=(0,d.Z)(ie.prototype,"sentryService",[H],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),_e=(0,d.Z)(ie.prototype,"fileDownloadService",[K],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),be=(0,d.Z)(ie.prototype,"assetFoldersFlow",[V],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Ie=(0,d.Z)(ie.prototype,"modalManagementFlow",[Y],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ve=(0,d.Z)(ie.prototype,"assetsUploadFlow",[J],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),we=(0,d.Z)(ie.prototype,"nodeSelectionFlow",[X],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),(0,d.Z)(ie.prototype,"removeClassRelationsFromAssets",[q,I.P],Object.getOwnPropertyDescriptor(ie.prototype,"removeClassRelationsFromAssets"),ie.prototype),(0,d.Z)(ie.prototype,"removeNodeRelationsFromAssets",[Q,I.P],Object.getOwnPropertyDescriptor(ie.prototype,"removeNodeRelationsFromAssets"),ie.prototype),(0,d.Z)(ie.prototype,"toggleAssetOptimisation",[ee,I.P],Object.getOwnPropertyDescriptor(ie.prototype,"toggleAssetOptimisation"),ie.prototype),(0,d.Z)(ie.prototype,"addNodeAfterSelectedNode",[te,I.P],Object.getOwnPropertyDescriptor(ie.prototype,"addNodeAfterSelectedNode"),ie.prototype),(0,d.Z)(ie.prototype,"addAssetInNode",[ne,I.P],Object.getOwnPropertyDescriptor(ie.prototype,"addAssetInNode"),ie.prototype),(0,d.Z)(ie.prototype,"enableOptimisationsForAllImages",[I.P],Object.getOwnPropertyDescriptor(ie.prototype,"enableOptimisationsForAllImages"),ie.prototype),(0,d.Z)(ie.prototype,"disableOptimisationsForAllImages",[I.P],Object.getOwnPropertyDescriptor(ie.prototype,"disableOptimisationsForAllImages"),ie.prototype),oe=ie))},693696:function(e,t,n){var o=n(503348),i=n(777460),s=n(918437),r=n(395942),a=n(302503),c=n(785978),l=n(676422),d=n.n(l),p=n(202784),u=n(552322);const h=e=>{const{handleLinkClick:t,isSizeError:n=!1}=e;return(0,u.jsxs)("div",{className:"jsx-1583539811",children:[(0,u.jsxs)("p",{className:"jsx-1583539811",children:["You have reached the uploads limit ",n?"size":""," in this project. "]}),(0,u.jsxs)("p",{className:"jsx-1583539811 next-row",children:["In order to upload more, you can delete some of the files you don't use anymore. You can do this from the",(0,u.jsx)("span",{onClick:t,className:"jsx-1583539811",children:(0,u.jsx)("b",{className:"jsx-1583539811 assets-manager",children:" assets manager."})})]}),(0,u.jsx)(d(),{id:"1583539811",children:[".next-row.jsx-1583539811{margin-top:5px;}",".assets-manager.jsx-1583539811{cursor:pointer;}"]})]})};var y=n(440516),m=n(686646),f=n(918939),g=n(656733),_=n(491463),b=n(422169),I=n(143180),v=n(638852),w=n(329852),O=n(205632),j=n(975350),S=n(393724),N=n(774468),D=n(378888),E=n(834630),T=n(21023),P=n(173541);const C=e=>{const{onSubmit:t,onDismiss:n}=e,o=(0,p.useCallback)((async()=>{t(),n&&n()}),[]);return(0,u.jsxs)(u.Fragment,{children:[(0,u.jsx)("p",{className:"modal-title",children:"Custom Font file detected"}),(0,u.jsx)("p",{children:"Custom Font files can only be added from Project Settings."}),(0,u.jsxs)("div",{className:"modal-btns",children:[(0,u.jsx)(P.z,{onClick:n,style:"solid",colorScheme:"neutral",children:"Cancel"}),(0,u.jsx)(P.z,{refAttrs:{autoFocus:!0},onClick:o,style:"solid",colorScheme:"accent",children:"Go to Project Settings"})]})]})};var x,A,F,k,R,M,U,Z,L,B,W,z,$,G,H,K,V,Y,J,X,q,Q,ee,te,ne,oe,ie,se,re=n(327089),ae=n(559196);x=(0,a.provide)("assetsUploadFlow"),A=(0,a.inject)("sharedbProjectSyncService"),F=(0,a.inject)("projectDoc"),k=(0,a.inject)("projectUIState"),R=(0,a.inject)("assetsRepository"),M=(0,a.inject)("globalAppState"),U=(0,a.inject)("guardsService"),Z=(0,a.inject)("assetsManagementFlow"),L=(0,a.inject)("notificationsManagementFlow"),B=(0,a.inject)("modalManagementFlow"),W=(0,a.inject)("projectInitFlow"),z=(0,a.inject)("sentryService"),$=(0,a.inject)("workspacesFlow"),G=(0,re.G)(ae.l.UPLOAD_ASSETS),x((K=class{constructor(){(0,o.Z)(this,"dbSync",V,this),(0,o.Z)(this,"projectDoc",Y,this),(0,o.Z)(this,"projectUIState",J,this),(0,o.Z)(this,"assetsRepository",X,this),(0,o.Z)(this,"globalAppState",q,this),(0,o.Z)(this,"guardsService",Q,this),(0,o.Z)(this,"assetsManagementFlow",ee,this),(0,o.Z)(this,"notificationsManagementFlow",te,this),(0,o.Z)(this,"modalManagementFlow",ne,this),(0,o.Z)(this,"projectInitFlow",oe,this),(0,o.Z)(this,"sentryService",ie,this),(0,o.Z)(this,"workspacesFlow",se,this),(0,i.Z)(this,"checkAssetLimitReachedForFreePlan",(e=>{if(this.projectUIState.workspace.professionalSubscription)return!1;const t=this.projectInitFlow.getProjectLimitations(),{size:n}=this.assetsManagementFlow.getAssetsStats();let o=0;return(Array.isArray(e)?e:Object.values(e)).map((e=>{o+=(null===e||void 0===e?void 0:e.size)||0})),n+o>t.MAX_ASSETS_SIZE_FOR_PROJECT&&(v.Z.mixpanelEvent(v.Z.AnalyticsEvents.WORKSPACE_FREEPLAN_LIMIT_ASSETS_REACHED),!0)})),(0,i.Z)(this,"uploadHasVideoAssetForUnpaidUser",(e=>{if(this.globalAppState.isPayingUser)return!1;return(Array.isArray(e)?e:Object.values(e)).some((e=>N.kN.some((t=>null===e||void 0===e?void 0:e.name.toLocaleLowerCase().endsWith(`.${t}`)))))})),(0,i.Z)(this,"validateAssetsToUpload",(e=>{const{size:t,count:n}=this.assetsManagementFlow.getAssetsStats(),o=this.projectInitFlow.getProjectLimitations();let i;i=0;const s=Array.isArray(e)?e:Object.values(e);let r=!1;if(s.map((e=>{if(r)return;i+=(null===e||void 0===e?void 0:e.size)||0;const t=e?(0,T.extname)(e.name):"";let n="."===t.charAt(0)?t.substring(1):t;if(!n)throw new Error("Assets upload failed. Asset type file is missing.");if(n=n.toLocaleLowerCase(),n&&N.bE.includes(n))return void(r=!0);if(n&&!N.oy.includes(n)){const e=`The format of the upload is not supported. Please upload only ${(0,D.si)({list:N.oy,ending:"or"})} files.`;throw new Error(e)}if(((null===e||void 0===e?void 0:e.name)||"").match(S.yS)){throw new Error("Asset name cannot contain * : \" '  | < > ? / `")}})),r)return!1;if(n+e.length>o.MAX_ASSETS_FOR_PROJECT)throw new Error(`${c.N9.MAXIMUM_LIMIT_REACHED}: ${o.MAX_ASSETS_FOR_PROJECT}`);if(t+i>o.MAX_ASSETS_SIZE_FOR_PROJECT){v.Z.mixpanelEvent(v.Z.AnalyticsEvents.WORKSPACE_LIMIT_ASSETS_REACHED);const e=o.MAX_ASSETS_SIZE_FOR_PROJECT/1024/1024,t=e>=1e3?e/1e3+"GB":`${e}MB`;throw new Error(`${c.N9.MAXIMUM_SIZE_LIMIT_REACHED}: ${t}`)}return!0}))}async upload(e){var t,n;const{files:o,assetType:i,parentFolderId:s=w.D.PUBLIC_ASSETS,assetId:a="",projectSettingsFontUpload:c=!1}=e,l=null===(t=this.projectDoc.collaborators.getWorkspaceOwner())||void 0===t||null===(n=t.account)||void 0===n?void 0:n.id,d=this.projectInitFlow.getProjectLimitations();if(this.checkAssetLimitReachedForFreePlan(o)){var p;const e=b.d.createCustomModal({Component:I.$,data:{entity:"assets",workspaceName:this.projectUIState.workspace.name,isWorkspaceOwner:l===(null===(p=this.globalAppState.user.userData)||void 0===p?void 0:p.id),userAssetsSizeLimitation:d.MAX_ASSETS_SIZE_FOR_PROJECT,onSubmit:()=>{v.Z.mixpanelEvent(v.Z.AnalyticsEvents.WORKSPACE_UPGRADE,{source:"assets-limit"}),this.workspacesFlow.triggerUpgradeWorkspaceModal({})},showUpgradeBtn:!0}});this.modalManagementFlow.showModal(e)}else if(this.uploadHasVideoAssetForUnpaidUser(o)){var u;const e=b.d.createCustomModal({Component:I.$,data:{entity:"video",workspaceName:this.projectUIState.workspace.name,isWorkspaceOwner:l===(null===(u=this.globalAppState.user.userData)||void 0===u?void 0:u.id),userAssetsSizeLimitation:d.MAX_ASSETS_SIZE_FOR_PROJECT,onSubmit:()=>{v.Z.mixpanelEvent(v.Z.AnalyticsEvents.WORKSPACE_UPGRADE,{source:"video-asset"}),this.workspacesFlow.triggerUpgradeWorkspaceModal({})},showUpgradeBtn:!0}});this.modalManagementFlow.showModal(e)}else{try{if(!this.validateAssetsToUpload(o)&&!c){const e=b.d.createCustomModal({Component:C,onSubmit:()=>{O.default.push((0,j.No)(this.projectUIState.slug,"fonts"))}});return void this.modalManagementFlow.showModal(e)}}catch(h){return void this.notificationsManagementFlow.createNotification(m.k$.ERROR,h)}try{(0,r.mutate)(this.projectUIState,(e=>e.assetsList.assetUploading[s]=!0));const e=[];Array.from(o).map((t=>{if(!t)return null;e.push(t)}));const t=(0,E.zt)(e).map((e=>this.assetsRepository.upload({files:e,projectId:this.projectDoc.id,assetType:i,parentFolderId:s,assetId:a}))),n=(await Promise.all(t)).flat().filter((e=>e));if(!n)return;n.forEach((e=>{const t=e.name.split("."),n=t[t.length-1].toLocaleLowerCase();N.n1.includes(n)||e.type!==f.K.IMAGE||this.sentryService.captureException(`Potential image type issue, name: ${e.name}, type: ${e.type}`)}));const c=Object.values(this.projectDoc.assets.byId).map((e=>e.name));return this.guardsService.executeFunctionGuarded(g._.DISABLE_HISTORY,(()=>this.dbSync.mutate(this.projectDoc,(e=>{n.forEach((t=>{if(t.name=(0,_._x)(c,t.name.toLowerCase()),c.push(t.name),a){const n=e.assets.byId[a];Object.assign(n,{size:t.size}),delete e.assets.byId[a],e.assets.add(n)}else{e.assets.add(t);const n={[t.id]:"asset"};e.folders.addChildToFolder({child:n,folderId:s})}}))})))),n}catch(h){const e=this.getUploadErrorMessage(h);this.notificationsManagementFlow.createNotification(m.k$.ERROR,e)}finally{(0,r.mutate)(this.projectUIState,(e=>e.assetsList.assetUploading={}))}}}getUploadErrorMessage(e){const t=(null===e||void 0===e?void 0:e.error)&&"string"===typeof e.error;return t&&e.error.includes(c.N9.MAXIMUM_SIZE_LIMIT_REACHED)?(v.Z.mixpanelEvent(v.Z.AnalyticsEvents.WORKSPACE_LIMIT_ASSETS_REACHED),h({handleLinkClick:this.setAssetsManagerAsOpenedSidebar,isSizeError:!0})):t&&e.error.includes(c.N9.MAXIMUM_LIMIT_REACHED)?h({handleLinkClick:this.setAssetsManagerAsOpenedSidebar}):(null===e||void 0===e?void 0:e.error)===c.lI.TOO_MANY_REQUESTS?c.lI.TOO_MANY_REQUESTS:e.message.includes("Payload Too Large")||e.message.includes("413")?"Assets upload failed. The free space limit was reached.":e.message.includes("Internal Server Error")||e.message.includes("500")?"Assets upload failed due to server connection. Please refresh or try again with fewer files.":"Assets upload failed. Please try again."}setAssetsManagerAsOpenedSidebar(){(0,r.mutate)(this.projectUIState,(e=>e.layout.sidebarPanel=y.tI.ASSETS_MANAGER))}},V=(0,s.Z)(K.prototype,"dbSync",[A],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Y=(0,s.Z)(K.prototype,"projectDoc",[F],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),J=(0,s.Z)(K.prototype,"projectUIState",[k],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),X=(0,s.Z)(K.prototype,"assetsRepository",[R],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),q=(0,s.Z)(K.prototype,"globalAppState",[M],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Q=(0,s.Z)(K.prototype,"guardsService",[U],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ee=(0,s.Z)(K.prototype,"assetsManagementFlow",[Z],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),te=(0,s.Z)(K.prototype,"notificationsManagementFlow",[L],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ne=(0,s.Z)(K.prototype,"modalManagementFlow",[B],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),oe=(0,s.Z)(K.prototype,"projectInitFlow",[W],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ie=(0,s.Z)(K.prototype,"sentryService",[z],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),se=(0,s.Z)(K.prototype,"workspacesFlow",[$],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),(0,s.Z)(K.prototype,"upload",[G],Object.getOwnPropertyDescriptor(K.prototype,"upload"),K.prototype),H=K))},978338:function(e,t,n){n.d(t,{gG:function(){return o},Sy:function(){return i},EH:function(){return s},lJ:function(){return r},XF:function(){return a}});const o=(e,t,n)=>{e=e.replace(/[\[\]]/g,"\\$&");const o=new RegExp("[?&]"+e+"(=([^&#]*)|&|#|$)").exec(t);let i=t;return o?(i=i.replace(o[0],n),i):(i+=n,i)},i=e=>{for(let t=e.length-1;t>0;t--){const n=Math.floor(Math.random()*(t+1)),o=e[t];e[t]=e[n],e[n]=o}},s=(e,t)=>{e=e.replace(/[\[\]]/g,"\\$&");const n=new RegExp("[?&]"+e+"(=([^&#]*)|&|#|$)").exec(t);return n||[]},r=e=>{if(!e)return"";if(!e.includes("url("))return e;const t=e.substring(e.indexOf("(")+1,e.lastIndexOf(")"));return!t||t.match(/'([^']*)|"([^"]*)/)?e:e.replace(t,`"${t}"`)},a=(e,t)=>(e=Math.ceil(e),t=Math.floor(t),Math.floor(Math.random()*(t-e+1))+e)},425428:function(e,t,n){var o,i,s,r,a,c,l,d,p,u,h,y,m,f,g,_,b,I,v,w,O,j,S,N,D,E,T,P,C,x,A,F,k,R,M,U,Z,L=n(503348),B=n(777460),W=n(918437),z=n(302503),$=n(785978),G=n(824497),H=n(656733),K=n(395942),V=n(686646),Y=n(422169),J=n(521314),X=n(781872),q=n(239498),Q=n(522788),ee=n(86233),te=n(34802);function ne(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function oe(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ne(Object(n),!0).forEach((function(t){(0,B.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ne(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}o=(0,z.provide)("collaboratorManagementFlow"),i=(0,z.inject)("notificationsManagementFlow"),s=(0,z.inject)("projectUIState"),r=(0,z.inject)("projectDoc"),a=(0,z.inject)("workspaceCollaboratorRepository"),c=(0,z.inject)("workspacesRepository"),l=(0,z.inject)("projectRepository"),d=(0,z.inject)("modalManagementFlow"),p=(0,z.inject)("globalAppState"),u=(0,z.inject)("sharedbProjectSyncService"),h=(0,z.inject)("guardsService"),y=(0,z.inject)("stageScrollFlow"),m=(0,z.inject)("componentManagementFlow"),f=(0,z.inject)("webRTCState"),g=(0,z.inject)("stageMoveFlow"),_=(0,z.inject)("zoomControlFlow"),b=(0,z.inject)("sentryService"),I=(0,z.inject)("permissionsRepository"),o((w=class{constructor(){(0,L.Z)(this,"notificationsManagementFlow",O,this),(0,L.Z)(this,"projectUIState",j,this),(0,L.Z)(this,"projectDoc",S,this),(0,L.Z)(this,"workspaceCollaboratorRepository",N,this),(0,L.Z)(this,"workspacesRepository",D,this),(0,L.Z)(this,"projectRepository",E,this),(0,L.Z)(this,"modalManagementFlow",T,this),(0,L.Z)(this,"globalAppState",P,this),(0,L.Z)(this,"dbSync",C,this),(0,L.Z)(this,"guardsService",x,this),(0,L.Z)(this,"stageScrollFlow",A,this),(0,L.Z)(this,"componentManagementFlow",F,this),(0,L.Z)(this,"webRTCState",k,this),(0,L.Z)(this,"stageMoveFlow",R,this),(0,L.Z)(this,"zoomControlFlow",M,this),(0,L.Z)(this,"sentryService",U,this),(0,L.Z)(this,"permissionsRepository",Z,this),(0,B.Z)(this,"emailIsAlreadyInvited",(e=>this.projectDoc.collaborators.getAll().some((t=>{var n;return(null===(n=t.account)||void 0===n?void 0:n.email)===e||t.invitedEmail===e})))),(0,B.Z)(this,"getCurrentUserProjectRole",(()=>{const e=this.globalAppState.user.userData,t=this.projectDoc.collaborators.getAll().find((t=>{var n;return(null===(n=t.account)||void 0===n?void 0:n.id)===(null===e||void 0===e?void 0:e.id)})),n=null===t||void 0===t?void 0:t.accessType;return n||null})),(0,B.Z)(this,"followUserSelectedPage",(e=>{this.componentManagementFlow.select(e,!0),setTimeout((()=>{this.zoomControlFlow.setStageZoomLevel(.5),this.projectUIState.selection.componentId===e&&this.stageMoveFlow.centerStage()}))})),(0,B.Z)(this,"followUserSelectedNodes",(e=>{e&&(e.length<=0||this.stageScrollFlow.bringNodeIntoView({nodeId:e[0]}))})),(0,B.Z)(this,"requestEditingPermissions",(async()=>{try{await this.permissionsRepository.requestEditingPermissions(this.projectDoc.id)}catch(e){return this.notificationsManagementFlow.handleError(e),!1}return this.notificationsManagementFlow.createNotification(V.k$.INFO,"Permission change request sent."),(0,K.mutate)(this.globalAppState,(({user:e})=>{if(!e||!e.userData)return;const t=e.userData.meta.sentEditingPermissionRequests;e.userData.meta.sentEditingPermissionRequests=oe(oe({},t),{},{[this.projectDoc.id]:(new Date).toISOString()})})),!0})),(0,B.Z)(this,"resetFollowedUserId",(()=>{(0,K.mutate)(this.webRTCState,(e=>{e.followedUserId=null}))})),(0,B.Z)(this,"setFollowedUserId",(e=>{(0,K.mutate)(this.webRTCState,(t=>{t.followedUserId=e}))})),(0,B.Z)(this,"changeProjectAccessType",(async e=>{try{await this.projectRepository.update(this.projectDoc.id,{accessType:e}),this.guardsService.executeFunctionGuarded(H._.DISABLE_HISTORY,(()=>this.dbSync.mutate(this.projectDoc,(t=>{t.accessType=e}))))}catch(t){this.notificationsManagementFlow.handleError($.FC.UPDATE_PROJECT_ACCESS_TYPE)}})),(0,B.Z)(this,"addOrUpdateProjectCollaborator",(async e=>{const{accessType:t,action:n,actionFnc:o,collabEmail:i}=e;if(t===G.Z.READ)return void o();const s=(0,q.m6)({email:i});if(!s){if(await this.isEditorsLimitReached())return void this.notificationsManagementFlow.createNotification(V.k$.ERROR,$.FC.EDITORS_LIMIT_REACHED)}if(!s&&await this.shouldBillNewSeat(i)){const e=Y.d.createCustomModal({Component:J.L,data:{onSubmit:async()=>{await o();const e=Y.d.createCustomModal({Component:te.F});this.modalManagementFlow.showModal(e,{backgroundColor:X.DM.GRAY_300,padding:0})},action:n}});this.modalManagementFlow.showModal(e)}else o()}))}init(e){if(this.getCurrentUserProjectRole()===G.Z.READ)return;const t=e.collaborators,n=Object.values(this.projectDoc.collaborators.byId);(null===t||void 0===t?void 0:t.length)===n.length&&null!==t&&void 0!==t&&t.every((e=>{const t=n.find((t=>t.id===e.id));return!!t&&(t.accessType===e.accessType&&t.permissionLevel===e.permissionLevel&&t.projectsAccessType===e.projectsAccessType)}))||this.dbSync.mutate(this.projectDoc,(t=>{t.collaborators.setAll((null===e||void 0===e?void 0:e.collaborators)||[])}))}async delete(e,t){const n=this.projectDoc.collaborators.byId[e];if(this.guardsService.executeFunctionGuarded(H._.DISABLE_HISTORY,(()=>this.dbSync.mutate(this.projectDoc,(t=>{delete t.collaborators.byId[e]})))),t)return await this.deleteData(e,n);setTimeout((async()=>{await this.deleteData(e,n);const{loggedInUserIsOwner:t,payingSeats:o}=await this.getPayingSeatsIfOwner();t&&this.guardsService.executeFunctionGuarded(H._.DISABLE_HISTORY,(()=>(0,K.mutate)(this.projectUIState,(e=>{e.workspace.payingSeats=o}))))}),100)}async deleteData(e,t){try{const n=await this.workspaceCollaboratorRepository.delete({collaboratorId:e,projectId:this.projectDoc.id});return n||this.guardsService.executeFunctionGuarded(H._.DISABLE_HISTORY,(()=>this.dbSync.mutate(this.projectDoc,(n=>{n.collaborators.byId[e]=t})))),n}catch(n){return n.message.includes($.FC.CANNOT_DELETE_COLLABORATOR)||(this.dbSync.mutate(this.projectDoc,(n=>{n.collaborators.byId[e]=t})),this.notificationsManagementFlow.handleError(`Could not remove collaborator from project. Please try again: ${null===n||void 0===n?void 0:n.message}`)),!1}}async changeAccess(e){const{id:t,accessType:n}=e;if(t&&n)try{await this.workspaceCollaboratorRepository.changeAccess({projectId:this.projectDoc.id,collaboratorId:t,accessType:n});const{loggedInUserIsOwner:e,payingSeats:o}=await this.getPayingSeatsIfOwner();this.guardsService.executeFunctionGuarded(H._.DISABLE_HISTORY,(()=>{this.dbSync.mutate(this.projectDoc,(e=>{const o=e.collaborators.byId[t];o&&(o.accessType=n)})),e&&(0,K.mutate)(this.projectUIState,(e=>{e.workspace.payingSeats=o}))}))}catch(o){this.notificationsManagementFlow.handleError(o.message)}}async add(e){const{email:t,accessType:n}=e;if(!t)return void this.notificationsManagementFlow.handleError($.FC.NO_EMAIL_PROVIDED);const o=this.globalAppState.user.userData;if(o&&t===o.email)this.notificationsManagementFlow.handleError($.FC.CANNOT_ADD_YOURSELF);else try{const e=await this.workspaceCollaboratorRepository.add({workspaceId:this.projectUIState.workspace.id,projectId:this.projectDoc.id,email:t,accessType:n}),{loggedInUserIsOwner:o,payingSeats:i}=await this.getPayingSeatsIfOwner();this.guardsService.executeFunctionGuarded(H._.DISABLE_HISTORY,(()=>{this.dbSync.mutate(this.projectDoc,(t=>{t.collaborators.add(e)})),o&&(0,K.mutate)(this.projectUIState,(e=>{e.workspace.payingSeats=i}))}))}catch(i){this.notificationsManagementFlow.handleError(i.message)}}getLoggedInUserAccessType(){const e=this.globalAppState.user.userData;if(!e)throw new Error("Logged in user not found");const t=this.projectDoc.collaborators.getAll().find((t=>{var n;return(null===(n=t.account)||void 0===n?void 0:n.id)===e.id||t.invitedEmail===e.email}));return(null===t||void 0===t?void 0:t.accessType)||G.Z.READ}getLoggedInUserPermissionLevel(){const e=this.projectDoc.collaborators.getAll(),t=this.globalAppState.user.userData;if(!t)throw new Error("Logged in user not found");const n=e.find((e=>{var n;return(null===(n=e.account)||void 0===n?void 0:n.id)===t.id||e.invitedEmail===t.email}));return(null===n||void 0===n?void 0:n.permissionLevel)||G.z.PROJECT}async shouldBillNewSeat(e){if(this.getLoggedInUserPermissionLevel()===G.z.PROJECT||this.getLoggedInUserAccessType()!==G.Z.OWNER)return!1;const t=await this.userIsEditorInOtherProject(e),n=this.projectUIState.workspace.subscriptionPlanType;return!(!n||!(0,ee.LV)(n)||t)}async userIsEditorInOtherProject(e){const t=(await this.workspaceCollaboratorRepository.getAll(this.projectUIState.workspace.id)).filter((t=>{var n;return e===t.invitedEmail||e===(null===(n=t.account)||void 0===n?void 0:n.email)}));return!!t.length&&"write"===t[0].accessType}async isEditorsLimitReached(){const e=this.projectUIState.workspace.subscriptionPlanType;if(e){const t=await this.workspaceCollaboratorRepository.getAll(this.projectUIState.workspace.id),n=null===t||void 0===t?void 0:t.filter((e=>e.accessType!==G.Z.READ)).length;return!(n&&n<Q.cF[e].MAX_WORKSPACE_EDITORS)}return!1}async getPayingSeatsIfOwner(){const e=this.getLoggedInUserAccessType()===G.Z.OWNER;if(e)try{return{loggedInUserIsOwner:e,payingSeats:await this.workspacesRepository.getPayingSeats(this.projectUIState.workspace.id)}}catch(t){this.sentryService.captureException(new Error(`Paying Seats or Projects With CMS request failed in CollaboratorManagmentFlow: ${null===t||void 0===t?void 0:t.message}`))}return{loggedInUserIsOwner:!1,payingSeats:0}}},O=(0,W.Z)(w.prototype,"notificationsManagementFlow",[i],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),j=(0,W.Z)(w.prototype,"projectUIState",[s],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),S=(0,W.Z)(w.prototype,"projectDoc",[r],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),N=(0,W.Z)(w.prototype,"workspaceCollaboratorRepository",[a],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),D=(0,W.Z)(w.prototype,"workspacesRepository",[c],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),E=(0,W.Z)(w.prototype,"projectRepository",[l],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),T=(0,W.Z)(w.prototype,"modalManagementFlow",[d],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),P=(0,W.Z)(w.prototype,"globalAppState",[p],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),C=(0,W.Z)(w.prototype,"dbSync",[u],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),x=(0,W.Z)(w.prototype,"guardsService",[h],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),A=(0,W.Z)(w.prototype,"stageScrollFlow",[y],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),F=(0,W.Z)(w.prototype,"componentManagementFlow",[m],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),k=(0,W.Z)(w.prototype,"webRTCState",[f],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),R=(0,W.Z)(w.prototype,"stageMoveFlow",[g],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),M=(0,W.Z)(w.prototype,"zoomControlFlow",[_],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),U=(0,W.Z)(w.prototype,"sentryService",[b],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Z=(0,W.Z)(w.prototype,"permissionsRepository",[I],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),v=w))},229187:function(e,t,n){n.d(t,{Q:function(){return o}});const o="rootClassName"},754611:function(e,t,n){var o,i,s,r,a,c,l,d,p,u,h,y,m,f,g,_=n(503348),b=n(777460),I=n(918437),v=n(302503),w=n(329852),O=n(395942),j=n(656733),S=n(918939),N=n(414326);o=(0,v.provide)("assetFoldersFlow"),i=(0,v.inject)("sharedbProjectSyncService"),s=(0,v.inject)("projectDoc"),r=(0,v.inject)("projectUIState"),a=(0,v.inject)("folderManagementFlow"),c=(0,v.inject)("guardsService"),l=(0,v.inject)("assetsSelectionFlow"),o((p=class{constructor(){(0,_.Z)(this,"dbSync",u,this),(0,_.Z)(this,"projectDoc",h,this),(0,_.Z)(this,"projectUIState",y,this),(0,_.Z)(this,"folderManagementFlow",m,this),(0,_.Z)(this,"guardsService",f,this),(0,_.Z)(this,"assetsSelectionFlow",g,this),(0,b.Z)(this,"applySelectionRules",((e,t,n,o,i)=>{const s=Object.keys(this.projectUIState.folders.selected.entities),{ctrl:r,shift:a}=this.projectUIState.userInteractions.pressedKeys;if(i)this.excludeRootFolderFromMixedCtxMenu(s,e);else{if(o&&!r&&!a)return this.assetsSelectionFlow.deselectAllAssets(),this.deselectAllFolders(),void this.assetsSelectionFlow.selectAsset(o,e);if(n){t===w.D.PRIVATE_ASSETS||t===w.D.PUBLIC_ASSETS?(this.deselectAllFolders(),this.assetsSelectionFlow.deselectAllAssets(),this.selectAssetFolder(t,e)):this.excludeRootFolderFromMixedCtxMenu(s,e)}else!r&&!a&&s.length>0&&(this.deselectAllFolders(),this.assetsSelectionFlow.deselectAllAssets(),this.selectAssetFolder(t,e))}})),(0,b.Z)(this,"excludeRootFolderFromMixedCtxMenu",((e,t)=>{e.includes(w.D.PRIVATE_ASSETS)&&this.selectAssetFolder(w.D.PRIVATE_ASSETS,t),e.includes(w.D.PUBLIC_ASSETS)&&this.selectAssetFolder(w.D.PUBLIC_ASSETS,t)})),(0,b.Z)(this,"dontShowPrivateFileWarning",(()=>{(0,O.mutate)(this.projectUIState,(e=>{e.folders.showPrivateFileWarning=!1}))})),(0,b.Z)(this,"setFolderSortType",(e=>{(0,O.mutate)(this.projectUIState,(t=>{t.folders.orderType=e}))}))}selectAssetFolder(e,t){const{selected:n}=this.projectUIState.folders;(0,O.mutate)(this.projectUIState,(o=>{n.entities[e]?(delete o.folders.selected.entities[e],o.folders.selected.location=null):(o.folders.selected.entities[e]=!0,o.folders.selected.location=t)}))}deselectAllFolders(){(0,O.mutate)(this.projectUIState,(e=>{e.folders.selected.entities={},e.folders.selected.location=null}))}moveFoldersToFolder(e){const{folderIds:t,targetFolderId:n}=e;this.guardsService.executeFunctionGuarded(j._.DISABLE_HISTORY,(()=>{(0,O.mutate)(this.projectUIState,(e=>{t.forEach((t=>{delete e.folders.selected.entities[t]}))})),this.dbSync.mutate(this.projectDoc,(e=>{t.forEach((t=>{const o=e.folders.byId[t];if(!o)return;const i={[o.id]:"folder"};e.folders.removeChildFromFolder({child:i,folderId:o.parentId||""}),e.folders.addChildToFolder({child:i,folderId:n})})),e.folders.changeParentFolder(t,n),t.forEach((t=>{const n=e.folders.byId[t];n&&this.folderManagementFlow.rename(t,n.name)}))})),(0,O.mutate)(this.projectUIState,(e=>{t.forEach((t=>{e.folders.selected.entities[t]=!0}))}))}))}moveAssetsToFolder(e){const{assetIds:t,targetFolderId:n}=e;this.guardsService.executeFunctionGuarded(j._.DISABLE_HISTORY,(()=>this.dbSync.mutate(this.projectDoc,(e=>{t.forEach((t=>{const o=e.assets.byId[t];if(!o)return;const i={[o.id]:"asset"};e.folders.removeChildFromFolder({child:i,folderId:o.parentFolderId}),e.folders.addChildToFolder({child:i,folderId:n})})),e.assets.changeParentFolder(t,n)}))))}moveIsDisabled(e,t){return!(!e.length||t!==w.D.PRIVATE_ASSETS)||!!e.includes(t)}removeAssetsFromFolder(e){const{assetIds:t,targetFolderId:n}=e;this.guardsService.executeFunctionGuarded(j._.DISABLE_HISTORY,(()=>this.dbSync.mutate(this.projectDoc,(e=>{t.forEach((t=>{const o=e.assets.byId[t];if(!o)return;const i={[o.id]:"asset"};e.folders.removeChildFromFolder({child:i,folderId:n})}))}))))}getOrderedFoldersOfFolder(e,t){return(t||Object.values(this.projectDoc.folders.byId)).filter((t=>t.parentId===e)).sort(((e,t)=>e.name.localeCompare(t.name)))}getOrderedAssetsOfFolder(e,t){return(t||Object.values(this.projectDoc.assets.byId)).filter((t=>t.parentFolderId===e&&(t.type===S.K.IMAGE||t.type===S.K.VIDEO||t.type===S.K.EDITABLE_FILE||t.type===S.K.FILE))).sort(((e,t)=>{switch(this.projectUIState.folders.orderType){case"size":return parseFloat(t.size.toString())-parseFloat(e.size.toString());default:return e.name.localeCompare(t.name)}}))}getEntitiesFromAFolder(e){let t=[];this.getOrderedFoldersOfFolder(e).map((e=>{t.push({name:e.name,id:e.id,icon:N.TV.folder}),t=[...t,...this.getEntitiesFromAFolder(e.id)]}));const n=this.getOrderedAssetsOfFolder(e).map((e=>({name:e.name,id:e.id,icon:N.TV.asset})));return[...t,...n]}getOrderedAssetAndFolder(){return[...this.getOrderedAssetsOfFolder(w.D.PRIVATE_ASSETS).map((e=>({name:e.name,id:e.id,icon:e.type===S.K.FILE||e.type===S.K.EDITABLE_FILE?N.md["custom-files/file"]:N.TV.asset}))),...this.getEntitiesFromAFolder(w.D.PUBLIC_ASSETS)]}getFirstFromSelectedEntities(){var e,t;const n=Object.keys(this.projectUIState.assetsList.selected.entities),o=Object.keys(this.projectUIState.folders.selected.entities),i=n.concat(o),s=this.getOrderedAssetAndFolder().filter((e=>i.includes(e.id)));return{name:null===(e=s[0])||void 0===e?void 0:e.name,icon:null===(t=s[0])||void 0===t?void 0:t.icon}}getAssetIdsFromFolders(e){return e.reduce(((e,t)=>{const n=this.getOrderedAssetsOfFolder(t).map((e=>e.id));return e.push(...n),e}),[])}getFolderDescendants(e){let t=[];const n=this.getOrderedFoldersOfFolder(e);return t=[...t,...n.map((e=>e.id))],n.forEach((e=>{t=[...t,...this.getFolderDescendants(e.id)]})),t}getMultipleFoldersDescendants(e){return e.map((e=>this.getFolderDescendants(e))).reduce(((e,t)=>[...e,...t]),[])}getAssetsAndFoldersByName(e){const t=this.projectDoc.assets.byId,n=Object.values(this.projectDoc.folders.byId).filter((e=>null!==e.parentId&&e.parentId!==w.D.ASSETS));if(!e)return{assetIds:Object.keys(t),folderIds:n.map((e=>e.id))};const o=e.toLocaleLowerCase(),i=n.reduce(((e,t)=>{if(-1===t.name.toLocaleLowerCase().indexOf(o))return e;-1===e.folderIds.indexOf(t.id)&&e.folderIds.push(t.id);this.getAncestors(t.parentId).forEach((t=>{-1===e.folderIds.indexOf(t)&&e.folderIds.push(t),this.folderManagementFlow.updateFolderExpandStatus(t,!0)}));const n=this.getFolderDescendants(t.id);n.push(t.id),n.forEach((t=>{-1===e.folderIds.indexOf(t)&&e.folderIds.push(t)}));return this.getAssetIdsFromFolders(n).forEach((t=>{-1===e.assetIds.indexOf(t)&&e.assetIds.push(t)})),e}),{assetIds:[],folderIds:[]});return Object.values(t).reduce(((e,t)=>{if(-1===t.name.toLocaleLowerCase().indexOf(o))return e;if(t.type===S.K.PAGE_OG_IMAGE||t.type===S.K.PROJECT_OG_IMAGE||t.type===S.K.FAVICON)return e;-1===e.assetIds.indexOf(t.id)&&e.assetIds.push(t.id);return this.getAncestors(t.parentFolderId).forEach((t=>{-1===e.folderIds.indexOf(t)&&e.folderIds.push(t),this.folderManagementFlow.updateFolderExpandStatus(t,!0)})),e}),i)}getAncestors(e){if(null===e)return[];const t=[];for(;e!==w.D.PRIVATE_ASSETS&&e!==w.D.PUBLIC_ASSETS;){const n=this.projectDoc.folders.byId[e];if(!n||!n.parentId)break;t.push(n.id),e=n.parentId}return t.push(e),t}getAncestorsPath(e){const t=this.getAncestors(e).reverse();if("public"===this.projectDoc.folders.byId[t[0]].name&&t.shift(),e===w.D.PRIVATE_ASSETS)return"";return`${t.map((e=>this.projectDoc.folders.byId[e].name)).join("/")}/`}},u=(0,I.Z)(p.prototype,"dbSync",[i],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),h=(0,I.Z)(p.prototype,"projectDoc",[s],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),y=(0,I.Z)(p.prototype,"projectUIState",[r],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),m=(0,I.Z)(p.prototype,"folderManagementFlow",[a],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),f=(0,I.Z)(p.prototype,"guardsService",[c],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),g=(0,I.Z)(p.prototype,"assetsSelectionFlow",[l],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),d=p))},382405:function(e,t,n){var o=n(503348),i=n(777460),s=n(918437),r=n(918939),a=n(302503),c=n(395942),l=n(235221),d=n(40835),p=n(329852),u=n(491463),h=n(676422),y=n.n(h),m=n(173541),f=n(781872),g=(n(202784),n(884481)),_=n(298384),b=n(16004),I=n(61750),v=n(505892),w=n(552322);const O=e=>{const{folder:t,nestedLevel:n=0,selectedEntities:o,isRoot:i,getSubFolders:s,getAssets:r}=e,a=s(t.id,null===o||void 0===o?void 0:o.folders),c=r(t.id,null===o||void 0===o?void 0:o.assets);return(0,w.jsxs)("div",{className:y().dynamic([["3987683521",[f.N_.UNIT,n*b.ys,i?"capitalize":"none",f.DM.GRAY_900]]]),children:[(0,w.jsxs)("div",{className:y().dynamic([["3987683521",[f.N_.UNIT,n*b.ys,i?"capitalize":"none",f.DM.GRAY_900]]])+" folder-wrapper",children:[(0,w.jsx)(v.J,{type:(0,I.UO)(t.id,c.length+a.length>0),size:16}),(0,w.jsx)("span",{className:y().dynamic([["3987683521",[f.N_.UNIT,n*b.ys,i?"capitalize":"none",f.DM.GRAY_900]]]),children:t.name})]}),(0,w.jsx)("ul",{className:y().dynamic([["3987683521",[f.N_.UNIT,n*b.ys,i?"capitalize":"none",f.DM.GRAY_900]]]),children:a.map((e=>(0,w.jsx)("li",{className:y().dynamic([["3987683521",[f.N_.UNIT,n*b.ys,i?"capitalize":"none",f.DM.GRAY_900]]]),children:(0,w.jsx)(O,{folder:e,selectedEntities:o,nestedLevel:n+1,getSubFolders:s,getAssets:r})},e.id)))}),(0,w.jsx)("ul",{className:y().dynamic([["3987683521",[f.N_.UNIT,n*b.ys,i?"capitalize":"none",f.DM.GRAY_900]]]),children:c.map((e=>(0,w.jsx)("li",{className:y().dynamic([["3987683521",[f.N_.UNIT,n*b.ys,i?"capitalize":"none",f.DM.GRAY_900]]]),children:(0,w.jsx)(_.y,{asset:e,nestedLevel:n+1})},e.id)))}),(0,w.jsx)(y(),{id:"3987683521",dynamic:[f.N_.UNIT,n*b.ys,i?"capitalize":"none",f.DM.GRAY_900],children:[`.folder-wrapper.__jsx-style-dynamic-selector{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;gap:${f.N_.UNIT};height:28px;padding-left:${n*b.ys}px;text-transform:${i?"capitalize":"none"};}`,`span.__jsx-style-dynamic-selector{color:${f.DM.GRAY_900};}`,"ul.__jsx-style-dynamic-selector{list-style:none;}"]})]})},j=e=>{const{onSubmit:t,onDismiss:n,getSubFolders:o,getAssets:i,folders:s,isRootFolder:r,selectedEntities:a,individualAssetsToDelete:c,hasFontsFolder:l}=e;return(0,w.jsxs)("div",{className:y().dynamic([["4189997127",[f.N_.ONE_AND_HALF,f.N_.TWO_UNITS,f.N_.UNIT,f.N_.UNIT,f.N_.HALF_UNIT,f.N_.HALF_UNIT]]])+" wrapper",children:[(0,w.jsx)("p",{className:y().dynamic([["4189997127",[f.N_.ONE_AND_HALF,f.N_.TWO_UNITS,f.N_.UNIT,f.N_.UNIT,f.N_.HALF_UNIT,f.N_.HALF_UNIT]]])+" modal-title",children:r?"Delete nested folders and assets":"Delete folders and assets"}),(0,w.jsxs)("div",{className:y().dynamic([["4189997127",[f.N_.ONE_AND_HALF,f.N_.TWO_UNITS,f.N_.UNIT,f.N_.UNIT,f.N_.HALF_UNIT,f.N_.HALF_UNIT]]])+" entities-wrapper",children:[(0,w.jsx)("p",{className:y().dynamic([["4189997127",[f.N_.ONE_AND_HALF,f.N_.TWO_UNITS,f.N_.UNIT,f.N_.UNIT,f.N_.HALF_UNIT,f.N_.HALF_UNIT]]]),children:`You're going to delete all ${r?"nested":"listed"} assets and folders${l?" (except custom fonts)":""}:\n        `}),(0,w.jsx)(w.Fragment,{children:s.map((e=>(0,w.jsx)(O,{folder:e,isRoot:r,selectedEntities:a,getSubFolders:o,getAssets:i},e.id)))}),(0,w.jsx)(w.Fragment,{children:c&&c.map((e=>(0,w.jsx)(_.y,{asset:e},e.id)))})]}),(0,w.jsxs)("div",{className:y().dynamic([["4189997127",[f.N_.ONE_AND_HALF,f.N_.TWO_UNITS,f.N_.UNIT,f.N_.UNIT,f.N_.HALF_UNIT,f.N_.HALF_UNIT]]])+" modal-btns",children:[(0,w.jsx)(m.z,{onClick:n,style:"solid",colorScheme:"neutral",children:"Cancel"}),(0,w.jsx)(m.z,{onClick:()=>{t(),n()},style:"solid",colorScheme:"danger",refAttrs:{autoFocus:!0},children:"Delete"})]}),(0,w.jsx)(y(),{id:"4189997127",dynamic:[f.N_.ONE_AND_HALF,f.N_.TWO_UNITS,f.N_.UNIT,f.N_.UNIT,f.N_.HALF_UNIT,f.N_.HALF_UNIT],children:[`.modal-title.__jsx-style-dynamic-selector{margin-bottom:${f.N_.ONE_AND_HALF};}`,`.modal-btns.__jsx-style-dynamic-selector{-webkit-box-pack:end;-webkit-justify-content:flex-end;-ms-flex-pack:end;justify-content:flex-end;gap:${f.N_.TWO_UNITS};}`,`.entities-wrapper.__jsx-style-dynamic-selector{padding:${f.N_.UNIT} 0;max-height:300px;overflow:auto;}`,`.entities-wrapper.__jsx-style-dynamic-selector>p.__jsx-style-dynamic-selector{margin-bottom:${f.N_.UNIT};}`,`.entity.__jsx-style-dynamic-selector{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;margin-bottom:${f.N_.HALF_UNIT};}`,".entity.__jsx-style-dynamic-selector:last-child,.entity.__jsx-style-dynamic-selector:only-child{margin-bottom:0;}",`.entity.__jsx-style-dynamic-selector>span.__jsx-style-dynamic-selector{margin-left:${f.N_.HALF_UNIT};}`]}),(0,w.jsx)("style",{children:g.W2})]})};var S,N,D,E,T,P,C,x,A,F,k,R,M,U,Z,L,B,W,z,$,G,H=n(656733),K=n(422169),V=n(686646);S=(0,a.provide)("folderManagementFlow"),N=(0,a.inject)("projectDoc"),D=(0,a.inject)("sharedbProjectSyncService"),E=(0,a.inject)("projectUIState"),T=(0,a.inject)("assetsEditFlow"),P=(0,a.inject)("guardsService"),C=(0,a.inject)("modalManagementFlow"),x=(0,a.inject)("assetFoldersFlow"),A=(0,a.inject)("sentryService"),F=(0,a.inject)("notificationsManagementFlow"),S((R=class{constructor(){(0,o.Z)(this,"projectDoc",M,this),(0,o.Z)(this,"dbSync",U,this),(0,o.Z)(this,"projectUIState",Z,this),(0,o.Z)(this,"assetsEditFlow",L,this),(0,o.Z)(this,"guardsService",B,this),(0,o.Z)(this,"modalManagementFlow",W,this),(0,o.Z)(this,"assetFoldersFlow",z,this),(0,o.Z)(this,"sentryService",$,this),(0,o.Z)(this,"notificationsManagementFlow",G,this),(0,i.Z)(this,"getFolderParents",(e=>{const t=this.projectDoc.folders.byId[e];let n=t.parentId;const o=[t];for(;n;){const e=this.projectDoc.folders.byId[n];o.push(e),n=e.parentId}return o.reverse()})),(0,i.Z)(this,"updateFolderExplorerPanel",((e,t)=>{(0,c.mutate)(this.projectUIState,(n=>{n.folders.explorer.panel=e,t&&(n.folders.explorer.source=e)}))})),(0,i.Z)(this,"clearFolderExplorerSource",(()=>{(0,c.mutate)(this.projectUIState,(e=>{e.folders.explorer.source=null}))})),(0,i.Z)(this,"updateFolderExpandStatus",((e,t)=>{(0,c.mutate)(this.projectUIState,(n=>{t?n.folders.expandedFolders[e]=!0:delete n.folders.expandedFolders[e]}))})),(0,i.Z)(this,"resetAllFolderExpandStatus",(()=>{(0,c.mutate)(this.projectUIState,(e=>{e.folders.expandedFolders={}}))}))}startEditingFolder(e,t){e&&this.projectDoc.folders.byId[e]&&(this.projectDoc.folders.byId[e].name!==p.D.FONTS||this.projectDoc.folders.byId[e].parentId!==p.D.PUBLIC_ASSETS?(0,c.mutate)(this.projectUIState,(n=>{n.folders.folderUnderEdit.folderId=e,n.folders.folderUnderEdit.location=t})):this.notificationsManagementFlow.createNotification(V.k$.ERROR,"Fonts folder cannot be renamed."))}stopEditingAnyFolders(){(0,c.mutate)(this.projectUIState,(e=>{e.folders.folderUnderEdit.folderId=null,e.folders.folderUnderEdit.location=null}))}getChildFoldersOfFolder(e){return this.projectDoc.folders.getChildFoldersOfFolder(e)}create(e){const{folderName:t,parentFolderId:n=p.D.PUBLIC_ASSETS}=e,o=this.projectDoc.folders.getChildFoldersOfFolder(n).map((e=>e.name)),i=(0,u.Zu)(o,t);let s;return this.guardsService.executeFunctionGuarded(H._.DISABLE_HISTORY,(()=>this.dbSync.mutate(this.projectDoc,(e=>{s=e.folders.create({folderName:i,parentFolderId:n}),e.folders.addChildToFolder({child:{[s.id]:"folder"},folderId:n})})))),s}createSubFolder(e){const{parentFolderId:t,location:n}=e,o=this.create({folderName:"New Folder",parentFolderId:t});if(!o)throw new Error("Can't create new folder, check with support!");let i=n;"panel-gallery"===n&&this.updateFolderExplorerPanel(t),"panel-breadcrumbs"===n&&(i="panel-gallery"),this.assetFoldersFlow.deselectAllFolders(),this.assetFoldersFlow.selectAssetFolder(o.id,i),this.updateFolderExpandStatus(t,!0),this.startEditingFolder(o.id,i)}delete(e,t=[]){const n=1===e.length&&(e[0]===p.D.PRIVATE_ASSETS||e[0]===p.D.PUBLIC_ASSETS),o={folderIds:[],assetIds:[]};let i=e;const s=[],r=e.find((e=>this.projectDoc.folders.byId[e].name===p.D.FONTS&&this.projectDoc.folders.byId[e].parentId===p.D.PUBLIC_ASSETS)),a=t.find((e=>this.assetsEditFlow.isCustomFontDependency(e)));if(r)return void this.notificationsManagementFlow.createNotification(V.k$.ERROR,"Fonts folder cannot be deleted.");if(a)return void this.notificationsManagementFlow.createNotification(V.k$.ERROR,"Custom fonts files can only be deleted from project settings.");if(e.length>1){const t=this.assetFoldersFlow.getMultipleFoldersDescendants(e);i=e.filter((e=>!t.includes(e))),i.forEach((e=>{const t=this.getAllChildEntitiesOfFolder(e,!1);o.folderIds=o.folderIds.concat(t.folderIds),o.assetIds=o.assetIds.concat(t.assetIds)}))}else{const t=this.getAllChildEntitiesOfFolder(e[0],n);o.folderIds=t.folderIds,o.assetIds=t.assetIds}t.forEach((e=>{o.assetIds.includes(e)||(o.assetIds.push(e),s.push(e))}));const l=o.folderIds.length;o.assetIds=o.assetIds.filter((e=>!this.assetsEditFlow.isCustomFontDependency(e))),o.folderIds=o.folderIds.filter((e=>{const t=this.projectDoc.folders.byId[e];return!("fonts"===t.name&&"public"===t.parentId)}));const d=l>o.folderIds.length,u={folders:o.folderIds.map((e=>this.projectDoc.folders.byId[e])),assets:o.assetIds.map((e=>this.projectDoc.assets.byId[e]))},h=K.d.createCustomModal({Component:j,onSubmit:async()=>{!(await this.assetsEditFlow.delete(o.assetIds))&&o.assetIds.length||this.guardsService.executeFunctionGuarded(H._.DISABLE_HISTORY,(()=>{(0,c.mutate)(this.projectUIState,(e=>{o.folderIds.forEach((t=>{delete e.folders.selected.entities[t],e.folders.selected.location=null,delete e.folders.expandedFolders[t],e.folders.explorer.panel===t&&(e.folders.explorer.source=null)}))})),this.dbSync.mutate(this.projectDoc,(t=>{n?o.folderIds.forEach((n=>{t.folders.removeChildFromFolder({child:{[n]:"folder"},folderId:e[0]})})):u.folders.forEach((e=>{t.folders.removeChildFromFolder({child:{[e.id]:"folder"},folderId:e.parentId})})),o.folderIds.forEach((e=>{t.folders.delete(e)}))}))}))},data:{folders:i.map((e=>this.projectDoc.folders.byId[e])),isRootFolder:n,selectedEntities:u,individualAssetsToDelete:s.map((e=>this.projectDoc.assets.byId[e])),hasFontsFolder:d,getSubFolders:this.assetFoldersFlow.getOrderedFoldersOfFolder,getAssets:this.assetFoldersFlow.getOrderedAssetsOfFolder}});this.modalManagementFlow.showModal(h)}rename(e,t){t||(t="New Folder");const n=this.projectDoc.folders.getSiblingsFolderOfFolder(e).filter((t=>t.id!==e)).map((e=>e.name));this.guardsService.executeFunctionGuarded(H._.DISABLE_HISTORY,(()=>this.dbSync.mutate(this.projectDoc,(o=>{o.folders.rename(e,(0,u.Zu)(n,t))})))),(0,c.mutate)(this.projectUIState,(e=>{e.folders.folderUnderEdit.folderId=null,e.folders.folderUnderEdit.location=null}))}getAllChildEntitiesOfFolder(e,t){const n=this.projectDoc.folders.byId[e],o=[...Object.keys(n.children)],i={folderIds:t?[]:[e],assetIds:[]};for(;o.length;){const e=o.shift(),t=this.projectDoc.folders.byId[e]||this.projectDoc.assets.byId[e];t instanceof l.g&&(i.folderIds.push(t.id),o.push(...Object.keys(t.children))),t instanceof d.G&&(t.type===r.K.IMAGE||t.type===r.K.VIDEO||t.type===r.K.EDITABLE_FILE||t.type===r.K.FILE)&&i.assetIds.push(t.id)}return i}},M=(0,s.Z)(R.prototype,"projectDoc",[N],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),U=(0,s.Z)(R.prototype,"dbSync",[D],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Z=(0,s.Z)(R.prototype,"projectUIState",[E],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),L=(0,s.Z)(R.prototype,"assetsEditFlow",[T],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),B=(0,s.Z)(R.prototype,"guardsService",[P],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),W=(0,s.Z)(R.prototype,"modalManagementFlow",[C],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),z=(0,s.Z)(R.prototype,"assetFoldersFlow",[x],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),$=(0,s.Z)(R.prototype,"sentryService",[A],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),G=(0,s.Z)(R.prototype,"notificationsManagementFlow",[F],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),k=R))},198478:function(e,t,n){n.d(t,{ks:function(){return o},dS:function(){return i},uw:function(){return s},cM:function(){return r}});const o="System Font",i={100:{label:"100 - Thin",value:"100",italic:!1},"100normal":{label:"100 - Thin",value:"100",italic:!1},200:{label:"200 - Extra Light",value:"200",italic:!1},"200normal":{label:"200 - Extra Light",value:"200",italic:!1},300:{label:"300 - Light",value:"300",italic:!1},"300normal":{label:"300 - Light",value:"300",italic:!1},regular:{label:"400 - Regular",value:"400",italic:!1},400:{label:"400 - Regular",value:"400",italic:!1},"400normal":{label:"400 - Regular",value:"400",italic:!1},500:{label:"500 - Medium",value:"500",italic:!1},"500normal":{label:"500 - Medium",value:"500",italic:!1},600:{label:"600 - Semi-bold",value:"600",italic:!1},"600normal":{label:"600 - Semi-bold",value:"600",italic:!1},bold:{label:"700 - Bold",value:"700",italic:!1},700:{label:"700 - Bold",value:"700",italic:!1},"700normal":{label:"700 - Bold",value:"700",italic:!1},800:{label:"800 - Extra-bold",value:"800",italic:!1},"800normal":{label:"800 - Extra-bold",value:"800",italic:!1},900:{label:"900 - Black",value:"900",italic:!1},"900normal":{label:"900 - Black",value:"900",italic:!1},"100italic":{label:"100 - Thin Italic",value:"100",italic:!0},"200italic":{label:"200 - Extra-light Italic",value:"200",italic:!0},"300italic":{label:"300 - Light Italic",value:"300",italic:!0},"400italic":{label:"400 - Regular Italic",value:"400",italic:!0},italic:{label:"400 - Regular Italic",value:"400",italic:!0},"500italic":{label:"500 - Medium Italic",value:"500",italic:!0},"600italic":{label:"600 - Semi-bold Italic",value:"600",italic:!0},"700italic":{label:"700 - Bold Italic",value:"700",italic:!0},"800italic":{label:"800 - Extra-bold Italic",value:"800",italic:!0},"900italic":{label:"900 - Black Italic",value:"900",italic:!0}},s=["100","200","300","400","500","600","700","800","900"],r={Arial:["400 - Regular","700 - Bold","400 - Regular Italic","700 - Bold Italic"],ArialBlack:["900 - Black","900 - Black Italic"],ComicSansMS:["400 - Regular","700 - Bold","400 - Regular Italic","700 - Bold Italic"],CourierNew:["400 - Regular","700 - Bold","400 - Regular Italic","700 - Bold Italic"],Georgia:["400 - Regular","700 - Bold","400 - Regular Italic","700 - Bold Italic"],Impact:["400 - Regular"],Tahoma:["400 - Regular","700 - Bold"],TimesNewRoman:["400 - Regular","700 - Bold","400 - Regular Italic","700 - Bold Italic"],Verdana:["400 - Regular","700 - Bold","400 - Regular Italic","700 - Bold Italic"],System:["400 - Regular","700 - Bold","400 - Regular Italic","700 - Bold Italic"]}},868570:function(e,t,n){var o=n(622794),i=n(503348),s=n(777460),r=n(918437),a=n(378888),c=n(302503);var l=async()=>{const e=await fetch("https://www.googleapis.com/webfonts/v1/webfonts?sort=popularity&key=AIzaSyAgebXXAIYZq76KRo-5I7MkWWwmJZaX2KM");return(await e.json()).items},d=n(198478);const p=(e,t)=>{const n=e.replace(/ /g,"+");let o=!1;const i=t.map((e=>(e.includes("italic")&&!o&&(o=!0),"italic"===e?"400italic":"regular"===e?"400":e))),s=[...i.filter((e=>!e.includes("italic"))).sort(((e,t)=>e<t?-1:1)),...i.filter((e=>e.includes("italic"))).sort(((e,t)=>e<t?-1:1))].reduce(((e,t)=>{const n=parseInt(t);return e+=o?t.includes("italic")?`1,${n};`:`0,${n};`:`${n};`}),o?"ital,wght@":"wght@");return`https://fonts.googleapis.com/css2?family=${n}:${s.substring(0,s.length-1)}&display=swap`};var u=n(910034),h=n(255328),y=n(244658),m=n(686646);const f=["doc"];var g,_,b,I,v,w,O,j,S,N,D;function E(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function T(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?E(Object(n),!0).forEach((function(t){(0,s.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):E(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}const P=["auto","cursive","fantasy","monospace","sans-serif","serif","inherit","initial","revert","unset",'-apple-system, BlinkMacSystemFont, "Segoe UI", "Roboto", "Oxygen","Ubuntu", "Cantarell", "Fira Sans","Droid Sans", "Helvetica Neue", sans-serif'];g=(0,c.provide)("fontsInProjectFlow"),_=(0,c.inject)("projectDoc"),b=(0,c.inject)("sentryService"),I=(0,c.inject)("sharedbProjectSyncService"),v=(0,c.inject)("notificationsManagementFlow"),g((O=class{constructor(){(0,i.Z)(this,"projectDoc",j,this),(0,i.Z)(this,"sentryService",S,this),(0,i.Z)(this,"dbSync",N,this),(0,i.Z)(this,"notificationsManagementFlow",D,this),(0,s.Z)(this,"allGoogleFonts",[]),(0,s.Z)(this,"allGoogleFontNames",[]),(0,s.Z)(this,"fontsAppendedToHead",{}),(0,s.Z)(this,"appendedGoogleFontsForPreview",{}),(0,s.Z)(this,"customFonts",[]),(0,s.Z)(this,"getFontType",(e=>{if(null===u.Lx||void 0===u.Lx?void 0:u.Lx.find((t=>t===e)))return"system";return this.allGoogleFonts.find((t=>t.family===e))?"google":"custom"})),(0,s.Z)(this,"getFontAvailableWeights",((e,t=!1)=>{e=e.replace(/"/g,"");const n=this.allGoogleFonts.find((t=>t.family===e));if(t)return null===n||void 0===n?void 0:n.variants;const o=Object.keys(d.dS),i=null===n||void 0===n?void 0:n.variants.map((e=>{if(o.includes(e))return d.dS[e]}));if(null!==i&&void 0!==i&&i.length){return[...i.filter((e=>!1===(null===e||void 0===e?void 0:e.italic))).sort(((e,t)=>e&&t&&(null===e||void 0===e?void 0:e.value)<(null===t||void 0===t?void 0:t.value)?-1:1)),...i.filter((e=>!0===(null===e||void 0===e?void 0:e.italic))).sort(((e,t)=>e&&t&&(null===e||void 0===e?void 0:e.value)<(null===t||void 0===t?void 0:t.value)?-1:1))].map((e=>null===e||void 0===e?void 0:e.label))}return e===u.xK&&(e="System"),n&&null!==i&&void 0!==i&&i.length?[]:d.cM[e.replace(/\s/g,"")]})),(0,s.Z)(this,"appendGoogleFontForPreview",(e=>{if(this.appendedGoogleFontsForPreview[e])return;const t=p(e,this.getFontAvailableWeights(e,!0)),n=document.createElement("link");Object.assign(n.dataset,{mode:"font-preview"}),Object.assign(n,{href:t,rel:"stylesheet"}),document.head.appendChild(n),this.appendedGoogleFontsForPreview[e]=n})),(0,s.Z)(this,"removeAllPreviewFonts",(()=>{Object.values(this.appendedGoogleFontsForPreview).forEach((e=>{e.remove()})),this.appendedGoogleFontsForPreview={}})),(0,s.Z)(this,"appendFontToHead",((e,t)=>{if(!this.fontsAppendedToHead[e.name]){if("google"===e.type){if(u.BV.includes(e.name))return void console.error(`Font ${e.name} is deprecated from google. Please use a different font.`);const n=null!==t&&void 0!==t?t:p(e.name,this.getFontAvailableWeights(e.name,!0)),o=document.createElement("link");Object.assign(o.dataset,{fontId:e.id,fontName:e.name}),Object.assign(o,{href:n,rel:"stylesheet"}),document.head.appendChild(o),this.fontsAppendedToHead[e.id]=o}if("custom"===e.type){if(e.properties){const t=document.createElement("style");return t.innerText=e.toFontDecleration()||"",Object.assign(t.dataset,{fontId:e.id,fontName:e.name}),document.head.appendChild(t),void(this.fontsAppendedToHead[e.id]=t)}const n=document.createElement("link"),o=t||e.path;Object.assign(n.dataset,{fontId:e.id,fontName:e.name}),Object.assign(n,{href:o,rel:"stylesheet"}),document.head.appendChild(n),this.fontsAppendedToHead[e.id]=n}}})),(0,s.Z)(this,"isFontImported",((e,t)=>{const n=t||this.projectDoc;return Object.values(n.fonts.byId||{}).map((e=>e.name)).includes(e)})),(0,s.Z)(this,"removeFontFromHead",(e=>{var t;this.fontsAppendedToHead[e]&&(null===(t=this.fontsAppendedToHead[e])||void 0===t||t.remove(),delete this.fontsAppendedToHead[e])})),(0,s.Z)(this,"getCustomFonts",(async()=>Object.values(this.projectDoc.fonts.byId||{}).reduce(((e,t)=>{if("custom"!==t.type)return e;const n=e.find((e=>e.family===t.name)),o=t.properties?t.properties.fontWeight+t.properties.fontStyle:"400";if(n)n.variants.push(o);else{const n={family:t.name,variants:[o]};e.push(n)}return e}),[]))),(0,s.Z)(this,"getAssetFromFontPath",(e=>Object.values(this.projectDoc.assets.byId).find((t=>t.path===e.split("/").pop()))))}async initAndListenForUpdates(){this.removeAllPreviewFonts();try{const e=await l();e&&(this.allGoogleFonts=e,this.allGoogleFontNames=this.allGoogleFonts.map((e=>e.family))),this.customFonts=await this.getCustomFonts()}catch(e){this.sentryService.captureException(e)}this.importGoogleFontsFromDefaultTextStyles(),Object.values(this.projectDoc.fonts.byId).forEach((e=>{const{usedInNodes:t={},usedInTokens:n={},usedInClasses:o={},type:i}=e;"google"===i&&0===Object.keys(t).length&&0===Object.keys(n).length&&0===Object.keys(o).length||(this.removeFontFromHead(e.id),this.appendFontToHead(e))}))}deleteFontById(e){this.dbSync.mutate(this.projectDoc,(t=>{const n=t.fonts.byId[e];if(!n)throw new Error(`Failed in removing font with if ${e} from project`);t.fonts.removeFont(e),this.removeFontFromHead(n.id)}))}removeUnUsedFonts(e){const{doc:t}=e||{};t&&Object.values(this.projectDoc.fonts.byId).forEach((e=>{Object.keys(e.usedInNodes).length||Object.keys(e.usedInTokens).length||e.usedInClasses&&Object.keys(e.usedInClasses).length||"custom"===e.type||t.fonts.removeFont(e.id)}))}importGoogleFont(e){const{doc:t,fontName:n,usedInDefaultTextStyles:o}=e;if(!t)return"";if("google"!==this.getFontType(n))return"";const i=new y.F({id:(0,a.Ox)(),name:n,path:p(n,this.getFontAvailableWeights(n,!0)),type:"google",usedInNodes:{},usedInTokens:T({},o),usedInClasses:{}});return t.fonts.addFont(i),this.appendFontToHead(i),n}importGoogleFontsFromDefaultTextStyles(e){const t=e||this.projectDoc,n=Object.values(t.designLanguage.textStyleSetsById).reduce(((e,t)=>{var n;const o=null===(n=t.content.fontFamily)||void 0===n?void 0:n.content;return"google"===this.getFontType(o)&&(e=T(T({},e),{},{[o]:T(T({},e[o]),{},{[t.id]:!0})})),e}),{});Object.keys(n).forEach((o=>{this.isFontImported(o,t)||this.importGoogleFont({fontName:o,usedInDefaultTextStyles:n[o],doc:e})}))}addFont(e){const{fontName:t,tokens:n=[],nodeIds:o=[],classIds:i=[],path:s,doc:r,properties:c}=e;if(!r)return;const l=r.fonts.getFontByName(t);if(!l){const e=this.getFontType(t);return"custom"!==e||s?void r.fonts.addFont(new y.F(T({id:(0,a.Ox)(),name:t,path:"google"===e?p(t,this.getFontAvailableWeights(t,!0)):"custom"===e?s:void 0,type:e,usedInTokens:null===n||void 0===n?void 0:n.reduce(((e,t)=>(e[t]=!0,e)),{}),usedInNodes:null===o||void 0===o?void 0:o.reduce(((e,t)=>(e[t],e[t]=1,e)),{}),usedInClasses:null===i||void 0===i?void 0:i.reduce(((e,t)=>(e[t],e[t]=1,e)),{})},c&&{properties:c}))):void this.notificationsManagementFlow.createNotification(m.k$.ERROR,"Custom font needs path to be added to the project settings")}r.fonts.updateFontUsageById(l.id,{tokens:n,nodeIds:o,classIds:i},"add")}addNewCustomFont(e){const{doc:t}=e,n=(0,o.Z)(e,f);t&&t.fonts.addFont(new y.F(T(T({},n),{},{id:(0,a.Ox)(),type:"custom",usedInNodes:{},usedInTokens:{},usedInClasses:{}})))}updateFontUsageWhenAddingStyles(e){const{key:t,nodeId:n,fontName:o,oldFontName:i,doc:s}=e;if(!s)return;if("fontFamily"!==t)return;if(i&&this.updateFontUsageWhenRemovingStyles({fontName:i,key:t,nodeId:n}),P.includes(o))return;const r=this.allGoogleFonts.find((e=>e.family===o)),a=u.Lx.find((e=>e===o)),c=s.fonts.getFontByName(o);if(!r&&!c&&!a){if(u.BV.includes(o))return void this.notificationsManagementFlow.createNotification(m.k$.ERROR,`Font ${o} seems to have been deprecated from Google. We recommend to use a different font`);this.notificationsManagementFlow.createNotification(m.k$.ERROR,`Trying to enter an unrecognized font name - ${o}`)}c?s.fonts.updateFontUsageById(c.id,{nodeIds:[n]},"add"):this.addFont({fontName:o,tokens:[],nodeIds:[n]})}updateFontUsageWhenRemovingStyles(e){const{fontName:t,key:n,nodeId:o,doc:i}=e;if(!i)return;if("fontFamily"!==n)return;const s=i.fonts.getFontByName(t);s&&(1===s.usedInNodes[o]?delete s.usedInNodes[o]:s.usedInNodes[o]-=1)}},j=(0,r.Z)(O.prototype,"projectDoc",[_],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),S=(0,r.Z)(O.prototype,"sentryService",[b],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),N=(0,r.Z)(O.prototype,"dbSync",[I],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),D=(0,r.Z)(O.prototype,"notificationsManagementFlow",[v],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),(0,r.Z)(O.prototype,"removeUnUsedFonts",[h.P],Object.getOwnPropertyDescriptor(O.prototype,"removeUnUsedFonts"),O.prototype),(0,r.Z)(O.prototype,"importGoogleFont",[h.P],Object.getOwnPropertyDescriptor(O.prototype,"importGoogleFont"),O.prototype),(0,r.Z)(O.prototype,"addFont",[h.P],Object.getOwnPropertyDescriptor(O.prototype,"addFont"),O.prototype),(0,r.Z)(O.prototype,"addNewCustomFont",[h.P],Object.getOwnPropertyDescriptor(O.prototype,"addNewCustomFont"),O.prototype),(0,r.Z)(O.prototype,"updateFontUsageWhenAddingStyles",[h.P],Object.getOwnPropertyDescriptor(O.prototype,"updateFontUsageWhenAddingStyles"),O.prototype),(0,r.Z)(O.prototype,"updateFontUsageWhenRemovingStyles",[h.P],Object.getOwnPropertyDescriptor(O.prototype,"updateFontUsageWhenRemovingStyles"),O.prototype),w=O))},239031:function(e,t,n){n.d(t,{q:function(){return K}});var o,i,s,r,a,c,l,d,p,u,h,y,m,f,g,_,b,I,v,w,O,j,S,N=n(503348),D=n(777460),E=n(918437),T=n(302503),P=n(395942),C=n(255328),x=n(37164),A=n(555362),F=n(378888),k=n(751433),R=n(233475),M=n(523689),U=n(436035),Z=n(883970),L=n(286873),B=n(656733),W=n(327089),z=n(559196),$=n(686646);function G(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function H(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?G(Object(n),!0).forEach((function(t){(0,D.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):G(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}let K=(o=(0,T.inject)("projectDoc"),i=(0,T.inject)("projectUIState"),s=(0,T.inject)("sharedbProjectSyncService"),r=(0,T.inject)("migrationsFlow"),a=(0,T.inject)("guardsService"),c=(0,T.inject)("workspacesRepository"),l=(0,T.inject)("nodeSelectionFlow"),d=(0,T.inject)("notificationsManagementFlow"),p=(0,T.inject)("propDefinitionManagementFlow"),u=(0,W.G)(z.l.CHANGE_CURRENT_LANGUAGE),h=(0,W.G)(z.l.ADD_NEW_LANGUAGE),S=j=class{constructor(){(0,N.Z)(this,"projectDoc",m,this),(0,N.Z)(this,"projectUIState",f,this),(0,N.Z)(this,"dbSync",g,this),(0,N.Z)(this,"migrationsFlow",_,this),(0,N.Z)(this,"guardsService",b,this),(0,N.Z)(this,"workspacesRepository",I,this),(0,N.Z)(this,"nodeSelectionFlow",v,this),(0,N.Z)(this,"notificationsManagementFlow",w,this),(0,N.Z)(this,"propDefinitionManagementFlow",O,this),(0,D.Z)(this,"translationManager",Z.K.Instance),(0,D.Z)(this,"translationUtils",L.V.Instance),(0,D.Z)(this,"changeCurrentMainlanguage",(e=>{this.dbSync.mutate(this.projectDoc,(t=>{t.internationalization.mainLanguage=e})),this.changeCurrentLanguage(e)}))}static get Instance(){return this._instance||(this._instance=new this)}get isEnabled(){return this.projectDoc.internationalization.enabled}async requestMoreLanguages(){const{id:e}=this.projectUIState.workspace;try{await this.workspacesRepository.requestMoreLanguages(e),this.notificationsManagementFlow.createNotification($.k$.SUCCESS,"We received your request and we will get back to you as soon as possible")}catch(t){if(-1!=(null===t||void 0===t?void 0:t.message.indexOf("was already sent")))return void this.notificationsManagementFlow.createNotification($.k$.WARNING,"A request has already been sent. You can only send one every 24 hours.");this.notificationsManagementFlow.createNotification($.k$.ERROR,"Could not request more languages")}}async enableInternationalization(e){var t;await this.migrationsFlow.createAutomatedBackup(),e=null!==(t=e)&&void 0!==t?t:U.P;let n=!1;this.guardsService.executeFunctionGuarded(B._.DISABLE_HISTORY,(()=>this.dbSync.mutate(this.projectDoc,(t=>{var o;t.internationalization||(t.internationalization=new U.Q(e)),e&&e.short!==(null===(o=t.internationalization.mainLanguage)||void 0===o?void 0:o.short)&&(t.internationalization.mainLanguage=e,t.internationalization.availableLanguages={},t.internationalization.availableLanguages[e.short]=e.name,t.internationalization.translations={},t.internationalization.translations[e.short]={},n=!0),t.internationalization.enabled=!0,this.linkAllTextNodesToTranslations({doc:t})})))),n&&this.changeCurrentLanguage(e)}changeCurrentLanguage(e){(0,P.mutate)(this.projectUIState,(t=>{t.internationalization.currentLanguage=e}));const t=this.projectUIState.selection.componentId,n=this.projectDoc.getProjectPageOrComponent(null!==t&&void 0!==t?t:"");n&&this.nodeSelectionFlow.setNodeSelection({nodeId:n.rootNodeId})}async addNewLanguage(e){if(!this.projectDoc.internationalization.enabled)return;const{language:t,translateContent:n=!1,setAsDefaultLanguage:o=!0}=e,{availableLanguages:i}=this.projectDoc.internationalization;if(i[t.short])return;let s={};const r=n?this.getDefaultContentThatNeedsTranslation():null;if(r){var a;const e=this.projectUIState.selection.componentId,n=this.projectDoc.getProjectPageOrComponent(null!==e&&void 0!==e?e:"");if(!n)return;const o=null!==(a=await this.translationManager.executeTranslation({toTranslate:r.hierarchyContents,pageName:n.title,language:t.name}))&&void 0!==a?a:[];if(r.staticContents){const e=await this.translationManager.executeTranslation({toTranslate:r.staticContents,pageName:n.title,language:t.name});o.push(...null!==e&&void 0!==e?e:[])}s=o.reduce(((e,t)=>(Object.assign(e,H({},t.textsToRewrite)),e)),{})}this.dbSync.mutate(this.projectDoc,(e=>{const n=this.addTranslationNodesForNewLanguage(e,s);e.internationalization.addLanguage(t,null!==n&&void 0!==n?n:{}),(0,P.mutate)(this.projectUIState,(e=>{o&&(e.internationalization.currentLanguage=t)}))}))}deleteLanguage(e){const{doc:t,language:n}=e;if(!t)return;const{currentLanguage:o}=this.projectUIState.internationalization,{availableLanguages:i,mainLanguage:s,translations:r}=t.internationalization||{};if(Object.keys(null!==i&&void 0!==i?i:{}).length<=1||!s)return;if((null===s||void 0===s?void 0:s.short)===n.short)return;o.short===n.short&&this.changeCurrentLanguage(s);const a=r[n.short];if(!r)return;const c=Object.keys(a).map((e=>{const t=a[e];return"static"===t.type?null:t.content})).filter((e=>e));t.deleteNodesById({nodeIds:c}),t.internationalization.removeLanguage(n.short)}getDefaultStaticTextValueForTranslationKey(e){const{doc:t,key:n}=e;if(!t)return null;const{translations:o,mainLanguage:i}=t.internationalization;if(null===i||void 0===i||!i.short)return null;const s=o[i.short][n];if(!s)return null;if("static"===s.type)return s.content;const r=t.nodes.getById(s.content);if(!r||"element-node"!==r.type)return null;return this.translationUtils.extractStaticTextContentFromNode(r).reduce(((e,t)=>{var n;const o=null!==(n=t.textsOrder)&&void 0!==n?n:[];return o.length?(o.forEach((n=>{e+=t.textsToRewrite[n]})),e):e+=Object.keys(t.textsToRewrite).reduce(((e,n)=>e+=t.textsToRewrite[n]),"")}),"")}linkStaticTextToTranslation(e){var t;const{doc:n,initialValue:o,initialLanguage:i,defaultValueForOtherLanguages:s}=e;if(!n)return;const{availableLanguages:r}=n.internationalization,a=null!==(t=e.languageKey)&&void 0!==t?t:`static_${(0,x.x0)(6)}`;return Object.keys(r).forEach((e=>{n.internationalization.addTranslation(e,a,{type:"static",content:e!==i&&null!==s&&void 0!==s?s:o})})),new A.P({content:{id:(0,F.Ox)(),referenceType:"locale",refPath:[a]}})}updateStaticTextTranslation(e){const{doc:t,key:n,value:o,lang:i}=e;if(!t)return;const{translations:s}=t.internationalization,r=s[i];if(!r)return;const a=r[n];a&&"static"===a.type&&(a.content=o)}linkStaticNodesToTranslations(e){const{doc:t,nodes:n}=e;if(!t)return;t.internationalization.enabled&&n.forEach((n=>{var o,i,s,r,a;if("element-node"!==n.type)return;if(!("contentChildren"in n)||!n.contentChildren)return;const c=Object.keys(null!==(o=n.contentChildren)&&void 0!==o?o:{})[0];if(!c)return;const l=n.contentChildren[c];if("static"!==(null===l||void 0===l?void 0:l.type))return;const d=null!==(i=e.languageKey)&&void 0!==i?i:`${null!==(s=n.name)&&void 0!==s?s:"text"}_${(0,x.x0)(6)}`;Object.keys(null!==(r=null===(a=t.internationalization)||void 0===a?void 0:a.availableLanguages)&&void 0!==r?r:{}).forEach((e=>{const n=l.content.toString(),o=new M.F({content:n}),i=new k.HX({primitiveType:R.sO.TEXT,semanticType:R.RY.SPAN,contentChildren:{[o.id]:o}});t.nodes.add(i),t.internationalization.addTranslation(e,d,{type:"hierarchy",content:i.id})}));const p=new A.P({content:{id:(0,F.Ox)(),referenceType:"locale",refPath:[d]}});delete n.contentChildren[c],n.contentChildren[p.id]=p}))}linkAllTextNodesToTranslations(e){const{doc:t}=e;if(!t)return;const{mainLanguage:n}=t.internationalization;if(!n)return;this.propDefinitionManagementFlow.convertAllStringPropDefinitionsToRichText({doc:t});const o=Object.values(t.components.byId);o.forEach((e=>{const n=null===e||void 0===e?void 0:e.propDefinitions;if(n)for(const i of Object.values(n)){var o;"richtext"===(null===i||void 0===i?void 0:i.type)&&this.linkHieraryRootToTranslations({nodeId:null!==(o=i.defaultHierarchyRootId)&&void 0!==o?o:"",doc:t})}}));const i=[],s=Object.values(t.pages.byId);[...o,...s].forEach((e=>{null!==e&&void 0!==e&&e.rootNodeId&&t.nodes.bfs(e.rootNodeId,(e=>{var n;if(e)if("component-instance-node"!==e.type){if("element-node"===e.type&&(!e.parentId||-1===i.indexOf(e.parentId)))if(e.primitiveType!==R.sO.BUTTON)e.primitiveType===R.sO.TEXT&&(this.linkElementNodeToTranslations({node:e,doc:t}),i.push(e.id));else{var o;const n=Object.keys(e.childrenIds),i=Object.keys(null!==(o=e.contentChildren)&&void 0!==o?o:{});!n.length&&!!i.length&&this.linkStaticNodesToTranslations({nodes:[e],doc:t})}}else Object.values(null!==(n=e.attrs)&&void 0!==n?n:{}).forEach((e=>{var n,o;"hierarchy"===e.type&&this.linkHieraryRootToTranslations({nodeId:null!==(n=null===(o=e.content)||void 0===o?void 0:o.toString())&&void 0!==n?n:"",doc:t})}))}))})),s.forEach((e=>{e&&this.linkPageSettingsToTranslations({pageId:e.id,doc:t})}))}linkPageSettingsToTranslations(e){const{doc:t,pageId:n}=e;if(!t)return;const{mainLanguage:o}=t.internationalization;if(!o)return;const i=t.pages.byId[n];if(!i||!i.settings)return;const{settings:s}=i;["title","description","seoTitle","seoDescription","socialTitle","socialDescription"].forEach((e=>{const t=s[e];if(!t)return;const n=this.linkStaticTextToTranslation({initialValue:null===t||void 0===t?void 0:t.toString(),initialLanguage:o.short});n&&Object.assign(s,{[e]:n})}))}linkHieraryRootToTranslations(e){const{nodeId:t,doc:n}=e;if(!n||!t)return;const o=n.nodes.getById(null!==t&&void 0!==t?t:"");if("element-node"!==(null===o||void 0===o?void 0:o.type)||(null===o||void 0===o?void 0:o.primitiveType)!==R.sO.FRAGMENT)return;const i=Object.keys(o.childrenIds)[0],s=n.nodes.getById(i);s&&"element-node"===s.type&&this.linkElementNodeToTranslations({node:s,doc:n})}linkElementNodeToTranslations(e){var t;const{node:n,doc:o}=e;if(!o||!n)return;const i=Object.keys(n.childrenIds),s=Object.keys(null!==(t=n.contentChildren)&&void 0!==t?t:{});i.length||!s.length?this.linkRichTextNodesToTranslations({nodes:[n],doc:o}):this.linkStaticNodesToTranslations({nodes:[n],doc:o})}linkRichTextNodesToTranslations(e){const{doc:t,nodes:n}=e;t&&n.forEach((n=>{var o,i;if("element-node"!==n.type)return;if(!("childrenIds"in n)||!Object.keys(n.childrenIds).length)return;const s=null!==(o=e.languageKey)&&void 0!==o?o:`${null!==(i=n.name)&&void 0!==i?i:"text"}_${(0,x.x0)(6)}`;Object.keys(t.internationalization.availableLanguages).forEach((e=>{const o=new k.HX({primitiveType:R.sO.TEXT,semanticType:R.RY.SPAN}),i=Object.keys(n.childrenIds).reduce(((e,n)=>{if(!t.nodes.getById(n))return e;const i=t.cloneNode({nodeId:n,removeRootStatus:!0});return i?(i.parentId=o.id,t.addNode(i),e[i.id]=!0,e):e}),{});o.childrenIds=H({},i),t.nodes.add(o),t.internationalization.addTranslation(e,s,{type:"hierarchy",content:o.id})})),t.deleteNodesById({nodeIds:Object.keys(n.childrenIds),withSubtree:!0,deleteRoot:!0}),n.childrenIds={};const r=new A.P({content:{id:(0,F.Ox)(),referenceType:"locale",refPath:[s]}});n.contentChildren={},n.contentChildren[r.id]=r}))}getDefaultContentThatNeedsTranslation(){const{translations:e,mainLanguage:t}=this.projectDoc.internationalization;if(null===t||void 0===t||!t.short)return null;const n=e[t.short];return{staticContents:Object.keys(n).reduce(((e,t)=>{const o=n[t];if("static"===o.type){if(!o.content)return e;if("string"!==typeof o.content)return e;e.push({textsToRewrite:{[t]:o.content}})}return e}),[]),hierarchyContents:Object.keys(n).map((e=>{const t=n[e];if("hierarchy"!==t.type)return null;const o=this.projectDoc.nodes.getById(t.content);return o&&"element-node"===o.type?this.translationUtils.extractStaticTextContentFromNode(o):null})).flat().filter((e=>e))}}addTranslationNodesForNewLanguage(e,t){const{mainLanguage:n,translations:o}=e.internationalization;if(!n)return null;const i=o[n.short];return Object.keys(null!==i&&void 0!==i?i:{}).length?Object.keys(i).reduce(((n,o)=>{const s=i[o];switch(s.type){case"static":var r;return n[o]={type:"static",content:null!==(r=t[o])&&void 0!==r?r:s.content},n;case"hierarchy":{const{hierarchyClone:i,newRootNodeId:r}=this.translationUtils.cloneHierarchyAndInjectTranslations(e,s.content,t);if(!r)throw new Error("Could not generate new root node hierarchy id");i.forEach((t=>{e.addNode(t)})),n[o]={type:"hierarchy",content:r}}}return n}),{}):null}},(0,D.Z)(j,"_instance",void 0),y=S,m=(0,E.Z)(y.prototype,"projectDoc",[o],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),f=(0,E.Z)(y.prototype,"projectUIState",[i],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),g=(0,E.Z)(y.prototype,"dbSync",[s],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),_=(0,E.Z)(y.prototype,"migrationsFlow",[r],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),b=(0,E.Z)(y.prototype,"guardsService",[a],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),I=(0,E.Z)(y.prototype,"workspacesRepository",[c],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),v=(0,E.Z)(y.prototype,"nodeSelectionFlow",[l],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),w=(0,E.Z)(y.prototype,"notificationsManagementFlow",[d],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),O=(0,E.Z)(y.prototype,"propDefinitionManagementFlow",[p],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),(0,E.Z)(y.prototype,"changeCurrentLanguage",[u],Object.getOwnPropertyDescriptor(y.prototype,"changeCurrentLanguage"),y.prototype),(0,E.Z)(y.prototype,"addNewLanguage",[h],Object.getOwnPropertyDescriptor(y.prototype,"addNewLanguage"),y.prototype),(0,E.Z)(y.prototype,"deleteLanguage",[C.P],Object.getOwnPropertyDescriptor(y.prototype,"deleteLanguage"),y.prototype),(0,E.Z)(y.prototype,"getDefaultStaticTextValueForTranslationKey",[C.P],Object.getOwnPropertyDescriptor(y.prototype,"getDefaultStaticTextValueForTranslationKey"),y.prototype),(0,E.Z)(y.prototype,"linkStaticTextToTranslation",[C.P],Object.getOwnPropertyDescriptor(y.prototype,"linkStaticTextToTranslation"),y.prototype),(0,E.Z)(y.prototype,"updateStaticTextTranslation",[C.P],Object.getOwnPropertyDescriptor(y.prototype,"updateStaticTextTranslation"),y.prototype),(0,E.Z)(y.prototype,"linkStaticNodesToTranslations",[C.P],Object.getOwnPropertyDescriptor(y.prototype,"linkStaticNodesToTranslations"),y.prototype),(0,E.Z)(y.prototype,"linkAllTextNodesToTranslations",[C.P],Object.getOwnPropertyDescriptor(y.prototype,"linkAllTextNodesToTranslations"),y.prototype),(0,E.Z)(y.prototype,"linkPageSettingsToTranslations",[C.P],Object.getOwnPropertyDescriptor(y.prototype,"linkPageSettingsToTranslations"),y.prototype),(0,E.Z)(y.prototype,"linkHieraryRootToTranslations",[C.P],Object.getOwnPropertyDescriptor(y.prototype,"linkHieraryRootToTranslations"),y.prototype),(0,E.Z)(y.prototype,"linkElementNodeToTranslations",[C.P],Object.getOwnPropertyDescriptor(y.prototype,"linkElementNodeToTranslations"),y.prototype),(0,E.Z)(y.prototype,"linkRichTextNodesToTranslations",[C.P],Object.getOwnPropertyDescriptor(y.prototype,"linkRichTextNodesToTranslations"),y.prototype),y)},883970:function(e,t,n){n.d(t,{K:function(){return F}});var o=n(503348),i=n(777460),s=n(918437),r=n(523689),a=n(302503);class c{constructor(){(0,i.Z)(this,"translationCache",{})}static get Instance(){return this._instance||(this._instance=new this)}extractContentFromCache(e=[],t){const n=[],o=[];for(const s of e){var i;if(1!==Object.keys(s.textsToRewrite).length){o.push(s);continue}const e=Object.keys(s.textsToRewrite)[0],r=s.textsToRewrite[e],a=null===(i=this.translationCache[t])||void 0===i?void 0:i.find((e=>e.initialValue===r));if(a&&a.translated){const t={textsToRewrite:{[e]:a.translated}};n.push(t)}else o.push(s)}return{cachedTranslations:n,nonCachedTranslations:o}}saveTranslationToCache(e,t,n){for(const o of e){if(1!==Object.keys(o.textsToRewrite).length)continue;const e=Object.keys(o.textsToRewrite)[0],i=o.textsToRewrite[e],s=t.find((t=>1===Object.keys(t.textsToRewrite).length&&Object.keys(t.textsToRewrite)[0]===e)),r=null===s||void 0===s?void 0:s.textsToRewrite[e];if(!r)continue;this.translationCache[n]||(this.translationCache[n]=[]);this.translationCache[n].find((e=>e.initialValue===i))||this.translationCache[n].push({initialValue:i,translated:r})}}}(0,i.Z)(c,"_instance",void 0);var l,d,p,u,h,y,m,f,g,_,b,I,v,w,O,j,S,N,D,E=n(286873),T=n(656733),P=n(395942),C=n(378888),x=n(686646);function A(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}let F=(l=(0,a.inject)("projectDoc"),d=(0,a.inject)("projectUIState"),p=(0,a.inject)("aiContentGenerationFlow"),u=(0,a.inject)("nodeAttributeManagmentFlow"),h=(0,a.inject)("sharedbProjectSyncService"),y=(0,a.inject)("rtcFlow"),m=(0,a.inject)("guardsService"),f=(0,a.inject)("notificationsManagementFlow"),D=N=class{constructor(){(0,o.Z)(this,"projectDoc",_,this),(0,o.Z)(this,"projectUIState",b,this),(0,o.Z)(this,"aiContentGenerationFlow",I,this),(0,o.Z)(this,"nodeAttributeManagmentFlow",v,this),(0,o.Z)(this,"dbSync",w,this),(0,o.Z)(this,"rtcFlow",O,this),(0,o.Z)(this,"guardsService",j,this),(0,o.Z)(this,"notificationsManagementFlow",S,this),(0,i.Z)(this,"translationCache",c.Instance),(0,i.Z)(this,"translationUtils",E.V.Instance),(0,i.Z)(this,"executeTranslation",(async e=>{const{toTranslate:t,language:n,pageName:o}=e,i=this.translationCache.extractContentFromCache(t,n),{nonCachedTranslations:s,cachedTranslations:r}=i;if(!s.length)return r;try{const e=await this.aiContentGenerationFlow.generateTextAlternativeForMultipleTexts({command:"TRANSLATE",metadata:s,pageName:o,newLanguage:n});return this.translationCache.saveTranslationToCache(t,e,n),[...e,...r]}catch(a){return null}})),(0,i.Z)(this,"getAttributeReferencingLangFromCompInstance",(e=>{var t;const n=this.projectDoc.nodes.getById(e);if(!n||"component-instance-node"!==n.type)return null;const o=Object.values(null!==(t=n.attrs)&&void 0!==t?t:{}).map((e=>{var t;if("hierarchy"!==e.type)return null;const n=this.projectDoc.nodes.getById(e.content.toString());if(!n||"element-node"!==n.type)return null;const o=Object.keys(null!==(t=n.childrenIds)&&void 0!==t?t:{})[0],i=this.projectDoc.nodes.getById(null!==o&&void 0!==o?o:"");if(!i||"element-node"!==i.type)return null;return i.getContentLangReferenceKey()})).filter((e=>e));return this.getTranslationNodesForReferenceKeys(o)}))}static get Instance(){return this._instance||(this._instance=new this)}async translateAllNodesFromMainLanguageToEveryLanguage(e){const t=this.projectDoc.internationalization.enabled;if(!this.projectUIState.userPreferences.automaticallyTranslateTextElements||!t)return;const{mainLanguage:n,availableLanguages:o,translations:i}=this.projectDoc.internationalization;if(null===n||void 0===n||!n.short||Object.keys(o).length<=1)return;const s=this.getContentToTranslateFromComponentsOrPages([e],!0);if(!Object.keys(s).length)return;this.lockNodesThatNeedTranslation([e],Object.values(s).flat());const r=this.showTranslationInProgressNotification(),a=[],c=i[n.short];for(const l of Object.keys(o)){if(l===(null===n||void 0===n?void 0:n.short))continue;const e=await this.executeTranslation({toTranslate:s[n.name],language:l});e&&(e.forEach((e=>{Object.keys(e.textsToRewrite).forEach((t=>{const n=this.projectDoc.nodes.getById(t);if(!n||"element-node"!==n.type)return;const o=Object.keys(c).find((e=>c[e].content===t));if(!o)return;const i=this.projectDoc.internationalization.getTranslationRootHierarchyNodeId(l,o);i&&(Object.assign(e.textsToRewrite,{[i]:e.textsToRewrite[t]}),delete e.textsToRewrite[t])}))})),a.push(...e))}this.applyTranslatedChangesToActualNodes(a,(t=>{[e].forEach((e=>{this.nodeAttributeManagmentFlow.resetAllComponentHierarchyAttributes({compId:e,doc:t})}))})),this.rtcFlow.lockNodesUnderTranslation([]),this.notificationsManagementFlow.handleNotificationDelete(r)}async translateComponentsNodesInEveryLanguage(e){const t=this.projectDoc.internationalization.enabled;if(!this.projectUIState.userPreferences.automaticallyTranslateTextElements||!t)return;const n=Array.isArray(e.compIds)?e.compIds:[e.compIds],{mainLanguage:o,availableLanguages:i}=this.projectDoc.internationalization;if(null===o||void 0===o||!o.short||Object.keys(i).length<=1)return;const s=this.getContentToTranslateFromComponentsOrPages(n);if(!Object.keys(s).length)return;this.lockNodesThatNeedTranslation(n,Object.values(s).flat());const r=[];for(const a of Object.keys(s)){if(a===(null===o||void 0===o?void 0:o.name))continue;const e=await this.executeTranslation({toTranslate:s[a],language:a});e&&r.push(...e)}this.applyTranslatedChangesToActualNodes(r,(e=>{n.forEach((t=>{this.nodeAttributeManagmentFlow.resetAllComponentHierarchyAttributes({compId:t,doc:e})}))})),this.rtcFlow.lockNodesUnderTranslation([])}async translateStaticValueInEveryLanguage(e){if(!this.projectDoc.internationalization.enabled)return;const{mainLanguage:t,availableLanguages:n,translations:o}=this.projectDoc.internationalization;if(null===t||void 0===t||!t.short)return;const i=o[t.short][e];if(!i||"static"!==i.type)return;const s=Object.keys(n).reduce(((o,s)=>{if(s===(null===t||void 0===t?void 0:t.short))return o;const r={[e]:i.content};return o[n[s]]=[{textsToRewrite:r}],o}),{}),r=Object.keys(s).reduce(((e,n)=>(n===(null===t||void 0===t?void 0:t.name)||(e[n]=this.executeTranslation({toTranslate:s[n],language:n})),e)),{});await Promise.all(Object.values(r));const a={};for(const c of Object.keys(r))a[c]=await r[c];this.guardsService.executeFunctionGuarded(T._.DISABLE_HISTORY,(()=>{this.dbSync.mutate(this.projectDoc,(t=>{Object.keys(a).forEach((o=>{var i;const s=a[o];if(!s)return;const r=null===(i=s[0])||void 0===i?void 0:i.textsToRewrite[e];if(!r)return;const c=Object.keys(n).find((e=>n[e]===o));c&&(t.internationalization.translations[c][e]={type:"static",content:r})}))}))}))}async translateNodeInEveryLanguage(e){var t;if(!this.projectDoc.internationalization.enabled)return;const{nodeId:n,meta:o}=e;if(!this.projectUIState.userPreferences.automaticallyTranslateTextElements&&(null===o||void 0===o||!o.bypassAutomaticallyTranslateOption))return;this.translationUtils.showNodeAutomaticTranslationDialog();const{mainLanguage:s,availableLanguages:a,translations:c}=this.projectDoc.internationalization;if(null===s||void 0===s||!s.short||Object.keys(a).length<=1)return;if(this.projectUIState.internationalization.currentLanguage.short!==s.short&&!0!==(null===o||void 0===o?void 0:o.forceTranslate))return;const l=this.projectDoc.nodes.getById(n);if(!l||"element-node"!==l.type)return;let d=l.getContentLangReferenceKey();if(!d){if(d=Object.keys(c[s.short]).find((e=>c[s.short][e].content===n)),!d){var p,u;const e=Object.keys(null!==(p=l.contentChildren)&&void 0!==p?p:{})[0],t=null===(u=l.contentChildren)||void 0===u?void 0:u[e];"dynamic"===(null===t||void 0===t?void 0:t.type)&&"prop"===t.content.referenceType&&(d=this.translationUtils.getTranslationLangReferenceKeyFromProp(t.content.id))}if(!d)return}const h=this.projectDoc.internationalization.getTranslationRootHierarchyNodeId(s.short,d),y=this.projectDoc.nodes.getById(null!==(t=null===h||void 0===h?void 0:h.toString())&&void 0!==t?t:"");if(!y||"element-node"!==y.type)return;const m=this.getNodeIdsToLockFromNode(y);this.rtcFlow.lockNodesUnderTranslation(m);const f=this.translationUtils.extractStaticTextContentFromNode(y),g={};for(const i of Object.keys(a)){var _;if(i===(null===s||void 0===s?void 0:s.short))continue;const e=c[i][d];if(!e||"hierarchy"!==e.type)continue;const t=await this.executeTranslation({toTranslate:f,language:a[i]});t&&(t.forEach((e=>{Object.assign(e,{lang:i})})),g[null===(_=e.content)||void 0===_?void 0:_.toString()]=t)}this.guardsService.executeFunctionGuarded(T._.DISABLE_HISTORY,(()=>{this.dbSync.mutate(this.projectDoc,(e=>{Object.keys(g).forEach((t=>{const n=e.nodes.getById(t);if(!n||"element-node"!==n.type)return;const o=g[t];null!==o&&void 0!==o&&o.length&&o.forEach((t=>{var a,l,p,u,h;const y=Object.keys(t.textsToRewrite)[0];if(!y)return;if(1===Object.keys(null!==(a=t.textsToRewrite)&&void 0!==a?a:{}).length){var m;const o=new r.F({content:t.textsToRewrite[y]}),i=Object.values(null!==(m=n.contentChildren)&&void 0!==m?m:{})[0];return"static"===(null===i||void 0===i?void 0:i.type)&&(n.contentChildren={}),n.contentChildren[o.id]=o,void(Object.keys(n.childrenIds).length&&(n.childrenIds={},e.deleteNodesById({nodeIds:Object.keys(n.childrenIds)})))}const f=c[s.short];if(!f)return;const g=f[d],_=o.reduce(((e,t)=>(Object.assign(e,function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?A(Object(n),!0).forEach((function(t){(0,i.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):A(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},t.textsToRewrite)),e)),{}),b=this.translationUtils.cloneHierarchyAndInjectTranslations(e,null===(l=g.content)||void 0===l?void 0:l.toString(),_),{hierarchyClone:I,newRootNodeId:v}=b;if(!v)throw new Error("Could not generate new root node hierarchy id");const w=e.internationalization.translations[t.lang][d];w&&"hierarchy"===w.type&&(e.deleteNodesById({nodeIds:[null===(p=w.content)||void 0===p?void 0:p.toString()]}),this.storeNodesHistory(null!==(u=null===(h=w.content)||void 0===h?void 0:h.toString())&&void 0!==u?u:"",v),I.forEach((t=>{e.addNode(t)})),e.internationalization.translations[t.lang][d]={type:"hierarchy",content:v})}))}))}))})),this.rtcFlow.lockNodesUnderTranslation([])}applyTranslatedChangesToActualNodes(e,t){this.guardsService.executeFunctionGuarded(T._.DISABLE_HISTORY,(()=>{this.dbSync.mutate(this.projectDoc,(n=>{e.forEach((e=>{Object.keys(e.textsToRewrite).forEach((t=>{var o;const i=n.nodes.getById(t);if(!i||"element-node"!==i.type)return;const s=new r.F({content:e.textsToRewrite[t]}),a=Object.values(null!==(o=i.contentChildren)&&void 0!==o?o:{})[0];"static"===(null===a||void 0===a?void 0:a.type)&&(i.contentChildren={}),i.contentChildren[s.id]=s}))})),null===t||void 0===t||t(n)}))}))}storeNodesHistory(e,t){(0,P.mutate)(this.projectUIState,(n=>{n.nodesHistory[e]=t}))}getContentToTranslateFromComponentsOrPages(e,t=!1){const n={};return e.forEach((e=>{var o;const i=this.projectDoc.getProjectPageOrComponent(e);i&&i.rootNodeId&&(Object.values(null!==(o=i.propDefinitions)&&void 0!==o?o:{}).forEach((e=>{var t;if("richtext"!==e.type&&!e.defaultHierarchyRootId)return;const o=this.projectDoc.nodes.getById(e.defaultHierarchyRootId);if("element-node"!==(null===o||void 0===o?void 0:o.type)||"fragment"!==(null===o||void 0===o?void 0:o.primitiveType))return;const i=Object.keys(null!==(t=o.childrenIds)&&void 0!==t?t:{})[0],s=this.projectDoc.nodes.getById(null!==i&&void 0!==i?i:"");if(!s||"element-node"!==s.type)return;const r=s.getContentLangReferenceKey();if(!r)return;const a=this.extractContentFromNodeInAllLanguages(r);a&&Object.keys(a).forEach((e=>{n[e]||(n[e]=[]),n[e].push(...a[e])}))})),this.projectDoc.nodes.bfs(i.rootNodeId,(e=>{if("element-node"!==e.type)return;const o=e.getContentLangReferenceKey();if(!o)return;const i=this.extractContentFromNodeInAllLanguages(o,t);if(!i)return;Object.keys(i).forEach((e=>{n[e]||(n[e]=[]),n[e].push(...i[e])}));const s=this.translationUtils.getTranslationNodeFromElementNode({node:e});s&&s.type})))})),n}extractContentFromNodeInAllLanguages(e,t=!1){const{mainLanguage:n,availableLanguages:o,translations:i}=this.projectDoc.internationalization;if(null===n||void 0===n||!n.short)return null;const s={};return Object.keys(o).forEach((r=>{var a;if(r===n.short&&!t)return;if(r!==n.short&&t)return;const c=i[r];if(!c)return;const l=c[e];if("hierarchy"!==l.type)return;const d=this.projectDoc.nodes.getById(null===(a=l.content)||void 0===a?void 0:a.toString());if(!d||"element-node"!==d.type)return;const p=this.translationUtils.extractStaticTextContentFromNode(d);s[o[r]]||(s[o[r]]=[]),s[o[r]].push(p[0])})),s}getNodeIdsToLockFromNode(e){var t;const{translations:n,mainLanguage:o,availableLanguages:i}=this.projectDoc.internationalization;if(null===o||void 0===o||!o.short)return[];const s=Object.keys(null!==(t=n[null===o||void 0===o?void 0:o.short])&&void 0!==t?t:{}).find((t=>n[null===o||void 0===o?void 0:o.short][t].content===e.id));return s?Object.keys(i).map((e=>{var t;if(e===(null===o||void 0===o?void 0:o.short))return null;const i=n[e][s];if(!i||"hierarchy"!==i.type)return null;const r=i.content,a=this.projectDoc.nodes.getById(null===r||void 0===r?void 0:r.toString());return a&&"element-node"===a.type?Object.keys(null!==(t=a.childrenIds)&&void 0!==t?t:{}).length?Object.keys(a.childrenIds):[r]:null})).filter((e=>e)).flat():[]}lockNodesThatNeedTranslation(e,t){const n=[...t.map((e=>Object.keys(e.textsToRewrite).map((e=>{const t=this.projectDoc.nodes.getById(e);return t&&"element-node"===t.type?e:null})))).filter((e=>e)).flat(),...this.extractAllLangAttributesFromComponentInstances(e)];this.rtcFlow.lockNodesUnderTranslation(n)}extractAllLangAttributesFromComponentInstances(e){return e.map((e=>{var t;const n=this.projectDoc.components.byId[e];if(!n||!Object.keys(null!==(t=n.instantiatedByNodes)&&void 0!==t?t:{}).length)return null;return Object.keys(n.instantiatedByNodes).map(this.getAttributeReferencingLangFromCompInstance).filter((e=>e)).flat()})).filter((e=>e)).flat()}getTranslationNodesForReferenceKeys(e,t=!0){const{availableLanguages:n,mainLanguage:o}=this.projectDoc.internationalization;return Object.keys(n).map((n=>{if(n===(null===o||void 0===o?void 0:o.short)&&t)return null;const i=this.projectDoc.internationalization.translations[n];return i?e.map((e=>{const t=i[e];return t&&"hierarchy"===t.type?t.content:null})).filter((e=>e)):null})).filter((e=>e)).flat()}showTranslationInProgressNotification(){const e=(0,C.Ox)();return this.notificationsManagementFlow.createNotification(x.k$.DEFAULT,"Translation in progress",{disableClose:!0,disableExpiration:!0,id:e}),e}},(0,i.Z)(N,"_instance",void 0),g=D,_=(0,s.Z)(g.prototype,"projectDoc",[l],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),b=(0,s.Z)(g.prototype,"projectUIState",[d],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),I=(0,s.Z)(g.prototype,"aiContentGenerationFlow",[p],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),v=(0,s.Z)(g.prototype,"nodeAttributeManagmentFlow",[u],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),w=(0,s.Z)(g.prototype,"dbSync",[h],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),O=(0,s.Z)(g.prototype,"rtcFlow",[y],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),j=(0,s.Z)(g.prototype,"guardsService",[m],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),S=(0,s.Z)(g.prototype,"notificationsManagementFlow",[f],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),g)},286873:function(e,t,n){n.d(t,{V:function(){return R}});var o=n(503348),i=n(777460),s=n(918437),r=n(971162),a=n(302503),c=n(255328),l=n(523689),d=n(395942),p=n(422169),u=n(676422),h=n.n(u),y=n(173541),m=n(505892),f=n(781872),g=n(273526),_=n(552322);const b=e=>{const{onDismiss:t,onSubmit:n}=e;return(0,_.jsxs)("div",{className:`jsx-${g.W.__hash} `+h().dynamic([["1785947491",[f.N_.TWO_UNITS,f.N_.HALF_UNIT,f.N_.TWO_UNITS,f.N_.HALF_UNIT,f.DM.GRAY_300,f.N_.HALF_UNIT,f.N_.HALF_UNIT]]]),children:[(0,_.jsxs)("div",{className:`jsx-${g.W.__hash} `+h().dynamic([["1785947491",[f.N_.TWO_UNITS,f.N_.HALF_UNIT,f.N_.TWO_UNITS,f.N_.HALF_UNIT,f.DM.GRAY_300,f.N_.HALF_UNIT,f.N_.HALF_UNIT]]])+" content-modal-header",children:[(0,_.jsx)("p",{className:`jsx-${g.W.__hash} `+h().dynamic([["1785947491",[f.N_.TWO_UNITS,f.N_.HALF_UNIT,f.N_.TWO_UNITS,f.N_.HALF_UNIT,f.DM.GRAY_300,f.N_.HALF_UNIT,f.N_.HALF_UNIT]]]),children:"Text elements are automatically translated"}),(0,_.jsx)(y.z,{style:"transparent",onClick:t,shape:"square",children:(0,_.jsx)(m.J,{type:"actions/close",size:14,color:f.DM.GRAY_900})})]}),(0,_.jsxs)("div",{className:`jsx-${g.W.__hash} `+h().dynamic([["1785947491",[f.N_.TWO_UNITS,f.N_.HALF_UNIT,f.N_.TWO_UNITS,f.N_.HALF_UNIT,f.DM.GRAY_300,f.N_.HALF_UNIT,f.N_.HALF_UNIT]]])+" content-root",children:[(0,_.jsx)("p",{className:`jsx-${g.W.__hash} `+h().dynamic([["1785947491",[f.N_.TWO_UNITS,f.N_.HALF_UNIT,f.N_.TWO_UNITS,f.N_.HALF_UNIT,f.DM.GRAY_300,f.N_.HALF_UNIT,f.N_.HALF_UNIT]]]),children:"Every time you change a text while in the project main language, it will be automatically translated to every other language you have imported inside the project."}),(0,_.jsx)("p",{className:`jsx-${g.W.__hash} `+h().dynamic([["1785947491",[f.N_.TWO_UNITS,f.N_.HALF_UNIT,f.N_.TWO_UNITS,f.N_.HALF_UNIT,f.DM.GRAY_300,f.N_.HALF_UNIT,f.N_.HALF_UNIT]]])+" disable-message",children:"You can disable this feature at any time from the top left corner of the editor:"}),(0,_.jsxs)("div",{className:`jsx-${g.W.__hash} `+h().dynamic([["1785947491",[f.N_.TWO_UNITS,f.N_.HALF_UNIT,f.N_.TWO_UNITS,f.N_.HALF_UNIT,f.DM.GRAY_300,f.N_.HALF_UNIT,f.N_.HALF_UNIT]]])+" settings-item",children:[(0,_.jsx)("p",{className:`jsx-${g.W.__hash} `+h().dynamic([["1785947491",[f.N_.TWO_UNITS,f.N_.HALF_UNIT,f.N_.TWO_UNITS,f.N_.HALF_UNIT,f.DM.GRAY_300,f.N_.HALF_UNIT,f.N_.HALF_UNIT]]]),children:"Edit"}),(0,_.jsx)("p",{className:`jsx-${g.W.__hash} `+h().dynamic([["1785947491",[f.N_.TWO_UNITS,f.N_.HALF_UNIT,f.N_.TWO_UNITS,f.N_.HALF_UNIT,f.DM.GRAY_300,f.N_.HALF_UNIT,f.N_.HALF_UNIT]]]),children:">"}),(0,_.jsx)("p",{className:`jsx-${g.W.__hash} `+h().dynamic([["1785947491",[f.N_.TWO_UNITS,f.N_.HALF_UNIT,f.N_.TWO_UNITS,f.N_.HALF_UNIT,f.DM.GRAY_300,f.N_.HALF_UNIT,f.N_.HALF_UNIT]]]),children:"Automatically translate text elements"})]})]}),(0,_.jsx)("div",{className:`jsx-${g.W.__hash} `+h().dynamic([["1785947491",[f.N_.TWO_UNITS,f.N_.HALF_UNIT,f.N_.TWO_UNITS,f.N_.HALF_UNIT,f.DM.GRAY_300,f.N_.HALF_UNIT,f.N_.HALF_UNIT]]])+" content-modal-footer",children:(0,_.jsx)(y.z,{refAttrs:{autoFocus:!0},onClick:n,style:"solid",colorScheme:"accent",children:"OK"})}),(0,_.jsx)(h(),{id:g.W.__hash,children:g.W}),(0,_.jsx)(h(),{id:"1785947491",dynamic:[f.N_.TWO_UNITS,f.N_.HALF_UNIT,f.N_.TWO_UNITS,f.N_.HALF_UNIT,f.DM.GRAY_300,f.N_.HALF_UNIT,f.N_.HALF_UNIT],children:[`.disable-message.__jsx-style-dynamic-selector{margin-top:${f.N_.TWO_UNITS};}`,`.settings-item.__jsx-style-dynamic-selector{padding:${f.N_.HALF_UNIT} ${f.N_.TWO_UNITS};display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;gap:${f.N_.HALF_UNIT};-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;background-color:${f.DM.GRAY_300};border-radius:${f.N_.HALF_UNIT};margin-top:${f.N_.HALF_UNIT};}`]})]})},I=e=>{const{onDismiss:t,onSubmit:n}=e;return(0,_.jsxs)("div",{className:`jsx-${g.W.__hash} `+h().dynamic([["2297913768",[f.N_.TWO_UNITS,f.N_.HALF_UNIT,f.N_.TWO_UNITS,f.N_.HALF_UNIT,f.DM.GRAY_300,f.N_.HALF_UNIT,f.N_.HALF_UNIT]]]),children:[(0,_.jsxs)("div",{className:`jsx-${g.W.__hash} `+h().dynamic([["2297913768",[f.N_.TWO_UNITS,f.N_.HALF_UNIT,f.N_.TWO_UNITS,f.N_.HALF_UNIT,f.DM.GRAY_300,f.N_.HALF_UNIT,f.N_.HALF_UNIT]]])+" content-modal-header",children:[(0,_.jsx)("p",{className:`jsx-${g.W.__hash} `+h().dynamic([["2297913768",[f.N_.TWO_UNITS,f.N_.HALF_UNIT,f.N_.TWO_UNITS,f.N_.HALF_UNIT,f.DM.GRAY_300,f.N_.HALF_UNIT,f.N_.HALF_UNIT]]]),children:"Page settings are automatically translated"}),(0,_.jsx)(y.z,{style:"transparent",onClick:t,shape:"square",children:(0,_.jsx)(m.J,{type:"actions/close",size:14,color:f.DM.GRAY_900})})]}),(0,_.jsxs)("div",{className:`jsx-${g.W.__hash} `+h().dynamic([["2297913768",[f.N_.TWO_UNITS,f.N_.HALF_UNIT,f.N_.TWO_UNITS,f.N_.HALF_UNIT,f.DM.GRAY_300,f.N_.HALF_UNIT,f.N_.HALF_UNIT]]])+" content-root",children:[(0,_.jsx)("p",{className:`jsx-${g.W.__hash} `+h().dynamic([["2297913768",[f.N_.TWO_UNITS,f.N_.HALF_UNIT,f.N_.TWO_UNITS,f.N_.HALF_UNIT,f.DM.GRAY_300,f.N_.HALF_UNIT,f.N_.HALF_UNIT]]]),children:"Every time you change the page settings while the project main language is selected, we will automatically translate them to every other language you have imported inside the project."}),(0,_.jsx)("p",{className:`jsx-${g.W.__hash} `+h().dynamic([["2297913768",[f.N_.TWO_UNITS,f.N_.HALF_UNIT,f.N_.TWO_UNITS,f.N_.HALF_UNIT,f.DM.GRAY_300,f.N_.HALF_UNIT,f.N_.HALF_UNIT]]])+" disable-message",children:"You can disable this feature at any time from the top left corner of the editor:"}),(0,_.jsxs)("div",{className:`jsx-${g.W.__hash} `+h().dynamic([["2297913768",[f.N_.TWO_UNITS,f.N_.HALF_UNIT,f.N_.TWO_UNITS,f.N_.HALF_UNIT,f.DM.GRAY_300,f.N_.HALF_UNIT,f.N_.HALF_UNIT]]])+" settings-item",children:[(0,_.jsx)("p",{className:`jsx-${g.W.__hash} `+h().dynamic([["2297913768",[f.N_.TWO_UNITS,f.N_.HALF_UNIT,f.N_.TWO_UNITS,f.N_.HALF_UNIT,f.DM.GRAY_300,f.N_.HALF_UNIT,f.N_.HALF_UNIT]]]),children:"Edit"}),(0,_.jsx)("p",{className:`jsx-${g.W.__hash} `+h().dynamic([["2297913768",[f.N_.TWO_UNITS,f.N_.HALF_UNIT,f.N_.TWO_UNITS,f.N_.HALF_UNIT,f.DM.GRAY_300,f.N_.HALF_UNIT,f.N_.HALF_UNIT]]]),children:">"}),(0,_.jsx)("p",{className:`jsx-${g.W.__hash} `+h().dynamic([["2297913768",[f.N_.TWO_UNITS,f.N_.HALF_UNIT,f.N_.TWO_UNITS,f.N_.HALF_UNIT,f.DM.GRAY_300,f.N_.HALF_UNIT,f.N_.HALF_UNIT]]]),children:"Automatically translate text elements"})]})]}),(0,_.jsx)("div",{className:`jsx-${g.W.__hash} `+h().dynamic([["2297913768",[f.N_.TWO_UNITS,f.N_.HALF_UNIT,f.N_.TWO_UNITS,f.N_.HALF_UNIT,f.DM.GRAY_300,f.N_.HALF_UNIT,f.N_.HALF_UNIT]]])+" content-modal-footer",children:(0,_.jsx)(y.z,{refAttrs:{autoFocus:!0},onClick:n,style:"solid",colorScheme:"accent",children:"OK"})}),(0,_.jsx)(h(),{id:g.W.__hash,children:g.W}),(0,_.jsx)(h(),{id:"2297913768",dynamic:[f.N_.TWO_UNITS,f.N_.HALF_UNIT,f.N_.TWO_UNITS,f.N_.HALF_UNIT,f.DM.GRAY_300,f.N_.HALF_UNIT,f.N_.HALF_UNIT],children:[`.disable-message.__jsx-style-dynamic-selector{margin-top:${f.N_.TWO_UNITS};}`,`.settings-item.__jsx-style-dynamic-selector{padding:${f.N_.HALF_UNIT} ${f.N_.TWO_UNITS};display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;gap:${f.N_.HALF_UNIT};-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;background-color:${f.DM.GRAY_300};border-radius:${f.N_.HALF_UNIT};margin-top:${f.N_.HALF_UNIT};}`]})]})};var v,w,O,j,S,N,D,E,T,P,C,x,A;function F(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function k(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?F(Object(n),!0).forEach((function(t){(0,i.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):F(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}let R=(v=(0,a.inject)("projectDoc"),w=(0,a.inject)("projectUIState"),O=(0,a.inject)("globalAppState"),j=(0,a.inject)("modalManagementFlow"),S=(0,a.inject)("userAccountRepository"),A=x=class{constructor(){(0,o.Z)(this,"projectDoc",D,this),(0,o.Z)(this,"projectUIState",E,this),(0,o.Z)(this,"globalAppState",T,this),(0,o.Z)(this,"modalManagementFlow",P,this),(0,o.Z)(this,"userAccountRepository",C,this),(0,i.Z)(this,"showPageSettingsAutomaticTranslationDialog",(async()=>{var e;const{userData:t}=this.globalAppState.user;if(!t)return;if(null===(e=t.meta.internationalization)||void 0===e?void 0:e.automaticPageSettingsTranslationDialogDisplayed)return;const n=p.d.createCustomModal({Component:I,onSubmit:()=>{this.modalManagementFlow.hideModal()},onDismiss:()=>{this.modalManagementFlow.hideModal()}});this.modalManagementFlow.showModal(n,{padding:"0px",maxWidth:"600px"},!1),(0,d.mutate)(this.globalAppState,(({user:e})=>{e&&e.userData&&(e.userData.meta.internationalization={automaticPageSettingsTranslationDialogDisplayed:!0})}));try{await this.userAccountRepository.update({meta:t.meta})}catch(o){console.error("Failed in updating user account meta data",o)}})),(0,i.Z)(this,"showNodeAutomaticTranslationDialog",(async()=>{var e;const{userData:t}=this.globalAppState.user;if(!t)return;if(null===(e=t.meta.internationalization)||void 0===e?void 0:e.automaticNodeTranslationDialogDisplayed)return;const n=p.d.createCustomModal({Component:b,onSubmit:()=>{this.modalManagementFlow.hideModal()},onDismiss:()=>{this.modalManagementFlow.hideModal()}});this.modalManagementFlow.showModal(n,{padding:"0px",maxWidth:"600px"},!1),(0,d.mutate)(this.globalAppState,(({user:e})=>{var t;e&&e.userData&&(e.userData.meta.internationalization=k(k({},null!==(t=e.userData.meta.internationalization)&&void 0!==t?t:{}),{},{automaticNodeTranslationDialogDisplayed:!0}))}));try{await this.userAccountRepository.update({meta:t.meta})}catch(o){console.error("Failed in updating user account meta data",o)}})),(0,i.Z)(this,"getTranslationNodeLangKeyFromComponentProp",((e,t)=>{var n,o;const i=this.projectDoc.components.byId[e];if(!i)return null;const s=i.propDefinitions[t];if(!s)return null;if("richtext"!==s.type)return null;const r=this.projectDoc.nodes.getById(null!==(n=s.defaultHierarchyRootId)&&void 0!==n?n:"");if(!r||!("contentChildren"in r))return null;const a=Object.keys(null!==(o=r.childrenIds)&&void 0!==o?o:{})[0],c=this.projectDoc.nodes.getById(null!==a&&void 0!==a?a:"");return c&&"contentChildren"in c?c.getContentLangReferenceKey():null}))}static get Instance(){return this._instance||(this._instance=new this)}mainLanguageIsSelected(){const{currentLanguage:e}=this.projectUIState.internationalization,{mainLanguage:t}=this.projectDoc.internationalization;return t&&(null===e||void 0===e?void 0:e.short)===(null===t||void 0===t?void 0:t.short)}getTranslationLangReferenceKeyFromProp(e){const{compInstanceId:t,componentId:n}=this.projectUIState.selection;if(t){var o,i,s;const n=this.projectDoc.nodes.getById(null!==t&&void 0!==t?t:"");if(!n||!("attrs"in n))return null;const r=this.projectDoc.components.byId[null!==(o=n.compIdOfCompInstance)&&void 0!==o?o:""];if(!r)return null;const a=r.propDefinitions[e];if(!a)return null;const c=null===(i=n.attrs)||void 0===i?void 0:i[a.name];if(!c)return null;if("hierarchy"!==c.type)return null;const l=this.projectDoc.nodes.getById(null===c||void 0===c?void 0:c.content);if(!l||!("contentChildren"in l))return null;const d=Object.keys(null!==(s=l.childrenIds)&&void 0!==s?s:{})[0],p=this.projectDoc.nodes.getById(null!==d&&void 0!==d?d:"");return p&&"contentChildren"in p?p.getContentLangReferenceKey():null}if(n)return this.getTranslationNodeLangKeyFromComponentProp(n,e)}getTranslationNodeFromElementNode(e){var t,n,o;const{node:i,doc:s}=e;if(!s)return null;if("element-node"!==i.type)return null;const r=Object.values(i.contentChildren||{});if(1!==r.length)return null;const a=r[0];if("dynamic"!==a.type||"locale"!==a.content.referenceType)return null;const c=null===(t=this.projectUIState.internationalization.currentLanguage)||void 0===t?void 0:t.short;if(!c)return null;const l=null===(n=a.content.refPath)||void 0===n?void 0:n[0];if(!l)return null;const d=s.internationalization.getTranslationRootHierarchyNodeId(c,l);return d&&null!==(o=s.nodes.getById(null===d||void 0===d?void 0:d.toString()))&&void 0!==o?o:null}extractStaticTextContentFromNode(e){var t;const n=Object.values(null!==(t=e.contentChildren)&&void 0!==t?t:{});if(1===n.length){const t=n[0];return"static"===t.type?[{textsToRewrite:{[e.id]:t.content.toString()}}]:[]}const o=e.childrenIds;if(!Object.keys(null!==o&&void 0!==o?o:{}).length)return[];const i=Object.keys(o).map((e=>{const t=this.projectDoc.nodes.getById(e);return t&&"element-node"===t.type?this.extractStaticTextContentFromNode(t):[]})).flat().reduce(((e,t)=>(Object.keys(t.textsToRewrite).forEach((n=>{e[n]=t.textsToRewrite[n]})),e)),{}),s=Object.keys(i).reduce(((e,t)=>{const n=this.projectDoc.nodes.getById(t);return n?(e[n.id]=n.pos,e):e}),{});return[{textsToRewrite:i,textsOrder:Object.keys(s).sort(((e,t)=>(0,r.F0)(parseFloat(s[e]))-(0,r.F0)(parseFloat(s[t]))))}]}cloneHierarchyAndInjectTranslations(e,t,n){if(!e)throw new Error("Could not find the project document thile cloning hierarchy");const o={},i={};let s=null;return e.nodes.bfs(t,(r=>{var a,c,d;const p=e.cloneNode({nodeId:r.id});if(!p)throw new Error(`Failed in cloning the hierarchy node for translations - ${r.id}`);if(r.id===t&&(s=p.id),o[r.id]=p.id,r.parentId){var u;const e=o[r.parentId];var h,y;if(e&&(p.parentId=e),i[null!==(u=p.parentId)&&void 0!==u?u:""])i[null!==(h=p.parentId)&&void 0!==h?h:""].childrenIds[p.id]=!0,delete i[null!==(y=p.parentId)&&void 0!==y?y:""].childrenIds[r.id]}if(i[p.id]=p,"element-node"!==p.type||!("contentChildren"in p))return;const m=Object.keys(null!==(a=p.contentChildren)&&void 0!==a?a:{});if(1!==m.length)return;const f=null===(c=p.contentChildren)||void 0===c?void 0:c[m[0]];if("static"!==(null===f||void 0===f?void 0:f.type))return;const g=f.content.toString();p.contentChildren={};const _=new l.F({content:null!==(d=n[r.id])&&void 0!==d?d:g});p.contentChildren[f.id]=_,i[p.id]=p})),{hierarchyClone:Object.values(i),newRootNodeId:s}}},(0,i.Z)(x,"_instance",void 0),N=A,D=(0,s.Z)(N.prototype,"projectDoc",[v],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),E=(0,s.Z)(N.prototype,"projectUIState",[w],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),T=(0,s.Z)(N.prototype,"globalAppState",[O],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),P=(0,s.Z)(N.prototype,"modalManagementFlow",[j],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),C=(0,s.Z)(N.prototype,"userAccountRepository",[S],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),(0,s.Z)(N.prototype,"getTranslationNodeFromElementNode",[c.P],Object.getOwnPropertyDescriptor(N.prototype,"getTranslationNodeFromElementNode"),N.prototype),N)},739671:function(e,t,n){var o=n(503348),i=n(777460),s=n(918437),r=n(395942),a=n(302503),c=n(327089),l=n(412940),d=n(559196),p=n(440516),u=n(422169),h=n(344627),y=n(676422),m=n.n(y),f=(n(202784),n(173541)),g=n(505892),_=n(781872),b=n(552322);const I=e=>{const{onDismiss:t}=e;return(0,b.jsxs)("div",{className:m().dynamic([["2478857090",[_.N_.UNIT,_.DM.GRAY_800,_.N_.UNIT,_.Xw.MEDIUM_500,_.N_.UNIT,_.DM.GRAY_800,_.N_.THREE_UNITS]]])+" modal-wrapper",children:[(0,b.jsxs)("div",{className:m().dynamic([["2478857090",[_.N_.UNIT,_.DM.GRAY_800,_.N_.UNIT,_.Xw.MEDIUM_500,_.N_.UNIT,_.DM.GRAY_800,_.N_.THREE_UNITS]]])+" modal-title",children:[(0,b.jsx)("p",{className:m().dynamic([["2478857090",[_.N_.UNIT,_.DM.GRAY_800,_.N_.UNIT,_.Xw.MEDIUM_500,_.N_.UNIT,_.DM.GRAY_800,_.N_.THREE_UNITS]]]),children:"How to update the CMS data"}),(0,b.jsx)(f.z,{colorScheme:"neutral",style:"transparent",shape:"square",onClick:t,children:(0,b.jsx)(g.J,{type:"actions/close",size:14})})]}),(0,b.jsx)("p",{style:{color:_.DM.GRAY_900},className:m().dynamic([["2478857090",[_.N_.UNIT,_.DM.GRAY_800,_.N_.UNIT,_.Xw.MEDIUM_500,_.N_.UNIT,_.DM.GRAY_800,_.N_.THREE_UNITS]]]),children:"If you update the data structures of your CMS after successfully connecting the project to it, you have two options to import and use the updates in Teleport:"}),(0,b.jsxs)("ul",{className:m().dynamic([["2478857090",[_.N_.UNIT,_.DM.GRAY_800,_.N_.UNIT,_.Xw.MEDIUM_500,_.N_.UNIT,_.DM.GRAY_800,_.N_.THREE_UNITS]]]),children:[(0,b.jsx)("li",{className:m().dynamic([["2478857090",[_.N_.UNIT,_.DM.GRAY_800,_.N_.UNIT,_.Xw.MEDIUM_500,_.N_.UNIT,_.DM.GRAY_800,_.N_.THREE_UNITS]]]),children:(0,b.jsxs)("i",{className:m().dynamic([["2478857090",[_.N_.UNIT,_.DM.GRAY_800,_.N_.UNIT,_.Xw.MEDIUM_500,_.N_.UNIT,_.DM.GRAY_800,_.N_.THREE_UNITS]]]),children:["1. CMS Connection tab Menu -",">"," Sync Content Types "]})}),(0,b.jsxs)("div",{className:m().dynamic([["2478857090",[_.N_.UNIT,_.DM.GRAY_800,_.N_.UNIT,_.Xw.MEDIUM_500,_.N_.UNIT,_.DM.GRAY_800,_.N_.THREE_UNITS]]])+" item-wrapper",children:[(0,b.jsx)("div",{className:m().dynamic([["2478857090",[_.N_.UNIT,_.DM.GRAY_800,_.N_.UNIT,_.Xw.MEDIUM_500,_.N_.UNIT,_.DM.GRAY_800,_.N_.THREE_UNITS]]])+" icon-wrapper",children:(0,b.jsx)(g.J,{type:"warning",size:14})}),(0,b.jsx)("span",{className:m().dynamic([["2478857090",[_.N_.UNIT,_.DM.GRAY_800,_.N_.UNIT,_.Xw.MEDIUM_500,_.N_.UNIT,_.DM.GRAY_800,_.N_.THREE_UNITS]]]),children:"It will fetch the updated fields and types from CMS which you can therefore use and link to nodes."})]}),(0,b.jsxs)("div",{className:m().dynamic([["2478857090",[_.N_.UNIT,_.DM.GRAY_800,_.N_.UNIT,_.Xw.MEDIUM_500,_.N_.UNIT,_.DM.GRAY_800,_.N_.THREE_UNITS]]])+" item-wrapper",children:[(0,b.jsx)("div",{className:m().dynamic([["2478857090",[_.N_.UNIT,_.DM.GRAY_800,_.N_.UNIT,_.Xw.MEDIUM_500,_.N_.UNIT,_.DM.GRAY_800,_.N_.THREE_UNITS]]])+" icon-wrapper",children:(0,b.jsx)(g.J,{type:"warning",size:14})}),(0,b.jsx)("span",{className:m().dynamic([["2478857090",[_.N_.UNIT,_.DM.GRAY_800,_.N_.UNIT,_.Xw.MEDIUM_500,_.N_.UNIT,_.DM.GRAY_800,_.N_.THREE_UNITS]]]),children:"The data source for the existing CMS List / Details Pages cannot be changed"})]}),(0,b.jsxs)("div",{className:m().dynamic([["2478857090",[_.N_.UNIT,_.DM.GRAY_800,_.N_.UNIT,_.Xw.MEDIUM_500,_.N_.UNIT,_.DM.GRAY_800,_.N_.THREE_UNITS]]])+" item-wrapper",children:[(0,b.jsx)("div",{className:m().dynamic([["2478857090",[_.N_.UNIT,_.DM.GRAY_800,_.N_.UNIT,_.Xw.MEDIUM_500,_.N_.UNIT,_.DM.GRAY_800,_.N_.THREE_UNITS]]])+" icon-wrapper",children:(0,b.jsx)(g.J,{type:"warning",size:14})}),(0,b.jsx)("span",{className:m().dynamic([["2478857090",[_.N_.UNIT,_.DM.GRAY_800,_.N_.UNIT,_.Xw.MEDIUM_500,_.N_.UNIT,_.DM.GRAY_800,_.N_.THREE_UNITS]]]),children:"You cannot generate new CMS List / Details Pages"})]}),(0,b.jsxs)("div",{className:m().dynamic([["2478857090",[_.N_.UNIT,_.DM.GRAY_800,_.N_.UNIT,_.Xw.MEDIUM_500,_.N_.UNIT,_.DM.GRAY_800,_.N_.THREE_UNITS]]])+" item-wrapper",children:[(0,b.jsx)("div",{className:m().dynamic([["2478857090",[_.N_.UNIT,_.DM.GRAY_800,_.N_.UNIT,_.Xw.MEDIUM_500,_.N_.UNIT,_.DM.GRAY_800,_.N_.THREE_UNITS]]])+" icon-wrapper",children:(0,b.jsx)(g.J,{type:"warning",size:14})}),(0,b.jsx)("span",{className:m().dynamic([["2478857090",[_.N_.UNIT,_.DM.GRAY_800,_.N_.UNIT,_.Xw.MEDIUM_500,_.N_.UNIT,_.DM.GRAY_800,_.N_.THREE_UNITS]]]),children:"You won't lose any of your work"})]}),(0,b.jsx)("li",{className:m().dynamic([["2478857090",[_.N_.UNIT,_.DM.GRAY_800,_.N_.UNIT,_.Xw.MEDIUM_500,_.N_.UNIT,_.DM.GRAY_800,_.N_.THREE_UNITS]]]),children:(0,b.jsxs)("i",{className:m().dynamic([["2478857090",[_.N_.UNIT,_.DM.GRAY_800,_.N_.UNIT,_.Xw.MEDIUM_500,_.N_.UNIT,_.DM.GRAY_800,_.N_.THREE_UNITS]]]),children:["2. CMS Connection tab Menu -",">","Disconnect CMS -",">"," Setup Connection"," "]})}),(0,b.jsxs)("div",{className:m().dynamic([["2478857090",[_.N_.UNIT,_.DM.GRAY_800,_.N_.UNIT,_.Xw.MEDIUM_500,_.N_.UNIT,_.DM.GRAY_800,_.N_.THREE_UNITS]]])+" item-wrapper",children:[(0,b.jsx)("div",{className:m().dynamic([["2478857090",[_.N_.UNIT,_.DM.GRAY_800,_.N_.UNIT,_.Xw.MEDIUM_500,_.N_.UNIT,_.DM.GRAY_800,_.N_.THREE_UNITS]]])+" icon-wrapper",children:(0,b.jsx)(g.J,{type:"warning",size:14})}),(0,b.jsx)("span",{className:m().dynamic([["2478857090",[_.N_.UNIT,_.DM.GRAY_800,_.N_.UNIT,_.Xw.MEDIUM_500,_.N_.UNIT,_.DM.GRAY_800,_.N_.THREE_UNITS]]]),children:"Use this only if you want to generate new CMS List / Details Pages"})]}),(0,b.jsxs)("div",{className:m().dynamic([["2478857090",[_.N_.UNIT,_.DM.GRAY_800,_.N_.UNIT,_.Xw.MEDIUM_500,_.N_.UNIT,_.DM.GRAY_800,_.N_.THREE_UNITS]]])+" item-wrapper",children:[(0,b.jsx)("div",{className:m().dynamic([["2478857090",[_.N_.UNIT,_.DM.GRAY_800,_.N_.UNIT,_.Xw.MEDIUM_500,_.N_.UNIT,_.DM.GRAY_800,_.N_.THREE_UNITS]]])+" icon-wrapper",children:(0,b.jsx)(g.J,{type:"warning",size:14})}),(0,b.jsx)("span",{className:m().dynamic([["2478857090",[_.N_.UNIT,_.DM.GRAY_800,_.N_.UNIT,_.Xw.MEDIUM_500,_.N_.UNIT,_.DM.GRAY_800,_.N_.THREE_UNITS]]]),children:"Disconnecting the CMS will remove existing CMS Pages and you might lose some of your work"})]})]}),(0,b.jsx)("div",{className:m().dynamic([["2478857090",[_.N_.UNIT,_.DM.GRAY_800,_.N_.UNIT,_.Xw.MEDIUM_500,_.N_.UNIT,_.DM.GRAY_800,_.N_.THREE_UNITS]]])+" button-wrapper",children:(0,b.jsx)(f.z,{onClick:()=>{t()},children:"I understand"})}),(0,b.jsx)(m(),{id:"2478857090",dynamic:[_.N_.UNIT,_.DM.GRAY_800,_.N_.UNIT,_.Xw.MEDIUM_500,_.N_.UNIT,_.DM.GRAY_800,_.N_.THREE_UNITS],children:[".modal-wrapper.__jsx-style-dynamic-selector{max-width:560px;line-height:1.5;}",".modal-title.__jsx-style-dynamic-selector{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:justify;-webkit-justify-content:space-between;-ms-flex-pack:justify;justify-content:space-between;}",`span.__jsx-style-dynamic-selector{margin:${_.N_.UNIT} 0;color:${_.DM.GRAY_800};}`,`li.__jsx-style-dynamic-selector{margin:${_.N_.UNIT} 0px;font-size:14px;font-weight:${_.Xw.MEDIUM_500};list-style:none;}`,".item-wrapper.__jsx-style-dynamic-selector{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;-webkit-box-pack:start;-webkit-justify-content:flex-start;-ms-flex-pack:start;justify-content:flex-start;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;}",`.icon-wrapper.__jsx-style-dynamic-selector{margin:2px ${_.N_.UNIT} 0 0;color:${_.DM.GRAY_800};}`,`.button-wrapper.__jsx-style-dynamic-selector{margin:${_.N_.THREE_UNITS} 0 8px 0;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-pack:end;-webkit-justify-content:flex-end;-ms-flex-pack:end;justify-content:flex-end;}`]})]})};var v,w,O,j,S,N,D,E,T,P,C,x,A,F,k,R,M,U,Z;v=(0,a.provide)("layoutManagementFlow"),w=(0,a.inject)("projectUIState"),O=(0,a.inject)("projectDoc"),j=(0,a.inject)("userProjectDataPersistenceFlow"),S=(0,a.inject)("globalAppState"),N=(0,a.inject)("userAccountRepository"),D=(0,a.inject)("modalManagementFlow"),E=(0,a.inject)("absolutePositionedLayerFlow"),T=(0,c.G)(d.l.SIDEBAR_CHANGE),P=(0,c.G)(d.l.INSPECTOR_TYPE_CHANGE),v((x=class{constructor(){(0,o.Z)(this,"projectUIState",A,this),(0,o.Z)(this,"projectDoc",F,this),(0,o.Z)(this,"userProjectDataPersistenceFlow",k,this),(0,o.Z)(this,"globalAppState",R,this),(0,o.Z)(this,"userAccountRepository",M,this),(0,o.Z)(this,"modalManagementFlow",U,this),(0,o.Z)(this,"absolutePositionedLayerFlow",Z,this),(0,i.Z)(this,"cmsMainFlow",h.c.Instance),(0,i.Z)(this,"setShortcutsVisibleValue",(e=>{(0,r.mutate)(this.projectUIState,(t=>{t.layout.shortcutsVisible=e}))})),(0,i.Z)(this,"toggleHelpBubble",(e=>{(0,r.mutate)(this.projectUIState,(t=>{t.layout.helpBubbleVisible=e||!t.layout.helpBubbleVisible}))}))}changeActiveSidebar(e,t=!0){(0,r.mutate)(this.projectUIState,(n=>{const{layout:o}=n;o.sidebarPanel===e?t&&(o.sidebarPanel=null):o.sidebarPanel=e,o.mainPanel===p.iW.DEV&&(o.mainPanel=p.iW.STAGE)})),this.userProjectDataPersistenceFlow.savePreferences(this.projectUIState)}async openAssetsSidebar(e){(0,r.mutate)(this.projectUIState,(t=>{t.layout.selectedAssetsTab=e})),this.projectUIState.layout.sidebarPanel!==p.tI.ASSETS_MANAGER&&await this.changeActiveSidebar(p.tI.ASSETS_MANAGER)}setSidebarWidth(e){(0,r.mutate)(this.projectUIState,(t=>{t.sidebarSettings.width=e}))}toggleCodeEdit(){(0,r.mutate)(this.projectUIState,(({layout:e,stage:t})=>{e.mainPanel=e.mainPanel===p.iW.STAGE?p.iW.DEV:p.iW.STAGE,e.mainPanel===p.iW.STAGE&&(t.webComp.controlValues.x=l.m7.controlValues.x,t.webComp.controlValues.y=l.m7.controlValues.y)})),this.userProjectDataPersistenceFlow.savePreferences(this.projectUIState)}changeDesignLanguageTab(e){(0,r.mutate)(this.projectUIState,(t=>{const{layout:n,designLanguage:o}=t;n.designLanguageTab=e,o.sidebarPanel&&(o.sidebarPanel=null)}))}changeInspectorType(e){(0,r.mutate)(this.projectUIState,(({layout:t})=>{t.visibleInspector=e}))}changeLayoutPanel(e){(0,r.mutate)(this.projectUIState,(({layout:t})=>{t.mainPanel=e})),this.userProjectDataPersistenceFlow.savePreferences(this.projectUIState)}toggleUserPreferenceValue(e){(0,r.mutate)(this.projectUIState,(({userPreferences:t})=>{t[e]=!t[e]}))}toggleFolders(e){(0,r.mutate)(this.projectUIState,(t=>{t.sidebarSettings.expanded[e]=!t.sidebarSettings.expanded[e]}))}setFileGridTemplateRows(e){(0,r.mutate)(this.projectUIState,(t=>{t.sidebarSettings.filesGridTemplateRows=e}))}toggleProjectMenu(e){(0,r.mutate)(this.projectUIState,(({layout:t})=>{t.projectMenuOpen!==e&&(t.projectMenuOpen=e)}))}selectStyledSectionGroup(e){(0,r.mutate)(this.projectUIState,(({layout:t})=>{t.selectedSectionTemplatesGroup=e}))}setFilesTabScroll(e){(0,r.mutate)(this.projectUIState,(t=>{t.filesTabScroll=e}))}toggleElementPreviewMode(){(0,r.mutate)(this.projectUIState,(e=>{e.userInteractions.isNodeInPreviewMode=!e.userInteractions.isNodeInPreviewMode}))}stopElementPreviewMode(){(0,r.mutate)(this.projectUIState,(e=>{e.userInteractions.isNodeInPreviewMode=!1}))}changeActiveComponentSetupTab(e){(0,r.mutate)(this.projectUIState,(t=>{t.layout.selectedComponentSetupTab=e}))}showCMSSyncHelperModal(){const e=u.d.createCustomModal({Component:I,onDismiss:()=>this.modalManagementFlow.hideModal()});this.modalManagementFlow.showModal(e)}},A=(0,s.Z)(x.prototype,"projectUIState",[w],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),F=(0,s.Z)(x.prototype,"projectDoc",[O],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),k=(0,s.Z)(x.prototype,"userProjectDataPersistenceFlow",[j],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),R=(0,s.Z)(x.prototype,"globalAppState",[S],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),M=(0,s.Z)(x.prototype,"userAccountRepository",[N],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),U=(0,s.Z)(x.prototype,"modalManagementFlow",[D],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Z=(0,s.Z)(x.prototype,"absolutePositionedLayerFlow",[E],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),(0,s.Z)(x.prototype,"changeActiveSidebar",[T],Object.getOwnPropertyDescriptor(x.prototype,"changeActiveSidebar"),x.prototype),(0,s.Z)(x.prototype,"changeInspectorType",[P],Object.getOwnPropertyDescriptor(x.prototype,"changeInspectorType"),x.prototype),C=x))},271848:function(e,t,n){var o,i,s,r,a,c,l,d,p,u,h,y,m,f=n(503348),g=n(777460),_=n(735468),b=n(889371),I=n(918437),v=n(395942),w=n(656733),O=n(298357),j=n.n(O),S=n(327089),N=n(440516),D=n(559196),E=n(302503);o=(0,E.provide)("localHistoryStackFlow"),i=(0,E.inject)("projectUIState"),s=(0,E.inject)("guardsService"),r=(0,E.inject)("sentryService"),a=(0,S.G)(D.l.UNDO),c=(0,S.G)(D.l.REDO),o((y=new WeakMap,m=new WeakMap,d=class{constructor(){(0,f.Z)(this,"projectUIState",p,this),(0,f.Z)(this,"guardsService",u,this),(0,f.Z)(this,"sentryService",h,this),(0,g.Z)(this,"onUndo",void 0),(0,g.Z)(this,"onRedo",void 0),(0,g.Z)(this,"lastChangeAt",{}),y.set(this,{writable:!0,value:!1}),m.set(this,{writable:!0,value:!1}),(0,g.Z)(this,"undoStack",[]),(0,g.Z)(this,"redoStack",[])}init(e){this.onUndo=e.onUndo,this.onRedo=e.onRedo,this.undo=j()(this.undo,200),this.redo=j()(this.redo,200),(0,b.Z)(this,m,!0)}destroy(){(0,b.Z)(this,m,!1),this.undoStack=[],this.redoStack=[]}store(e,t){(0,_.Z)(this,m)&&this.projectUIState.layout.mainPanel!==N.iW.DEV&&((0,_.Z)(this,y)||!t.length||this.guardsService.getGuard(w._.DISABLE_HISTORY)||(this.updateLastChangeAt(),this.undoStack.push({root:e,patches:t}),this.redoStack=[],(0,v.mutate)(this.projectUIState,(e=>{e.userInteractions.undo=this.undoStack.length,e.userInteractions.redo=this.redoStack.length}))))}undo(){if(!(0,_.Z)(this,m))return;if(this.projectUIState.layout.mainPanel===N.iW.DEV)return;const e=this.undoStack.pop();if(!e)return;this.updateLastChangeAt(),(0,b.Z)(this,y,!0);const{root:t,patches:n}=e,o=n.map(v.inversePatch).reverse();try{this.onUndo(t,o),this.redoStack.push({root:t,patches:n})}catch(i){this.sentryService.captureException(new Error(`Undo operation failed: ${i.message}`)),this.undoStack=[],this.redoStack=[]}finally{(0,b.Z)(this,y,!1),(0,v.mutate)(this.projectUIState,(e=>{e.userInteractions.undo=this.undoStack.length,e.userInteractions.redo=this.redoStack.length}))}}redo(){if(!(0,_.Z)(this,m))return;if(this.projectUIState.layout.mainPanel===N.iW.DEV)return;const e=this.redoStack.pop();if(!e)return;this.updateLastChangeAt(),(0,b.Z)(this,y,!0);const{root:t,patches:n}=e;try{this.onRedo(t,n),this.undoStack.push({root:t,patches:n})}catch(o){this.sentryService.captureException(new Error(`Redo operation failed: ${o.message}`)),this.undoStack=[],this.redoStack=[]}finally{(0,b.Z)(this,y,!1),(0,v.mutate)(this.projectUIState,(e=>{e.userInteractions.undo=this.undoStack.length,e.userInteractions.redo=this.redoStack.length}))}}updateLastChangeAt(){const{selection:e}=this.projectUIState;e.componentId&&(this.lastChangeAt[e.componentId]=new Date)}},p=(0,I.Z)(d.prototype,"projectUIState",[i],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),u=(0,I.Z)(d.prototype,"guardsService",[s],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),h=(0,I.Z)(d.prototype,"sentryService",[r],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),(0,I.Z)(d.prototype,"undo",[a],Object.getOwnPropertyDescriptor(d.prototype,"undo"),d.prototype),(0,I.Z)(d.prototype,"redo",[c],Object.getOwnPropertyDescriptor(d.prototype,"redo"),d.prototype),l=d))},18986:function(e,t,n){var o,i,s,r,a,c,l,d,p,u,h,y,m,f,g,_=n(503348),b=n(777460),I=n(918437),v=n(302503),w=n(395942),O=n(255328),j=n(541109),S=n(881649),N=n(557149),D=n(422169),E=n(415066),T=n(638852);function P(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function C(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?P(Object(n),!0).forEach((function(t){(0,b.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):P(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}o=(0,v.provide)("mediaQueryBreakpointManagementFlow"),i=(0,v.inject)("projectDoc"),s=(0,v.inject)("projectUIState"),r=(0,v.inject)("modalManagementFlow"),a=(0,v.inject)("sentryService"),c=(0,v.inject)("layoutManagementFlow"),l=(0,v.inject)("selfHealingFlow"),o((p=class{constructor(){(0,_.Z)(this,"projectDoc",u,this),(0,_.Z)(this,"projectUIState",h,this),(0,_.Z)(this,"modalManagementFlow",y,this),(0,_.Z)(this,"sentryService",m,this),(0,_.Z)(this,"layoutManagementFlow",f,this),(0,_.Z)(this,"selfHealingFlow",g,this),(0,b.Z)(this,"handleBreakpointChanged",(e=>{T.Z.mixpanelEvent(T.Z.AnalyticsEvents.PROJECT_SIDEBARS_TOP_BREAKPOINT_SELECT,{breakpoint:e.maxWidth}),(0,w.mutate)(this.projectUIState,(t=>{t.userInteractions.isNodeInPreviewMode&&this.layoutManagementFlow.stopElementPreviewMode();let n=e.maxWidth;1!==window.devicePixelRatio&&2!==window.devicePixelRatio&&(n-=1),t.stage.setCurrentWidth(n),t.selection.componentId&&(t.userPreferences.viewportSize=e.maxWidth)}))})),(0,b.Z)(this,"openBreakpointManagementPanel",(()=>{T.Z.mixpanelEvent(T.Z.AnalyticsEvents.PROJECT_SIDEBARS_TOP_BREAKPOINTS_SETTINGS),(0,w.mutate)(this.projectUIState,(e=>{e.mediaQueryBreakpoints.showManagementPanel=!0}))})),(0,b.Z)(this,"closeBreakpointManagementPanel",(()=>{(0,w.mutate)(this.projectUIState,(e=>{e.mediaQueryBreakpoints.showManagementPanel=!1}))}))}getNonDefaultActiveMQBreakpointsInOrder(e){return this.projectDoc.mediaQueryBreakpoints.getNonDefaultActiveMQBreakpointsInOrder(e)}getActiveMediaQueriesInOrder(e){return this.projectDoc.mediaQueryBreakpoints.getActiveMediaQueriesInOrder(e)}getAllMediaQueriesInOrder(e){return this.projectDoc.mediaQueryBreakpoints.getAllMediaQueriesInOrder(e)}getDefaultMediaQuery(){let e=this.projectDoc.mediaQueryBreakpoints.getDefaultMediaQuery();if(!e){const t=this.selfHealingFlow.restoreDefaultMediaQueries({});t&&(e=t)}return e}create(e){const{doc:t}=e;t&&t.mediaQueryBreakpoints.create(C({},e))}activateByIcon(e){const{doc:t,icon:n}=e;if(!t)return;const o=Object.values(t.mediaQueryBreakpoints.byId).find((e=>e.icon===n));o?delete o.isDisabled:this.create({icon:n,maxWidth:j.z4[n]})}activateById(e){const{doc:t,id:n}=e;t&&delete t.mediaQueryBreakpoints.byId[n].isDisabled}computeNewDefault(e){const{doc:t}=e;if(!t)return;const n=t.mediaQueryBreakpoints.getDefaultMediaQuery(),o=t.mediaQueryBreakpoints.getActiveMediaQueriesInOrder(!0)[0];if(!n)return o.isDefault=!0,void this.updateBreakpointFromNodeStyles({maxWidth:o.maxWidth,doc:t});(n.isDisabled||n.maxWidth<o.maxWidth)&&(delete n.isDefault,o.isDefault=!0,this.updateBreakpointFromNodeStyles({maxWidth:o.maxWidth,doc:t}))}computeNewMatchedMQ(e){const{doc:t}=e;if(!t)return;const n=this.projectUIState.stage.getCurrentWidth(),o=t.mediaQueryBreakpoints.getActiveMediaQueriesInOrder().filter((e=>e.maxWidth>=n))[0]||t.mediaQueryBreakpoints.getDefaultMediaQuery();(0,w.mutate)(this.projectUIState,(e=>{e.stage.matchedBreakpoint=o.id}))}deleteFromBatchWithConfirmation(e){const{batch:t,onSubmit:n}=e;let o="";const i=Object.keys(t).map((e=>{if(!t[e].isDisabled)return null;const n=this.projectDoc.mediaQueryBreakpoints.byId[e];return n.isDefault&&(o="default-"),`'${n.getName()}'`})).filter((e=>e)),s=D.d.createDeleteModal({deletedEntity:i.length>1?`${o}breakpoints`:`${o}breakpoint`,entityNames:i,onSubmit:n});this.modalManagementFlow.showModal(s)}updateBatch(e){const{batch:t,doc:n}=e;n&&(Object.keys(t).forEach((e=>{const{maxWidth:o,isDisabled:i}=t[e];o&&this.resize({id:e,maxWidth:o,doc:n}),i&&this.disable({id:e,doc:n}),!1===i&&this.activateById({id:e,doc:n})})),this.computeNewDefault({doc:n}),this.computeNewMatchedMQ({doc:n}))}validateUpdates(e){const t={},n=this.processUpdates(e),o=this.getAllMediaQueriesInOrder().filter((e=>{var t,o;return!(void 0!==(null===(t=n[e.id])||void 0===t?void 0:t.isDisabled)?null===(o=n[e.id])||void 0===o?void 0:o.isDisabled:e.isDisabled)}));return Object.keys(n).forEach((e=>{var i,s,r,a;const c=o.findIndex((t=>t.id===e)),l=this.projectDoc.mediaQueryBreakpoints.byId[e],d=n[e].maxWidth||l.maxWidth,p=void 0!==n[e].isDisabled?n[e].isDisabled:l.isDisabled;if(!d||p)return;const u=o[c+1],h=o[c-1],y=N.MAX_STAGE_WIDTH+j.UL,m=N.MIN_STAGE_WIDTH-j.UL;let f=(null===(i=n[(null===u||void 0===u?void 0:u.id)||""])||void 0===i?void 0:i.maxWidth)||(null===(s=o[c+1])||void 0===s?void 0:s.maxWidth)||y,g=(null===(r=n[(null===h||void 0===h?void 0:h.id)||""])||void 0===r?void 0:r.maxWidth)||(null===(a=o[c-1])||void 0===a?void 0:a.maxWidth)||m;f-=j.UL,g+=j.UL,d<g&&(t[e]=`${l.getName()} must be bigger than ${(null===h||void 0===h?void 0:h.getName())||`${g}px`}${h?` by at least ${j.UL}px`:""}`),d>f&&(t[e]=`${l.getName()} must be smaller than ${(null===u||void 0===u?void 0:u.getName())||`${f}px`}${u?` by at least ${j.UL}px`:""}`)})),{errors:t,processedUpdates:n}}processUpdates(e){const t={};return Object.keys(e).forEach((n=>{const o=this.projectDoc.mediaQueryBreakpoints.byId[n];t[n]={},!e[n].isDisabled!==!o.isDisabled&&(t[n].isDisabled=e[n].isDisabled),e[n].maxWidth!==o.maxWidth&&(t[n].maxWidth=e[n].maxWidth),Object.values(t[n]).filter((e=>void 0!==e)).length||delete t[n]})),t}getCurrentMediaQuery(){const e=this.projectDoc.mediaQueryBreakpoints.byId[this.projectUIState.stage.matchedBreakpoint||""]||this.getDefaultMediaQuery();if(!e){const e=new Error(`Failed to get current media query, which means that project is in an invalid state. ProjectId: ${this.projectDoc.id}`);throw this.sentryService.captureException(e,{type:E.U.CRITICAL}),e}return e}disable(e){const{id:t,doc:n}=e;if(!n)return;const o=n.mediaQueryBreakpoints.byId[t];o&&(o.isDisabled=!0,this.updateBreakpointFromNodeStyles({maxWidth:o.maxWidth,doc:n}))}remove(e){const{id:t,doc:n}=e;if(!n)return;const o=n.mediaQueryBreakpoints.byId[t].maxWidth;this.updateBreakpointFromNodeStyles({maxWidth:o,doc:n}),n.mediaQueryBreakpoints.remove(t)}resize(e){const{id:t,maxWidth:n,doc:o}=e;if(!o)return;const i=o.mediaQueryBreakpoints.byId[t],s=i.maxWidth;i.maxWidth=n,this.updateBreakpointFromNodeStyles({doc:o,maxWidth:s,newMaxWidth:n})}createDefaultMediaQueries(e){const{doc:t}=e;t&&(t.mediaQueryBreakpoints=new S.s,j.vn.forEach((e=>{this.create(C(C({},e),{},{doc:t}))})))}updateBreakpointFromNodeStyles(e){const{maxWidth:t,doc:n,newMaxWidth:o}=e;n&&(n.nodes.getAllNodes().forEach((e=>{e&&"referencedStyles"in e&&Object.values(null===e||void 0===e?void 0:e.referencedStyles).forEach((n=>{if("inlined"!==n.content.mapType)return;const i=n.content.conditions.find((e=>"screen-size"===e.conditionType&&e.maxWidth===t));i&&i.maxWidth===t&&(o?i.maxWidth=o:null===e||void 0===e||delete e.referencedStyles[n.id])}))})),Object.values(n.components.byId).forEach((e=>{Object.values((null===e||void 0===e?void 0:e.styleSetDefinitions)||{}).forEach((e=>{Object.values((null===e||void 0===e?void 0:e.referencedStyles)||{}).forEach((n=>{if("inlined"!==n.content.mapType)return;const i=n.content.conditions.find((e=>"screen-size"===e.conditionType&&e.maxWidth===t));i&&i.maxWidth===t&&(o?i.maxWidth=o:null===e||void 0===e||delete e.referencedStyles[n.id])}))}))})),Object.values(n.classes.byId).forEach((e=>{Object.values(e.conditions).forEach((n=>{if("screen-size"===n.type&&n.meta.maxWidth===t){if(o)return void(n.meta.maxWidth=o);delete e.conditions[n.id]}}))})))}},u=(0,I.Z)(p.prototype,"projectDoc",[i],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),h=(0,I.Z)(p.prototype,"projectUIState",[s],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),y=(0,I.Z)(p.prototype,"modalManagementFlow",[r],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),m=(0,I.Z)(p.prototype,"sentryService",[a],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),f=(0,I.Z)(p.prototype,"layoutManagementFlow",[c],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),g=(0,I.Z)(p.prototype,"selfHealingFlow",[l],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),(0,I.Z)(p.prototype,"create",[O.P],Object.getOwnPropertyDescriptor(p.prototype,"create"),p.prototype),(0,I.Z)(p.prototype,"activateByIcon",[O.P],Object.getOwnPropertyDescriptor(p.prototype,"activateByIcon"),p.prototype),(0,I.Z)(p.prototype,"activateById",[O.P],Object.getOwnPropertyDescriptor(p.prototype,"activateById"),p.prototype),(0,I.Z)(p.prototype,"computeNewDefault",[O.P],Object.getOwnPropertyDescriptor(p.prototype,"computeNewDefault"),p.prototype),(0,I.Z)(p.prototype,"computeNewMatchedMQ",[O.P],Object.getOwnPropertyDescriptor(p.prototype,"computeNewMatchedMQ"),p.prototype),(0,I.Z)(p.prototype,"updateBatch",[O.P],Object.getOwnPropertyDescriptor(p.prototype,"updateBatch"),p.prototype),(0,I.Z)(p.prototype,"disable",[O.P],Object.getOwnPropertyDescriptor(p.prototype,"disable"),p.prototype),(0,I.Z)(p.prototype,"remove",[O.P],Object.getOwnPropertyDescriptor(p.prototype,"remove"),p.prototype),(0,I.Z)(p.prototype,"resize",[O.P],Object.getOwnPropertyDescriptor(p.prototype,"resize"),p.prototype),(0,I.Z)(p.prototype,"createDefaultMediaQueries",[O.P],Object.getOwnPropertyDescriptor(p.prototype,"createDefaultMediaQueries"),p.prototype),(0,I.Z)(p.prototype,"updateBreakpointFromNodeStyles",[O.P],Object.getOwnPropertyDescriptor(p.prototype,"updateBreakpointFromNodeStyles"),p.prototype),d=p))},120998:function(__unused_webpack_module,__webpack_exports__,__webpack_require__){__webpack_require__.d(__webpack_exports__,{H:function(){return IMAGE_CSS_PROPERTIES}});var _vercel_path0_node_modules_next_node_modules_babel_runtime_helpers_esm_initializerDefineProperty__WEBPACK_IMPORTED_MODULE_20__=__webpack_require__(503348),_vercel_path0_node_modules_next_node_modules_babel_runtime_helpers_esm_defineProperty__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(777460),_vercel_path0_node_modules_next_node_modules_babel_runtime_helpers_esm_applyDecoratedDescriptor__WEBPACK_IMPORTED_MODULE_25__=__webpack_require__(918437),_constants_elements__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(233475),di__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(302503),di__WEBPACK_IMPORTED_MODULE_2___default=__webpack_require__.n(di__WEBPACK_IMPORTED_MODULE_2__),_app_project_page_domain_project_document_node_static_node__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(523689),_app_project_page_domain_project_document_node_types_style_types__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(761328),_app_utils_helpers__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(378888),_app_project_page_domain_project_document_node_dynamic_node__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__(555362),proxy_live_document__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__(395942),proxy_live_document__WEBPACK_IMPORTED_MODULE_7___default=__webpack_require__.n(proxy_live_document__WEBPACK_IMPORTED_MODULE_7__),_app_constants_cssProperties__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__(330058),_app_project_page_styling_default__WEBPACK_IMPORTED_MODULE_9__=__webpack_require__(694829),_app_common_utils_decorators_with_db_sync__WEBPACK_IMPORTED_MODULE_10__=__webpack_require__(255328),_app_project_page_domain_project_document_design_language_utils__WEBPACK_IMPORTED_MODULE_22__=__webpack_require__(916539),_component_constants__WEBPACK_IMPORTED_MODULE_21__=__webpack_require__(229187),_app_project_page_components_inspector_main_sections_utils__WEBPACK_IMPORTED_MODULE_11__=__webpack_require__(764944),_app_app_context_decorators_use_in_api__WEBPACK_IMPORTED_MODULE_12__=__webpack_require__(327089),_app_app_context_services_api_types__WEBPACK_IMPORTED_MODULE_13__=__webpack_require__(559196),_app_project_page_domain_project_document_utils__WEBPACK_IMPORTED_MODULE_14__=__webpack_require__(971162),_app_project_page_components_inspector_main_sections_background_image_utils_bg_img_parser__WEBPACK_IMPORTED_MODULE_23__=__webpack_require__(989993),_app_constants_assets__WEBPACK_IMPORTED_MODULE_15__=__webpack_require__(774468),_assets_utils__WEBPACK_IMPORTED_MODULE_24__=__webpack_require__(978338),_app_common_utils_decorators_with_image_optimisation__WEBPACK_IMPORTED_MODULE_16__=__webpack_require__(254068),_app_project_page_components_inspector_common_interactive_elements_utils__WEBPACK_IMPORTED_MODULE_17__=__webpack_require__(278702),_app_common_utils_general__WEBPACK_IMPORTED_MODULE_18__=__webpack_require__(239498),_app_project_page_ui_sensors_dynamic_properties_assignment_panel_utils__WEBPACK_IMPORTED_MODULE_19__=__webpack_require__(900870),_dec,_dec2,_dec3,_dec4,_dec5,_dec6,_dec7,_dec8,_dec9,_dec10,_dec11,_dec12,_dec13,_dec14,_dec15,_dec16,_dec17,_dec18,_dec19,_dec20,_dec21,_dec22,_dec23,_dec24,_dec25,_dec26,_dec27,_dec28,_dec29,_dec30,_dec31,_dec32,_dec33,_dec34,_dec35,_dec36,_dec37,_dec38,_dec39,_dec40,_dec41,_dec42,_dec43,_class,_class2,_descriptor,_descriptor2,_descriptor3,_descriptor4,_descriptor5,_descriptor6,_descriptor7,_descriptor8,_descriptor9,_descriptor10,_descriptor11,_descriptor12;function ownKeys(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function _objectSpread(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ownKeys(Object(n),!0).forEach((function(t){(0,_vercel_path0_node_modules_next_node_modules_babel_runtime_helpers_esm_defineProperty__WEBPACK_IMPORTED_MODULE_0__.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ownKeys(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}const IMAGE_CSS_PROPERTIES=["backgroundImage","listStyleImage"];let NodeStyleFlow=(_dec=(0,di__WEBPACK_IMPORTED_MODULE_2__.provide)("nodeStyleManagmentFlow"),_dec2=(0,di__WEBPACK_IMPORTED_MODULE_2__.inject)("projectUIState"),_dec3=(0,di__WEBPACK_IMPORTED_MODULE_2__.inject)("projectDoc"),_dec4=(0,di__WEBPACK_IMPORTED_MODULE_2__.inject)("sharedbProjectSyncService"),_dec5=(0,di__WEBPACK_IMPORTED_MODULE_2__.inject)("fontsInProjectFlow"),_dec6=(0,di__WEBPACK_IMPORTED_MODULE_2__.inject)("componentStyleManagementFlow"),_dec7=(0,di__WEBPACK_IMPORTED_MODULE_2__.inject)("assetsEditFlow"),_dec8=(0,di__WEBPACK_IMPORTED_MODULE_2__.inject)("mediaQueryBreakpointManagementFlow"),_dec9=(0,di__WEBPACK_IMPORTED_MODULE_2__.inject)("temporaryStyleFlow"),_dec10=(0,di__WEBPACK_IMPORTED_MODULE_2__.inject)("positioningService"),_dec11=(0,di__WEBPACK_IMPORTED_MODULE_2__.inject)("sentryService"),_dec12=(0,di__WEBPACK_IMPORTED_MODULE_2__.inject)("nodeAttributeManagmentFlow"),_dec13=(0,di__WEBPACK_IMPORTED_MODULE_2__.inject)("nodeManagementFlow"),_dec14=(0,_app_app_context_decorators_use_in_api__WEBPACK_IMPORTED_MODULE_12__.G)(_app_app_context_services_api_types__WEBPACK_IMPORTED_MODULE_13__.l.SET_MULTIPLE_STYLES_BY_KEY),_dec15=(0,_app_app_context_decorators_use_in_api__WEBPACK_IMPORTED_MODULE_12__.G)(_app_app_context_services_api_types__WEBPACK_IMPORTED_MODULE_13__.l.REMOVE_MULTIPLE_STYLES_BY_KEY_BREAKPOINT),_dec16=(0,_app_app_context_decorators_use_in_api__WEBPACK_IMPORTED_MODULE_12__.G)(_app_app_context_services_api_types__WEBPACK_IMPORTED_MODULE_13__.l.SET_STYLE_BY_KEY_BREAKPOINT),_dec17=(0,_app_app_context_decorators_use_in_api__WEBPACK_IMPORTED_MODULE_12__.G)(_app_app_context_services_api_types__WEBPACK_IMPORTED_MODULE_13__.l.COPY_STYLES_FROM_NODE_BREAKPOINT),_dec18=(0,_app_app_context_decorators_use_in_api__WEBPACK_IMPORTED_MODULE_12__.G)(_app_app_context_services_api_types__WEBPACK_IMPORTED_MODULE_13__.l.SET_NODE_STYLE),_dec19=(0,_app_common_utils_decorators_with_image_optimisation__WEBPACK_IMPORTED_MODULE_16__.u)(_app_common_utils_decorators_with_image_optimisation__WEBPACK_IMPORTED_MODULE_16__.j.UPDATE_STYLE_KEY),_dec20=(0,_app_app_context_decorators_use_in_api__WEBPACK_IMPORTED_MODULE_12__.G)(_app_app_context_services_api_types__WEBPACK_IMPORTED_MODULE_13__.l.SET_CONDITIONAL_STYLE),_dec21=(0,_app_common_utils_decorators_with_image_optimisation__WEBPACK_IMPORTED_MODULE_16__.u)(_app_common_utils_decorators_with_image_optimisation__WEBPACK_IMPORTED_MODULE_16__.j.UPDATE_STYLE_KEY),_dec22=(0,_app_app_context_decorators_use_in_api__WEBPACK_IMPORTED_MODULE_12__.G)(_app_app_context_services_api_types__WEBPACK_IMPORTED_MODULE_13__.l.BIND_PROJECT_STYLE_TO_NODE),_dec23=(0,_app_app_context_decorators_use_in_api__WEBPACK_IMPORTED_MODULE_12__.G)(_app_app_context_services_api_types__WEBPACK_IMPORTED_MODULE_13__.l.UNBIND_PROJECT_STYLE_TO_NODE),_dec24=(0,_app_app_context_decorators_use_in_api__WEBPACK_IMPORTED_MODULE_12__.G)(_app_app_context_services_api_types__WEBPACK_IMPORTED_MODULE_13__.l.CREATE_INTERACTION_STATE),_dec25=(0,_app_app_context_decorators_use_in_api__WEBPACK_IMPORTED_MODULE_12__.G)(_app_app_context_services_api_types__WEBPACK_IMPORTED_MODULE_13__.l.BIND_TEXT_STYLE_TO_NODE),_dec26=(0,_app_app_context_decorators_use_in_api__WEBPACK_IMPORTED_MODULE_12__.G)(_app_app_context_services_api_types__WEBPACK_IMPORTED_MODULE_13__.l.OVERRIDE_NODE_STYLE),_dec27=(0,_app_common_utils_decorators_with_image_optimisation__WEBPACK_IMPORTED_MODULE_16__.u)(_app_common_utils_decorators_with_image_optimisation__WEBPACK_IMPORTED_MODULE_16__.j.OVERRIDE_STYLE),_dec28=(0,_app_app_context_decorators_use_in_api__WEBPACK_IMPORTED_MODULE_12__.G)(_app_app_context_services_api_types__WEBPACK_IMPORTED_MODULE_13__.l.REMOVE_STYLE_BY_KEY_BREAKPOINT),_dec29=(0,_app_app_context_decorators_use_in_api__WEBPACK_IMPORTED_MODULE_12__.G)(_app_app_context_services_api_types__WEBPACK_IMPORTED_MODULE_13__.l.REMOVE_NODE_STYLE),_dec30=(0,_app_common_utils_decorators_with_image_optimisation__WEBPACK_IMPORTED_MODULE_16__.u)(_app_common_utils_decorators_with_image_optimisation__WEBPACK_IMPORTED_MODULE_16__.j.UPDATE_STYLE_KEY),_dec31=(0,_app_app_context_decorators_use_in_api__WEBPACK_IMPORTED_MODULE_12__.G)(_app_app_context_services_api_types__WEBPACK_IMPORTED_MODULE_13__.l.REMOVE_MULTIPLE_STYLES_BY_KEY),_dec32=(0,_app_app_context_decorators_use_in_api__WEBPACK_IMPORTED_MODULE_12__.G)(_app_app_context_services_api_types__WEBPACK_IMPORTED_MODULE_13__.l.REMOVE_CONDITIONAL_STYLE),_dec33=(0,_app_common_utils_decorators_with_image_optimisation__WEBPACK_IMPORTED_MODULE_16__.u)(_app_common_utils_decorators_with_image_optimisation__WEBPACK_IMPORTED_MODULE_16__.j.UPDATE_STYLE_KEY),_dec34=(0,_app_app_context_decorators_use_in_api__WEBPACK_IMPORTED_MODULE_12__.G)(_app_app_context_services_api_types__WEBPACK_IMPORTED_MODULE_13__.l.REMOVE_INTERACTION_STATE_STYLE),_dec35=(0,_app_app_context_decorators_use_in_api__WEBPACK_IMPORTED_MODULE_12__.G)(_app_app_context_services_api_types__WEBPACK_IMPORTED_MODULE_13__.l.REMOVE_MULTIPLE_STYLES_BY_KEY),_dec36=(0,_app_common_utils_decorators_with_image_optimisation__WEBPACK_IMPORTED_MODULE_16__.u)(_app_common_utils_decorators_with_image_optimisation__WEBPACK_IMPORTED_MODULE_16__.j.UPDATE_STYLE_KEY),_dec37=(0,_app_app_context_decorators_use_in_api__WEBPACK_IMPORTED_MODULE_12__.G)(_app_app_context_services_api_types__WEBPACK_IMPORTED_MODULE_13__.l.ORDER_STYLES),_dec38=(0,_app_app_context_decorators_use_in_api__WEBPACK_IMPORTED_MODULE_12__.G)(_app_app_context_services_api_types__WEBPACK_IMPORTED_MODULE_13__.l.OVERRIDE_CONDITIONAL_STYLE),_dec39=(0,_app_common_utils_decorators_with_image_optimisation__WEBPACK_IMPORTED_MODULE_16__.u)(_app_common_utils_decorators_with_image_optimisation__WEBPACK_IMPORTED_MODULE_16__.j.OVERRIDE_STYLE),_dec40=(0,_app_app_context_decorators_use_in_api__WEBPACK_IMPORTED_MODULE_12__.G)(_app_app_context_services_api_types__WEBPACK_IMPORTED_MODULE_13__.l.UNBIND_TOKEN_FROM_NODES),_dec41=(0,_app_app_context_decorators_use_in_api__WEBPACK_IMPORTED_MODULE_12__.G)(_app_app_context_services_api_types__WEBPACK_IMPORTED_MODULE_13__.l.UNBIND_TEXT_STYLE_FROM_NODE),_dec42=(0,_app_app_context_decorators_use_in_api__WEBPACK_IMPORTED_MODULE_12__.G)(_app_app_context_services_api_types__WEBPACK_IMPORTED_MODULE_13__.l.UPDATE_NODE_VISIBILITY),_dec43=(0,_app_app_context_decorators_use_in_api__WEBPACK_IMPORTED_MODULE_12__.G)(_app_app_context_services_api_types__WEBPACK_IMPORTED_MODULE_13__.l.UPDATE_NODE_TOKEN_REFERENCE),_dec((_class2=class NodeStyleFlow{constructor(){(0,_vercel_path0_node_modules_next_node_modules_babel_runtime_helpers_esm_initializerDefineProperty__WEBPACK_IMPORTED_MODULE_20__.Z)(this,"projectUIState",_descriptor,this),(0,_vercel_path0_node_modules_next_node_modules_babel_runtime_helpers_esm_initializerDefineProperty__WEBPACK_IMPORTED_MODULE_20__.Z)(this,"projectDoc",_descriptor2,this),(0,_vercel_path0_node_modules_next_node_modules_babel_runtime_helpers_esm_initializerDefineProperty__WEBPACK_IMPORTED_MODULE_20__.Z)(this,"dbSync",_descriptor3,this),(0,_vercel_path0_node_modules_next_node_modules_babel_runtime_helpers_esm_initializerDefineProperty__WEBPACK_IMPORTED_MODULE_20__.Z)(this,"fontsInProjectFlow",_descriptor4,this),(0,_vercel_path0_node_modules_next_node_modules_babel_runtime_helpers_esm_initializerDefineProperty__WEBPACK_IMPORTED_MODULE_20__.Z)(this,"componentStyleManagementFlow",_descriptor5,this),(0,_vercel_path0_node_modules_next_node_modules_babel_runtime_helpers_esm_initializerDefineProperty__WEBPACK_IMPORTED_MODULE_20__.Z)(this,"assetsEditFlow",_descriptor6,this),(0,_vercel_path0_node_modules_next_node_modules_babel_runtime_helpers_esm_initializerDefineProperty__WEBPACK_IMPORTED_MODULE_20__.Z)(this,"mediaQueryBreakpointManagementFlow",_descriptor7,this),(0,_vercel_path0_node_modules_next_node_modules_babel_runtime_helpers_esm_initializerDefineProperty__WEBPACK_IMPORTED_MODULE_20__.Z)(this,"temporaryStyleFlow",_descriptor8,this),(0,_vercel_path0_node_modules_next_node_modules_babel_runtime_helpers_esm_initializerDefineProperty__WEBPACK_IMPORTED_MODULE_20__.Z)(this,"positioningService",_descriptor9,this),(0,_vercel_path0_node_modules_next_node_modules_babel_runtime_helpers_esm_initializerDefineProperty__WEBPACK_IMPORTED_MODULE_20__.Z)(this,"sentryService",_descriptor10,this),(0,_vercel_path0_node_modules_next_node_modules_babel_runtime_helpers_esm_initializerDefineProperty__WEBPACK_IMPORTED_MODULE_20__.Z)(this,"nodeAttributeManagmentFlow",_descriptor11,this),(0,_vercel_path0_node_modules_next_node_modules_babel_runtime_helpers_esm_initializerDefineProperty__WEBPACK_IMPORTED_MODULE_20__.Z)(this,"nodeManagementFlow",_descriptor12,this),(0,_vercel_path0_node_modules_next_node_modules_babel_runtime_helpers_esm_defineProperty__WEBPACK_IMPORTED_MODULE_0__.Z)(this,"getResolvedStyles",(e=>{var t;const{dynamicStyleResult:n,replaceAssetIdsWithSrcs:o,nodeId:i,ignoreDisabledNodes:s}=e,r=this.projectDoc.getComponentIdForNode(i),a=this.projectDoc.nodes.getById(i),c=this.projectDoc.nodes.getById((null===a||void 0===a?void 0:a.parentId)||""),l="fragment"===(null===c||void 0===c?void 0:c.primitiveType)&&null!==(t=c.meta)&&void 0!==t&&t.isAttributeRoot?this.projectDoc.nodes.getById(i):this.projectDoc.nodes.getById(this.projectDoc.getOwnerIdOfDependentNode(i));if(!l||!("styles"in l))return{};if(this.projectDoc.nodes.nodeIsCompInstance(l)){const e=this.projectDoc.components.byId[l.compIdOfCompInstance],t=this.projectDoc.nodes.getById((null===e||void 0===e?void 0:e.rootNodeId)||""),{styles:i}=this.componentStyleManagementFlow.getStylesInheritedFromComponentInstance((null===t||void 0===t?void 0:t.id)||"",l.id);return this.resolveStaticAndDynamicNodes({styles:i,dynamicStyleResult:n,replaceAssetIdsWithSrcs:o,compOwningNode:r||"",ignoreDisabledNodes:s})}return this.resolveStaticAndDynamicNodes({styles:l.styles,dynamicStyleResult:n,replaceAssetIdsWithSrcs:o,compOwningNode:r||"",ignoreDisabledNodes:s})})),(0,_vercel_path0_node_modules_next_node_modules_babel_runtime_helpers_esm_defineProperty__WEBPACK_IMPORTED_MODULE_0__.Z)(this,"getResolvedInlineStyles",(e=>{const{nodeId:t,condition:n,replaceAssetIdsWithSrcs:o,dynamicStyleResult:i,ignoreDisabledNodes:s}=e,r=this.projectDoc.nodes.getById(this.projectDoc.getOwnerIdOfDependentNode(t));if(!r||!("styles"in r))return{};if(this.projectDoc.nodes.nodeIsCompInstance(r)){var a;const e=this.projectDoc.components.byId[r.compIdOfCompInstance],t=null===e||void 0===e?void 0:e.getInlineConditionalStyleMapForClass(n,null===(a=r.attrs[_component_constants__WEBPACK_IMPORTED_MODULE_21__.Q])||void 0===a?void 0:a.content);return t?this.resolveStaticAndDynamicNodes({styles:t.content.styles,dynamicStyleResult:i,replaceAssetIdsWithSrcs:o,ignoreDisabledNodes:s}):{}}const c=r.getInlineConditionalStyleMap(n);return c?this.resolveStaticAndDynamicNodes({styles:c.content.styles,dynamicStyleResult:i,replaceAssetIdsWithSrcs:o,ignoreDisabledNodes:s}):{}})),(0,_vercel_path0_node_modules_next_node_modules_babel_runtime_helpers_esm_defineProperty__WEBPACK_IMPORTED_MODULE_0__.Z)(this,"nodeHasStyleAtCurrentBreakpoint",(e=>{const{nodeId:t,key:n,values:o,excludeValues:i}=e,{styles:s,inheritedStyles:r}=this.getComputedStyleByKeyForCurrentBreakpoint(t,[n]),{resolvedClassesStyles:a,resolvedInheritedClassesStyles:c}=this.getResolvedClassesStylesBasedOnCurrentBreakpoint({nodeId:t});if(!o)return!!s[n]||!!r[n]||!!a[n]||!!c[n];const l=s[n]||r[n]||a[n]||c[n];return i?(!!s[n]||!!r[n]||!!a[n]||!!c[n])&&-1===o.indexOf(l):-1!==o.indexOf(l)})),(0,_vercel_path0_node_modules_next_node_modules_babel_runtime_helpers_esm_defineProperty__WEBPACK_IMPORTED_MODULE_0__.Z)(this,"getCurrentStyleValueByKeyForNode",((e,t)=>{const n={},{styles:o,classesStyles:i,inheritedStyles:s,inheritedClassesStyles:r}=this.getComputedStyleByKeyForCurrentBreakpoint(e,t);return t.forEach((e=>{n[e]=o[e]||i[e]||s[e]||r[e]})),n})),(0,_vercel_path0_node_modules_next_node_modules_babel_runtime_helpers_esm_defineProperty__WEBPACK_IMPORTED_MODULE_0__.Z)(this,"getDefaultStylesForNodeByType",(e=>{const t=this.projectDoc.nodes.getById(e);if(!t||!t.primitiveType||!("abilities"in t))return{};const n=this.getDefaultStylesFromTokens(),o=t.semanticType?(0,_app_project_page_styling_default__WEBPACK_IMPORTED_MODULE_9__.ux)()[t.semanticType]:{},i=(0,_app_project_page_styling_default__WEBPACK_IMPORTED_MODULE_9__.oD)(n)[t.primitiveType],s=t.abilities.link?(0,_app_project_page_styling_default__WEBPACK_IMPORTED_MODULE_9__.oD)(n)[_constants_elements__WEBPACK_IMPORTED_MODULE_1__.sO.LINK]:{},r=_objectSpread(_objectSpread(_objectSpread({},i),o),s),a=t.semanticType,c=a&&Object.values(_constants_elements__WEBPACK_IMPORTED_MODULE_1__.RY).includes(a);return Object.assign(r,_objectSpread({},c?_constants_elements__WEBPACK_IMPORTED_MODULE_1__.xp[a]:{})),r})),(0,_vercel_path0_node_modules_next_node_modules_babel_runtime_helpers_esm_defineProperty__WEBPACK_IMPORTED_MODULE_0__.Z)(this,"getInheritedStylesBasedOnCurrentBreakpoint",(e=>{const t=this.projectDoc.nodes.getById(e);if(!t||!("styles"in t))return{};let n={},o=t.parentId&&this.projectDoc.nodes.getById(t.parentId);for(;o;){const e=this.getResolvedStylesBasedOnCurrentBreakpoint({nodeId:o.id}),t=o.semanticType;n=_objectSpread(_objectSpread(_objectSpread({},t&&Object.values(_constants_elements__WEBPACK_IMPORTED_MODULE_1__.RY).includes(t)?_constants_elements__WEBPACK_IMPORTED_MODULE_1__.xp[t]:{}),(0,_app_utils_helpers__WEBPACK_IMPORTED_MODULE_5__.ei)(e,_app_constants_cssProperties__WEBPACK_IMPORTED_MODULE_8__.ki)),n),o=o.parentId&&this.projectDoc.nodes.getById(o.parentId)}return n})),(0,_vercel_path0_node_modules_next_node_modules_babel_runtime_helpers_esm_defineProperty__WEBPACK_IMPORTED_MODULE_0__.Z)(this,"getComputedStyleByKeyForCurrentBreakpoint",((e,t,n)=>this.getComputedStyleByKeyForBreakpoint(e,t,this.mediaQueryBreakpointManagementFlow.getCurrentMediaQuery(),n))),(0,_vercel_path0_node_modules_next_node_modules_babel_runtime_helpers_esm_defineProperty__WEBPACK_IMPORTED_MODULE_0__.Z)(this,"getComputedStyleByKeyForBreakpoint",((e,t,n,o)=>{const i={};let s={};const r={},a={};let c,l=!1;const d=this.projectDoc.nodes.getById(e);if(!d||!("styles"in d))return{styles:i,inheritedStyles:s,classesStyles:r,inheritedClassesStyles:a,breakpointForStyles:c,interactionStateStyles:l};const p=this.getResolvedStyles({nodeId:e,ignoreDisabledNodes:o}),{resolvedClassesStyles:u,resolvedInheritedClassesStyles:h}=this.getResolvedClassesStylesBasedOnCurrentBreakpoint({nodeId:e,ignoreDisabledNodes:o}),y=this.projectUIState.stage.interactionState.state;let m=!1;if(n.isDefault?t.forEach((e=>{"undefined"!==typeof p[e]&&(i[e]=p[e]),p[e]&&(i[e]=p[e])})):t.forEach((e=>{var r;let a,l;!m&&p[e]&&(m=!0);const u=(null===(r=d.attrs[_component_constants__WEBPACK_IMPORTED_MODULE_21__.Q])||void 0===r?void 0:r.content.toString())||"",h=this.projectDoc.nodes.nodeIsCompInstance(d)?this.projectDoc.components.byId[d.compIdOfCompInstance]:void 0,y=h?h.getInlineMatchedStyleSetIdsForClass(n.maxWidth,u):d.getInlineMatchedStyleSetIds(n.maxWidth);y.forEach((t=>{const r=h?h.styleSetDefinitions[u].referencedStyles[t]:d.referencedStyles[t];if("inlined"===r.content.mapType){const t=this.resolveStaticAndDynamicNodes({styles:r.content.styles,ignoreDisabledNodes:o})[e];t&&a&&(m=!0),t&&!a&&(a=t,l=r.content.conditions[0].maxWidth)}if(l===n.maxWidth){const t=a||p[e];"undefined"!==typeof t&&(i[e]=t)}else{a&&(m=!0);const t=a||p[e];"undefined"!==typeof t&&(s[e]=t)}l&&(c=l)})),y.length||t.forEach((e=>{p[e]&&(s[e]=p[e])}))})),y){s=_objectSpread(_objectSpread({},s),i);const e=d.getInlineConditionalStyleMap({conditionType:"element-state",content:y});if(e){const n=this.resolveStaticAndDynamicNodes({styles:e.content.styles,ignoreDisabledNodes:o});t.forEach((e=>{n[e]&&(l||(l=!0),i[e]=n[e])}))}}if(u&&t.forEach((e=>{u[e]&&(r[e]=u[e])})),h&&t.forEach((e=>{h[e]&&(a[e]=h[e])})),this.projectDoc.nodes.nodeIsCompInstance(d)){const e=this.projectDoc.components.byId[d.compIdOfCompInstance],{inheritedStyles:n,styles:i}=this.getComputedStyleByKeyForCurrentBreakpoint((null===e||void 0===e?void 0:e.rootNodeId)||"",t,o);s=_objectSpread(_objectSpread(_objectSpread({},i),n),s)}return{styles:i,inheritedStyles:s,classesStyles:r,inheritedClassesStyles:a,breakpointForStyles:c,interactionStateStyles:l,anyKeyHasValueOnBiggerMQ:m}}))}setMultipleStylesByKeyForCurrentBreakpoint(e){const{styleMap:t,doc:n,nodeIds:o}=e;Object.keys(t).forEach((e=>{!t[e]||!t[e].value&&0!==t[e].value?this.removeStyleByKeyBasedOnCurrentBreakpoint({key:e,doc:n,nodeIds:o}):this.setStyleByKeyBasedOnCurrentBreakpoint(_objectSpread({key:e,doc:n,nodeIds:o},t[e]))}))}removeMultipleStylesByKeyBasedOnCurrentBreakpoint(e){const{keys:t,doc:n,nodeIds:o}=e;t.forEach((e=>{this.removeStyleByKeyBasedOnCurrentBreakpoint({key:e,doc:n,nodeIds:o})}))}setStyleByKeyBasedOnCurrentBreakpoint(e){const t=this.projectUIState.stage.interactionState.state,n=this.mediaQueryBreakpointManagementFlow.getCurrentMediaQuery();t?this.setConditionalInlineStyleByKey(_objectSpread(_objectSpread({},e),{},{condition:{conditionType:"element-state",content:t}})):n.isDefault?this.setStyleByKey(e):this.setConditionalInlineStyleByKey(_objectSpread(_objectSpread({},e),{},{condition:{conditionType:"screen-size",maxWidth:n.maxWidth}}))}copyStylesFromNodeBasedOnCurrentBreakpoint(e){const{doc:t,nodeId:n,changedKeys:o,node:i}=e;if(!t)return;const s=this.mediaQueryBreakpointManagementFlow.getCurrentMediaQuery(),r=this.projectUIState.stage.interactionState.state,a=r?{conditionType:"element-state",content:r}:s.isDefault?null:{conditionType:"screen-size",maxWidth:s.maxWidth};if(a&&"getInlineConditionalStyleMap"in i){const e=i.getInlineConditionalStyleMap(a);o.forEach((o=>{const i=null===e||void 0===e?void 0:e.content.styles[o];if(i){if("static"!==i.type){if("token"===i.content.referenceType){const e=i.content.id;return void this.setConditionalInlineStyleByKey({doc:t,key:o,tokenId:e,value:"",nodeIds:[n],condition:a})}throw new Error("Copy style does not support dynamic prop values")}if("string"!==typeof i.content&&"number"!==typeof i.content)throw new Error(`Style content is not a string or number: ${i.content} (${typeof i.content})`);this.setConditionalInlineStyleByKey({doc:t,key:o,nodeIds:[n],value:i.content,condition:a})}else this.removeConditionalInlineStyleByKey({doc:t,key:o,nodeIds:[n],condition:a})}))}else"styles"in i&&o.forEach((e=>{const o=i.styles[e];if(o){if("static"!==o.type){if("token"===o.content.referenceType){const i=o.content.id;return void this.setStyleByKey({doc:t,nodeIds:[n],key:e,tokenId:i,value:""})}throw new Error("Copy style does not support dynamic prop values")}if("string"!==typeof o.content&&"number"!==typeof o.content)throw new Error(`Style content is not a string or number: ${o.content} (${typeof o.content})`);this.setStyleByKey({doc:t,nodeIds:[n],key:e,value:o.content})}else this.removeStyleByKey({doc:t,nodeIds:[n],key:e})}))}setStyleByKey(e){const{doc:t,nodeIds:n,key:o,value:i,tokenId:s}=e;if(!t)return;if(!n.length)throw new Error("NodeIds list cannot be empty");const r=this.projectUIState.localWork.nodesUnderLocalWork;n.forEach((n=>{const a=t.nodes.getById(n);if(!a||!("styles"in a))return;if(this.initialiseStylesOnNode({nodeId:n,doc:t}),t.nodes.nodeIsCompInstance(a)&&a)return void this.componentStyleManagementFlow.addStyleToCompInstance(_objectSpread(_objectSpread({},e),{},{nodeId:n}));if("fakeSize"in a&&a.fakeSize&&!r&&_app_constants_cssProperties__WEBPACK_IMPORTED_MODULE_8__.E5.includes(o)&&("width"!==o||"100%"!==i)&&(a.fakeSize=!1),!("styles"in a))throw new Error("Node does not have styles abilities");const c=_objectSpread({},a.styles[o]);var l,d;if(this.updateNodeReferenceForTokenWhenRemovingStyle({tokenReference:c,nodeId:a.id}),"fontFamily"===o&&this.fontsInProjectFlow.updateFontUsageWhenAddingStyles({doc:t,key:o,nodeId:n,fontName:i,oldFontName:c.content}),!s)return a.styles[o]="fontFamily"===o?new _app_project_page_domain_project_document_node_static_node__WEBPACK_IMPORTED_MODULE_3__.F({content:`"${i}"`,pos:null===(l=a.styles[o])||void 0===l?void 0:l.pos}):new _app_project_page_domain_project_document_node_static_node__WEBPACK_IMPORTED_MODULE_3__.F({content:i,pos:null===(d=a.styles[o])||void 0===d?void 0:d.pos}),r||IMAGE_CSS_PROPERTIES.includes(o)&&t.syncAssetInNodeRelationByNewContent({node:a,oldContent:c,newContent:a.styles[o]}),void this.nodeAttributeManagmentFlow.resetPristineAttributesAfterPropChange(t,a.parentId);if(s){var p;const e=t.designLanguage.tokensById[s];if(!e)return;e.usedInNodes[a.id]?e.usedInNodes[a.id]+=1:e.usedInNodes[a.id]=1,a.styles[o]=new _app_project_page_domain_project_document_node_dynamic_node__WEBPACK_IMPORTED_MODULE_6__.P({content:{referenceType:"token",id:s},pos:null===(p=a.styles[o])||void 0===p?void 0:p.pos})}this.nodeAttributeManagmentFlow.resetPristineAttributesAfterPropChange(t,a.parentId)})),r&&(0,proxy_live_document__WEBPACK_IMPORTED_MODULE_7__.mutate)(this.projectUIState,(e=>{var t;null===(t=e.localWork.changedStyles)||void 0===t||t.push(o)}))}setConditionalInlineStyleByKey(e){const{doc:t,nodeIds:n,condition:o,value:i,key:s,tokenId:r}=e;if(!t)return;if(!n.length)throw new Error("NodeIds list cannot be empty");const a=this.projectUIState.localWork.nodesUnderLocalWork;n.forEach((n=>{const c=t.nodes.getById(n);if(!c||!("styles"in c))return;if(this.initialiseStylesOnNode({nodeId:n,doc:t}),t.nodes.nodeIsCompInstance(c))return void this.componentStyleManagementFlow.addReferencedStyleToCompInstance(_objectSpread(_objectSpread({},e),{},{nodeId:n}));let l=c.getInlineConditionalStyleMap(o),d=!1;l||(l={type:"style-map",id:(0,_app_utils_helpers__WEBPACK_IMPORTED_MODULE_5__.Ox)(),content:{mapType:"inlined",conditions:[o],styles:{}}},d=!0);const p=_objectSpread({},l.content.styles[s]);var u;(this.updateNodeReferenceForTokenWhenRemovingStyle({tokenReference:p,nodeId:c.id}),"fontFamily"===s&&this.fontsInProjectFlow.updateFontUsageWhenAddingStyles({doc:t,key:s,nodeId:n,fontName:i,oldFontName:p.content}),r)||(l.content.styles[s]=new _app_project_page_domain_project_document_node_static_node__WEBPACK_IMPORTED_MODULE_3__.F({content:i,pos:null===(u=l.content.styles[s])||void 0===u?void 0:u.pos}),d&&(c.referencedStyles[l.id]=l),a||IMAGE_CSS_PROPERTIES.includes(s)&&t.syncAssetInNodeRelationByNewContent({node:c,oldContent:p,newContent:l.content.styles[s]}));if(r){var h;const e=t.designLanguage.tokensById[r];if(!e)return;e.usedInNodes[c.id]?e.usedInNodes[c.id]+=1:e.usedInNodes[c.id]=1,l.content.styles[s]=new _app_project_page_domain_project_document_node_dynamic_node__WEBPACK_IMPORTED_MODULE_6__.P({content:{referenceType:"token",id:r},pos:null===(h=l.content.styles[s])||void 0===h?void 0:h.pos}),d&&(c.referencedStyles[l.id]=l)}this.nodeAttributeManagmentFlow.resetPristineAttributesAfterPropChange(t,c.parentId)})),a&&(0,proxy_live_document__WEBPACK_IMPORTED_MODULE_7__.mutate)(this.projectUIState,(e=>{var t;null===(t=e.localWork.changedStyles)||void 0===t||t.push(s)}))}bindProjectStyleToNode({doc:e,refId:t,nodeId:n}){if(!e)return;const o=e.nodes.getById(n);if(!o||!("styles"in o))return;const i=e.classes.byId[t];if(!i)throw new Error(`Project is missing from the style sheet - ${t}`);if("simple"!==i.classType)throw new Error(`Attempted to bind nodes to non-simple class - ${t}`);const s={id:t,type:"style-map",content:{mapType:"project-referenced",referenceId:t}};o.referencedStyles[s.id]=s,null!==i&&void 0!==i&&i.usedInNodes?i.usedInNodes[n]=!0:i.usedInNodes={[n]:!0}}unbindProjectStyleFromNodeIds({doc:e,classId:t,nodeIds:n}){if(!e)return;const o=e.classes.byId[t];if("simple"!==o.classType)throw new Error("Attempted to unbind non-simple class from nodes");n.forEach((n=>{var i;const s=e.nodes.getById(n);s&&"styles"in s&&(null!==s&&void 0!==s&&null!==(i=s.conditionalReferencedProjectStyles)&&void 0!==i&&i[t]&&this.nodeManagementFlow.removeRenderingConditionForProjectStyle({doc:e,nodeId:n,styleId:t}),delete s.referencedStyles[t],delete o.usedInNodes[n])}))}createInteractionState(e){const{doc:t,interactionState:n,nodeIds:o}=e;if(!t)return;if(!o.length)throw new Error("NodeIds list cannot be empty");const i={conditionType:"element-state",content:n};o.forEach((e=>{const n=t.nodes.getById(e);if(!n||!("styles"in n))return;this.initialiseStylesOnNode({nodeId:e,doc:t});let o=n.getInlineConditionalStyleMap(i);o||(o={type:"style-map",id:(0,_app_utils_helpers__WEBPACK_IMPORTED_MODULE_5__.Ox)(),content:{mapType:"inlined",conditions:[i],styles:{}}},"element-state"===i.conditionType&&this.setStyleByKey({nodeIds:[e],key:"transition",value:"0.3s"}),n.referencedStyles[o.id]=o)}))}getAllInteractionStates(e){if(!e.length)return[];const t=new Set;return e.forEach((e=>{const n=this.projectDoc.nodes.getById(e);if(!n||!("styles"in n))return[];Object.keys(_app_project_page_domain_project_document_node_types_style_types__WEBPACK_IMPORTED_MODULE_4__.F).forEach((e=>{const o={conditionType:"element-state",content:e};n.getInlineConditionalStyleMap(o)&&t.add(e)}))})),[...t]}bindTextStyleOnSelectedNodes(e){const{doc:t,nodeIds:n,textStyleId:o}=e;if(!t)return;const i=t.designLanguage.textStyleSetsById[o];i&&n.forEach((e=>{const n=t.nodes.getById(e);if(!n||!("styles"in n))return;this.initialiseStylesOnNode({nodeId:e,doc:t});if(Object.values(n.referencedStyles||{}).some((e=>"design-language-referenced"===e.content.mapType))){const o=(0,_app_project_page_components_inspector_main_sections_utils__WEBPACK_IMPORTED_MODULE_11__.hm)(n);if(i.id===o||null===o)return;this.unbindTextStyleFromNode({doc:t,textStyleId:o,nodeIds:[e]})}const s=(0,_app_utils_helpers__WEBPACK_IMPORTED_MODULE_5__.Ox)();n.referencedStyles[s]={id:s,type:"style-map",content:{mapType:"design-language-referenced",referenceId:o}},i.usedInNodes[e]=!0}))}overrideNodeStyle(e){const{nodeIds:t,newStyle:n}=e,o=this.projectUIState.localWork.nodesUnderLocalWork;(o?proxy_live_document__WEBPACK_IMPORTED_MODULE_7__.mutate:this.dbSync.mutate)(this.projectDoc,(e=>{t.forEach((t=>{const o=e.nodes.getById(t);o&&"styles"in o&&(o.styles=n,this.nodeAttributeManagmentFlow.resetPristineAttributesAfterPropChange(e,o.parentId))}))})),o&&(0,proxy_live_document__WEBPACK_IMPORTED_MODULE_7__.mutate)(this.projectUIState,(e=>{var t;null===(t=e.localWork.changedStyles)||void 0===t||t.push(...Object.keys(n))}))}removeStyleByKeyBasedOnCurrentBreakpoint(e){const t=this.projectUIState.stage.interactionState.state,n=this.mediaQueryBreakpointManagementFlow.getCurrentMediaQuery();t?this.removeConditionalInlineStyleByKey(_objectSpread(_objectSpread({},e),{},{condition:{conditionType:"element-state",content:t}})):n.isDefault?this.removeStyleByKey(e):this.removeConditionalInlineStyleByKey(_objectSpread(_objectSpread({},e),{},{condition:{conditionType:"screen-size",maxWidth:n.maxWidth}}))}removeStyleByKey(e){const{nodeIds:t,key:n,doc:o}=e,i=this.projectUIState.localWork.nodesUnderLocalWork;o&&(t.forEach((t=>{const s=o.nodes.getById(t);if(!s||!("styles"in s))return;if(o.nodes.nodeIsCompInstance(s))return void this.componentStyleManagementFlow.removeStyleFromCompInstance(_objectSpread(_objectSpread({},e),{},{nodeId:t}));const r=s.styles[n];this.updateNodeReferenceForTokenWhenRemovingStyle({tokenReference:r,nodeId:s.id}),"static"===(null===r||void 0===r?void 0:r.type)&&this.fontsInProjectFlow.updateFontUsageWhenRemovingStyles({doc:o,fontName:r.content,key:n,nodeId:t});const a=_objectSpread({},s.styles[n]);delete s.styles[n],this.nodeAttributeManagmentFlow.resetPristineAttributesAfterPropChange(o,s.parentId),i||IMAGE_CSS_PROPERTIES.includes(n)&&o.syncAssetInNodeRelationByNewContent({node:s,oldContent:a,newContent:null})})),i&&(0,proxy_live_document__WEBPACK_IMPORTED_MODULE_7__.mutate)(this.projectUIState,(e=>{var t;null===(t=e.localWork.changedStyles)||void 0===t||t.push(n)})))}removeMultipleStylesByKey(e){const{nodeIds:t,keys:n,doc:o}=e;o&&n.forEach((e=>{this.removeStyleByKey({nodeIds:t,key:e})}))}removeConditionalInlineStyleByKey(e){const{nodeIds:t,key:n,doc:o,condition:i}=e;if(!o)return;if(!t.length)throw new Error("NodeIds list cannot be empty");const s=this.projectUIState.localWork.nodesUnderLocalWork;t.forEach((t=>{const r=o.nodes.getById(t);if(!r||!("styles"in r))return;if(o.nodes.nodeIsCompInstance(r))return void this.componentStyleManagementFlow.removeConditionalStyleFromCompInstance(_objectSpread(_objectSpread({},e),{},{nodeId:t}));const a=r.getInlineConditionalStyleMap(i);if(!a)return;const c=a.content.styles[n];this.updateNodeReferenceForTokenWhenRemovingStyle({tokenReference:c,nodeId:r.id}),"static"===(null===c||void 0===c?void 0:c.type)&&this.fontsInProjectFlow.updateFontUsageWhenRemovingStyles({doc:o,fontName:c.content,key:n,nodeId:t});const l=_objectSpread({},a.content.styles[n]),d=Object.keys(a.content.styles);1===d.length&&d[0]===n&&"element-state"!==i.conditionType?delete r.referencedStyles[a.id]:delete a.content.styles[n],this.nodeAttributeManagmentFlow.resetPristineAttributesAfterPropChange(o,r.parentId),s||IMAGE_CSS_PROPERTIES.includes(n)&&o.syncAssetInNodeRelationByNewContent({node:r,oldContent:l,newContent:null})})),s&&(0,proxy_live_document__WEBPACK_IMPORTED_MODULE_7__.mutate)(this.projectUIState,(e=>{var t;null===(t=e.localWork.changedStyles)||void 0===t||t.push(n)}))}removeInteractionStateStyles(e){const{nodeIds:t,doc:n,interactionState:o}=e;if(n){if(!t.length)throw new Error("NodeIds list cannot be empty");t.forEach((e=>{const t=n.nodes.getById(e);if(!t||!("styles"in t))return;const i=t.getInlineConditionalStyleMap({conditionType:"element-state",content:o});if(!i)return;delete t.referencedStyles[i.id];this.getAllInteractionStates([e]).length||this.removeStyleByKey({doc:n,nodeIds:[e],key:"transition"})}))}}removeAllStylesFromNodeForBreakpoint(e){const{doc:t,nodeId:n,condition:o}=e;if(!t)return;const i=t.nodes.getById(n);if(!i||!("styles"in i))return;if(!o)return void Object.keys(i.styles).forEach((e=>{this.removeStyleByKey({doc:t,nodeIds:[n],key:e})}));const s=i.getInlineConditionalStyleMap(o);if(!s)return;Object.keys(s.content.styles).forEach((e=>{this.removeConditionalInlineStyleByKey({doc:t,nodeIds:[n],key:e,condition:o})}))}orderStyles(e){var t;const{nodeId:n,condition:o,doc:i}=e;if(!i)return;const s=i.nodes.getById(n);if(!s||!("styles"in s))return;const r=o?(null===(t=s.getInlineConditionalStyleMap(o))||void 0===t?void 0:t.content.styles)||{}:s.styles;Object.values(r).forEach((e=>{e.pos||(e.pos=this.positioningService.getHighestAvailablePosition({entitiyCollection:r}))}))}overrideConditionalInlineStyles(e){const{nodeIds:t,condition:n,styles:o}=e;if(!t.length)throw new Error("NodeIds list cannot be empty");const i=this.projectUIState.localWork.nodesUnderLocalWork;(i?proxy_live_document__WEBPACK_IMPORTED_MODULE_7__.mutate:this.dbSync.mutate)(this.projectDoc,(e=>{t.forEach((t=>{const i=e.nodes.getById(t);if(!i||!("styles"in i))return;let s=JSON.parse(JSON.stringify(i.getInlineConditionalStyleMap(n)));s||(s={type:"style-map",id:(0,_app_utils_helpers__WEBPACK_IMPORTED_MODULE_5__.Ox)(),content:{mapType:"inlined",conditions:[n],styles:o}}),s.content.styles=o,i.referencedStyles[s.id]=s}))})),i&&(0,proxy_live_document__WEBPACK_IMPORTED_MODULE_7__.mutate)(this.projectUIState,(e=>{var t;null===(t=e.localWork.changedStyles)||void 0===t||t.push(...Object.keys(o))}))}getResolvedStylesBasedOnCurrentBreakpoint(e){const{nodeId:t,dynamicStyleResult:n,replaceAssetIdsWithSrcs:o,ignoreDisabledNodes:i}=e,s=this.projectDoc.nodes.getById(t);if(!s||!("styles"in s))return{};const r=this.projectUIState.stage.interactionState.state,a=this.mediaQueryBreakpointManagementFlow.getCurrentMediaQuery();if(r){const e=a.isDefault?[]:s.getInlineMatchedStyleSetIds(a.maxWidth),c=s.referencedStyles[e[0]];if(c&&"inlined"===c.content.mapType)return this.getResolvedInlineStyles({nodeId:t,condition:{conditionType:"element-state",content:r},dynamicStyleResult:n,replaceAssetIdsWithSrcs:o,ignoreDisabledNodes:i})}if(!a.isDefault){const e=s.getInlineMatchedStyleSetIds(a.maxWidth),r=s.referencedStyles[e[0]];if(r&&"inlined"===r.content.mapType)return this.getResolvedInlineStyles({nodeId:t,condition:{maxWidth:r.content.conditions[0].maxWidth,conditionType:"screen-size"},dynamicStyleResult:n,replaceAssetIdsWithSrcs:o,ignoreDisabledNodes:i})}return this.getResolvedStyles(e)}resolveStaticAndDynamicNodes(e){const{styles:t,compOwningNode:n,dynamicStyleResult:o,replaceAssetIdsWithSrcs:i,ignoreDisabledNodes:s}=e;return Object.keys(t).reduce(((e,r)=>{if(s&&t[r].disabled)return e;const a=this.resolveDynamicNode(t[r],r,o,i,n);return a&&(e[r]=a),e}),{})}resolveDynamicNode(e,t,n,o,i){if(e){if("static"===e.type){let n=String(e.content);return o&&IMAGE_CSS_PROPERTIES.includes(t)&&(n=this.getAbsoluteBackgroundImage(e.content,i)),String(n)}if("dynamic"===e.type){const t=e.content;let o=t.defaultValue;if("token"===t.referenceType){const e=this.projectDoc.designLanguage.tokensById[t.id];if("variable"===n){var s;o=`var(${null===(s=this.projectDoc.designLanguage.getTokensAsCustomProperties()[t.id])||void 0===s?void 0:s.name})`}else if("value"===n)o=null===e||void 0===e?void 0:e.value;else{const t=this.projectDoc.designLanguage.categoriesById[null===e||void 0===e?void 0:e.categoryId];o="color"===(null===e||void 0===e?void 0:e.type)||"gradient"===(null===e||void 0===e?void 0:e.type)?(0,_app_project_page_domain_project_document_design_language_utils__WEBPACK_IMPORTED_MODULE_22__.MU)(_objectSpread(_objectSpread({},e),{},{categoryName:t.name})):null===e||void 0===e?void 0:e.name}}if(o)return o}}}getResolvedClassesStylesBasedOnCurrentBreakpoint(e){const t=this.projectDoc.nodes.getById(e.nodeId);if(!t||!("styles"in t))return{resolvedClassesStyles:{},resolvedInheritedClassesStyles:{}};const n=Object.values((null===t||void 0===t?void 0:t.referencedStyles)||{}).filter((e=>"project-referenced"===e.content.mapType));let o=[];n.forEach((t=>{if(this.projectDoc.classes.byId[t.content.referenceId])o.push(this.projectDoc.classes.byId[t.content.referenceId]);else{void 0===t.id&&this.dbSync.mutate(this.projectDoc,(t=>{const n=t.nodes.getById(e.nodeId),o=n.referencedStyles;delete o[void 0],n.referencedStyles=_objectSpread({},o)}));const n=new Error(`Class ${t.id} is missing from project`);this.sentryService.captureException(n)}})),o=o.sort(((e,t)=>(0,_app_project_page_domain_project_document_utils__WEBPACK_IMPORTED_MODULE_14__.F0)(parseFloat(e.pos)-(0,_app_project_page_domain_project_document_utils__WEBPACK_IMPORTED_MODULE_14__.F0)(parseFloat(t.pos)))));const{interactionState:i}=this.projectUIState.stage,s=i.state,r=this.mediaQueryBreakpointManagementFlow.getCurrentMediaQuery();let a={},c={};return o.forEach((t=>{const n=this.projectDoc.classes.byId[t.id];if(!n)return;let o={},i={},l=null;if(r.isDefault&&(o=n.content),!r.isDefault){i=_objectSpread(_objectSpread({},n.content),i);n.getMatchedScreenSizeStyleSetIds(r.maxWidth).forEach((e=>{const t=n.conditions[e];t.meta.maxWidth===r.maxWidth?o=t.content:i=_objectSpread(_objectSpread({},i),t.content)}))}s&&(l=Object.values(n.conditions).find((e=>"element-state"===e.type&&e.meta.state===s)),l&&(o=_objectSpread(_objectSpread({},o),l.content))),a=Object.assign(a,this.resolveStaticAndDynamicNodes(_objectSpread({styles:o},e))),c=Object.assign(c,this.resolveStaticAndDynamicNodes(_objectSpread({styles:i},e)))})),{resolvedClassesStyles:a,resolvedInheritedClassesStyles:c}}unbindTokenFromNodes(e){const{doc:t,tokenId:n,nodeIds:o}=e;if(!t)return;const i=t.designLanguage.tokensById[n];i&&o.forEach((e=>{const o=t.nodes.getById(e);o&&"styles"in o&&(t.nodes.nodeIsCompInstance(o)?this.componentStyleManagementFlow.unbindTokenFromCompInstance({doc:t,nodeId:e,tokenId:n}):(Object.values((null===o||void 0===o?void 0:o.referencedStyles)||{}).forEach((e=>{var t;"inlined"===e.content.mapType&&null!==(t=e.content)&&void 0!==t&&t.conditions.length&&Object.values(e.content.styles||{}).length>0&&Object.keys(e.content.styles).forEach((t=>{const s=e.content.styles[t];"dynamic"===s.type&&"token"===s.content.referenceType&&s.content.id===n&&(delete o.referencedStyles[e.id].content.styles[t],o.referencedStyles[e.id].content.styles[t]=new _app_project_page_domain_project_document_node_static_node__WEBPACK_IMPORTED_MODULE_3__.F({content:i.value}))}))})),Object.keys(o.styles||{}).forEach((e=>{const t=o.styles[e];"dynamic"===t.type&&"token"==t.content.referenceType&&t.content.id===n&&(delete o.styles[e],o.styles[e]=new _app_project_page_domain_project_document_node_static_node__WEBPACK_IMPORTED_MODULE_3__.F({content:i.value}))}))))}))}unbindTextStyleFromNode(e){const{nodeIds:t,doc:n,textStyleId:o}=e;if(!n)return;const i=n.designLanguage.textStyleSetsById[o],s=i.content;t.forEach((e=>{const t=n.nodes.getById(e);t&&"styles"in t&&(delete i.usedInNodes[e],t.referencedStyles={},Object.keys(s||{}).forEach((e=>{var n;t.styles[e]=new _app_project_page_domain_project_document_node_static_node__WEBPACK_IMPORTED_MODULE_3__.F({content:null===(n=s[e])||void 0===n?void 0:n.content})})))}))}updateNodesVisibility(e){const{hide:t,doc:n,nodeIds:o}=e;o.forEach((e=>{const{styles:o,inheritedStyles:i}=this.getComputedStyleByKeyForCurrentBreakpoint(e,["display"]);if(t){if("none"===o.display||"none"===i.display)return;return this.temporaryStyleFlow.movePropertiesToTempStyle({doc:n,properties:["display"],nodeIds:[e]}),void("none"===i.display?this.removeStyleByKeyBasedOnCurrentBreakpoint({doc:n,nodeIds:[e],key:"display"}):this.setStyleByKeyBasedOnCurrentBreakpoint({doc:n,key:"display",value:"none",nodeIds:[e]}))}const{style:s,inheritedStyle:r}=this.temporaryStyleFlow.getValuesFromTempStyle("display");s?this.temporaryStyleFlow.retrievePropertiesFromTempStyle({doc:n,properties:["display"],nodeIds:[e]}):r?this.setStyleByKeyBasedOnCurrentBreakpoint({doc:n,key:"display",value:r,nodeIds:[e]}):"none"!==o.display?"none"===i.display&&this.setStyleByKeyBasedOnCurrentBreakpoint({doc:n,key:"display",value:"flex",nodeIds:[e]}):this.removeStyleByKeyBasedOnCurrentBreakpoint({doc:n,key:"display",nodeIds:[e]})}))}getDefaultStylesFromTokens(){const e=this.projectDoc.designLanguage.getTokenWithRole("background-color"),t=this.projectDoc.designLanguage.getTokenWithRole("foreground-color"),n=this.projectDoc.designLanguage.getDefaultTextStyle(),{content:o}=n,i=e=>{const t=this.projectDoc.designLanguage.categoriesById[null===e||void 0===e?void 0:e.categoryId];return(0,_app_project_page_domain_project_document_design_language_utils__WEBPACK_IMPORTED_MODULE_22__.MU)(_objectSpread(_objectSpread({},e),{},{categoryName:t.name}))};return _objectSpread(_objectSpread(_objectSpread({},t?{color:i(t)}:null),e?{background:i(e)}:null),Object.keys(o||{}).reduce(((e,t)=>{const n=o[t];if("static"===(null===n||void 0===n?void 0:n.type)){if("object"===typeof n.content||"boolean"===typeof n.content)throw new Error(`Style content comming from Default TextStyles is not a string or number: ${n.content} (${typeof n.content})`);e[t]=n.content}return e}),{}))}updateNodeReferenceForTokenWhenRemovingStyle(e){const{doc:t,tokenReference:n,nodeId:o}=e;if(t&&n&&"dynamic"===n.type&&"token"===n.content.referenceType){const e=t.designLanguage.tokensById[n.content.id];if(!e)throw new Error(`Can't update Token node reference,Token ${n.content.id} does not exist`);e.usedInNodes[o]-=1}}ancestorHasStyleAtCurrentBreakpoint(e){const{nodeId:t,key:n,values:o}=e;let i=this.projectDoc.nodes.getById(t);for(;null!==(s=i)&&void 0!==s&&s.parentId;){var s;if(this.nodeHasStyleAtCurrentBreakpoint({nodeId:i.parentId,key:n,values:o}))return!0;i=this.projectDoc.nodes.getById(i.parentId)}return!1}getRelativeBackgroundImage(e){return(0,_app_project_page_components_inspector_main_sections_background_image_utils_bg_img_parser__WEBPACK_IMPORTED_MODULE_23__.BQ)(e).map((e=>{if(e.includes("gradient"))return e;const t=`${e}`.split(/'|"/)[1];let n=t;if(t)n=this.assetsEditFlow.replaceAssetAbsoluteSrcWithLocal(t)||t;else{const o=this.projectDoc.assets.byId[e];n=o?o.imageSrc:t}return n&&t?e.replace(t,n):n?`url("${n}")`:e})).join()}getAbsoluteBackgroundImage(e,t){return(0,_app_project_page_components_inspector_main_sections_background_image_utils_bg_img_parser__WEBPACK_IMPORTED_MODULE_23__.BQ)(e).map((e=>{if(e.includes("gradient"))return e;let n=`${e}`.split(/'|"/)[1];if(n)n=this.assetsEditFlow.replaceAssetLocalSrcWithAbsolute(n,t)||n;else{const o=this.projectDoc.assets.byId[e];n=o?o.getRemoteSrcForComp(t||""):n}return`url('${n}')`})).join()}getBackgroundImageWithAssetId(e){return(0,_app_project_page_components_inspector_main_sections_background_image_utils_bg_img_parser__WEBPACK_IMPORTED_MODULE_23__.BQ)(e).map((e=>{if(e.includes("gradient"))return e;const t=`${e}`.split(/'|"/)[1],n=this.assetsEditFlow.getAssetBySrc(t);return n?n.id:(0,_assets_utils__WEBPACK_IMPORTED_MODULE_24__.lJ)(e)})).join()}getNewBackgroundImageValue(e,t){const{styles:n,inheritedStyles:o}=this.getComputedStyleByKeyForCurrentBreakpoint(t,["backgroundImage"]),i=n.backgroundImage||o.backgroundImage;if(!i)return e;const s=(0,_app_project_page_components_inspector_main_sections_background_image_utils_bg_img_parser__WEBPACK_IMPORTED_MODULE_23__.BQ)(i);if(1===s.length)return e;let{focusedBgImgIndex:r}=this.projectUIState.userInteractions;return r?(0,proxy_live_document__WEBPACK_IMPORTED_MODULE_7__.mutate)(this.projectUIState,(e=>{e.userInteractions.focusedBgImgIndex=null})):r=s.findIndex((e=>!e.includes("gradient")))||0,s[r]=e,s.join(",")}replaceRemovedAssetFromBgImg(e,t){const n=(0,_app_project_page_components_inspector_main_sections_background_image_utils_bg_img_parser__WEBPACK_IMPORTED_MODULE_23__.BQ)(t);if(1===n.length)return`url("${_app_constants_assets__WEBPACK_IMPORTED_MODULE_15__.i$}")`;const o=n.findIndex((t=>t===e));return n[o]=`url("${_app_constants_assets__WEBPACK_IMPORTED_MODULE_15__.i$}")`,n.join(",")}getNodeParentFlexDirection(e){var t;const{nodeId:n}=e,o=null===(t=this.projectDoc.nodes.getById(n))||void 0===t?void 0:t.parentId;if(!o)return;const i=this.getCurrentStyleValueByKeyForNode(o,["display","flexDirection"]);return"flex"===i.display?i.flexDirection||"row":void 0}getAllStyleValuesForKey(e){const{key:t,nodeId:n}=e,o=this.projectDoc.nodes.getById(n);if(!o||!("styles"in o))return[];const i=[this.resolveDynamicNode(o.styles[t],t,"value")];return Object.values(o.referencedStyles).forEach((e=>{if("inlined"===e.content.mapType&&i.push(this.resolveDynamicNode(e.content.styles[t],t,"value")),"project-referenced"===e.content.mapType){const n=this.projectDoc.classes.byId[e.content.referenceId];if(!n)return;i.push(this.resolveDynamicNode(n.content[t],t,"value")),Object.values(n.conditions).forEach((e=>{i.push(this.resolveDynamicNode(e.content[t],t,"value"))}))}})),i.filter((e=>e))}nodeIsHidden(e){const t=[_constants_elements__WEBPACK_IMPORTED_MODULE_1__.IV.DROPDOWN_LIST,_constants_elements__WEBPACK_IMPORTED_MODULE_1__.IV.MOBILE_MENU];for(const i of t){const t=(0,_app_project_page_components_inspector_common_interactive_elements_utils__WEBPACK_IMPORTED_MODULE_17__.U2)(this.projectDoc,e,i);if(t)return!this.projectUIState.selection.nodesWithUtilityClasses[t.id]}const{styles:n,inheritedStyles:o}=this.getComputedStyleByKeyForCurrentBreakpoint(e,["display"]);return"none"===n.display||"none"===o.display||this.ancestorHasStyleAtCurrentBreakpoint({nodeId:e,key:"display",values:["none"]})}toggleNodesPropertyByKey(e){const{nodeIds:t,condition:n,key:o}=e;(0,proxy_live_document__WEBPACK_IMPORTED_MODULE_7__.mutate)(this.projectDoc,(e=>{t.forEach((t=>{const i=e.nodes.getById(t);if(!i||!("styles"in i))return;if(n){const e=this.getInlineConditionalStyleMapForNode({nodeId:t,condition:n});if(null===e||void 0===e||!e[o])return;return void(e[o].disabled=!e[o].disabled)}const s=this.getStylesForNode({nodeId:t,doc:e});s[o]&&(s[o].disabled=!s[o].disabled)}))}))}initialiseStylesOnNode(e){const{nodeId:t,doc:n}=e;if(!n)return;const o=n.nodes.getById(t);o&&"styles"in o&&(0===Object.keys(o.styles).length&&(o.styles={}),0===Object.keys(o.referencedStyles).length&&(o.referencedStyles={}))}checkRenderingCondition(renderingConditions,internalStateValues,componentInstanceId,selectedCompId){var _renderingConditions$,_renderingConditions$2,_matchValue4;if("global"===renderingConditions.reference.content.referenceType)return this.nodeSatisfiesGlobalStateRenderingCondition(renderingConditions);let matchValue=Object.values(internalStateValues||{}).find((e=>e.id===renderingConditions.reference.id));if(!matchValue&&selectedCompId){const e=_objectSpread(_objectSpread({},this.projectUIState.componentList.stateValues[selectedCompId]),this.projectUIState.componentList.propValues[selectedCompId]);matchValue=Object.values(e||{}).find((e=>e.id===renderingConditions.reference.id))}var _matchValue,_matchValue$component;if("root"!==componentInstanceId)return renderingConditions.value===(null===(_matchValue=matchValue)||void 0===_matchValue||null===(_matchValue$component=_matchValue.componentInstanceValues)||void 0===_matchValue$component?void 0:_matchValue$component[componentInstanceId]);if(null!==(_renderingConditions$=renderingConditions.condition)&&void 0!==_renderingConditions$&&null!==(_renderingConditions$2=_renderingConditions$.conditions)&&void 0!==_renderingConditions$2&&_renderingConditions$2.length){var _matchValue2,_matchValue3;const condition=renderingConditions.condition.conditions[0];if(!condition)return!0;let value="object"===typeof(null===(_matchValue2=matchValue)||void 0===_matchValue2?void 0:_matchValue2.value)?_objectSpread({},matchValue.value):null===(_matchValue3=matchValue)||void 0===_matchValue3?void 0:_matchValue3.value;if("dynamic"===renderingConditions.reference.type&&renderingConditions.reference.content.refPath&&value)for(const e of renderingConditions.reference.content.refPath){var _pathPart,_value;value=null!==(_pathPart=null===(_value=value)||void 0===_value?void 0:_value[e])&&void 0!==_pathPart?_pathPart:null}const{operand:operand,operation:operation}=condition,stringOperation=`'${value}' ${(0,_app_common_utils_general__WEBPACK_IMPORTED_MODULE_18__.M4)(operation)} '${operand}'`;try{const result=eval(stringOperation);return result}catch(error){return console.error("error",error),!0}}return renderingConditions.value===(null===(_matchValue4=matchValue)||void 0===_matchValue4?void 0:_matchValue4.value)}nodeSatisfiesStateRenderingCondition(e,t,n){if(!t)return!1;const o=this.projectDoc.nodes.getById(e),i=_objectSpread(_objectSpread({},this.projectUIState.componentList.stateValues[t]),this.projectUIState.componentList.propValues[t]);if(!o||!("renderingConditions"in o)||!o.renderingConditions)return!0;const s=this.projectUIState.selection.componentId;return this.checkRenderingCondition(o.renderingConditions,i,n,s!==t?s:null)}styleOnNodeSatisfiesStateRenderingCondition(e,t,n,o){if(!n)return!1;const i=this.projectDoc.nodes.getById(e),s=_objectSpread(_objectSpread({},this.projectUIState.componentList.stateValues[n]),this.projectUIState.componentList.propValues[n]);if(!i||!("referencedStyles"in i)||!i.referencedStyles||!("conditionalReferencedProjectStyles"in i)||!i.conditionalReferencedProjectStyles)return!0;const r=this.projectUIState.selection.componentId,a=i.conditionalReferencedProjectStyles[t];return!a||this.checkRenderingCondition(a,s,o,r!==n?r:null)}nodeSatisfiesGlobalStateRenderingCondition(e){var t,n;const o=e.reference.id.split("__");if(o.length<2)return!1;const i=null===(t=e.condition)||void 0===t||null===(n=t.conditions[0])||void 0===n?void 0:n.operand;if(!i)return!1;switch(o[0]){case _app_project_page_ui_sensors_dynamic_properties_assignment_panel_utils__WEBPACK_IMPORTED_MODULE_19__.v3.CURRENT_LANGUAGE:{const{currentLanguage:e}=this.projectUIState.internationalization;return e[o[1]]===i}case _app_project_page_ui_sensors_dynamic_properties_assignment_panel_utils__WEBPACK_IMPORTED_MODULE_19__.v3.ALL_LANGUAGES:default:return!1}}getInlineConditionalStyleMapForNode(e){var t;const{nodeId:n,condition:o,doc:i}=e;if(!i)return{};const s=i.nodes.getById(n);if(!s||!("referencedStyles"in s))return{};if("component-instance-node"===s.type){var r,a,c,l;const e=i.components.byId[s.compIdOfCompInstance];if(!e||!("maxWidth"in o))return{};const t=(null===(r=s.attrs[_component_constants__WEBPACK_IMPORTED_MODULE_21__.Q])||void 0===r?void 0:r.content.toString())||"",n=e.getInlineMatchedStyleSetIdsForClass(null!==(a=o.maxWidth)&&void 0!==a?a:0,t)[0];if(!n)return{};const d=null===(c=e.styleSetDefinitions)||void 0===c||null===(l=c[t])||void 0===l?void 0:l.referencedStyles[n];return d&&"style-map"===d.type&&"inlined"===d.content.mapType?d.content.styles:{}}return(null===(t=s.getInlineConditionalStyleMap(o))||void 0===t?void 0:t.content.styles)||{}}getStylesForNode(e){const{nodeId:t,doc:n}=e;if(!n)return{};const o=n.nodes.getById(t);if(!o||!("styles"in o))return{};if("component-instance-node"===o.type){var i,s,r;const e=n.components.byId[o.compIdOfCompInstance];if(!e)return{};const t=(null===(i=o.attrs[_component_constants__WEBPACK_IMPORTED_MODULE_21__.Q])||void 0===i?void 0:i.content.toString())||"";return(null===(s=e.styleSetDefinitions)||void 0===s||null===(r=s[t])||void 0===r?void 0:r.styles)||{}}return o.styles}getNodeRelativeTo(e){switch(Object.values(this.getCurrentStyleValueByKeyForNode(e,["position"]))[0]||"static"){case"relative":return e;case"absolute":return this.findNearestPositionedAncestor(e)||null;case"sticky":const t=this.projectDoc.nodes.getById(e);return t?t.parentId:null;default:return null}}findNearestPositionedAncestor(e){return this.projectDoc.nodes.getAncestors({nodeId:e,includePassedNode:!1}).find((e=>{const t=Object.values(this.getCurrentStyleValueByKeyForNode(e,["position"]))[0];if(["relative","absolute","fixed","sticky"].includes(t))return e}))}computeGridChildPositionIfParentIsGrid(e){{const{parentId:t,childId:n,doc:o}=e;if(!o)return;const i=o.nodes.getById(t);if(!i)return;const{styles:s,inheritedClassesStyles:r,inheritedStyles:a}=this.getComputedStyleByKeyForCurrentBreakpoint(t,["gridTemplateRows","gridTemplateColumns","display","gap"]);if(!("grid"===s.display||"grid"===a.display||"grid"===r.display))return;const c=Object.keys(i.childrenIds||{}).map((e=>o.nodes.getById(e))).filter((e=>!!(e.styles&&e.styles.gridRowStart&&e.styles.gridRowEnd&&e.styles.gridColumnStart&&e.styles.gridColumnEnd))).map((e=>{const{gridRowStart:t,gridRowEnd:n,gridColumnStart:o,gridColumnEnd:i}=e.styles;return{gridRowStart:null===t||void 0===t?void 0:t.content,gridRowEnd:null===n||void 0===n?void 0:n.content,gridColumnStart:null===o||void 0===o?void 0:o.content,gridColumnEnd:null===i||void 0===i?void 0:i.content}})),l=this.getFirstAvailableSlotInGrid({gridTemplateRows:s.gridTemplateRows,gridTemplateColumns:s.gridTemplateColumns,occupiedSlots:c}),d=o.nodes.getById(n);if(!d)return;this.setMultipleStylesByKeyForCurrentBreakpoint({nodeIds:[d.id],styleMap:{gridRowStart:{value:l.rowStart.toString()},gridRowEnd:{value:l.rowEnd.toString()},gridColumnStart:{value:l.columnStart.toString()},gridColumnEnd:{value:l.columnEnd.toString()}}})}}getFirstAvailableSlotInGrid(e){const{gridTemplateRows:t="1fr",gridTemplateColumns:n="1fr",occupiedSlots:o}=e,i=t.split(" "),s=n.split(" "),r=i.length,a=s.length,c=Array.from({length:r},(()=>Array.from({length:a},(()=>!1))));o.forEach((e=>{const{gridRowStart:t,gridRowEnd:n,gridColumnStart:o,gridColumnEnd:i}=e,s=parseInt(t),r=parseInt(n)-1,a=parseInt(o),l=parseInt(i)-1;for(let d=s;d<=r;d++)for(let e=a;e<=l;e++)c[d-1][e-1]=!0}));for(let l=0;l<r;l++)for(let e=0;e<a;e++)if(!c[l][e])return{rowStart:l+1,rowEnd:l+2,columnStart:e+1,columnEnd:e+2};return{rowStart:r,rowEnd:r+1,columnStart:0,columnEnd:1}}},_descriptor=(0,_vercel_path0_node_modules_next_node_modules_babel_runtime_helpers_esm_applyDecoratedDescriptor__WEBPACK_IMPORTED_MODULE_25__.Z)(_class2.prototype,"projectUIState",[_dec2],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),_descriptor2=(0,_vercel_path0_node_modules_next_node_modules_babel_runtime_helpers_esm_applyDecoratedDescriptor__WEBPACK_IMPORTED_MODULE_25__.Z)(_class2.prototype,"projectDoc",[_dec3],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),_descriptor3=(0,_vercel_path0_node_modules_next_node_modules_babel_runtime_helpers_esm_applyDecoratedDescriptor__WEBPACK_IMPORTED_MODULE_25__.Z)(_class2.prototype,"dbSync",[_dec4],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),_descriptor4=(0,_vercel_path0_node_modules_next_node_modules_babel_runtime_helpers_esm_applyDecoratedDescriptor__WEBPACK_IMPORTED_MODULE_25__.Z)(_class2.prototype,"fontsInProjectFlow",[_dec5],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),_descriptor5=(0,_vercel_path0_node_modules_next_node_modules_babel_runtime_helpers_esm_applyDecoratedDescriptor__WEBPACK_IMPORTED_MODULE_25__.Z)(_class2.prototype,"componentStyleManagementFlow",[_dec6],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),_descriptor6=(0,_vercel_path0_node_modules_next_node_modules_babel_runtime_helpers_esm_applyDecoratedDescriptor__WEBPACK_IMPORTED_MODULE_25__.Z)(_class2.prototype,"assetsEditFlow",[_dec7],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),_descriptor7=(0,_vercel_path0_node_modules_next_node_modules_babel_runtime_helpers_esm_applyDecoratedDescriptor__WEBPACK_IMPORTED_MODULE_25__.Z)(_class2.prototype,"mediaQueryBreakpointManagementFlow",[_dec8],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),_descriptor8=(0,_vercel_path0_node_modules_next_node_modules_babel_runtime_helpers_esm_applyDecoratedDescriptor__WEBPACK_IMPORTED_MODULE_25__.Z)(_class2.prototype,"temporaryStyleFlow",[_dec9],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),_descriptor9=(0,_vercel_path0_node_modules_next_node_modules_babel_runtime_helpers_esm_applyDecoratedDescriptor__WEBPACK_IMPORTED_MODULE_25__.Z)(_class2.prototype,"positioningService",[_dec10],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),_descriptor10=(0,_vercel_path0_node_modules_next_node_modules_babel_runtime_helpers_esm_applyDecoratedDescriptor__WEBPACK_IMPORTED_MODULE_25__.Z)(_class2.prototype,"sentryService",[_dec11],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),_descriptor11=(0,_vercel_path0_node_modules_next_node_modules_babel_runtime_helpers_esm_applyDecoratedDescriptor__WEBPACK_IMPORTED_MODULE_25__.Z)(_class2.prototype,"nodeAttributeManagmentFlow",[_dec12],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),_descriptor12=(0,_vercel_path0_node_modules_next_node_modules_babel_runtime_helpers_esm_applyDecoratedDescriptor__WEBPACK_IMPORTED_MODULE_25__.Z)(_class2.prototype,"nodeManagementFlow",[_dec13],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),(0,_vercel_path0_node_modules_next_node_modules_babel_runtime_helpers_esm_applyDecoratedDescriptor__WEBPACK_IMPORTED_MODULE_25__.Z)(_class2.prototype,"setMultipleStylesByKeyForCurrentBreakpoint",[_dec14,_app_common_utils_decorators_with_db_sync__WEBPACK_IMPORTED_MODULE_10__.P],Object.getOwnPropertyDescriptor(_class2.prototype,"setMultipleStylesByKeyForCurrentBreakpoint"),_class2.prototype),(0,_vercel_path0_node_modules_next_node_modules_babel_runtime_helpers_esm_applyDecoratedDescriptor__WEBPACK_IMPORTED_MODULE_25__.Z)(_class2.prototype,"removeMultipleStylesByKeyBasedOnCurrentBreakpoint",[_dec15,_app_common_utils_decorators_with_db_sync__WEBPACK_IMPORTED_MODULE_10__.P],Object.getOwnPropertyDescriptor(_class2.prototype,"removeMultipleStylesByKeyBasedOnCurrentBreakpoint"),_class2.prototype),(0,_vercel_path0_node_modules_next_node_modules_babel_runtime_helpers_esm_applyDecoratedDescriptor__WEBPACK_IMPORTED_MODULE_25__.Z)(_class2.prototype,"setStyleByKeyBasedOnCurrentBreakpoint",[_dec16,_app_common_utils_decorators_with_db_sync__WEBPACK_IMPORTED_MODULE_10__.P],Object.getOwnPropertyDescriptor(_class2.prototype,"setStyleByKeyBasedOnCurrentBreakpoint"),_class2.prototype),(0,_vercel_path0_node_modules_next_node_modules_babel_runtime_helpers_esm_applyDecoratedDescriptor__WEBPACK_IMPORTED_MODULE_25__.Z)(_class2.prototype,"copyStylesFromNodeBasedOnCurrentBreakpoint",[_dec17,_app_common_utils_decorators_with_db_sync__WEBPACK_IMPORTED_MODULE_10__.P],Object.getOwnPropertyDescriptor(_class2.prototype,"copyStylesFromNodeBasedOnCurrentBreakpoint"),_class2.prototype),(0,_vercel_path0_node_modules_next_node_modules_babel_runtime_helpers_esm_applyDecoratedDescriptor__WEBPACK_IMPORTED_MODULE_25__.Z)(_class2.prototype,"setStyleByKey",[_dec18,_app_common_utils_decorators_with_db_sync__WEBPACK_IMPORTED_MODULE_10__.P,_dec19],Object.getOwnPropertyDescriptor(_class2.prototype,"setStyleByKey"),_class2.prototype),(0,_vercel_path0_node_modules_next_node_modules_babel_runtime_helpers_esm_applyDecoratedDescriptor__WEBPACK_IMPORTED_MODULE_25__.Z)(_class2.prototype,"setConditionalInlineStyleByKey",[_dec20,_app_common_utils_decorators_with_db_sync__WEBPACK_IMPORTED_MODULE_10__.P,_dec21],Object.getOwnPropertyDescriptor(_class2.prototype,"setConditionalInlineStyleByKey"),_class2.prototype),(0,_vercel_path0_node_modules_next_node_modules_babel_runtime_helpers_esm_applyDecoratedDescriptor__WEBPACK_IMPORTED_MODULE_25__.Z)(_class2.prototype,"bindProjectStyleToNode",[_dec22,_app_common_utils_decorators_with_db_sync__WEBPACK_IMPORTED_MODULE_10__.P],Object.getOwnPropertyDescriptor(_class2.prototype,"bindProjectStyleToNode"),_class2.prototype),(0,_vercel_path0_node_modules_next_node_modules_babel_runtime_helpers_esm_applyDecoratedDescriptor__WEBPACK_IMPORTED_MODULE_25__.Z)(_class2.prototype,"unbindProjectStyleFromNodeIds",[_dec23,_app_common_utils_decorators_with_db_sync__WEBPACK_IMPORTED_MODULE_10__.P],Object.getOwnPropertyDescriptor(_class2.prototype,"unbindProjectStyleFromNodeIds"),_class2.prototype),(0,_vercel_path0_node_modules_next_node_modules_babel_runtime_helpers_esm_applyDecoratedDescriptor__WEBPACK_IMPORTED_MODULE_25__.Z)(_class2.prototype,"createInteractionState",[_dec24,_app_common_utils_decorators_with_db_sync__WEBPACK_IMPORTED_MODULE_10__.P],Object.getOwnPropertyDescriptor(_class2.prototype,"createInteractionState"),_class2.prototype),(0,_vercel_path0_node_modules_next_node_modules_babel_runtime_helpers_esm_applyDecoratedDescriptor__WEBPACK_IMPORTED_MODULE_25__.Z)(_class2.prototype,"bindTextStyleOnSelectedNodes",[_dec25,_app_common_utils_decorators_with_db_sync__WEBPACK_IMPORTED_MODULE_10__.P],Object.getOwnPropertyDescriptor(_class2.prototype,"bindTextStyleOnSelectedNodes"),_class2.prototype),(0,_vercel_path0_node_modules_next_node_modules_babel_runtime_helpers_esm_applyDecoratedDescriptor__WEBPACK_IMPORTED_MODULE_25__.Z)(_class2.prototype,"overrideNodeStyle",[_dec26,_dec27],Object.getOwnPropertyDescriptor(_class2.prototype,"overrideNodeStyle"),_class2.prototype),(0,_vercel_path0_node_modules_next_node_modules_babel_runtime_helpers_esm_applyDecoratedDescriptor__WEBPACK_IMPORTED_MODULE_25__.Z)(_class2.prototype,"removeStyleByKeyBasedOnCurrentBreakpoint",[_dec28,_app_common_utils_decorators_with_db_sync__WEBPACK_IMPORTED_MODULE_10__.P],Object.getOwnPropertyDescriptor(_class2.prototype,"removeStyleByKeyBasedOnCurrentBreakpoint"),_class2.prototype),(0,_vercel_path0_node_modules_next_node_modules_babel_runtime_helpers_esm_applyDecoratedDescriptor__WEBPACK_IMPORTED_MODULE_25__.Z)(_class2.prototype,"removeStyleByKey",[_dec29,_app_common_utils_decorators_with_db_sync__WEBPACK_IMPORTED_MODULE_10__.P,_dec30],Object.getOwnPropertyDescriptor(_class2.prototype,"removeStyleByKey"),_class2.prototype),(0,_vercel_path0_node_modules_next_node_modules_babel_runtime_helpers_esm_applyDecoratedDescriptor__WEBPACK_IMPORTED_MODULE_25__.Z)(_class2.prototype,"removeMultipleStylesByKey",[_dec31,_app_common_utils_decorators_with_db_sync__WEBPACK_IMPORTED_MODULE_10__.P],Object.getOwnPropertyDescriptor(_class2.prototype,"removeMultipleStylesByKey"),_class2.prototype),(0,_vercel_path0_node_modules_next_node_modules_babel_runtime_helpers_esm_applyDecoratedDescriptor__WEBPACK_IMPORTED_MODULE_25__.Z)(_class2.prototype,"removeConditionalInlineStyleByKey",[_dec32,_app_common_utils_decorators_with_db_sync__WEBPACK_IMPORTED_MODULE_10__.P,_dec33],Object.getOwnPropertyDescriptor(_class2.prototype,"removeConditionalInlineStyleByKey"),_class2.prototype),(0,_vercel_path0_node_modules_next_node_modules_babel_runtime_helpers_esm_applyDecoratedDescriptor__WEBPACK_IMPORTED_MODULE_25__.Z)(_class2.prototype,"removeInteractionStateStyles",[_dec34,_app_common_utils_decorators_with_db_sync__WEBPACK_IMPORTED_MODULE_10__.P],Object.getOwnPropertyDescriptor(_class2.prototype,"removeInteractionStateStyles"),_class2.prototype),(0,_vercel_path0_node_modules_next_node_modules_babel_runtime_helpers_esm_applyDecoratedDescriptor__WEBPACK_IMPORTED_MODULE_25__.Z)(_class2.prototype,"removeAllStylesFromNodeForBreakpoint",[_dec35,_app_common_utils_decorators_with_db_sync__WEBPACK_IMPORTED_MODULE_10__.P,_dec36],Object.getOwnPropertyDescriptor(_class2.prototype,"removeAllStylesFromNodeForBreakpoint"),_class2.prototype),(0,_vercel_path0_node_modules_next_node_modules_babel_runtime_helpers_esm_applyDecoratedDescriptor__WEBPACK_IMPORTED_MODULE_25__.Z)(_class2.prototype,"orderStyles",[_dec37,_app_common_utils_decorators_with_db_sync__WEBPACK_IMPORTED_MODULE_10__.P],Object.getOwnPropertyDescriptor(_class2.prototype,"orderStyles"),_class2.prototype),(0,_vercel_path0_node_modules_next_node_modules_babel_runtime_helpers_esm_applyDecoratedDescriptor__WEBPACK_IMPORTED_MODULE_25__.Z)(_class2.prototype,"overrideConditionalInlineStyles",[_dec38,_dec39],Object.getOwnPropertyDescriptor(_class2.prototype,"overrideConditionalInlineStyles"),_class2.prototype),(0,_vercel_path0_node_modules_next_node_modules_babel_runtime_helpers_esm_applyDecoratedDescriptor__WEBPACK_IMPORTED_MODULE_25__.Z)(_class2.prototype,"unbindTokenFromNodes",[_dec40,_app_common_utils_decorators_with_db_sync__WEBPACK_IMPORTED_MODULE_10__.P],Object.getOwnPropertyDescriptor(_class2.prototype,"unbindTokenFromNodes"),_class2.prototype),(0,_vercel_path0_node_modules_next_node_modules_babel_runtime_helpers_esm_applyDecoratedDescriptor__WEBPACK_IMPORTED_MODULE_25__.Z)(_class2.prototype,"unbindTextStyleFromNode",[_dec41,_app_common_utils_decorators_with_db_sync__WEBPACK_IMPORTED_MODULE_10__.P],Object.getOwnPropertyDescriptor(_class2.prototype,"unbindTextStyleFromNode"),_class2.prototype),(0,_vercel_path0_node_modules_next_node_modules_babel_runtime_helpers_esm_applyDecoratedDescriptor__WEBPACK_IMPORTED_MODULE_25__.Z)(_class2.prototype,"updateNodesVisibility",[_dec42,_app_common_utils_decorators_with_db_sync__WEBPACK_IMPORTED_MODULE_10__.P],Object.getOwnPropertyDescriptor(_class2.prototype,"updateNodesVisibility"),_class2.prototype),(0,_vercel_path0_node_modules_next_node_modules_babel_runtime_helpers_esm_applyDecoratedDescriptor__WEBPACK_IMPORTED_MODULE_25__.Z)(_class2.prototype,"updateNodeReferenceForTokenWhenRemovingStyle",[_dec43,_app_common_utils_decorators_with_db_sync__WEBPACK_IMPORTED_MODULE_10__.P],Object.getOwnPropertyDescriptor(_class2.prototype,"updateNodeReferenceForTokenWhenRemovingStyle"),_class2.prototype),(0,_vercel_path0_node_modules_next_node_modules_babel_runtime_helpers_esm_applyDecoratedDescriptor__WEBPACK_IMPORTED_MODULE_25__.Z)(_class2.prototype,"initialiseStylesOnNode",[_app_common_utils_decorators_with_db_sync__WEBPACK_IMPORTED_MODULE_10__.P],Object.getOwnPropertyDescriptor(_class2.prototype,"initialiseStylesOnNode"),_class2.prototype),(0,_vercel_path0_node_modules_next_node_modules_babel_runtime_helpers_esm_applyDecoratedDescriptor__WEBPACK_IMPORTED_MODULE_25__.Z)(_class2.prototype,"getInlineConditionalStyleMapForNode",[_app_common_utils_decorators_with_db_sync__WEBPACK_IMPORTED_MODULE_10__.P],Object.getOwnPropertyDescriptor(_class2.prototype,"getInlineConditionalStyleMapForNode"),_class2.prototype),(0,_vercel_path0_node_modules_next_node_modules_babel_runtime_helpers_esm_applyDecoratedDescriptor__WEBPACK_IMPORTED_MODULE_25__.Z)(_class2.prototype,"getStylesForNode",[_app_common_utils_decorators_with_db_sync__WEBPACK_IMPORTED_MODULE_10__.P],Object.getOwnPropertyDescriptor(_class2.prototype,"getStylesForNode"),_class2.prototype),(0,_vercel_path0_node_modules_next_node_modules_babel_runtime_helpers_esm_applyDecoratedDescriptor__WEBPACK_IMPORTED_MODULE_25__.Z)(_class2.prototype,"computeGridChildPositionIfParentIsGrid",[_app_common_utils_decorators_with_db_sync__WEBPACK_IMPORTED_MODULE_10__.P],Object.getOwnPropertyDescriptor(_class2.prototype,"computeGridChildPositionIfParentIsGrid"),_class2.prototype),_class=_class2))||_class)},570735:function(e,t,n){var o=n(503348),i=n(777460),s=n(918437),r=n(205632),a=n(832501),c=n(395942),l=n(302503),d=n(638852),p=n(440516),u=n(255031),h=n(932433),y=n(51261),m=n(412940),f=n(4427),g=n(422169),_=n(676422),b=n.n(_),I=n(202784),v=n(173541),w=n(505892),O=n(414326),j=n(606626),S=n(552322);const N=e=>{const{onOverride:t,onCancel:n,onClose:o,forCloneableProject:i=!1}=e,{0:s,1:r}=(0,I.useState)(!1);return(0,S.jsxs)("div",{className:"jsx-3144625160 wrapper override-project-root",children:[(0,S.jsx)("div",{onClick:o,className:"jsx-3144625160 override-project-close",children:(0,S.jsx)(w.J,{type:O.u2["actions/close"]})}),(0,S.jsx)("div",{className:"jsx-3144625160 icon-wrapper",children:(0,S.jsx)(j.Q,{size:140,type:"override-project"})}),(0,S.jsxs)("div",{className:"jsx-3144625160 text-wrapper",children:[(0,S.jsx)("h1",{className:"jsx-3144625160 overried-project-title",children:"Sure you want to overwrite your project? "}),(0,S.jsx)("p",{className:"jsx-3144625160",children:i?"You alreay have a project in anonymous session. If you choose to overwrite it, \nyou will lose all the modifications done in teleportHQ. Your action cannot be undone.":"You've already exported this project, and if you choose to overwrite it, you will lose all\nthe modifications done in teleportHQ. This action cannot be undone. Create a free account\nand save your project."})]}),(0,S.jsxs)("div",{className:"jsx-3144625160 modal-btns buttons-wrapper",children:[(0,S.jsx)("div",{className:"jsx-3144625160 override-button",children:(0,S.jsx)(v.z,{refAttrs:{autoFocus:!0},onClick:async()=>{r(!0),await t(),r(!1)},style:"solid",colorScheme:"neutral",isLoading:s,isDisabled:s,children:"Overwrite"})}),(0,S.jsx)(v.z,{onClick:n,style:"solid",children:i?"Redirect to existing project":"Let's save my project"})]}),(0,S.jsx)(b(),{id:"3144625160",children:[".override-project-root.jsx-3144625160{position:relative;height:435px;width:630px;padding:60px;margin:-24px;background:var(--outline-color);border-radius:4px;}",".override-project-close.jsx-3144625160{position:absolute;cursor:pointer;top:20px;right:20px;}",".overried-project-title.jsx-3144625160{margin-bottom:14px;}",".icon-wrapper.jsx-3144625160{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;}",".text-wrapper.jsx-3144625160{color:var(--color-neutral-300);text-align:center;margin-top:30px;}",".buttons-wrapper.jsx-3144625160{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;}",".override-button.jsx-3144625160{margin-right:12px;}"]})]})};var D=n(928515),E=n(393181),T=n(492080),P=n(522788),C=n(824497),x=n(86233),A=n(500310),F=n(461423),k=n(813244),R=n(975350),M=n(111131),U=n(2758),Z=n(319682),L=n(698156),B=n(757156),W=n(344627),z=n(256240),$=n(536997),G=n(758961),H=n(436035),K=n(329852),V=n(235221),Y=n(559196),J=n(781872),X=n(273526);const q=e=>{const{onDismiss:t,currentLanguage:n}=e;return(0,S.jsxs)("div",{className:`jsx-${X.W.__hash}`,children:[(0,S.jsxs)("div",{className:`jsx-${X.W.__hash} content-modal-header`,children:[(0,S.jsx)("p",{className:`jsx-${X.W.__hash}`,children:"You are updating content in a secondary language"}),(0,S.jsx)(v.z,{style:"transparent",onClick:t,shape:"square",children:(0,S.jsx)(w.J,{type:"actions/close",size:14,color:J.DM.GRAY_900})})]}),(0,S.jsxs)("div",{className:`jsx-${X.W.__hash} content-root`,children:[(0,S.jsxs)("p",{className:`jsx-${X.W.__hash}`,children:["This content update will only affect the ",n," version of your website."]}),(0,S.jsx)("p",{className:`jsx-${X.W.__hash}`,children:"If you want your content to be translated, make sure to select the main language first."})]}),(0,S.jsx)("div",{className:`jsx-${X.W.__hash} content-modal-footer`,children:(0,S.jsx)(v.z,{refAttrs:{autoFocus:!0},onClick:t,style:"solid",colorScheme:"accent",children:"OK"})}),(0,S.jsx)(b(),{id:X.W.__hash,children:X.W})]})};var Q,ee,te,ne,oe,ie,se,re,ae,ce,le,de,pe,ue,he;function ye(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function me(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ye(Object(n),!0).forEach((function(t){(0,i.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ye(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}const fe=[Y.l.CREATE_COMPONENT,Y.l.CREATE_PAGE,Y.l.DUPLICATE_PAGE,Y.l.ADD_PRIMITIVE,Y.l.RICH_TEXT_CHANGE,Y.l.ADD_NEW_LANGUAGE,Y.l.CHANGE_CURRENT_LANGUAGE];let ge=(Q=(0,l.inject)("studioAPIService"),ee=(0,l.inject)("projectDoc"),te=(0,l.inject)("projectUIState"),ne=(0,l.inject)("modalManagementFlow"),oe=(0,l.inject)("globalAppState"),ie=(0,l.inject)("userAccountRepository"),he=ue=class{constructor(){(0,o.Z)(this,"studioAPI",re,this),(0,o.Z)(this,"projectDoc",ae,this),(0,o.Z)(this,"projectUIState",ce,this),(0,o.Z)(this,"modalManagementFlow",le,this),(0,o.Z)(this,"globalAppState",de,this),(0,o.Z)(this,"userAccountRepository",pe,this),(0,i.Z)(this,"operationsStack",[]),(0,i.Z)(this,"sequences",[{sequence:[Y.l.ADD_NEW_LANGUAGE,Y.l.ADD_PRIMITIVE,Y.l.RICH_TEXT_CHANGE],action:()=>this.openSecondaryLanguageTextChangeInfoModal()},{sequence:[Y.l.ADD_NEW_LANGUAGE,Y.l.RICH_TEXT_CHANGE],action:()=>this.openSecondaryLanguageTextChangeInfoModal()},{sequence:[Y.l.CHANGE_CURRENT_LANGUAGE,Y.l.RICH_TEXT_CHANGE],action:()=>this.openSecondaryLanguageTextChangeInfoModal()},{sequence:[Y.l.CHANGE_CURRENT_LANGUAGE,Y.l.ADD_PRIMITIVE,Y.l.RICH_TEXT_CHANGE],action:()=>this.openSecondaryLanguageTextChangeInfoModal()}]),(0,i.Z)(this,"openSecondaryLanguageTextChangeInfoModal",(async()=>{var e,t;const{userData:n}=this.globalAppState.user;if(!n)return;if(null===(e=n.meta.internationalization)||void 0===e?void 0:e.updateContentInSecondaryLanguageDialogDisplayed)return;const{mainLanguage:o}=this.projectDoc.internationalization;if(null===o||void 0===o||!o.short)return;const{currentLanguage:i}=this.projectUIState.internationalization;if((null===i||void 0===i?void 0:i.short)===o.short)return;const s=g.d.createCustomModal({Component:q,data:{currentLanguage:null!==(t=null===i||void 0===i?void 0:i.name)&&void 0!==t?t:""},onDismiss:()=>{this.modalManagementFlow.hideModal()}});this.modalManagementFlow.showModal(s,{padding:"0px",maxWidth:"600px"},!1),(0,c.mutate)(this.globalAppState,(({user:e})=>{var t;e&&e.userData&&(e.userData.meta.internationalization=me(me({},null!==(t=e.userData.meta.internationalization)&&void 0!==t?t:{}),{},{updateContentInSecondaryLanguageDialogDisplayed:!0}))}));try{await this.userAccountRepository.update({meta:n.meta})}catch(r){console.error("Failed in updating user account meta data",r)}}))}static get Instance(){return this._instance||(this._instance=new this)}init(){fe.forEach((e=>{this.studioAPI.attachHook(e,{onStart:()=>(this.operationsStack.length>50&&this.operationsStack.shift(),this.operationsStack.push(e),this.checkSequences(),!0)})}))}destroy(){this.operationsStack=[]}checkSequences(){for(const e of this.sequences)this.operationsStack.length<e.sequence.length||this.isSequenceMatch(e)&&e.action()}isSequenceMatch(e){return this.operationsStack.slice(-e.sequence.length).join()===e.sequence.join()}},(0,i.Z)(ue,"_instance",void 0),se=he,re=(0,s.Z)(se.prototype,"studioAPI",[Q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ae=(0,s.Z)(se.prototype,"projectDoc",[ee],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ce=(0,s.Z)(se.prototype,"projectUIState",[te],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),le=(0,s.Z)(se.prototype,"modalManagementFlow",[ne],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),de=(0,s.Z)(se.prototype,"globalAppState",[oe],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),pe=(0,s.Z)(se.prototype,"userAccountRepository",[ie],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),se);var _e,be,Ie,ve,we,Oe,je,Se,Ne,De,Ee,Te,Pe,Ce,xe,Ae,Fe,ke,Re,Me,Ue,Ze,Le,Be,We,ze,$e,Ge,He,Ke,Ve,Ye,Je,Xe,qe,Qe,et,tt,nt,ot,it,st,rt,at,ct,lt,dt,pt,ut,ht,yt,mt,ft,gt,_t,bt,It,vt,wt,Ot,jt,St,Nt,Dt,Et,Tt,Pt,Ct,xt,At,Ft,kt,Rt,Mt,Ut,Zt,Lt,Bt,Wt,zt,$t,Gt,Ht,Kt,Vt,Yt,Jt;function Xt(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function qt(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Xt(Object(n),!0).forEach((function(t){(0,i.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Xt(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}_e=(0,l.provide)("projectInitFlow"),be=(0,l.inject)("authService"),Ie=(0,l.inject)("projectRepository"),ve=(0,l.inject)("sentryService"),we=(0,l.inject)("sharedbProjectSyncService"),Oe=(0,l.inject)("projectDoc"),je=(0,l.inject)("projectUIState"),Se=(0,l.inject)("localHistoryStackFlow"),Ne=(0,l.inject)("userProjectDataPersistenceFlow"),De=(0,l.inject)("collaboratorManagementFlow"),Ee=(0,l.inject)("pointerInteractionManagementFlow"),Te=(0,l.inject)("globalAppState"),Pe=(0,l.inject)("userAccountRepository"),Ce=(0,l.inject)("fontsInProjectFlow"),xe=(0,l.inject)("routerService"),Ae=(0,l.inject)("nodeSelectionFlow"),Fe=(0,l.inject)("zoomControlFlow"),ke=(0,l.inject)("pageManagementFlow"),Re=(0,l.inject)("asyncWatcherService"),Me=(0,l.inject)("webRTCState"),Ue=(0,l.inject)("rtcFlow"),Ze=(0,l.inject)("sessionStorageService"),Le=(0,l.inject)("notificationsManagementFlow"),Be=(0,l.inject)("tutorialFlow"),We=(0,l.inject)("uidlToProjectMapper"),ze=(0,l.inject)("uidlDownloadService"),$e=(0,l.inject)("navbarFlow"),Ge=(0,l.inject)("modalManagementFlow"),He=(0,l.inject)("localStorageService"),Ke=(0,l.inject)("workspacesRepository"),Ve=(0,l.inject)("projectCloneFlow"),Ye=(0,l.inject)("yDocumentManagementFlow"),Je=(0,l.inject)("projectFilesFlow"),Xe=(0,l.inject)("imageOptimisationFlow"),qe=(0,l.inject)("githubFlow"),Qe=(0,l.inject)("conflictManagementFlow"),et=(0,l.inject)("mediaQueryBreakpointManagementFlow"),tt=(0,l.inject)("projectClassManagementFlow"),nt=(0,l.inject)("aiContentGenerationFlow"),ot=(0,l.inject)("userPermissionGuardService"),it=(0,l.inject)("selfHealingFlow"),st=(0,l.inject)("projectPublishFlow"),rt=(0,l.inject)("migrationsFlow"),_e((ct=class{constructor(){(0,o.Z)(this,"authService",lt,this),(0,o.Z)(this,"projectRepository",dt,this),(0,o.Z)(this,"sentryService",pt,this),(0,o.Z)(this,"dbSync",ut,this),(0,o.Z)(this,"projectDoc",ht,this),(0,o.Z)(this,"projectUIState",yt,this),(0,o.Z)(this,"localHistoryStackFlow",mt,this),(0,o.Z)(this,"userProjectDataPersistenceFlow",ft,this),(0,o.Z)(this,"collaboratorManagementFlow",gt,this),(0,o.Z)(this,"pointerInteractionManagementFlow",_t,this),(0,o.Z)(this,"globalAppState",bt,this),(0,o.Z)(this,"userAccountRepository",It,this),(0,o.Z)(this,"fontsInProjectFlow",vt,this),(0,o.Z)(this,"routerService",wt,this),(0,o.Z)(this,"nodeSelectionFlow",Ot,this),(0,o.Z)(this,"zoomControlFlow",jt,this),(0,o.Z)(this,"pageManagementFlow",St,this),(0,o.Z)(this,"asyncWatcherService",Nt,this),(0,o.Z)(this,"webRTCState",Dt,this),(0,o.Z)(this,"rtcFlow",Et,this),(0,o.Z)(this,"sessionStorageService",Tt,this),(0,o.Z)(this,"notificationsManagementFlow",Pt,this),(0,o.Z)(this,"tutorialFlow",Ct,this),(0,o.Z)(this,"uidlToProjectMapper",xt,this),(0,o.Z)(this,"uidlDownloadService",At,this),(0,o.Z)(this,"navbarFlow",Ft,this),(0,o.Z)(this,"modalManagementFlow",kt,this),(0,o.Z)(this,"localStorageService",Rt,this),(0,o.Z)(this,"workspacesRepository",Mt,this),(0,o.Z)(this,"projectCloneFlow",Ut,this),(0,o.Z)(this,"yDocumentManagementFlow",Zt,this),(0,o.Z)(this,"projectFilesFlow",Lt,this),(0,o.Z)(this,"imageOptimisationFlow",Bt,this),(0,o.Z)(this,"githubFlow",Wt,this),(0,o.Z)(this,"conflictManagementFlow",zt,this),(0,o.Z)(this,"mediaQueryBreakpointManagementFlow",$t,this),(0,o.Z)(this,"projectClassManagementFlow",Gt,this),(0,o.Z)(this,"aiContentGenerationFlow",Ht,this),(0,o.Z)(this,"userPermissionGuardService",Kt,this),(0,o.Z)(this,"selfHealingFlow",Vt,this),(0,o.Z)(this,"projectPublishFlow",Yt,this),(0,o.Z)(this,"migrationsFlow",Jt,this),(0,i.Z)(this,"cmsUIState",B.H.Instance),(0,i.Z)(this,"cmsMainFlow",W.c.Instance),(0,i.Z)(this,"actionSequenceDetector",ge.Instance),(0,i.Z)(this,"contentGenerationRunning",!1),(0,i.Z)(this,"handleFlowsWithModalsOnLoad",(async e=>{if(this.sessionStorageService.get(A.f.AI_DATA)&&!this.contentGenerationRunning)return this.contentGenerationRunning=!0,await this.aiContentGenerationFlow.checkAndBeginGeneration(),this.contentGenerationRunning=!1,void this.updatePageSelection({pageId:this.projectDoc.pages.getIds()[0],inPreviewMode:e});if(e)return;this.tutorialFlow.shouldStartTutorial(p._2.VIDEO)&&this.tutorialFlow.addTutorialToQueue(p._2.VIDEO),this.tutorialFlow.runQueuedTutorials()})),(0,i.Z)(this,"preloadIcons",(()=>{$.U.Instance.preloadIconsMetadata()})),(0,i.Z)(this,"update",(async e=>{var t;let n=null===(t=e.query)||void 0===t?void 0:t.compId;this.projectDoc.pages.byId[n]||this.projectDoc.components.byId[n]||(n=this.projectUIState.selection.componentId||this.projectDoc.pages.getIds()[0]),this.updatePageSelection({pageId:n}),this.updateZoomLevel(),this.updateViewportSize(),this.fontsInProjectFlow.initAndListenForUpdates()})),(0,i.Z)(this,"getProjectLimitations",(()=>{var e;const t=this.projectUIState.workspace.subscriptionPlanType;if(t)return P.cF[t];const n=null===(e=this.globalAppState.user.userData)||void 0===e?void 0:e.createdAt;return(0,M.G)(n)})),(0,i.Z)(this,"initCMSUIState",(()=>{const{status:e,cmsConnectionData:t,usedContentTypes:n,componentTypes:o,locales:i}=this.projectDoc.cms;(0,c.mutate)(this.cmsUIState,(s=>{s.status=null!==e&&void 0!==e?e:"unset",s.cmsConnectionData=t,s.usedContentTypes=n,s.componentTypes=o,i&&(s.locales=qt(qt({},i),{},{selectedLocale:i.defaultLocale}))}))})),(0,i.Z)(this,"getInitialPageId",(e=>{var t;const{queryParams:n}=e,o=n.compId;return o&&"string"===typeof o&&this.projectDoc.nodes.getById(o)?o:this.projectUIState.selection.componentId?this.projectUIState.selection.componentId:null!==(t=this.projectDoc.pages.getHomePageId())&&void 0!==t?t:this.projectDoc.pages.getIds()[0]})),(0,i.Z)(this,"createInternationalizationIfNonExistent",(()=>{this.dbSync.mutate(this.projectDoc,(e=>{var t;if(null===(t=e.internationalization)||void 0===t||!t.mainLanguage){const t=new H.Q;t.mainLanguage=H.P,t.availableLanguages[H.P.short]=H.P.name,t.translations[H.P.short]={},e.internationalization=t}})),(0,c.mutate)(this.projectUIState,(e=>{e.internationalization?e.internationalization.currentLanguage=this.projectDoc.internationalization.mainLanguage:e.internationalization={currentLanguage:this.projectDoc.internationalization.mainLanguage}}))})),(0,i.Z)(this,"createCMSDataIfNonExistent",((e,t,n,o)=>{this.dbSync.mutate(this.projectDoc,(i=>{if(!e&&i.cms){const e=new Z._;e.fromJSON(JSON.parse(JSON.stringify(this.projectDoc.cms))),i.cms=e}if(!t&&i.cmsPages){const e=new U.g;e.fromJSON(JSON.parse(JSON.stringify(this.projectDoc.cmsPages))),i.cmsPages=e}if(!n&&i.resourceDefinitions){const e=new L.f;e.fromJSON(JSON.parse(JSON.stringify(this.projectDoc.resourceDefinitions))),i.resourceDefinitions=e}i.cms.isEnabled!==o&&(i.cms.isEnabled=null!==o&&void 0!==o&&o)}))})),(0,i.Z)(this,"loadProjectFromUIDL",(async(e,t)=>{const n=await this.uidlDownloadService.fetchUIDL(e),o=JSON.parse(n);await this.uidlToProjectMapper.mapUIDLToProject(o,t)})),(0,i.Z)(this,"updatePageSelection",(e=>{const{pageId:t,lang:n,type:o,inPreviewMode:i,detailsPageId:s}=e;if(!t)return;const r=i?(0,R.zg)(this.projectUIState.slug,t,s?{detailsPageId:s.toString()}:void 0):(0,R.aZ)(this.projectUIState.slug,t);if(i){const e=n?`${r}?lang=${n}`:r;this.routerService.replace(e)}else if(this.saveStagePositionForCompOrPage(this.projectUIState.previousSelectedPageOrCompId),this.routerService.push(r),(0,c.mutate)(this.projectUIState,(e=>{const t=e.previousSelectedPageOrCompId;t&&(this.projectDoc.pages.byId[t]&&(e.lastVisitedPage=t),this.projectDoc.components.byId[t]&&(e.lastVisitedComponent=t)),this.nodeSelectionFlow.resetNodeSelection(),this.projectUIState.userInteractions.isNodeInPreviewMode&&(e.userInteractions.isNodeInPreviewMode=!1)})),this.projectUIState.layout.mainPanel===p.iW.DEV){const e=this.projectUIState.devMode.selectedFile||T.e3;this.navbarFlow.selectOrCreateTabByEntityId(e,!0)}else this.navbarFlow.selectOrCreateTabByEntityId(t,o&&"replace"===o)})),(0,i.Z)(this,"cloneProject",(async e=>{await this.projectCloneFlow.clone(e),d.Z.mixpanelEvent(d.Z.AnalyticsEvents.DASHBOARD_PROJECT_CLONE)})),(0,i.Z)(this,"setMetaInfoOnAccount",(async e=>{const t=this.collaboratorManagementFlow.getLoggedInUserPermissionLevel()===C.z.PROJECT;(0,c.mutate)(this.globalAppState,(({user:n})=>{if(!n||!n.userData)return;n.userData.meta.lastAccessedProjects||(n.userData.meta.lastAccessedProjects={});const{lastAccessedSharedProjects:o,lastAccessedProjects:i}=n.userData.meta;if(t)n.userData.meta.lastAccessedSharedProjects=qt(qt({},o),{},{[e.id]:(new Date).toISOString()});else{const t=e.workspace.id,o=(null===i||void 0===i?void 0:i[t])||{};n.userData.meta.lasAccessedProject||(n.userData.meta.lastAccessedProjects={}),n.userData.meta.lastAccessedProjects[t]=qt(qt({},o),{},{[e.id]:(new Date).toISOString()})}n.userData.meta.login={lastTimeEnteredStage:(new Date).toISOString()},n.userData.meta.githubBranches||(n.userData.meta.githubBranches={[this.projectDoc.id]:T.cY})}));try{const{userData:e}=this.globalAppState.user;e&&await this.userAccountRepository.update({meta:e.meta})}catch(n){}})),(0,i.Z)(this,"initGithubData",(async()=>{var e,t;const n=this.projectUIState.navbar.devModeTabs||{},o=null===(e=this.globalAppState.user.userData)||void 0===e?void 0:e.meta.githubBranches;let i=o&&o[this.projectDoc.id]?o[this.projectDoc.id]:T.cY;null!==(t=this.projectDoc.projectFiles.local[i])&&void 0!==t&&t.byId||i===T.cY||(i=T.cY),(0,c.mutate)(this.projectUIState,(e=>{e.devMode.selectedBranch=i})),Object.keys(n).forEach((e=>{n[e].entityId.endsWith(T.Vf)&&this.navbarFlow.deleteTab(e)})),this.projectUIState.readonly||this.githubFlow.init()})),(0,i.Z)(this,"updateZoomLevel",(()=>{this.projectUIState.userPreferences.persistZoomLevel&&this.projectUIState.userPreferences.zoomLevel&&"number"===typeof this.projectUIState.userPreferences.zoomLevel?this.zoomControlFlow.setStageZoomLevel(this.projectUIState.userPreferences.zoomLevel):this.zoomControlFlow.adjustStageZoomLevelToScreenResolution(window.innerWidth)})),(0,i.Z)(this,"updateViewportSize",(()=>{var e;this.projectUIState.userPreferences.persistViewportSize&&this.projectUIState.userPreferences.viewportSize&&"number"===typeof this.projectUIState.userPreferences.viewportSize?this.projectUIState.stage.setCurrentWidth(this.projectUIState.userPreferences.viewportSize):this.projectUIState.stage.setCurrentWidth((null===(e=this.projectDoc.mediaQueryBreakpoints.getDefaultMediaQuery())||void 0===e?void 0:e.maxWidth)||m.Bk)})),(0,i.Z)(this,"updateComponentsStateAndPropsRenderValues",(()=>{(0,c.mutate)(this.projectUIState,(e=>{const t=this.projectDoc.components.byId;t&&Object.values(t).forEach((t=>{if(!t)return;const{stateDefinitions:n,propDefinitions:o,id:i,instantiatedByNodes:s}=t,r=Object.keys(n).reduce(((t,o)=>{var r,a,c,l;return t[o]={id:o,type:n[o].type,value:n[o].defaultValue,name:n[o].name,meta:{highlightInTreeView:!(null===(r=e.componentList.stateValues)||void 0===r||null===(a=r[i])||void 0===a||null===(c=a[o])||void 0===c||null===(l=c.meta)||void 0===l||!l.highlightInTreeView)},componentInstanceValues:Object.keys(s).reduce(((e,t)=>(e[t]=n[o].defaultValue,e)),{})},t}),{});try{const t=Object.keys(o).reduce(((t,n)=>{var r,a,c,l;const d=o[n].type;if(!k.iz.includes(d))return t;const p=o[n].name,u=o[n].defaultValue,h=Object.keys(s).reduce(((e,t)=>{var n;const o=this.projectDoc.nodes.getById(t);if(!o||"component-instance-node"!==o.type)return e;const i=o.attrs[p];return"static"!==(null===i||void 0===i?void 0:i.type)?(e[t]=u,e):(e[t]=null!==(n=null===i||void 0===i?void 0:i.content)&&void 0!==n?n:u,e)}),{});return t[n]={id:n,type:o[n].type,value:u,name:p,meta:{highlightInTreeView:!(null===(r=e.componentList.stateValues)||void 0===r||null===(a=r[i])||void 0===a||null===(c=a[n])||void 0===c||null===(l=c.meta)||void 0===l||!l.highlightInTreeView)},componentInstanceValues:h},t}),{});e.componentList.stateValues[i]=qt(qt({},e.componentList.stateValues[i]),r),e.componentList.propValues[i]=qt(qt({},e.componentList.propValues[i]),t)}catch(a){throw console.error(a),new Error("Error while updating component state and prop values")}}))}))})),(0,i.Z)(this,"setProjectThemeIfNotPresent",(()=>{this.dbSync.mutate(this.projectDoc,(e=>{e.selectedTheme||(e.selectedTheme={name:z.fY,variant:"light",overrideColors:!1,customColors:{}})}))})),(0,i.Z)(this,"createFunctionsFolderIfNotPresent",(()=>{this.dbSync.mutate(this.projectDoc,(e=>{e.folders.byId[K.D.FUNCTIONS]||(e.folders.byId[K.D.FUNCTIONS]=new V.g({id:K.D.FUNCTIONS,name:K.D.FUNCTIONS,parentId:null}))}))})),(0,i.Z)(this,"fixColorCategoryForOldProjects",(()=>{this.dbSync.mutate(this.projectDoc,(e=>{const t=Object.values(e.designLanguage.categoriesById).filter((e=>"colors"===e.section));if(t.length){t.forEach((e=>{e.section="color"}));const e=this.projectUIState.layout.designLanguageTab;Object.values(p.Xd).includes(e)||(0,c.mutate)(this.projectUIState,(e=>{e.layout.designLanguageTab=p.Xd.COLOR}))}}))})),(0,i.Z)(this,"saveStagePositionForCompOrPage",(e=>{e&&(0,c.mutate)(this.projectUIState,(t=>{const{stage:n}=t,{x:o,y:i,scale:s}=n.webComp.controlValues;n.pagesAndComponentsScrollPosition[e]={x:o,y:i,scale:s}}))}))}async begin(e){var t,o,i,s,l;const m=await this.authService.getAuthUserAsync();if(!m)throw new Error("User should be logged in here");m&&m.isAnonymous&&this.localStorageService.set(D.r.ANON_USER_ID,m.uid);const f=e.query.slug;let g;Object.assign(this.projectUIState,new h.K),Object.assign(this.webRTCState,new y.g),n.e(44711).then(n.bind(n,744711)).then((e=>{window.ResizeObserver=e.ResizeObserver}));let _=!1;try{var b,I;g=await this.projectRepository.loadBySlug(f);const e="string"===typeof(null===(b=g.meta)||void 0===b||null===(I=b.ai)||void 0===I?void 0:I.startedFromAITemplate)&&""!==g.meta.ai.startedFromAITemplate;let t=0,n=1;try{[t,n]=await Promise.all([this.workspacesRepository.getPayingSeats(g.workspace.id),this.workspacesRepository.getProjectsWithCMSEnabled(g.workspace.id)])}catch(C){this.sentryService.captureException(new Error(`Paying Seats or Projects With CMS request failed in ProjectInitFlow: ${null===C||void 0===C?void 0:C.message}`))}_="read"===this.getUserAccessType(g),(0,c.mutate)(this.projectDoc,(e=>{e.id=g.id,e.accessType=g.accessType})),(0,c.mutate)(this.projectUIState,(o=>{var i,s;o.slug=f||"",o.isAIProject=e,o.AIProjectPrompts=(null===(i=g.meta)||void 0===i||null===(s=i.ai)||void 0===s?void 0:s.prompts)||[],o.teleportVercelAlias=g.vercelAlias,o.title=g.name||"",o.projectAnalyticsConfig=g.analyticsConfig||{},o.projectStatus=p.kJ.FOUND,o.readonly=_,o.secrets=g.secrets,o.cloneable=_&&g.accessType===E.W.CLONEABLE,o.tokens={vercelToken:g.vercelToken,githubToken:g.githubToken},o.workspace={id:g.workspace.id,slug:g.workspace.slug,name:g.workspace.name,subscriptionPlanType:(0,x.eq)(g.workspace)||null,professionalSubscription:!!g.workspace.subscriptionItem,payingSeats:t,projectsWithCMSEnabled:n,meta:qt({},g.workspace.meta)}})),(0,c.mutate)(this.globalAppState,(e=>{e.isPayingUser=!!g.workspace.subscriptionItem})),this.userProjectDataPersistenceFlow.init(g)}catch(C){return(0,c.mutate)(this.projectUIState,(e=>e.projectStatus=p.kJ.NOT_FOUND)),void r.default.replace(R.Hj)}const v=await this.dbSync.init({documentSlug:null===(t=(null===(o=e.query)||void 0===o?void 0:o.slug)||"")||void 0===t?void 0:t.toString(),projectId:this.projectDoc.id,generateDefault:()=>{var e,t,n,o,i,s;const r=(null===(e=g.meta)||void 0===e||null===(t=e.ai)||void 0===t||null===(n=t.theme)||void 0===n?void 0:n.name)||z.fY,a=(null===(o=g.meta)||void 0===o||null===(i=o.ai)||void 0===i||null===(s=i.theme)||void 0===s?void 0:s.variant)||"light";return new u.n({theme:{name:r,variant:a},isNewProject:!0}).toJSON()},onServerOp:e=>{(0,c.mutateFromPatches)(this.projectDoc,(0,F.J)(e))},onClient:e=>{this.localHistoryStackFlow.store(this.projectDoc,(0,F.J)(e))},onConnectionOpen:()=>{_||this.userPermissionGuardService.enableWriteOperations(),(0,c.mutate)(this.projectUIState,(e=>{e.readonly=_,e.socketStatus="active"}))},onConnectionLost:()=>{(0,c.mutate)(this.projectUIState,(e=>{e.readonly=!0,e.socketStatus="disconnected"})),_||this.userPermissionGuardService.disableWriteOperations()},onSocketStatus:e=>{"error"===e&&d.Z.mixpanelEvent(d.Z.AnalyticsEvents.SOCKET_RECONNECT,{source:"project"})}});try{a.Z.validate(v||{})}catch(k){0}this.projectDoc.fromJSON(v||{}),(0,c.mutate)(this.projectUIState,(e=>{e.projectLoaded=!0}));const{cms:w,cmsPages:O,resourceDefinitions:j}=v||{};this.createFunctionsFolderIfNotPresent(),this.createCMSDataIfNonExistent(w,O,j,g.isCmsEnabled),this.createInternationalizationIfNonExistent(),this.initCMSUIState(),this.fixColorCategoryForOldProjects(),_||(this.setProjectThemeIfNotPresent(),this.migrationsFlow.runAllMigrations(),G.P&&(g.isCmsEnabled||this.cmsMainFlow.handleDisconnectCMS(!1,!0),(0,x.eq)(g.workspace)||(this.cmsMainFlow.handleDisableCMSWebhook(),this.projectPublishFlow.removeCustomDomain()))),await this.handleCloneableProject(g,m),await this.fontsInProjectFlow.initAndListenForUpdates(),this.projectClassManagementFlow.init();const S=this.sessionStorageService.get(A.f.UIDL_LINK);if(S){const e=this.sessionStorageService.get(A.f.THEME);this.sessionStorageService.set(A.f.UIDL_LINK,void 0),this.sessionStorageService.set(A.f.THEME,void 0),e?await this.loadProjectFromUIDL(S,!0):await this.loadProjectFromUIDL(S)}this.cleanUpVolatileUserDataAfterInit(),this.projectDoc.pages.getIds().length||this.pageManagementFlow.createHomePage(),Object.keys((null===(i=this.projectDoc.mediaQueryBreakpoints)||void 0===i?void 0:i.byId)||{}).length||this.mediaQueryBreakpointManagementFlow.createDefaultMediaQueries({});const N=this.getInitialPageId({queryParams:e.query});if(this.handleFlowsWithModalsOnLoad(e.inPreviewMode),this.contentGenerationRunning||this.updatePageSelection({pageId:N,type:"replace",inPreviewMode:e.inPreviewMode,lang:e.query.lang,detailsPageId:e.query.detailsPageId}),this.projectUIState.selection.componentId)if(this.projectUIState.layout.mainPanel===p.iW.DEV){const e=this.projectUIState.devMode.selectedFile||T.e3;this.navbarFlow.selectOrCreateTabByEntityId(e,!0)}else this.navbarFlow.selectOrCreateTabByEntityId(N,!0);var P;(this.aiContentGenerationFlow.checkAndUpdateZoomLevel(),this.updateZoomLevel(),this.updateViewportSize(),this.updateComponentsStateAndPropsRenderValues(),this.projectUIState.readonly||(this.collaboratorManagementFlow.init(g),this.selfHealingFlow.fixCollidingPropAndStateNamesForAllComps({}),this.selfHealingFlow.fixMissingAssetFolders({}),this.selfHealingFlow.removeTailwindNodeReferrences({})),e.inPreviewMode)||(this.pointerInteractionManagementFlow.bind(document.body),this.imageOptimisationFlow.computeSizePerComponentForAllAssetsIfNeeded({}),this.rtcFlow.init(),null!==(P=this.projectDoc.settings.experimentalFeatures)&&void 0!==P&&P.developerMode&&(await this.yDocumentManagementFlow.init(),await this.projectFilesFlow.init(),await this.yDocumentManagementFlow.initProjectFiles()),this.githubFlow.cleanupUnexistingRepoData(),await this.initGithubData(),this.conflictManagementFlow.init());null!==(s=this.projectDoc.settings.experimentalFeatures)&&void 0!==s&&s.developerMode&&this.cleanUpVolatileDevModeUserDataAfterInit(),this.asyncWatcherService.listenForUpdates(),this.notificationsManagementFlow.initLimitedNotifications(),this.setMetaInfoOnAccount(g),this.preloadIcons(),this.localHistoryStackFlow.init({onUndo:(e,t)=>{this.projectDoc===e&&this.dbSync.mutateFromPatches(this.projectDoc,t)},onRedo:(e,t)=>{this.projectDoc===e&&this.dbSync.mutateFromPatches(this.projectDoc,t)}}),!g.isCmsEnabled||null!==(l=this.projectDoc.cms.cmsConnectionData)&&void 0!==l&&l.publicUrl||await this.cmsMainFlow.getPublicUrl(),this.actionSequenceDetector.init()}async leave(){this.userProjectDataPersistenceFlow.stopListeningForUpdates(),this.asyncWatcherService.stopListeningForUpdates(),this.pointerInteractionManagementFlow.unbind(document.body),this.localHistoryStackFlow.destroy(),this.actionSequenceDetector.destroy(),setTimeout((()=>{(0,f.G)().destroy()})),this.rtcFlow.leave(),this.yDocumentManagementFlow.destroy();const e=(await Promise.all([n.e(96615),n.e(54949),n.e(58612)]).then(n.bind(n,454949))).QuillProviderFactory;(await e.getInstance()).destroy()}getUserAccessType(e){const{userData:t}=this.globalAppState.user;let n="read";const o=e.collaborators&&e.collaborators.find((e=>{var n;return(null===(n=e.account)||void 0===n?void 0:n.id)===(null===t||void 0===t?void 0:t.id)}));return o&&(n=o.accessType),n}cleanUpVolatileDevModeUserDataAfterInit(){(0,c.mutate)(this.projectUIState,(e=>{const t=e.devMode.selectedBranch,n=[...Object.keys(e.userPreferences.devFileViewState||{})],o=Object.keys(this.projectDoc.projectFiles.local[t].byId),i=this.githubFlow.computeFilesWithDiffs(t).map((e=>e.path)),s=Object.keys(this.projectDoc.projectFiles.staged[t].byId);n.forEach((t=>{Object.keys(e.userPreferences.devFileViewState[t]).forEach((n=>{"local"!==t||o.includes(n)?"diffing"!==t||i.includes(n)?"staged"!==t||s.includes(n)||delete e.userPreferences.devFileViewState.staged[n]:delete e.userPreferences.devFileViewState.diffing[n]:delete e.userPreferences.devFileViewState.local[n]}))}))}))}cleanUpVolatileUserDataAfterInit(){(0,c.mutate)(this.projectUIState,(e=>{const t=e.selection.componentId;return this.projectDoc.getProjectPageOrComponent(t||"")||(e.selection.componentId=this.projectDoc.pages.getHomePageId()||Object.keys(this.projectDoc.pages.byId)[0]),e.layout.sidebarPanel===p.tI.TREE_VIEW&&(e.layout.sidebarPanel=p.tI.FILES),Object.keys(e.navbar.tabs||{}).forEach((t=>{const n=e.navbar.tabs[t];n&&this.projectDoc.getProjectPageOrComponent(n.entityId)||delete e.navbar.tabs[t]})),e}))}async handleCloneableProject(e,t){if(e.accessType===E.W.CLONEABLE&&null!==t&&void 0!==t&&t.isAnonymous)try{const t=await this.workspacesRepository.getAll();if(!t.length)throw new Error("No workspace found");const n=await this.workspacesRepository.getWorkspaceBySlug(t[0].slug),o=n.projects;if(!o||!o[0])return void(await this.cloneProject(n));const i=null===o||void 0===o?void 0:o[0],s=i.id;if(i&&e.id===s)return;const a=g.d.createCustomModal({Component:N,data:{forCloneableProject:!0,onOverride:async()=>{await this.projectRepository.delete(s),n.projects=[],await this.cloneProject(n),this.modalManagementFlow.hideModal()},onCancel:async()=>{await r.default.replace((0,R.S1)(i.slug)),r.default.reload()},onClose:async()=>{await this.projectRepository.delete(s),n.projects=[],await this.cloneProject(n),this.modalManagementFlow.hideModal()}}});this.modalManagementFlow.showModal(a,{},!1)}catch(n){this.sentryService.captureException(n)}}},lt=(0,s.Z)(ct.prototype,"authService",[be],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),dt=(0,s.Z)(ct.prototype,"projectRepository",[Ie],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),pt=(0,s.Z)(ct.prototype,"sentryService",[ve],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ut=(0,s.Z)(ct.prototype,"dbSync",[we],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ht=(0,s.Z)(ct.prototype,"projectDoc",[Oe],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),yt=(0,s.Z)(ct.prototype,"projectUIState",[je],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),mt=(0,s.Z)(ct.prototype,"localHistoryStackFlow",[Se],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ft=(0,s.Z)(ct.prototype,"userProjectDataPersistenceFlow",[Ne],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),gt=(0,s.Z)(ct.prototype,"collaboratorManagementFlow",[De],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),_t=(0,s.Z)(ct.prototype,"pointerInteractionManagementFlow",[Ee],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),bt=(0,s.Z)(ct.prototype,"globalAppState",[Te],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),It=(0,s.Z)(ct.prototype,"userAccountRepository",[Pe],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),vt=(0,s.Z)(ct.prototype,"fontsInProjectFlow",[Ce],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),wt=(0,s.Z)(ct.prototype,"routerService",[xe],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Ot=(0,s.Z)(ct.prototype,"nodeSelectionFlow",[Ae],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),jt=(0,s.Z)(ct.prototype,"zoomControlFlow",[Fe],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),St=(0,s.Z)(ct.prototype,"pageManagementFlow",[ke],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Nt=(0,s.Z)(ct.prototype,"asyncWatcherService",[Re],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Dt=(0,s.Z)(ct.prototype,"webRTCState",[Me],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Et=(0,s.Z)(ct.prototype,"rtcFlow",[Ue],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Tt=(0,s.Z)(ct.prototype,"sessionStorageService",[Ze],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Pt=(0,s.Z)(ct.prototype,"notificationsManagementFlow",[Le],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Ct=(0,s.Z)(ct.prototype,"tutorialFlow",[Be],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),xt=(0,s.Z)(ct.prototype,"uidlToProjectMapper",[We],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),At=(0,s.Z)(ct.prototype,"uidlDownloadService",[ze],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Ft=(0,s.Z)(ct.prototype,"navbarFlow",[$e],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),kt=(0,s.Z)(ct.prototype,"modalManagementFlow",[Ge],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Rt=(0,s.Z)(ct.prototype,"localStorageService",[He],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Mt=(0,s.Z)(ct.prototype,"workspacesRepository",[Ke],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Ut=(0,s.Z)(ct.prototype,"projectCloneFlow",[Ve],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Zt=(0,s.Z)(ct.prototype,"yDocumentManagementFlow",[Ye],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Lt=(0,s.Z)(ct.prototype,"projectFilesFlow",[Je],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Bt=(0,s.Z)(ct.prototype,"imageOptimisationFlow",[Xe],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Wt=(0,s.Z)(ct.prototype,"githubFlow",[qe],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),zt=(0,s.Z)(ct.prototype,"conflictManagementFlow",[Qe],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),$t=(0,s.Z)(ct.prototype,"mediaQueryBreakpointManagementFlow",[et],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Gt=(0,s.Z)(ct.prototype,"projectClassManagementFlow",[tt],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Ht=(0,s.Z)(ct.prototype,"aiContentGenerationFlow",[nt],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Kt=(0,s.Z)(ct.prototype,"userPermissionGuardService",[ot],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Vt=(0,s.Z)(ct.prototype,"selfHealingFlow",[it],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Yt=(0,s.Z)(ct.prototype,"projectPublishFlow",[st],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Jt=(0,s.Z)(ct.prototype,"migrationsFlow",[rt],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),at=ct))},968848:function(e,t,n){var o,i,s,r,a,c,l,d,p,u,h,y,m,f,g,_,b,I,v,w,O,j,S,N,D,E,T,P,C,x=n(503348),A=n(777460),F=n(918437),k=n(395942),R=n(781872),M=n(51261),U=n(90895),Z=n(302503),L=n(440516),B=n(286873),W=n(890810);function z(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function $(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?z(Object(n),!0).forEach((function(t){(0,A.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):z(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}const G=R.DM.GRAY_500;o=(0,Z.provide)("rtcFlow"),i=(0,Z.inject)("authService"),s=(0,Z.inject)("globalAppState"),r=(0,Z.inject)("projectDoc"),a=(0,Z.inject)("webRTCState"),c=(0,Z.inject)("projectUIState"),l=(0,Z.inject)("sentryService"),d=(0,Z.inject)("projectChangesFlow"),p=(0,Z.inject)("projectInitFlow"),u=(0,Z.inject)("componentManagementFlow"),h=(0,Z.inject)("nodeSelectionFlow"),y=(0,Z.inject)("collaboratorManagementFlow"),m=(0,Z.inject)("elementRefProvider"),f=(0,Z.inject)("githubFlow"),o((_=class{constructor(){(0,A.Z)(this,"rtcService",null),(0,x.Z)(this,"authService",b,this),(0,x.Z)(this,"globalAppState",I,this),(0,x.Z)(this,"projectDoc",v,this),(0,x.Z)(this,"webRTCState",w,this),(0,x.Z)(this,"projectUIState",O,this),(0,x.Z)(this,"sentryService",j,this),(0,x.Z)(this,"projectChangesFlow",S,this),(0,x.Z)(this,"projectInitFlow",N,this),(0,x.Z)(this,"componentManagementFlow",D,this),(0,x.Z)(this,"nodeSelectionFlow",E,this),(0,x.Z)(this,"collaboratorManagementFlow",T,this),(0,x.Z)(this,"elementRefProvider",P,this),(0,x.Z)(this,"githubFlow",C,this),(0,A.Z)(this,"colors",U.T),(0,A.Z)(this,"shareDBConnectedAt",null),(0,A.Z)(this,"intlUtils",B.V.Instance)}async init(){const e=await this.authService.getAuthUserAsync();if(!e)return;const{RTCService:t}=await Promise.all([n.e(43811),n.e(13115),n.e(60689)]).then(n.bind(n,831282));this.rtcService=new t;const o=this.projectDoc.id,i=this.globalAppState.user.userData,s=this.collaboratorManagementFlow.getCurrentUserProjectRole();s&&this.rtcService.init({loggedInUser:e,currentUser:i,projectId:o,projectRole:s,dataHandler:this.handleRtcMessages.bind(this)})}saveConnectedAtInfo(e){this.shareDBConnectedAt=e}addNewPeer(e){const t=this.projectInitFlow.getProjectLimitations();if(Object.keys(this.webRTCState.connectedPeers).length===t.MAX_REAL_TIME_COLLABS-1&&this.shareDBConnectedAt){let t=!0;return Object.entries(this.webRTCState.connectedPeers).forEach((([,e])=>{this.shareDBConnectedAt&&e.connectedAt>this.shareDBConnectedAt&&(t=!1)})),e.connectedAt>this.shareDBConnectedAt&&(t=!1),void(t&&this.projectChangesFlow.handleTooManyUserConnections())}(0,k.mutate)(this.webRTCState,(t=>{e.color=this.getFirstAvailableColor(),t.connectedPeers[e.connectionId]=e}))}removePeer(e){e.color&&(this.colors[e.color]=!1),(0,k.mutate)(this.webRTCState,(t=>{delete t.connectedPeers[e.connectionId]}))}removeAllPeers(){(0,k.mutate)(this.webRTCState,(e=>{Object.keys(e.connectedPeers).length&&(e.isLoadingPeers=!0),new M.g})),this.webRTCState.isLoadingPeers&&setTimeout((()=>{(0,k.mutate)(this.webRTCState,(e=>{e.isLoadingPeers=!1}))}),2e3)}leave(){var e;null===(e=this.rtcService)||void 0===e||e.destroy()}broadcastMessage(e){this.rtcService&&this.rtcService.broadcastMessage(e)}sendMessageToPeer(e,t){this.rtcService?this.rtcService.sendMessageToPeer(e,t):this.sentryService.captureException(new Error("RTCFlow was not initialized in sendMessageToPeer"))}lockPageSettingsKey(e,t,n){this.globalAppState.user.userData&&(this.handleLockPageSettingsByKey(e,t,n),this.broadcastMessage({type:"lock-page-settings-under-translation",compId:e,pageSettingsKey:{key:t,languages:n}}))}unlockPageSettingsKey(e,t,n){this.globalAppState.user.userData&&(this.handleUnlockPageSettingsByKey(e,t,n),this.broadcastMessage({type:"unlock-page-settings-under-translation",compId:e,pageSettingsKey:{key:t,languages:n}}))}lockEditedNodes(e){this.globalAppState.user.userData&&this.broadcastMessage({type:"edited-nodes",nodeIds:e,compId:this.projectUIState.selection.componentId})}lockNodesUnderTranslation(e){this.globalAppState.user.userData&&(null!==e&&void 0!==e&&e.length?(0,k.mutate)(this.webRTCState,(t=>{t.nodesUnderTranslation["current-translating-nodes"]={nodeIds:e,color:"#8d4ddc"}})):(0,k.mutate)(this.webRTCState,(e=>{delete e.nodesUnderTranslation["current-translating-nodes"]})),this.broadcastMessage({type:"nodes-under-translation",nodeIds:e}))}unlockEditedNodes(){this.globalAppState.user.userData&&this.broadcastMessage({type:"edited-nodes",nodeIds:[],compId:this.projectUIState.selection.componentId})}notifyDevModeDataChange(e){const{selectedFile:t,selectedBranch:n,selection:o,changes:i,editorId:s}=e;this.globalAppState.user.userData&&this.broadcastMessage({type:"dev-data-change",selectedFile:t,selectedBranch:n,selection:o,changes:i,editorId:s})}notifySelectedComp(e){this.globalAppState.user.userData&&this.broadcastMessage({type:"selected-comp",compId:e})}notifySelectedNodes(e){this.globalAppState.user.userData&&this.broadcastMessage({type:"selected-nodes",nodeIds:e,compId:this.projectUIState.selection.componentId})}notifyBringAllPeer(){this.globalAppState.user.userData&&this.broadcastMessage({type:"bring-all-peers",compId:this.projectUIState.selection.componentId})}requestSelectedNodesFromPeer(e){this.sendMessageToPeer(e,{type:"get-selected-nodes"})}clearDevChanges(){(0,k.mutate)(this.webRTCState,(e=>{Object.keys(e.devData).forEach((t=>{e.devData[t].changes=[]}))}))}deleteNodesForDisconnectedPeer(e){(0,k.mutate)(this.webRTCState,(t=>{Object.keys(t.editedNodes).includes(e.connectionId)&&delete t.editedNodes[e.connectionId],Object.keys(t.selectedNodes).includes(e.connectionId)&&delete t.selectedNodes[e.connectionId]}))}deleteDevDataForDisconnectedPeer(e){(0,k.mutate)(this.webRTCState,(t=>{delete t.devData[e.connectionId]}))}isNodeLocked(e){var t,n,o;if(!Object.keys(this.webRTCState.editedNodes).length&&!Object.keys(null!==(t=this.webRTCState.nodesUnderTranslation)&&void 0!==t?t:{}).length)return!1;if(!!Object.values(this.webRTCState.editedNodes).find((t=>{var n;return null===(n=t.nodeIds)||void 0===n?void 0:n.includes(e)})))return!0;if(!Object.keys(this.webRTCState.nodesUnderTranslation).length)return!1;if(!!Object.values(this.webRTCState.nodesUnderTranslation).find((t=>{var n;return null===(n=t.nodeIds)||void 0===n?void 0:n.includes(e)})))return!0;const i=this.elementRefProvider.getDomNodeElementRefByNodeId(e);if(!i)return!1;if(!((null===(n=i.children[0])||void 0===n||null===(o=n.tagName)||void 0===o?void 0:o.toLowerCase())===W.rC))return!1;const s=i.children[0].getAttribute("rootnodeid");if(!s)return!1;const r=this.projectDoc.nodes.getById(s);if(!r||"element-node"!==r.type)return!1;const a=this.intlUtils.getTranslationNodeFromElementNode({node:r});return!!a&&!!Object.values(this.webRTCState.nodesUnderTranslation).find((e=>{var t;return null===(t=e.nodeIds)||void 0===t?void 0:t.includes(a.id)}))}changeGithubBranch(e){const t=this.globalAppState.user.userData;t&&t.id&&this.broadcastMessage({type:"change-github-branch",branch:e,userId:t.id})}handleSelectionOnEditedNodesReceived(e){if(!e.length)return Object.keys(this.projectUIState.selection.nodes).length||(0,k.mutate)(this.projectUIState,(e=>{Object.keys(this.webRTCState.prevSelectedLockedNodeIds).forEach((t=>{e.selection.nodes[t]=t}))})),void(0,k.mutate)(this.webRTCState,(e=>{e.prevSelectedLockedNodeIds={}}));const t={};(0,k.mutate)(this.projectUIState,(n=>{e.forEach((e=>{n.selection.nodes[e]&&(t[e]=!0,delete n.selection.nodes[e])}))})),(0,k.mutate)(this.webRTCState,(e=>{e.prevSelectedLockedNodeIds=t}))}handleLockPageSettingsByKey(e,t,n){(0,k.mutate)(this.webRTCState,(o=>{o.pageSettingsUnderTranslation[e]||(o.pageSettingsUnderTranslation[e]={}),o.pageSettingsUnderTranslation[e]=$($({},o.pageSettingsUnderTranslation[e]),n.reduce(((n,i)=>{var s;return n[i]=$($({},null!==(s=o.pageSettingsUnderTranslation[e][i])&&void 0!==s?s:{}),{},{[t]:{color:"#8d4ddc"}}),n}),{}))}))}handleUnlockPageSettingsByKey(e,t,n){(0,k.mutate)(this.webRTCState,(o=>{o.pageSettingsUnderTranslation[e]&&n.forEach((n=>{o.pageSettingsUnderTranslation[e][n]&&(delete o.pageSettingsUnderTranslation[e][n][t],Object.keys(o.pageSettingsUnderTranslation[e][n]).length||delete o.pageSettingsUnderTranslation[e][n],Object.keys(o.pageSettingsUnderTranslation[e]).length||delete o.pageSettingsUnderTranslation[e])}))}))}handleRtcMessages(e,t){const n=JSON.parse(e),{connectionId:o,color:i}=t;if(n.type){if("dev-data-change"===n.type){const{from:e,selectedFile:t,selectedBranch:i,selection:s,changes:r=[],editorId:a}=n;(0,k.mutate)(this.webRTCState,(({devData:n})=>{n[`${o}`]={editorId:a,selectedBranch:i,selectedFile:t,name:e.name,email:e.email,changes:[...r],selection:$({},s)}}))}if("unlock-page-settings-under-translation"===n.type){const{compId:e,pageSettingsKey:t}=n;this.handleUnlockPageSettingsByKey(e,t.key,t.languages)}if("lock-page-settings-under-translation"===n.type){const{compId:e,pageSettingsKey:t}=n;this.handleLockPageSettingsByKey(e,t.key,t.languages)}if("nodes-under-translation"===n.type){const{from:e,nodeIds:t}=n;(0,k.mutate)(this.webRTCState,(({nodesUnderTranslation:n})=>{t.length?n[`${o}`]={name:e.name,email:e.email,nodeIds:t,color:i}:delete n[o]}))}if("edited-nodes"===n.type){const{from:e,nodeIds:t,compId:s}=n;(0,k.mutate)(this.webRTCState,(({editedNodes:n})=>{t.length?n[`${o}`]={name:e.name,email:e.email,nodeIds:t,compId:s,color:i}:delete n[o]})),this.handleSelectionOnEditedNodesReceived(t)}if("selected-comp"===n.type){var s;if((null===(s=this.projectUIState.layout)||void 0===s?void 0:s.mainPanel)===L.iW.DEV)return;const{compId:e}=n;(0,k.mutate)(this.webRTCState,(({selectedComp:t,selectedNodes:n})=>{e?(delete n[o],t[`${o}`]={compId:e}):delete t[o]})),this.webRTCState.followedUserId===o&&this.collaboratorManagementFlow.followUserSelectedPage(e)}if("change-github-branch"===n.type){const e=this.globalAppState.user.userData;if(!e||!e.id)return;const{userId:t,branch:i}=n;if((0,k.mutate)(this.webRTCState,(({devData:e})=>{e[`${o}`]&&(e[`${o}`].selectedBranch=i)})),t!==e.id)return;(0,k.mutate)(this.globalAppState,(({user:e})=>{e&&e.userData&&(e.userData.meta.githubBranches=$($({},e.userData.meta.githubBranches),{},{[this.projectDoc.id]:i}))})),this.githubFlow.changeBranch(i,!1)}if("selected-nodes"===n.type){const{from:e,nodeIds:t,compId:s}=n;(0,k.mutate)(this.webRTCState,(({selectedNodes:n})=>{t.length?n[`${o}`]={name:e.name,email:e.email,nodeIds:t,compId:s,color:i}:delete n[o]})),this.webRTCState.followedUserId===o&&this.collaboratorManagementFlow.followUserSelectedNodes(t)}if("get-selected-nodes"===n.type){var r;null!==(r=this.webRTCState.connectedPeers[o])&&void 0!==r&&r.name||(0,k.mutate)(this.webRTCState,(({connectedPeers:e})=>{e[o].name=n.from.name,e[o].email=n.from.email,e[o].projectRole=n.from.projectRole}));const e=this.nodeSelectionFlow.getSelectedNodesIds(),t=this.projectUIState.selection.componentId;this.notifySelectedNodes(e),this.notifySelectedComp(t)}if("bring-all-peers"===n.type){const{compId:e}=n;(0,k.mutate)(this.webRTCState,(({selectedComp:t})=>{e?t[`${o}`]={compId:e}:delete t[o]})),this.componentManagementFlow.select(e)}}}getFirstAvailableColor(){const e=Object.keys(this.colors).find((e=>!this.colors[e]));return e?(this.colors[e]=!0,e):G}},b=(0,F.Z)(_.prototype,"authService",[i],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),I=(0,F.Z)(_.prototype,"globalAppState",[s],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),v=(0,F.Z)(_.prototype,"projectDoc",[r],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),w=(0,F.Z)(_.prototype,"webRTCState",[a],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),O=(0,F.Z)(_.prototype,"projectUIState",[c],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),j=(0,F.Z)(_.prototype,"sentryService",[l],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),S=(0,F.Z)(_.prototype,"projectChangesFlow",[d],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),N=(0,F.Z)(_.prototype,"projectInitFlow",[p],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),D=(0,F.Z)(_.prototype,"componentManagementFlow",[u],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),E=(0,F.Z)(_.prototype,"nodeSelectionFlow",[h],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),T=(0,F.Z)(_.prototype,"collaboratorManagementFlow",[y],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),P=(0,F.Z)(_.prototype,"elementRefProvider",[m],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),C=(0,F.Z)(_.prototype,"githubFlow",[f],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),g=_))},352541:function(e,t,n){n.d(t,{j:function(){return F}});var o,i,s,r,a,c,l,d,p,u,h,y,m,f,g,_,b,I,v=n(503348),w=n(918437),O=n(302503),j=n(255328),S=n(523689),N=n(233475),D=n(590196),E=n(564651),T=n(491463),P=n(476535),C=n(229187),x=n(869425),A=n(656733);o=(0,O.provide)("selfHealingFlow"),i=(0,O.inject)("projectDoc"),s=(0,O.inject)("guardsService"),r=(0,O.inject)("sentryService"),a=(0,O.inject)("mediaQueryBreakpointManagementFlow"),c=(0,O.inject)("assetsEditFlow"),l=(0,O.inject)("sharedbProjectSyncService"),o((p=class{constructor(){(0,v.Z)(this,"projectDoc",u,this),(0,v.Z)(this,"guardsService",h,this),(0,v.Z)(this,"sentryService",y,this),(0,v.Z)(this,"mediaQueryBreakpointManagementFlow",m,this),(0,v.Z)(this,"assetsEditFlow",f,this),(0,v.Z)(this,"dbSync",g,this)}removeSectionIdsWithoutBoundNodes(e){const{sectionIds:t,currentComponent:n}=e;if(!t.length)return;const o=[];for(const s of t){if(s.boundNodes.length)continue;let e=null;for(const t in n.sectionIds)if(n.sectionIds[t]===s.id.sectionId){e=t;break}e&&o.push(e)}if(!o.length)return;const i=new Error("Self healing flow for section ids without bound nodes triggered.");this.sentryService.captureException(i),this.guardsService.executeFunctionGuarded(A._.DISABLE_HISTORY,(()=>this.dbSync.mutate(this.projectDoc,(e=>{o.forEach((t=>{const o=e.getProjectPageOrComponent(n.id);o&&delete o.sectionIds[t]}))}))))}restoreDefaultMediaQueries(e){const{doc:t}=e;if(!t)return;const n=new Error("Self-healing flow for inexistent default MQ triggered.");return this.sentryService.captureException(n),this.mediaQueryBreakpointManagementFlow.computeNewDefault({doc:t}),this.mediaQueryBreakpointManagementFlow.computeNewMatchedMQ({doc:t}),t.mediaQueryBreakpoints.getDefaultMediaQuery()}fixMissingAssetFolders(e){const{doc:t}=e;t&&Object.values(t.assets.byId).forEach(((e,n)=>{if(!e.parentFolderId){e.parentFolderId="public",t.folders.add("public",{id:e.id,type:"asset"});const n=new Error("Self-healing flow for missing asset folder parent id triggered.");return void this.sentryService.captureException(n)}if(!t.folders.byId[e.parentFolderId]){t.folders.create({folderName:`images${n}`,folderId:e.parentFolderId,parentFolderId:"public"});const o=new Error("Self-healing flow for missing asset folder triggered.");this.sentryService.captureException(o)}const o=t.folders.byId[e.parentFolderId];o.children[e.id]||t.folders.add(o.id,{id:e.id,type:"asset"})}))}restoreUsedInNodes(e){const{scrValue:t,nodeId:n,doc:o}=e;if(!o)return;const i=this.assetsEditFlow.getAssetBySrc(t);if(!i)return;const s=o.assets.byId[i.id];if(!s)return;if(s.usedInNodes[n])return;const r=new Error("Self-healing flow for missing usedInNodes for assets triggered.");this.sentryService.captureException(r),s.createNodeRelation(n)}replaceWithDefaultValuesOnNodeWithInexistentProp(e){var t;const n=new Error("Self-healing flow for replacing default values in nodes with inexistent props triggered.");this.sentryService.captureException(n);const{nodeId:o,referenceKey:i,doc:s}=e;if(!s||!o)return new S.F({content:""});const r=s.nodes.getById(o);if(!r)return new S.F({content:""});const a=null===(t=Object.values(r.contentChildren).find((e=>"dynamic"===e.type&&e.content.id===i)))||void 0===t?void 0:t.id;if(a&&r.primitiveType){const e=new S.F({content:N.AP[r.primitiveType]});return r.contentChildren[a]=e,e}const c=Object.keys(r.attrs).find((e=>{const t=r.attrs[e];return"dynamic"===t.type&&t.content.id===i}));if(c){const e=new S.F({content:"src"===c?D.b.image.src:D.b.image.alt});return r.attrs[c]=e,e}return new S.F({content:""})}fixMultipleDynamicVariantsForCompRootNode(e){var t;const{component:n,doc:o}=e;if(!o||!n.rootNodeId||!o.nodes.getById(n.rootNodeId))return;const i=o.nodes.getById(n.rootNodeId);if(!i||!("referencedStyles"in i))return;const s=new Map,r={},a=null===(t=Object.values(n.propDefinitions).find((e=>e.name===C.Q)))||void 0===t?void 0:t.id;for(const c in i.referencedStyles){const e=i.referencedStyles[c];if("component-referenced"===e.content.mapType&&"dynamic"===e.content.content.type&&"prop"===e.content.content.content.referenceType){const t=e.content.content.content.id;if(s.has(t)||t!==a)continue;s.set(t,c)}r[c]=e}if(Object.keys(r).length!==Object.keys(i.referencedStyles).length){const e=new Error(`Self-healing flow for multiple dynamic variants triggered for component with id:${n.id}, for node with id:${i.id}.`);this.sentryService.captureException(e),i.referencedStyles=r}}fixCollidingPropAndStateNamesForAllComps(e){const{doc:t}=e;t&&Object.keys(t.components.byId).forEach((e=>{this.checkAndFixNameCollisions({componentId:e,doc:t,type:"prop"}),this.checkAndFixNameCollisions({componentId:e,doc:t,type:"state"})}))}checkAndFixNameCollisions(e){const{doc:t,componentId:n,type:o}=e;if(!t)return;const i=t.components.byId[n];if(!i)return;const s="prop"===o?i.propDefinitions:i.stateDefinitions,r={};if(!Object.values(s).find((e=>{const t=(0,E.createStateOrPropStoringValue)(e.name);return!!r[t]||(r[t]=!0,!1)})))return;const a=new Error(`Self-healing flow for ${o} name collision triggered for component with id:${i.id}.`);this.sentryService.captureException(a);const c=[];return Object.values(s).forEach((e=>{const t=(0,E.createStateOrPropStoringValue)(e.name);e.name=(0,T.Zu)(c,t),c.push(e.name)})),i}removeTailwindNodeReferrences(e){var t;const{doc:n}=e;if(!n)return;var o;(null===(t=n.settings.experimentalFeatures)||void 0===t?void 0:t[x.QR.TAILWINDCSS])&&(this.sentryService.captureException(new Error("Self-healing flow for tailwind still enabled triggered.")),null===(o=n.settings.experimentalFeatures)||void 0===o||delete o[x.QR.TAILWINDCSS]);Object.keys(n.tailwindCSS.byId).length&&(this.sentryService.captureException(new Error("Self-healing flow for tailwind node references triggered.")),n.tailwindCSS.byId={})}removePropDefinitionLocationForNodeThatDoesntExist(e){const{propDef:t,nodeId:n,doc:o}=e;if(o&&!o.nodes.getById(n)){var i;this.sentryService.captureException(new Error("Self-healing flow for prop definition location triggered."));const e=Object.values(o.components.byId).find((e=>e&&Object.keys(e.propDefinitions).includes(t.id)));if(!e)throw new Error("Component not found for prop definition location removal.");null===(i=e.propDefinitions[t.id].locations)||void 0===i||delete i[n]}}addUsedInNodeToCssClass(e){const{cssClassId:t,nodeId:n,doc:o}=e;if(!o)return;const i=o.classes.byId[t],s=o.nodes.getById(n);i&&"simple"===i.classType&&s&&(i.usedInNodes[n]||(i.usedInNodes[n]=!0))}removeUsedInNodeFromCssClass(e){var t;const{cssClassId:n,nodeId:o,doc:i}=e;if(!i)return;const s=i.classes.byId[n],r=i.nodes.getById(o),a=null===r||void 0===r||null===(t=r.referencedStyles)||void 0===t?void 0:t[n];s&&"simple"===s.classType&&!a&&delete s.usedInNodes[o]}},u=(0,w.Z)(p.prototype,"projectDoc",[i],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),h=(0,w.Z)(p.prototype,"guardsService",[s],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),y=(0,w.Z)(p.prototype,"sentryService",[r],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),m=(0,w.Z)(p.prototype,"mediaQueryBreakpointManagementFlow",[a],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),f=(0,w.Z)(p.prototype,"assetsEditFlow",[c],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),g=(0,w.Z)(p.prototype,"dbSync",[l],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),(0,w.Z)(p.prototype,"restoreDefaultMediaQueries",[j.P],Object.getOwnPropertyDescriptor(p.prototype,"restoreDefaultMediaQueries"),p.prototype),(0,w.Z)(p.prototype,"fixMissingAssetFolders",[j.P],Object.getOwnPropertyDescriptor(p.prototype,"fixMissingAssetFolders"),p.prototype),(0,w.Z)(p.prototype,"restoreUsedInNodes",[j.P],Object.getOwnPropertyDescriptor(p.prototype,"restoreUsedInNodes"),p.prototype),(0,w.Z)(p.prototype,"replaceWithDefaultValuesOnNodeWithInexistentProp",[j.P],Object.getOwnPropertyDescriptor(p.prototype,"replaceWithDefaultValuesOnNodeWithInexistentProp"),p.prototype),(0,w.Z)(p.prototype,"fixMultipleDynamicVariantsForCompRootNode",[j.P],Object.getOwnPropertyDescriptor(p.prototype,"fixMultipleDynamicVariantsForCompRootNode"),p.prototype),(0,w.Z)(p.prototype,"fixCollidingPropAndStateNamesForAllComps",[P.W],Object.getOwnPropertyDescriptor(p.prototype,"fixCollidingPropAndStateNamesForAllComps"),p.prototype),(0,w.Z)(p.prototype,"checkAndFixNameCollisions",[j.P],Object.getOwnPropertyDescriptor(p.prototype,"checkAndFixNameCollisions"),p.prototype),(0,w.Z)(p.prototype,"removeTailwindNodeReferrences",[j.P],Object.getOwnPropertyDescriptor(p.prototype,"removeTailwindNodeReferrences"),p.prototype),(0,w.Z)(p.prototype,"removePropDefinitionLocationForNodeThatDoesntExist",[j.P],Object.getOwnPropertyDescriptor(p.prototype,"removePropDefinitionLocationForNodeThatDoesntExist"),p.prototype),(0,w.Z)(p.prototype,"addUsedInNodeToCssClass",[j.P],Object.getOwnPropertyDescriptor(p.prototype,"addUsedInNodeToCssClass"),p.prototype),(0,w.Z)(p.prototype,"removeUsedInNodeFromCssClass",[j.P],Object.getOwnPropertyDescriptor(p.prototype,"removeUsedInNodeFromCssClass"),p.prototype),d=p));const F=new(_=(0,O.inject)("selfHealingFlow"),b=class{constructor(){(0,v.Z)(this,"selfHealingFlow",I,this)}addUsedInNodeToCssClass(e,t){this.selfHealingFlow.addUsedInNodeToCssClass({cssClassId:e,nodeId:t})}removeUsedInNodeFromCssClass(e,t){this.selfHealingFlow.removeUsedInNodeFromCssClass({cssClassId:e,nodeId:t})}},I=(0,w.Z)(b.prototype,"selfHealingFlow",[_],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),b)},347429:function(e,t,n){var o,i,s,r,a,c,l,d,p,u,h,y,m,f,g=n(503348),_=n(777460),b=n(735468),I=n(918437),v=n(395942),w=n(302503),O=n(440516),j=n(378888);function S(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function N(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?S(Object(n),!0).forEach((function(t){(0,_.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):S(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}o=(0,w.provide)("userProjectDataPersistenceFlow"),i=(0,w.inject)("projectUIState"),s=(0,w.inject)("projectDoc"),r=(0,w.inject)("workspaceCollaboratorRepository"),a=(0,w.inject)("sentryService"),c=(0,w.inject)("globalAppState"),o((f=new WeakMap,d=class{constructor(){(0,g.Z)(this,"projectUIState",p,this),(0,g.Z)(this,"projectDoc",u,this),(0,g.Z)(this,"workspaceCollaboratorRepository",h,this),(0,g.Z)(this,"sentryService",y,this),(0,g.Z)(this,"globalAppState",m,this),f.set(this,{writable:!0,value:[]}),(0,_.Z)(this,"savePreferences",(async e=>{if(this.projectUIState.readonly)return;const t={};O.w9.forEach((n=>{if(n.includes("/")){const o=n.split("/"),i=o[0],s=o[1];t[i]=N(N({},t[i]),{},{[s]:e[i][s]})}else t[n]=e[n]}));try{const e=this.projectDoc.id;await this.workspaceCollaboratorRepository.update({projectId:e,meta:t})}catch(n){this.sentryService.captureException(n)}})),(0,_.Z)(this,"debounceSavePreferences",(0,j.Ds)(this.savePreferences,3e3,!1))}init(e){var t;if(this.projectUIState.readonly)return;const n=null===(t=e.collaborators)||void 0===t?void 0:t.find((e=>{var t,n;return(null===(t=e.account)||void 0===t?void 0:t.id)===(null===(n=this.globalAppState.user.userData)||void 0===n?void 0:n.id)})),o=null===n||void 0===n?void 0:n.meta,i={};if(o&&(O.w9.forEach((e=>{if(e.includes("/")){const t=e.split("/"),n=t[0],i=t[1];if(o[n]){const e=this.projectUIState[n]||{},t=o[n][i];if(void 0===t&&!!Object.keys(e[i]||{}).length)return;Object.assign(this.projectUIState,{[n]:N(N({},e),{},{[i]:t})})}return}const t=this.projectUIState[e]||{};o.hasOwnProperty(e)||(i[e]=t),Object.keys(t).forEach((n=>{o[e]&&!o[e].hasOwnProperty(n)&&(i[e]=N(N({},i[e]),{},{[n]:t[n]}))})),o[e]&&Object.assign(this.projectUIState,{[e]:o[e]})})),Object.keys(i).length)){const t=N({},o);Object.keys(i).forEach((e=>{t[e]=N(N({},t[e]),i[e])})),this.workspaceCollaboratorRepository.update({projectId:e.id,meta:t}),Object.keys(t).forEach((e=>{"object"===typeof t[e]&&(t[e]=N(N({},this.projectUIState[e]),t[e]))})),Object.assign(this.projectUIState,N(N({},this.projectUIState),t))}this.subscribeToChanges()}subscribeToChanges(){const e=O.w9.map((e=>{if(e.includes("/")){const t=e.split("/");return`${t[0]}/${t[1]}`}return`${e}/**`})),t=(0,v.select)(this.projectUIState,e,this.debounceSavePreferences,"UserProjectDataPersistenceFlow");(0,b.Z)(this,f).push((()=>t.dispose()))}stopListeningForUpdates(){(0,b.Z)(this,f).forEach((e=>e()))}},p=(0,I.Z)(d.prototype,"projectUIState",[i],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),u=(0,I.Z)(d.prototype,"projectDoc",[s],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),h=(0,I.Z)(d.prototype,"workspaceCollaboratorRepository",[r],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),y=(0,I.Z)(d.prototype,"sentryService",[a],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),m=(0,I.Z)(d.prototype,"globalAppState",[c],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),l=d))},825504:function(e,t,n){n.d(t,{q:function(){return s},$:function(){return r}});var o=n(989993),i=n(120998);const s=(e,t,n)=>Object.keys(e||{}).reduce(((s,r)=>{const a=e[r];if(!a)return s;const c=a.toUIDL(n);if(!c)return s;if(i.H.includes(r)&&"string"===typeof c.content){const e=c.content;let n=(0,o.BQ)(e);n=n.map((e=>{if(e.includes("gradient"))return e;const n=null===t||void 0===t?void 0:t.find((t=>e.includes(t.id)));return n?`url("${n.localPath}")`:e})),c.content=n.join(",")}return a.content?(s[r]=c,s):s}),{}),r=(e,t,n)=>({type:"style-map",content:{conditions:e.content.conditions,mapType:"inlined",styles:Object.keys(e.content.styles||{}).reduce(((o,s)=>{if("inlined"!==e.content.mapType)return o;const r=e.content.styles[s];if(!r)return o;const a=r.toUIDL(n);return a?(i.H.includes(s)&&(null===t||void 0===t||t.forEach((e=>{const t=a.content;"string"===typeof t&&-1!==t.indexOf(e.id)&&(a.content=`url("${e.localPath}")`)}))),o[s]=a,o):o}),{})}})},189603:function(e,t,n){n.d(t,{PH:function(){return y},qO:function(){return m},Wh:function(){return f},Dn:function(){return g},EY:function(){return _},wv:function(){return b},LK:function(){return I},zj:function(){return v},cx:function(){return w},FW:function(){return O},hm:function(){return j},SK:function(){return S},Yg:function(){return N},ic:function(){return D},bC:function(){return E},OP:function(){return T},qp:function(){return P},g4:function(){return C},_x:function(){return x}});var o=n(777460),i=n(491463),s=n(378888),r=n(641673),a=n(523689),c=n(825504),l=n(455245),d=n(900870),p=n(463012);function u(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function h(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?u(Object(n),!0).forEach((function(t){(0,o.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):u(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}const y=e=>{const t=[],n=[];return Object.values(e.components.byId).forEach((e=>{if(!e)return;const n=(0,i.Zu)(t,(0,s.dE)(null===e||void 0===e?void 0:e.title)||"Component");t.push(n),e.title=n})),Object.values(e.pages.byId).forEach((e=>{if(!e)return;const t=(0,i.Zu)(n,(0,s.dE)(null===e||void 0===e?void 0:e.title)||"Page");n.push(t),e.title=t})),Object.values(e.cmsPages.byId).forEach((e=>{if(!e)return;const t=(0,i.Zu)(n,(0,s.dE)(null===e||void 0===e?void 0:e.title)||"Page");n.push(t),e.title=t})),e},m=e=>{const t=[];return Object.values(e).forEach((e=>{if(!e)return;const n=(0,i.Zu)(t,(0,s.dE)(e.name));t.push(n),e.name=n})),e},f=e=>e.reduce(((e,t)=>{if(!t)return e;const n=g(t||{});return Object.keys(n).forEach((t=>{e[t]=n[t]})),e}),{}),g=(e,t,n,o=l.o.UIDL,i)=>{const s=(null===e||void 0===e?void 0:e.propDefinitions)||{};if(!Object.keys(s).length)return{};const r=(null===e||void 0===e?void 0:e.stateDefinitions)||{};return Object.keys(s).reduce(((a,c)=>{const l=s[c];let d=l.defaultValue;if("locations"in l&&!Object.keys(l.locations).length&&"rootClassName"!==l.name)return a;if(t&&"locations"in l&&Object.keys(l.locations).forEach((e=>{var n;null===(n=t[e])||void 0===n||n.forEach((e=>{"string"===typeof d&&-1!==d.indexOf(e.id)&&(d=e.localPath)}))})),"richtext"===l.type&&l.defaultHierarchyRootId&&n){const s=n({nodeId:l.defaultHierarchyRootId,propDefinitions:g(e,t),stateDefinitions:b(r),defaultElementStyles:{},options:{skipDevModeWidgets:!1},projectType:o,useDefaultProps:null!==i&&void 0!==i&&i,experimentalFeatures:{},component:e});return a[l.name]={id:l.id,defaultValue:s.nodeHierarchy,type:"element"},a}return a[l.name]={id:l.id,defaultValue:d,type:l.type},a}),{})},_=e=>Object.keys(e).reduce(((t,n)=>{const o=e[n];return t[o.name]={id:o.id,defaultValue:o.defaultValue,type:o.type},t}),{}),b=e=>Object.keys(e).reduce(((t,n)=>{const o=e[n];return t[o.name]={id:o.id,defaultValue:o.defaultValue,type:o.type},t}),{}),I=(e,t)=>Object.keys(e).reduce(((n,o)=>{const i=e[o],s=[];Object.keys(i.usedByInstances||{}).forEach((e=>{const n=null===t||void 0===t?void 0:t[e];n&&s.push(...n)}));const r=Object.values(i.referencedStyles).reduce(((e,t)=>{if("inlined"!==t.content.mapType)return e;const n=t.content.conditions[0];if("screen-size"!==n.conditionType)return e;const{maxHeight:o,maxWidth:i,minHeight:r,minWidth:a}=n;return e.push({type:n.conditionType,content:(0,c.q)(t.content.styles,s),meta:{maxWidth:i||0,maxHeight:o,minHeight:r,minWidth:a}}),e}),[]);return n[o]={content:(0,c.q)(i.styles,s),conditions:r,type:"reusable-component-style-override"},n}),{}),v=(e,t)=>(0,r.hN)(`${e.name}-${"cms-listing-page"===t?"entities":"entity"}`),w=e=>(0,r.hN)((0,s.Y$)(e)),O=(e,t)=>{let n=[],o=[];e.forEach((e=>{n.push(...e.head),o.push(...e.body)})),n=[...new Set(n)],o=[...new Set(o)];let i=(null===t||void 0===t?void 0:t.head)||"",s=(null===t||void 0===t?void 0:t.body)||"";return n.forEach((e=>{var t;i=!e||null!==(t=i)&&void 0!==t&&t.includes(e)?`${i}`:`${i}\n        <style>${e}</style>`})),o.forEach((e=>{var t;s=!e||null!==(t=s)&&void 0!==t&&t.includes(e)?`${s}`:`${s}\n        <script defer src='${e}'><\/script>`})),{head:i,body:s}},j=e=>{try{e=JSON.parse(e)}catch(t){}return e?"string"===typeof e?`"${e}"`:"number"===typeof e||"boolean"===typeof e?e:Array.isArray(e)||"object"===typeof e&&null!==e?JSON.stringify(e):"":""},S=(e=[],t=[],n,o)=>{let i=(t.length>0?[...t,...e||[]]:[]).map((e=>isNaN(Number(e))?e:`[${Number(e)}]`)).join("?.");if(o&&(i=`${i}${o}`),n){const e=j(n);i=`${i}${e?` || ${e}`:""}`}return i},N=()=>({type:"package",path:"@teleporthq/react-components",version:"latest",meta:{namedImport:!0}}),D=e=>({type:"element",content:{elementType:"container",children:[{type:"static",content:e}]}}),E=(e,t)=>Object.keys(e).find((n=>e[n].id===t)),T=e=>{var t;if("global"!==e.content.referenceType)throw new Error("Repeater data source must be a global reference (for now)");const n=null!==(t=e.content.refPath)&&void 0!==t?t:[],o=null===n||void 0===n?void 0:n[0];if(!o)throw new Error("Repeater data source must have a reference path");switch(o){case d.v3.ALL_LANGUAGES:return{type:"global",content:"locales"};case d.v3.CURRENT_LANGUAGE:return{type:"global",content:"locale",refPath:n.slice(1)}}},P=(e,t,n,o,i,s)=>{var r,a;const{referenceType:c,refPath:l=[],refPathPrefix:d=[]}=e.content;switch(c){case"global":return T(e);case"ctx":return{type:"expr",content:S([...d,...l],[t[e.content.ctxId||""]],null!==(r=e.content.fallbackValue)&&void 0!==r?r:i,s)};case"prop":const c=e.content.id,p=Object.keys(n).find((e=>n[e].id===c));if(!p)throw new Error(`Referenced prop is missing from propDefinitions - ${c}`);return{type:"expr",content:`props['${p}']${s||""} || ${["array","object"].includes(typeof(null===n||void 0===n?void 0:n[p].defaultValue))?JSON.stringify(null===n||void 0===n?void 0:n[p].defaultValue):(null===n||void 0===n||null===(a=n[p].defaultValue)||void 0===a?void 0:a.toString())||i}`};case"state":const u=e.content.id;return{type:"expr",content:`${Object.keys(o).find((e=>o[e].id===u))}${s||""} || ${i}`};default:return null}},C=e=>{const{attrs:t,projectDoc:n,propDefinitions:o,stateDefinitions:i,useDefaultProps:s,cmsIdentifiersByCtxId:r={},projectType:c,customAttrParser:d}=e;if(Object.keys(t||{}).length)return h({},Object.keys(t||{}).reduce(((e,p)=>{var u;if(!p.length)return e;const y=t[p];if(!y)return e;let m="hierarchy"===y.type?new a.F(h({},y)):y.toUIDL();if(!m)return e;if("static"===m.type){const e=n.pages.byId[y.content.toString()||""];m.content=(null===e||void 0===e?void 0:e.resolvedUrl)||m.content,c!==l.o.HTML||null===e||void 0===e||!e.resolvedUrl||null!==e&&void 0!==e&&e.resolvedUrl.includes(".html")||(m.content=`${null===e||void 0===e?void 0:e.resolvedUrl}.html`)}if("dynamic"===m.type&&"dynamic"===y.type&&"ctx"===y.content.referenceType&&r[y.content.ctxId||""]){const{refPath:e=[],refPathPrefix:t=[],ctxId:n}=y.content;m={type:"expr",content:S([...t,...e],[r[n||""]],y.content.fallbackValue)}}if("dynamic"===(null===(u=m)||void 0===u?void 0:u.type)&&"dynamic"==y.type&&"prop"===y.content.referenceType){const e=E(o,y.content.id);if(!e)throw new Error(`Referenced prop is missing from propDefinitions - ${y.content.id}`);if(s){m=new a.F({content:o[e].defaultValue}).toUIDL()}else m.content.id=e}if("dynamic"===m.type&&"dynamic"==y.type&&"state"===y.content.referenceType){const e=E(i,y.content.id);if(!e)throw new Error(`Referenced state is missing from stateDefinitions - ${y.content.id}`);if(s){m=new a.F({content:i[e].defaultValue}).toUIDL()}else m.content.id=e}if(d){const{parsedAttr:t,extraGeneratedAttrs:n}=d(m);m=t,n&&Object.keys(n).forEach((t=>{e[t]=n[t]}))}return e[p]=m,e}),{}))},x=(e,t,n)=>Object.keys(e).reduce(((o,i)=>{const s=e[i],{reference:r,value:a,condition:c}=s;for(const e of null!==(l=null===c||void 0===c?void 0:c.conditions)&&void 0!==l?l:[]){var l;"!="===e.operation&&(e.operation="!=="),"=="===e.operation&&(e.operation="===")}if("dynamic"===r.type&&"ctx"===r.content.referenceType)throw new Error('Reference type "ctx" is not supported in UIDL yet.');const d=r.id||r.content.id,u="prop"===r.content.referenceType?E(t,d):E(n,d);return o[i]=new p.v({reference:h(h({},r),{},{id:u,content:h(h({},r.content),{},{id:u})}),value:a,condition:c}),o}),{})},305263:function(e,t,n){var o,i,s,r,a,c,l,d,p,u=n(503348),h=n(777460),y=n(918437),m=n(559196),f=n(302503),g=n(395942),_=n(440516),b=n(781872),I=n(4427);o=(0,f.provide)("userPermissionGuardService"),i=(0,f.inject)("projectUIState"),s=(0,f.inject)("projectDoc"),r=(0,f.inject)("studioAPIService"),o((c=class{constructor(){(0,u.Z)(this,"projectUIState",l,this),(0,u.Z)(this,"projectDoc",d,this),(0,u.Z)(this,"studioAPI",p,this),(0,h.Z)(this,"operationsDisabled",!1),(0,h.Z)(this,"addSocketConnectionRequiredGuard",(()=>{const e=Object.values(m.l),t=(0,I.G)();e.forEach((e=>this.studioAPI.attachHook(e,{onStart:()=>{var e;if(!this.projectUIState.projectLoaded)return!0;return!((null===(e=t.socketConnection)||void 0===e?void 0:e.readyState)!==WebSocket.OPEN&&t.wasInitializedOnce)}})))})),(0,h.Z)(this,"guardReadOnlyProject",(()=>{this.projectUIState.readonly&&((0,g.mutate)(this.projectUIState,(({layout:e})=>{e.sidebarPanel=_.tI.FILES,e.visibleInspector=_.dG.ADVANCED})),this.disableWriteOperations(),this.disableButtons())})),(0,h.Z)(this,"guardReadOnlyDevProject",(()=>{if(!this.projectUIState.readonly)return;const{elements:e}=this.studioAPI;e&&(e.dev.search&&(e.dev.search.disabled=!0),e.dev.sourceControl&&(e.dev.sourceControl.disabled=!0),e.dev.syncProject&&(e.dev.syncProject.disabled=!0),e.dev.upload&&(e.dev.upload.disabled=!0,e.dev.upload.onclick=e=>{e.preventDefault(),e.stopPropagation()}),e.dev.prettify&&(e.dev.prettify.disabled=!0),e.dev.options&&(e.dev.options.disabled=!0),e.dev.externalDependency&&(e.dev.externalDependency.disabled=!0,e.dev.externalDependency.onclick=e=>{e.preventDefault(),e.stopPropagation()}))})),(0,h.Z)(this,"enableWriteOperations",(()=>{this.studioAPI.detachAllHooks(),this.operationsDisabled=!1,this.addSocketConnectionRequiredGuard()}))}disableWriteOperations(){if(this.operationsDisabled)return;Object.values(m.l).forEach((e=>this.studioAPI.attachHook(e,{onStart:()=>!1}))),this.operationsDisabled=!0}disableButtons(){const{elements:e}=this.studioAPI;e&&(e.sidebar.elements&&(e.sidebar.elements.disabled=!0),e.sidebar.assetsManager&&(e.sidebar.assetsManager.disabled=!0),e.sidebar.cssClasses&&(e.sidebar.cssClasses.disabled=!0),e.sidebar.cms&&(e.sidebar.cms.disabled=!0),e.header.publish&&(e.header.publish.disabled=!0),e.header.projectSettings&&(e.header.projectSettings.disabled=!0,e.header.projectSettings.href="/",e.header.projectSettings.style.color=b.DM.GRAY_700,e.header.projectSettings.onclick=e=>{e.preventDefault(),e.stopPropagation()}))}},l=(0,y.Z)(c.prototype,"projectUIState",[i],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),d=(0,y.Z)(c.prototype,"projectDoc",[s],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),p=(0,y.Z)(c.prototype,"studioAPI",[r],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),a=c))},656733:function(e,t,n){let o;n.d(t,{_:function(){return o}}),function(e){e.DISABLE_HISTORY="disableHistory",e.VIRTUAL_WORK="virtualWork"}(o||(o={}))},159364:function(e,t,n){var o,i,s,r,a,c,l,d,p,u=n(503348),h=n(918437),y=n(302503),m=n(4427);o=(0,y.provide)("websocketMessageHandler"),i=(0,y.inject)("rtcFlow"),s=(0,y.inject)("projectChangesFlow"),r=(0,y.inject)("slugChangeFlow"),o((c=class{constructor(){(0,u.Z)(this,"rtcFlow",l,this),(0,u.Z)(this,"projectChangesFlow",d,this),(0,u.Z)(this,"slugChangeFlow",p,this)}handleMessage(e){if(!e.custom)return;const t=(0,m.G)();e.connectedAt?this.rtcFlow.saveConnectedAtInfo(e.connectedAt):12!==e.code?14!==e.code?15!==e.code?16!==e.code?17!==e.code?18!==e.code?19!==e.code?20!==e.code?t.onMessageHandler&&t.onMessageHandler(e):this.projectChangesFlow.handleLimitationIncrement("codeGenerationCount",e.teamId,e.count):this.projectChangesFlow.handleLimitationIncrement("aiTextGenerationCount",e.teamId,e.count):this.projectChangesFlow.handleCMSDisable():this.projectChangesFlow.handleAccessTypeUpdate(null===e||void 0===e?void 0:e.accessType):this.projectChangesFlow.handleApplicationUpdate():this.slugChangeFlow.handleProjectSlugUpdated(null===e||void 0===e?void 0:e.slug):this.projectChangesFlow.handleProjectAccessDenied():this.projectChangesFlow.handleProjectDeleted()}},l=(0,h.Z)(c.prototype,"rtcFlow",[i],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),d=(0,h.Z)(c.prototype,"projectChangesFlow",[s],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),p=(0,h.Z)(c.prototype,"slugChangeFlow",[r],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),a=c))},815184:function(e,t,n){var o,i,s,r,a,c,l,d,p,u,h,y=n(503348),m=n(777460),f=n(918437),g=n(638852),_=n(395942),b=n(461423),I=n(4427),v=(n(832501),n(302503));o=(0,v.provide)("sharedbProjectSyncService"),i=(0,v.inject)("websocketMessageHandler"),s=(0,v.inject)("notificationsManagementFlow"),r=(0,v.inject)("sentryService"),a=(0,v.inject)("projectRepository"),o((l=class{constructor(){(0,y.Z)(this,"websocketMessageHandler",d,this),(0,y.Z)(this,"notificationsManagementFlow",p,this),(0,y.Z)(this,"sentryService",u,this),(0,y.Z)(this,"projectRepository",h,this),(0,m.Z)(this,"uidlDocumentSyncDB",void 0),(0,m.Z)(this,"socketConnection",null),(0,m.Z)(this,"mutate",((e,t)=>{const n=(0,_.mutate)(e,t);if(n&&n.length){if("connected"!==this.uidlDocumentSyncDB.connection.state)throw new Error("Socket connection is not active");this.uidlDocumentSyncDB.submitOp((0,b.j)(n)),g.Z.mixpanelEvent(g.Z.AnalyticsEvents.PROJECT_OPERATION)}return null!==n&&void 0!==n?n:[]})),(0,m.Z)(this,"mutateFromPatches",((e,t)=>{(0,_.mutateFromPatches)(e,t),t&&t.length&&this.uidlDocumentSyncDB.submitOp((0,b.j)(t))}))}async init(e){var t;const o=await Promise.all([n.e(47483),n.e(17526)]).then(n.t.bind(n,17526,19)),i=(0,I.G)();if(this.socketConnection=i.connect(e.projectId,e.onConnectionLost),!this.socketConnection)return;switch(this.socketConnection.addEventListener("open",(()=>e.onSocketStatus("active"))),this.socketConnection.addEventListener("close",(()=>e.onSocketStatus("disconnected"))),this.socketConnection.addEventListener("error",(()=>e.onSocketStatus("error"))),this.socketConnection.readyState){case 1:e.onSocketStatus("active");break;case 0:e.onSocketStatus("reconnect");break;default:e.onSocketStatus("error")}const s=new o.Connection(this.socketConnection);this.uidlDocumentSyncDB=s.get("project",e.projectId),s.on("receive",(e=>{const t=e.data;if(t.custom&&t.error&&this.sentryService.captureException(new Error(t.error)),t.custom)return this.websocketMessageHandler.handleMessage(e.data),void(e.data=null)})),s.on("state",(t=>{"connected"===t&&e.onConnectionOpen(),"disconnected"===t&&e.onConnectionLost()}));const r=performance.now(),a=await this.projectRepository.loadProjectSnapshot(e.documentSlug),c=performance.now();if(a)try{this.projectRepository.storeLoadingTime(e.projectId,c-r)}catch(l){}return this.uidlDocumentSyncDB.data=null===a||void 0===a||null===(t=a.snapshot)||void 0===t?void 0:t.data,await new Promise(((e,t)=>{this.uidlDocumentSyncDB.subscribe((n=>{n?t(n):e(!0)}))})),void 0===this.uidlDocumentSyncDB.data&&await new Promise(((t,n)=>{this.uidlDocumentSyncDB.create(e.generateDefault(),(e=>{e?n(e):t(!0)}))})),this.uidlDocumentSyncDB.subscribe((e=>{e&&this.sentryService.captureException(new Error(e.message))})),this.uidlDocumentSyncDB.on("op",((t,n)=>{if(n)return e.onClient(t);e.onServerOp(t)})),this.uidlDocumentSyncDB.on("error",(e=>{this.sentryService.captureException(new Error(e.message)),this.notificationsManagementFlow.handleError("Something went wrong")})),this.uidlDocumentSyncDB.data}},d=(0,f.Z)(l.prototype,"websocketMessageHandler",[i],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),p=(0,f.Z)(l.prototype,"notificationsManagementFlow",[s],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),u=(0,f.Z)(l.prototype,"sentryService",[r],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),h=(0,f.Z)(l.prototype,"projectRepository",[a],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),c=l))},461423:function(e,t,n){n.d(t,{j:function(){return o},J:function(){return i}});const o=e=>e.map((e=>"add"!==e.op||e.old?"remove"===e.op?{p:e.pathArray,od:e.old}:{p:e.pathArray,od:e.old,oi:e.value}:{p:e.pathArray,oi:e.value})),i=e=>e.map((e=>{const{p:t}=e,n=t.join(".");if(e.hasOwnProperty("oi")&&e.hasOwnProperty("od"))return{op:"replace",pathArray:t,path:n,value:e.oi,old:e.od};if(e.hasOwnProperty("od"))return{op:"remove",pathArray:t,path:n,value:void 0,old:e.od};if(e.hasOwnProperty("oi"))return{op:"add",pathArray:t,path:n,value:e.oi};throw new Error(`Unknow patch encountered,\n ${JSON.stringify(e,null,2)}`)}))},4427:function(e,t,n){n.d(t,{G:function(){return h}});var o,i,s,r=n(503348),a=n(777460),c=n(918437),l=n(755476),d=n(302503);let p=(o=(0,d.inject)("authService"),i=class{constructor(){(0,r.Z)(this,"authService",s,this),(0,a.Z)(this,"onMessageHandler",void 0),(0,a.Z)(this,"socketConnection",null),(0,a.Z)(this,"onConnectionLost",void 0),(0,a.Z)(this,"statusCheckInterval",null),(0,a.Z)(this,"keepAliveTimeout",null),(0,a.Z)(this,"reconnectTimeout",null),(0,a.Z)(this,"reconnectionCount",0),(0,a.Z)(this,"wasInitializedOnce",!1)}connect(e,t){return this.socketConnection=new l.XY((async()=>{const t=await this.authService.getAuthUserAsync();t||console.error("Could not get auth user");const n=t?await t.getIdToken():"";return`wss://playground-api-production-v5.services.teleporthq.io/ws/${e}?token=${n}`}),void 0,{maxRetries:1e3}),this.onConnectionLost=t,this.keepAliveTimeout=setInterval((()=>{var e;null===(e=this.socketConnection)||void 0===e||e.send(JSON.stringify({custom:!0,type:"keepalive"}))}),3e3),this.socketConnection.addEventListener("open",(()=>{this.wasInitializedOnce||(this.wasInitializedOnce=!0),this.reconnectionCount=0})),this.socketConnection.addEventListener("close",(e=>{null!==e&&void 0!==e&&e.wasClean||this.reconnectSocket()})),window.addEventListener("online",(()=>{var e,t;(null===(e=this.socketConnection)||void 0===e?void 0:e.readyState)===(null===(t=this.socketConnection)||void 0===t?void 0:t.CLOSED)&&this.reconnectSocket()})),window.addEventListener("offline",(()=>{var e,t;if((null===(e=this.socketConnection)||void 0===e?void 0:e.readyState)===(null===(t=this.socketConnection)||void 0===t?void 0:t.OPEN)){var n;null===(n=this.socketConnection)||void 0===n||n.close();const e=setTimeout((()=>{this.reconnectSocket(),clearTimeout(e)}),100)}})),this.socketConnection}reconnectSocket(){var e,t;this.onConnectionLost&&this.onConnectionLost(),this.reconnectionCount+=1,null===(e=this.socketConnection)||void 0===e||e.close(),null===(t=this.socketConnection)||void 0===t||t.reconnect(),this.reconnectTimeout&&clearTimeout(this.reconnectTimeout),this.reconnectTimeout=setTimeout((()=>{var e,t;(null===(e=this.socketConnection)||void 0===e?void 0:e.readyState)!==(null===(t=this.socketConnection)||void 0===t?void 0:t.OPEN)&&this.reconnectSocket()}),this.reconnectionCount>2?5e3:2e3)}attachMessageHandler(e){return e?(this.onMessageHandler=t=>{e(t)},this.socketConnection):null}destroy(){var e;this.statusCheckInterval&&clearInterval(this.statusCheckInterval),this.keepAliveTimeout&&clearInterval(this.keepAliveTimeout),null===(e=this.socketConnection)||void 0===e||e.close()}},s=(0,c.Z)(i.prototype,"authService",[o],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),i),u=null;const h=()=>(u||(u=new p),u)},694829:function(e,t,n){n.d(t,{d3:function(){return l},Vu:function(){return y},lf:function(){return u},w0:function(){return m},ux:function(){return d},oD:function(){return p},Uc:function(){return h}});var o=n(777460),i=n(233475);var s={[i.sO.TEXTINPUT]:"input",[i.sO.CHECKBOX]:"input[type=checkbox]",[i.sO.RADIOBUTTON]:"input[type=radio]",[i.sO.LINK]:"a",[i.sO.IMAGE]:"img",[i.sO.ICON]:"svg"},r=n(369202);function a(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function c(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?a(Object(n),!0).forEach((function(t){(0,o.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):a(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}const l={primaryColor:"#0089be",backgroundColor:"#fff",borderRadius:"4px",borderWidth:"1px",fontSize:"16px",color:"#2b2b2b",lineHeight:"1.55",fontFamily:'-apple-system, BlinkMacSystemFont, "Segoe UI", "Roboto", "Oxygen","Ubuntu", "Cantarell", "Fira Sans","Droid Sans", "Helvetica Neue", sans-serif',fontStyle:"normal",letterSpacing:"normal"},d=()=>({[i.RY.PARAGRAPH]:{},[i.RY.SPAN]:{display:"inline"},[i.RY.HEADING1]:{fontWeight:"bold",fontSize:"2em"},[i.RY.HEADING2]:{fontWeight:"bold",fontSize:"1.5rem"},[i.RY.HEADING3]:{fontWeight:"bold",fontSize:"1.17em"},[i.RY.HEADING4]:{fontWeight:"bold",fontSize:"1em"},[i.RY.HEADING5]:{fontWeight:"bold",fontSize:"0.83em"},[i.RY.HEADING6]:{fontWeight:"bold",fontSize:"0.67em"}}),p=e=>{var t;return{[i.sO.FORM]:{margin:"0px"},[i.sO.TEXT]:{display:"block",color:null!==(t=null===e||void 0===e?void 0:e.color)&&void 0!==t?t:l.color}}},u=(e,t,n)=>{var o,i,s,r,a,c,d,p;return`\n  html {\n    font-family: ${null!==(o=null===e||void 0===e?void 0:e.fontFamily)&&void 0!==o?o:l.fontFamily};\n    font-size: ${null!==(i=null===e||void 0===e?void 0:e.fontSize)&&void 0!==i?i:l.fontSize};\n  }\n\n  body {\n    font-weight: ${null===e||void 0===e?void 0:e.fontWeight};\n    font-style:${null!==(s=null===e||void 0===e?void 0:e.fontStyle)&&void 0!==s?s:l.fontStyle};\n    text-decoration: ${null===e||void 0===e?void 0:e.textDecoration};\n    text-transform: ${null===e||void 0===e?void 0:e.textTransform};\n    letter-spacing: ${null!==(r=null===e||void 0===e?void 0:e.letterSpacing)&&void 0!==r?r:l.letterSpacing};\n    line-height: ${null!==(a=e.lineHeight)&&void 0!==a?a:l.lineHeight};\n    color: ${null!==(c=e.color)&&void 0!==c?c:l.color};\n    background: ${null!==(d=e.background)&&void 0!==d?d:l.backgroundColor};\n    ${t?"user-select: none;":""}\n    ${n?`fill: ${null!==(p=e.color)&&void 0!==p?p:l.color};`:null}\n  }\n\n  ${t?"*:focus { \n outline: none; \n }":""}\n\n  `},h=()=>`\n  .${r.w.SHOW} {\n    display: flex !important;\n    visibility: visible !important;\n    opacity: 1 !important;\n  }\n  .${r.w.TRANSLATE_TO_DEFAULT} {\n    transform: none !important;\n  }\n  `,y=(e,t)=>{const n=p(e);return Object.keys(n).reduce(((e,o)=>{const i=Object.keys(n[o]).reduce(((e,t)=>`${e} ${t.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase()}: ${n[o][t]};`),"");let r=`${s[o]||o} { ${i} }`;return"link"===o&&t&&(r=`[data-ability="link"], ${r}`),`${e} ${r}`}),"")},m=e=>{var t,n;const o=null===(t=e.getTokenWithRole("background-color"))||void 0===t?void 0:t.id,i=null===(n=e.getTokenWithRole("foreground-color"))||void 0===n?void 0:n.id,s=e.getTokensAsCustomProperties(),r=e.getDefaultTextStyle(),{content:a}=r||{};return c(c(c({},i?{color:`var(${s[i].name})`}:null),o?{background:`var(${s[o].name})`}:null),Object.keys(a||{}).reduce(((e,t)=>{const n=a[t];if("static"===(null===n||void 0===n?void 0:n.type)){if("string"!==typeof n.content&&"number"!==typeof n.content)throw new Error("The value was not a string or number. This case is not supported yet and might require a re-write of the rendering system.");e[t]=n.content}return e}),{}))}},369202:function(e,t,n){let o;n.d(t,{w:function(){return o}}),function(e){e.SHOW="thq-show",e.TRANSLATE_TO_DEFAULT="thq-translate-to-default"}(o||(o={}))},642112:function(e,t,n){n.d(t,{f:function(){return c}});var o=n(777460),i=n(461778),s=n(239031);function r(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function a(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?r(Object(n),!0).forEach((function(t){(0,o.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):r(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}const c=e=>{const{staticOrDynamicNode:t,pageOrComp:n}=e,o=s.q.Instance;if(t){if("dynamic"===t.type){if("token"===t.content.referenceType)return;const{referenceType:s,refPath:p}=t.content;switch(s){case"prop":if(!n)return;if(n instanceof i.n){var r;const e=null!==p&&void 0!==p&&p.length?`.${p.join(".")}`:"";return{contentValue:a(a({},n.propDefinitions[t.content.id]),{},{label:`${null===(r=n.propDefinitions[t.content.id])||void 0===r?void 0:r.name}${e}`,refPath:p}),referenceType:s,id:t.id}}return;case"locale":{var c,l;const e=null===(c=t.content.refPath)||void 0===c?void 0:c[0];return{contentValue:e&&null!==(l=o.getDefaultStaticTextValueForTranslationKey({key:e}))&&void 0!==l?l:"",referenceType:s,id:t.id}}case"state":if(n instanceof i.n){var d;const e=null!==p&&void 0!==p&&p.length?`.${p.join(".")}`:"";return{contentValue:a(a({},n.stateDefinitions[t.content.id]),{},{label:`${null===(d=n.stateDefinitions[t.content.id])||void 0===d?void 0:d.name}${e}`,refPath:p}),referenceType:s,id:t.id}}return;case"global":{const{refPath:e}=t.content;if(!e)throw new Error("Got an attribute with a dynamic reference to ctx but no refPath");const n=[...e];return n.length>1&&n.pop(),{contentValue:{id:n.join("__"),name:e[e.length-1],defaultValue:"Fallback value",declarationType:"global"},referenceType:s,id:t.id}}case"ctx":{const{ctxId:n}=t.content;if(!n)throw new Error("Got an attribute with a dynamic reference to ctx but no ctxId");const o=t.content.refPath;if(!o)throw new Error("Got an attribute with a dynamic reference to ctx but no refPath");let i=[...o].join(".");!i&&e.computeFallbackNameValue&&(i=e.computeFallbackNameValue(n));return{contentValue:{id:n,name:i,defaultValue:"Fallback value",declarationType:"ctx",label:i,refPath:o},referenceType:s,id:t.id}}case"expr":const{id:u}=t.content;return{contentValue:u,id:t.id}}}return{contentValue:"object"===typeof t.content?JSON.stringify(t.content):String(t.content),id:t.id}}}},829470:function(e,t,n){n.d(t,{uj:function(){return o},iq:function(){return i},t7:function(){return s},uZ:function(){return r}});const o=(e,t)=>{const n=e/2,o=t/2;return[e<t?-n:-e+o,e<t?t-n:o]},i=(e,t,n)=>0===n-t?0:(e-t)/(n-t),s=(e,t,n)=>e*(n-t)+t,r=(e,t,n)=>Math.min(n,Math.max(e,t))},493335:function(e,t,n){var o=n(503348),i=n(777460),s=n(918437),r=n(302503),a=n(205632),c=n(395942),l=n(918939),d=n(329852),p=n(975350),u=n(608872),h=n(491463),y=n(422169),m=(n(202784),n(173541)),f=n(884481),g=n(552322);const _=e=>{const{onDismiss:t,secretKey:n,onSubmit:o}=e;return(0,g.jsxs)("div",{children:[(0,g.jsxs)("div",{className:"modal-title",children:["Delete secret-",(0,g.jsx)("strong",{children:n})]}),(0,g.jsxs)("p",{className:"warning-message",children:["Are you sure you want to delete secret: ",(0,g.jsx)("strong",{children:n})," from the project?"]}),(0,g.jsxs)("div",{className:"modal-btns",children:[(0,g.jsx)(m.z,{style:"solid",colorScheme:"neutral",onClick:t,children:"Cancel"}),(0,g.jsx)(m.z,{style:"solid",colorScheme:"danger",onClick:o,children:"Delete"})]}),(0,g.jsx)("style",{children:f.W2})]})};var b,I,v,w,O,j,S,N,D,E,T,P,C,x,A,F,k,R,M;function U(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function Z(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?U(Object(n),!0).forEach((function(t){(0,i.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):U(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}b=(0,r.provide)("projectManagementFlow"),I=(0,r.inject)("sharedbProjectSyncService"),v=(0,r.inject)("projectDoc"),w=(0,r.inject)("projectUIState"),O=(0,r.inject)("assetsUploadFlow"),j=(0,r.inject)("assetsEditFlow"),S=(0,r.inject)("projectRepository"),N=(0,r.inject)("notificationsManagementFlow"),D=(0,r.inject)("modalManagementFlow"),b((T=class{constructor(){(0,o.Z)(this,"dbSync",P,this),(0,o.Z)(this,"projectDoc",C,this),(0,o.Z)(this,"projectUIState",x,this),(0,o.Z)(this,"assetsUploadFlow",A,this),(0,o.Z)(this,"assetsEditFlow",F,this),(0,o.Z)(this,"projectRepository",k,this),(0,o.Z)(this,"notificationsManagementFlow",R,this),(0,o.Z)(this,"modalManagementFlow",M,this)}updateSettings(e){this.dbSync.mutate(this.projectDoc,(t=>{t.settings=e}))}async updateIntegrationTokens(e){await this.projectRepository.update(this.projectDoc.id,e);const t=Z(Z({},null!==e&&void 0!==e&&e.githubToken?{githubToken:!0}:{githubToken:null}),null!==e&&void 0!==e&&e.vercelToken?{vercelToken:!0}:{vercelToken:null});return(0,c.mutate)(this.projectUIState,(e=>{e.tokens=t})),t}async changeProjectTitle(e){try{await this.projectRepository.update(this.projectDoc.id,{name:e}),(0,c.mutate)(this.projectUIState,(t=>{t.title=e}))}catch(t){throw new Error("There was a problem updating the project title")}}async redirectToProject(){const e=this.projectUIState.selection.componentId||this.projectDoc.pages.getHomePageId()||this.projectDoc.pages.getIds()[0];a.default.push((0,p.aZ)("[slug]","[compId]"),(0,p.aZ)(this.projectUIState.slug,e))}async uploadSettingsImage(e,t){const n=[];Object.values(this.projectDoc.assets.byId||{}).forEach((e=>{e.type===t&&n.push(e.id)})),this.assetsEditFlow.delete(n);const o=this.assetsUploadFlow.upload({files:e,assetType:t,parentFolderId:d.D.PUBLIC_ASSETS});if(t===l.K.PROJECT_OG_IMAGE){const e=await o;if(null===e||void 0===e||!e.length)return o;this.projectRepository.update(this.projectDoc.id,{socialImage:e[0].path})}return o}async upsertSecrets(e){if(!Object.keys(e).length)return this.projectUIState.secrets;try{return Object.keys(e).forEach((t=>{const n=this.getUniqueNameForSecret(t);n!==t&&(e[n]=e[t],delete e[t])})),await this.projectRepository.upsertSecrets(this.projectDoc.id,e),(0,c.mutate)(this.projectUIState,(t=>{t.secrets=Z(Z({},t.secrets),e)})),this.projectUIState.secrets}catch(t){return this.notificationsManagementFlow.handleErrorAndLogToSentry(t,"Coult not upsert secrets. Please try again."),null}}getUniqueNameForSecret(e){return Object.keys(this.projectUIState.secrets).includes(e)?(0,h.Zu)(Object.keys(this.projectUIState.secrets),(0,u.Lp)(e)):e}async upsertSecret(e,t,n=!1){try{const o=this.projectUIState.secrets[e]===t;if(!n&&o)return this.projectUIState.secrets;const i=n?(0,h.Zu)(Object.keys(this.projectUIState.secrets),(0,u.Lp)(e)):e;return await this.projectRepository.upsertSecrets(this.projectDoc.id,{[i]:t}),(0,c.mutate)(this.projectUIState,(e=>{e.secrets=Z(Z({},e.secrets),{},{[i]:t})})),this.projectUIState.secrets}catch(o){return this.notificationsManagementFlow.handleErrorAndLogToSentry(o,"Coult not upsert secret(s). Please try again."),null}}async removeSecretByKey(e){return new Promise((t=>{const n=y.d.createCustomModal({data:{secretKey:e},Component:_,onSubmit:async()=>{const n=await this.removeSecret(e);this.modalManagementFlow.hideModal(),t(n)},onDismiss:()=>{this.modalManagementFlow.hideModal(),t(null)}});this.modalManagementFlow.showModal(n)}))}async removeSecret(e){try{return await this.projectRepository.removeSecretByKey(this.projectDoc.id,e),(0,c.mutate)(this.projectUIState,(t=>{delete t.secrets[e]})),this.projectUIState.secrets}catch(t){return this.notificationsManagementFlow.handleErrorAndLogToSentry(t,"Coult not remove secret. Please try again."),null}}},P=(0,s.Z)(T.prototype,"dbSync",[I],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),C=(0,s.Z)(T.prototype,"projectDoc",[v],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),x=(0,s.Z)(T.prototype,"projectUIState",[w],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),A=(0,s.Z)(T.prototype,"assetsUploadFlow",[O],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),F=(0,s.Z)(T.prototype,"assetsEditFlow",[j],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),k=(0,s.Z)(T.prototype,"projectRepository",[S],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),R=(0,s.Z)(T.prototype,"notificationsManagementFlow",[N],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),M=(0,s.Z)(T.prototype,"modalManagementFlow",[D],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),E=T))},608872:function(e,t,n){n.d(t,{iS:function(){return o},lz:function(){return i},Lp:function(){return s},Eh:function(){return r}});const o=e=>e.replace(/[A-Z]+(?![a-z])|[A-Z]/g,((e,t)=>(t?"-":"")+e.toLowerCase())).trim().replace(/\ /g,""),i=e=>e.replace(/([^:])(\/\/+)/g,"$1/"),s=e=>e.trim().replaceAll(" ","_"),r=(e,t)=>{const n=parseInt((e.match(/\d+$/)||[])[0]||"",10)||0,o=parseInt((t.match(/\d+$/)||[])[0]||"",10)||0,i=e.replace(/\d+$/,""),s=t.replace(/\d+$/,"");return i===s?n-o:i.localeCompare(s)}},832501:function(e,t,n){n.d(t,{Z:function(){return Ke}});var o=n(777460),i=n(378366);const s=e=>(0,i.G0)(e,(0,i.a9)(null));class r extends Error{constructor(e){super(e)}}var a=n(813244),c=n(851913),l=n(761328);const d=(0,i.G0)((0,i.Vo)((()=>p)),(0,i.Vo)((()=>u))),p=(0,i.Ry)({id:(0,i.Z_)(),type:(0,i.a9)("static"),content:(0,i.G0)((0,i.Z_)(),(0,i.Rx)()),pos:(0,i.Z_)()}),u=(0,i.Ry)({id:(0,i.Z_)(),type:(0,i.a9)("dynamic"),content:(0,i.Vo)((()=>h)),pos:(0,i.Z_)()}),h=(0,i.Ry)({referenceType:(0,i.G0)((0,i.a9)("prop"),(0,i.a9)("token"),(0,i.a9)("state")),id:(0,i.Z_)(),defaultValue:(0,i.jt)((0,i.Z_)())}),y=(0,i.G0)((0,i.Vo)((()=>m)),(0,i.Vo)((()=>f)),(0,i.Vo)((()=>g)),(0,i.Vo)((()=>_)),(0,i.Vo)((()=>b))),m=(0,i.Ry)({type:(0,i.a9)("style-map"),id:(0,i.Z_)(),content:(0,i.Ry)({mapType:(0,i.a9)("design-language-referenced"),referenceId:(0,i.Z_)()})}),f=(0,i.Ry)({type:(0,i.a9)("style-map"),id:(0,i.Z_)(),content:(0,i.Ry)({mapType:(0,i.a9)("inlined"),conditions:(0,i.jt)((0,i.IX)((0,i.Vo)((()=>I)))),styles:(0,i.dz)((0,i.G0)((0,i.Vo)((()=>p)),(0,i.Vo)((()=>u))))})}),g=(0,i.Ry)({type:(0,i.a9)("style-map"),id:(0,i.Z_)(),content:(0,i.Ry)({mapType:(0,i.a9)("project-referenced"),conditions:(0,i.jt)((0,i.IX)((0,i.Vo)((()=>I)))),referenceId:(0,i.Z_)()})}),_=(0,i.Ry)({type:(0,i.a9)("style-map"),id:(0,i.Z_)(),content:(0,i.Ry)({mapType:(0,i.a9)("component-referenced"),content:(0,i.Ry)({type:(0,i.a9)("static"),content:(0,i.Z_)()})})}),b=(0,i.Ry)({type:(0,i.a9)("style-map"),id:(0,i.Z_)(),content:(0,i.Ry)({mapType:(0,i.a9)("component-referenced"),content:(0,i.Ry)({type:(0,i.a9)("dynamic"),content:(0,i.Ry)({referenceType:(0,i.G0)((0,i.a9)("comp"),(0,i.a9)("prop")),id:(0,i.Z_)()})})})}),I=(0,i.G0)((0,i.Vo)((()=>v)),(0,i.Vo)((()=>w))),v=(0,i.Ry)({conditionType:(0,i.a9)("screen-size"),maxHeight:(0,i.jt)((0,i.Rx)()),maxWidth:(0,i.jt)((0,i.Rx)()),minHeight:(0,i.jt)((0,i.Rx)()),minWidth:(0,i.jt)((0,i.Rx)())}),w=(0,i.Ry)({conditionType:(0,i.a9)("element-state"),content:(0,i.Vo)((()=>O))}),O=(0,i.G0)((0,i.a9)(l.F.hover),(0,i.a9)(l.F.focus),(0,i.a9)(l.F.active),(0,i.a9)(l.F.disabled),(0,i.a9)(l.F.checked),(0,i.a9)(l.F["focus-visible"]),(0,i.a9)(l.F["focus-within"])),j=(0,i.Ry)({type:(0,i.a9)("component"),title:(0,i.Z_)(),id:(0,i.Z_)(),pos:(0,i.Z_)(),rootNodeId:(0,i.jt)((0,i.Z_)()),instantiatedByNodes:(0,i.dz)((0,i.O7)()),usedComponents:(0,i.dz)((0,i.Rx)()),stateDefinitions:(0,i.dz)((0,i.Vo)((()=>D))),propDefinitions:(0,i.dz)((0,i.Vo)((()=>N))),sectionIds:(0,i.dz)((0,i.Z_)()),styleSetDefinitions:(0,i.dz)((0,i.Vo)((()=>S))),checkerRenderStyle:(0,i.jt)((0,i.Vo)((()=>T)))}),S=(0,i.Ry)({styles:(0,i.dz)((0,i.G0)(p,u)),referencedStyles:(0,i.dz)(y),usedByInstances:(0,i.dz)((0,i.O7)())}),N=(0,i.Ry)({id:(0,i.Z_)(),declarationType:(0,i.a9)("prop"),defaultValue:(0,i.Z_)(),type:(0,i.kw)((0,i.a9)("string"),(0,i.a9)("number"),(0,i.a9)("boolean"),(0,i.a9)("func")),name:(0,i.Z_)(),locations:(0,i.dz)((0,i.dz)((0,i.Vo)((()=>P)))),inputType:(0,i.Vo)((()=>E))}),D=(0,i.Ry)({id:(0,i.Z_)(),declarationType:(0,i.a9)("state"),name:(0,i.Z_)(),type:(0,i.kw)((0,i.a9)("string"),(0,i.a9)("number"),(0,i.a9)("boolean")),defaultValue:(0,i.Z_)(),locations:(0,i.dz)((0,i.dz)((0,i.Vo)((()=>k)))),inputType:(0,i.Vo)((()=>E))}),E=(0,i.kw)((0,i.a9)(a.SO.TEXT),(0,i.a9)(a.SO.TEXT_AREA),(0,i.a9)(a.SO.IMAGE),(0,i.a9)(a.SO.LINK),(0,i.a9)(a.SO.EMAIL),(0,i.a9)(a.SO.PHONE),(0,i.a9)(a.SO.NUMBER),(0,i.a9)(a.SO.SELECT)),T=(0,i.G0)((0,i.a9)(c.wY.WHITE_CHESS),(0,i.a9)(c.wY.BLACK_CHESS)),P=(0,i.Ry)({base:(0,i.Vo)((()=>C)),sufix:(0,i.jt)((0,i.Vo)((()=>x)))}),C=(0,i.kw)((0,i.a9)(a.hD.CONTENT),(0,i.a9)(a.hD.STYLE),(0,i.a9)(a.hD.ATTR),(0,i.a9)(a.hD.ABILITY),(0,i.a9)(a.hD.EVENT)),x=(0,i.G0)((0,i.Vo)((()=>A)),(0,i.Vo)((()=>F))),A=(0,i.G0)((0,i.a9)("src"),(0,i.a9)("alt"),(0,i.a9)("placeholder")),F=(0,i.G0)((0,i.a9)("url"),(0,i.a9)("phone"),(0,i.a9)("mail"),(0,i.a9)("subject")),k=((0,i.kw)((0,i.a9)("click"),(0,i.a9)("mouseenter"),(0,i.a9)("mouseleave"),(0,i.a9)("mouseover"),(0,i.a9)("focus"),(0,i.a9)("blur"),(0,i.a9)("scroll"),(0,i.a9)("keydown"),(0,i.a9)("keyup"),(0,i.a9)("keypress"),(0,i.a9)("change"),(0,i.a9)("submit"),(0,i.a9)("select"),(0,i.a9)("touchstart"),(0,i.a9)("touchend"),(0,i.a9)("load")),(0,i.Ry)({base:(0,i.Vo)((()=>R)),sufix:(0,i.jt)((0,i.Vo)((()=>M)))})),R=(0,i.kw)((0,i.a9)(a.uw.CONTENT),(0,i.a9)(a.uw.ATTR)),M=(0,i.G0)((0,i.a9)("disabled"),(0,i.a9)("defaultValue"),(0,i.a9)("placeholder"),(0,i.a9)("value"),(0,i.a9)("checked"));var U=n(203942),Z=n(930613);const L=(0,i.Ry)({type:(0,i.Vo)((()=>B)),content:(0,i.Vo)((()=>W))}),B=(0,i.Vo)((()=>V)),W=(0,i.G0)((0,i.Vo)((()=>z)),(0,i.Vo)((()=>G)),(0,i.Vo)((()=>$)),(0,i.Vo)((()=>H)),(0,i.Vo)((()=>K))),z=(0,i.Ry)({phone:(0,i.G0)((0,i.Z_)(),(0,i.Vo)((()=>u)))}),$=(0,i.Ry)({url:(0,i.G0)((0,i.Z_)(),(0,i.Vo)((()=>u))),newTab:(0,i.O7)()}),G=(0,i.Ry)({mail:(0,i.G0)((0,i.Z_)(),(0,i.Vo)((()=>u))),subject:(0,i.jt)((0,i.G0)((0,i.Z_)(),(0,i.Vo)((()=>u)))),body:(0,i.jt)((0,i.G0)((0,i.Z_)(),(0,i.Vo)((()=>u))))}),H=(0,i.Ry)({routeName:(0,i.Z_)()}),K=(0,i.Ry)({section:(0,i.Z_)()}),V=(0,i.G0)((0,i.a9)(Z.RZ.URL),(0,i.a9)(Z.RZ.MAIL),(0,i.a9)(Z.RZ.PHONE),(0,i.a9)(Z.RZ.SECTION),(0,i.a9)(Z.RZ.NAVLINK));var Y=n(233475);const J=(0,i.Ry)({type:(0,i.a9)("conditional"),reference:(0,i.Vo)((()=>u)),value:(0,i.kw)((0,i.Z_)())}),X=(0,i.Ry)({id:(0,i.Z_)(),canBeMappedToUIDL:(0,i.O7)(),name:(0,i.jt)(s((0,i.Z_)())),parentId:(0,i.jt)(s((0,i.Z_)())),styles:(0,i.dz)((0,i.G0)(p,u)),tempStyles:(0,i.jt)((0,i.dz)((0,i.G0)(p,u))),devComponentPath:(0,i.jt)(s((0,i.Z_)())),attrs:(0,i.dz)((0,i.G0)(d,(0,i.Ry)({id:(0,i.Z_)(),type:(0,i.a9)("comp-style"),content:(0,i.Z_)()}))),abilities:(0,i.jt)((0,i.dz)(L)),referencedStyles:(0,i.dz)(y),tempInlineStyles:(0,i.dz)(f),events:(0,i.dz)((0,i.dz)((0,i.Vo)((()=>ie)))),childrenIds:(0,i.dz)((0,i.O7)()),contentChildren:(0,i.jt)((0,i.dz)(d)),semanticType:(0,i.jt)(s((0,i.Vo)((()=>ne)))),primitiveType:s((0,i.Vo)((()=>q))),fakeSize:(0,i.jt)(s((0,i.O7)())),pos:(0,i.Z_)(),dependency:(0,i.jt)((0,i.jV)((0,i.Ry)({id:(0,i.Z_)()}),U.dependencyDecoder)),compIdOfCompInstance:(0,i.jt)(s((0,i.Z_)())),compIdOfRootNode:(0,i.jt)(s((0,i.Z_)())),renderingConditions:s((0,i.Vo)((()=>J))),conditionalReferencedProjectStyles:(0,i.dz)((0,i.Vo)((()=>J)))}),q=((0,i.jV)((0,i.Ry)({id:(0,i.Z_)()}),U.dependencyDecoder),(0,i.kw)((0,i.a9)(a.SO.TEXT),(0,i.a9)(a.SO.TEXT_AREA),(0,i.a9)(a.SO.IMAGE),(0,i.a9)(a.SO.LINK),(0,i.a9)(a.SO.EMAIL),(0,i.a9)(a.SO.PHONE),(0,i.a9)(a.SO.BOOLEAN),(0,i.a9)(a.SO.NUMBER),(0,i.a9)(a.SO.SELECT)),(0,i.kw)((0,i.a9)(Y.sO.CONTAINER),(0,i.a9)(Y.sO.TEXT),(0,i.a9)(Y.sO.IMAGE),(0,i.a9)(Y.sO.ICON),(0,i.a9)(Y.sO.VIDEO),(0,i.a9)(Y.sO.FORM),(0,i.a9)(Y.sO.BUTTON),(0,i.a9)(Y.sO.TEXTINPUT),(0,i.a9)(Y.sO.CHECKBOX),(0,i.a9)(Y.sO.RADIOBUTTON),(0,i.a9)(Y.sO.TEXTAREA),(0,i.a9)(Y.sO.IFRAME),(0,i.a9)(Y.sO.COMPONENT),(0,i.a9)(Y.sO.LINK),(0,i.a9)(Y.sO.MIXED),(0,i.a9)(Y.sO.LINEBREAK),(0,i.a9)(Y.sO.DEV_COMPONENT))),Q=(0,i.kw)((0,i.a9)(Y.iX.DIV),(0,i.a9)(Y.iX.ARTICLE),(0,i.a9)(Y.iX.SECTION),(0,i.a9)(Y.iX.ASIDE),(0,i.a9)(Y.iX.NAV),(0,i.a9)(Y.iX.HEADER),(0,i.a9)(Y.iX.MAIN),(0,i.a9)(Y.iX.FOOTER),(0,i.a9)(Y.iX.FIGURE)),ee=(0,i.kw)((0,i.a9)(Y.RY.SPAN),(0,i.a9)(Y.RY.LABEL),(0,i.a9)(Y.RY.STRONG),(0,i.a9)(Y.RY.PARAGRAPH),(0,i.a9)(Y.RY.HEADING1),(0,i.a9)(Y.RY.HEADING2),(0,i.a9)(Y.RY.HEADING3),(0,i.a9)(Y.RY.HEADING4),(0,i.a9)(Y.RY.HEADING5),(0,i.a9)(Y.RY.HEADING6),(0,i.a9)(Y.RY.BOLD),(0,i.a9)(Y.RY.ITALIC),(0,i.a9)(Y.RY.EMPHASIZE),(0,i.a9)(Y.RY.UNDERLINE),(0,i.a9)(Y.RY.STRIKE),(0,i.a9)(Y.RY.DELETED),(0,i.a9)(Y.RY.PRE),(0,i.a9)(Y.RY.CODE),(0,i.a9)(Y.RY.BLOCKQUOTE),(0,i.a9)(Y.RY.FIGCAPTION),(0,i.a9)(Y.RY.CITE)),te=(0,i.kw)((0,i.a9)(Y.qo.PATH)),ne=(0,i.G0)(Q,ee,te,(0,i.a9)(Y.sO.DEV_COMPONENT)),oe=(0,i.Ry)({id:(0,i.Z_)(),type:(0,i.a9)("propCall"),calls:(0,i.Z_)(),args:(0,i.jt)((0,i.IX)((0,i.G0)((0,i.Z_)(),(0,i.Rx)(),(0,i.O7)()))),pos:(0,i.Z_)()}),ie=((0,i.Ry)({id:(0,i.Z_)(),type:(0,i.a9)("stateChange"),modifies:(0,i.Z_)(),newState:(0,i.G0)((0,i.Z_)(),(0,i.Rx)(),(0,i.O7)()),pos:(0,i.Z_)()}),oe),se=(0,i.Ry)({general:(0,i.jt)((0,i.Vo)((()=>ce))),code:(0,i.jt)((0,i.Vo)((()=>ae))),social:(0,i.jt)((0,i.Vo)((()=>re)))}),re=(0,i.Ry)({title:(0,i.jt)((0,i.Z_)()),description:(0,i.jt)((0,i.Z_)()),image:(0,i.jt)((0,i.Z_)())}),ae=(0,i.Ry)({googleAnalyticsId:(0,i.jt)((0,i.Z_)()),tagManagerId:(0,i.jt)((0,i.Z_)()),headTag:(0,i.jt)((0,i.Z_)()),bodyTag:(0,i.jt)((0,i.Z_)())}),ce=(0,i.Ry)({title:(0,i.jt)((0,i.Z_)()),language:(0,i.jt)((0,i.Z_)()),description:(0,i.jt)((0,i.Z_)()),favicon:(0,i.jt)((0,i.Z_)())}),le=(0,i.Ry)({deployments:(0,i.jt)((0,i.Ry)({teleport:(0,i.jt)((0,i.Z_)()),vercel:(0,i.jt)((0,i.Z_)()),custom:(0,i.jt)((0,i.Z_)())}))}),de=(0,i.G0)((0,i.a9)("google"),(0,i.a9)("custom"),(0,i.a9)("system")),pe=(0,i.jV)((0,i.Vo)((()=>ue)),(0,i.Ry)({path:(0,i.Z_)()})),ue=(0,i.Ry)({id:(0,i.Z_)(),name:(0,i.Z_)(),type:de,usedInNodes:(0,i.dz)((0,i.Rx)()),usedInTokens:(0,i.dz)((0,i.O7)()),usedInClasses:(0,i.dz)((0,i.Rx)())}),he=(0,i.Ry)({type:(0,i.a9)("page"),id:(0,i.Z_)(),title:(0,i.Z_)(),pos:(0,i.Z_)(),isHomePage:(0,i.jt)((0,i.O7)()),settings:(0,i.Vo)((()=>ye)),sectionIds:(0,i.dz)((0,i.Z_)()),usedComponents:(0,i.dz)((0,i.Rx)()),rootNodeId:(0,i.jt)((0,i.Z_)())}),ye=(0,i.Ry)({url:(0,i.jt)(s((0,i.Z_)())),seoTitle:(0,i.jt)(s((0,i.Z_)())),seoDescription:(0,i.jt)(s((0,i.Z_)())),socialTitle:(0,i.jt)(s((0,i.Z_)())),socialDescription:(0,i.jt)(s((0,i.Z_)())),socialImage:(0,i.jt)(s((0,i.Z_)())),seoNoIndex:(0,i.jt)((0,i.O7)())}),me=(0,i.Ry)({id:(0,i.Z_)(),name:(0,i.Z_)(),parentId:s((0,i.Z_)()),post:(0,i.jt)((0,i.Z_)()),children:(0,i.Vo)((()=>fe))}),fe=((0,i.G0)((0,i.a9)("folder"),(0,i.a9)("page"),(0,i.a9)("component"),(0,i.a9)("asset")),(0,i.dz)((0,i.G0)((0,i.a9)("folder"),(0,i.a9)("page"),(0,i.a9)("component"),(0,i.a9)("asset"))));var ge=n(918939);const _e=(0,i.kw)((0,i.a9)(ge.K.IMAGE),(0,i.a9)(ge.K.FAVICON),(0,i.a9)(ge.K.PROJECT_OG_IMAGE),(0,i.a9)(ge.K.PAGE_OG_IMAGE),(0,i.a9)(ge.K.VIDEO),(0,i.a9)(ge.K.FILE),(0,i.a9)(ge.K.EDITABLE_FILE)),be=(0,i.Ry)({id:(0,i.Z_)(),name:(0,i.Z_)(),mimetype:(0,i.Z_)(),path:(0,i.Z_)(),type:_e,size:(0,i.Rx)(),usedInNodes:(0,i.dz)((0,i.O7)()),parentFolderId:(0,i.Z_)()});var Ie=n(463540),ve=n(84615);const we=(0,i.Ry)({id:(0,i.Z_)(),name:(0,i.Z_)(),content:(0,i.Vo)((()=>Ne)),identifier:(0,i.Z_)(),type:(0,i.a9)(Ie.i.TEXT_STYLE),categoryId:(0,i.Z_)(),position:(0,i.Rx)(),role:(0,i.jt)((0,i.a9)("default")),usedInNodes:(0,i.dz)((0,i.O7)())}),Oe=(0,i.Ry)({id:(0,i.Z_)(),name:(0,i.Z_)(),section:(0,i.Vo)((()=>Se)),position:(0,i.Rx)()}),je=(0,i.Ry)({id:(0,i.Z_)(),name:(0,i.Z_)(),value:(0,i.Z_)(),type:(0,i.Vo)((()=>De)),categoryId:(0,i.Z_)(),position:(0,i.Rx)(),role:(0,i.jt)((0,i.Vo)((()=>Ee))),usedInNodes:(0,i.dz)((0,i.Rx)())}),Se=(0,i.G0)((0,i.a9)("color"),(0,i.a9)("layout"),(0,i.a9)("typography")),Ne=(0,i.Ry)({fontFamily:(0,i.jt)(d),fontSize:(0,i.jt)(d),lineHeight:(0,i.jt)(d),letterSpacing:(0,i.jt)(d),fontWeight:(0,i.jt)(p),fontStyle:(0,i.jt)(d),textDecoration:(0,i.jt)(p),textTransform:(0,i.jt)(d)}),De=(0,i.kw)((0,i.a9)(Ie.i.COLOR),(0,i.a9)(Ie.i.SIZE),(0,i.a9)(Ie.i.SPACE),(0,i.a9)(Ie.i.RADIUS),(0,i.a9)(Ie.i.TYPEFACE),(0,i.a9)(Ie.i.TEXT_SCALE),(0,i.a9)(Ie.i.TEXT_STYLE)),Ee=(0,i.G0)((0,i.a9)("background-color"),(0,i.a9)("foreground-color")),Te=(0,i.dz)((0,i.Ry)({created:(0,i.Z_)(),framework:(0,i.jt)((0,i.G0)((0,i.a9)(ve.cd.REACT),(0,i.a9)(ve.cd.NEXT)))})),Pe=(0,i.Ry)({id:(0,i.Z_)(),name:(0,i.Z_)(),content:(0,i.Z_)(),path:(0,i.Z_)(),fileType:(0,i.Z_)()});var Ce=n(824497);const xe=(0,i.Ry)({id:(0,i.Z_)(),email:(0,i.Z_)(),name:(0,i.Z_)(),picture:(0,i.Z_)()}),Ae=(0,i.Ry)({id:(0,i.Z_)(),accessType:(0,i.G0)((0,i.a9)(Ce.Z.READ),(0,i.a9)(Ce.Z.WRITE),(0,i.a9)(Ce.Z.OWNER)),account:s(xe),invitedEmail:s((0,i.Z_)()),meta:(0,i.jt)((0,i.HG)())}),Fe=(0,i.Ry)({byId:(0,i.dz)((0,i.Vo)((()=>ke))),categoriesById:(0,i.dz)((0,i.Ry)({name:(0,i.Z_)(),id:(0,i.Z_)()}))}),ke=(0,i.Ry)({id:(0,i.Z_)(),type:(0,i.a9)("reusable-project-style-map"),pos:(0,i.Z_)(),classType:(0,i.a9)("simple-class"),isDefault:(0,i.O7)(),identifier:(0,i.Z_)(),categoryId:(0,i.Z_)(),content:(0,i.dz)(d),conditions:(0,i.dz)((0,i.Vo)((()=>Re))),usedInNodes:(0,i.dz)((0,i.O7)()),linkedTextStyles:(0,i.dz)((0,i.O7)())}),Re=(0,i.G0)((0,i.Vo)((()=>Me)),(0,i.Vo)((()=>Ue))),Me=(0,i.Ry)({id:(0,i.Z_)(),type:(0,i.a9)("screen-size"),content:(0,i.dz)(p),meta:(0,i.Ry)({maxWidth:(0,i.Rx)()})}),Ue=(0,i.Ry)({id:(0,i.Z_)(),type:(0,i.a9)("element-state"),content:(0,i.dz)(d),meta:(0,i.Ry)({state:(0,i.Vo)((()=>O))})});var Ze=n(393181),Le=n(333408);const Be=(0,i.Ry)({local:(0,i.dz)((0,i.Ry)({byId:(0,i.dz)((0,i.Ry)({code:(0,i.Z_)(),is_protected:(0,i.O7)(),created_at:(0,i.jt)((0,i.Rx)()),synced_at:(0,i.jt)((0,i.Rx)()),status:(0,i.jt)((0,i.G0)((0,i.a9)(Le.E.ADDED),(0,i.a9)(Le.E.NEW),(0,i.a9)(Le.E.MODIFIED),(0,i.a9)(Le.E.REMOVED),(0,i.a9)(Le.E.STAGED),(0,i.a9)(Le.E.RENAMED)))}))})),remote:(0,i.dz)((0,i.Ry)({byId:(0,i.dz)((0,i.Ry)({code:(0,i.Z_)(),is_protected:(0,i.O7)(),created_at:(0,i.jt)((0,i.Rx)()),synced_at:(0,i.jt)((0,i.Rx)()),status:(0,i.jt)((0,i.G0)((0,i.a9)(Le.E.ADDED),(0,i.a9)(Le.E.NEW),(0,i.a9)(Le.E.MODIFIED),(0,i.a9)(Le.E.REMOVED),(0,i.a9)(Le.E.STAGED),(0,i.a9)(Le.E.RENAMED)))}))})),staged:(0,i.dz)((0,i.Ry)({byId:(0,i.dz)((0,i.Ry)({code:(0,i.Z_)(),is_protected:(0,i.O7)(),created_at:(0,i.jt)((0,i.Rx)()),synced_at:(0,i.jt)((0,i.Rx)()),status:(0,i.jt)((0,i.G0)((0,i.a9)(Le.E.ADDED),(0,i.a9)(Le.E.NEW),(0,i.a9)(Le.E.MODIFIED),(0,i.a9)(Le.E.REMOVED),(0,i.a9)(Le.E.STAGED),(0,i.a9)(Le.E.RENAMED)))}))})),conflicts:(0,i.dz)((0,i.Vo)((()=>We))),lastSync:s((0,i.Rx)()),lastSave:s((0,i.Rx)()),isAddingExternalDependency:s((0,i.G0)((0,i.a9)(Le.B.ADDING),(0,i.a9)(Le.B.FAILED),(0,i.a9)(Le.B.FAILED)))}),We=(0,i.Ry)({byId:(0,i.dz)((0,i.Vo)((()=>ze))),type:(0,i.G0)((0,i.a9)("pull"),(0,i.a9)("merge")),lastCommitSha:(0,i.Z_)(),headBranch:(0,i.Z_)(),actionInProgress:(0,i.O7)(),solveInProgress:(0,i.O7)()}),ze=(0,i.Ry)({content:(0,i.Z_)(),baseContent:(0,i.Z_)(),newContent:(0,i.Z_)(),resolved:(0,i.O7)(),blocks:(0,i.dz)((0,i.Ry)({startLine:(0,i.Rx)(),endLine:(0,i.Rx)()})),localUsedLines:(0,i.dz)((0,i.IX)((0,i.Ry)({line:(0,i.Rx)(),content:(0,i.Z_)(),editorLine:(0,i.jt)((0,i.Rx)()),source:(0,i.G0)((0,i.a9)("local"),(0,i.a9)("remote"))}))),remoteUsedLines:(0,i.dz)((0,i.IX)((0,i.Ry)({line:(0,i.Rx)(),content:(0,i.Z_)(),editorLine:(0,i.jt)((0,i.Rx)()),source:(0,i.G0)((0,i.a9)("local"),(0,i.a9)("remote"))}))),diffs:(0,i.Ry)({baseDiffs:(0,i.dz)((0,i.Ry)({startLine:(0,i.Rx)(),endLine:(0,i.Rx)(),middleLine:(0,i.Rx)(),negativeRange:(0,i.jt)((0,i.O7)())})),updatedDiffs:(0,i.dz)((0,i.Ry)({startLine:(0,i.Rx)(),endLine:(0,i.Rx)(),middleLine:(0,i.Rx)(),negativeRange:(0,i.jt)((0,i.O7)())}))}),diffsOrder:(0,i.IX)((0,i.Z_)())});var $e=n(414326);const Ge=(0,i.Ry)({settings:se,stats:le,fonts:(0,i.Ry)({byId:(0,i.dz)(pe)}),nodes:(0,i.Ry)({byId:(0,i.dz)(X)}),pages:(0,i.Ry)({byId:(0,i.dz)(he)}),components:(0,i.Ry)({byId:(0,i.dz)(j)}),assets:(0,i.Ry)({byId:(0,i.dz)(be)}),folders:(0,i.Ry)({byId:(0,i.dz)(me)}),designLanguage:(0,i.Ry)({tokensById:(0,i.dz)(je),categoriesById:(0,i.dz)(Oe),textStyleSetsById:(0,i.dz)(we)}),cloudComponents:(0,i.Ry)({byId:(0,i.dz)(Te)}),customFiles:(0,i.Ry)({byId:(0,i.dz)(Pe)}),classes:Fe,projectFiles:Be,collaborators:(0,i.Ry)({byId:(0,i.dz)(Ae)}),accessType:(0,i.G0)((0,i.a9)(Ze.W.PUBLIC),(0,i.a9)(Ze.W.PRIVATE),(0,i.a9)(Ze.W.CLONEABLE)),mediaQueryBreakpoints:(0,i.Ry)({byId:(0,i.dz)((0,i.Vo)((()=>He)))}),tailwindCSS:(0,i.Ry)({byId:(0,i.dz)((0,i.dz)((0,i.Z_)()))})}),He=(0,i.Ry)({id:(0,i.Z_)(),icon:(0,i.G0)((0,i.a9)($e.yy["viewport/desktop"]),(0,i.a9)($e.yy["viewport/mobile"]),(0,i.a9)($e.yy["viewport/ultrawide"]),(0,i.a9)($e.yy["viewport/mobile-landscape"]),(0,i.a9)($e.yy["viewport/laptop"]),(0,i.a9)($e.yy["viewport/tablet"])),maxWidth:(0,i.Rx)(),isDefault:(0,i.jt)((0,i.O7)()),isDisabled:(0,i.jt)((0,i.O7)())});var Ke=Object.freeze(new class{constructor(){(0,o.Z)(this,"validate",(e=>{const t=Ge.runWithException(JSON.parse(JSON.stringify(e)));return(e=>{const t=Object.keys(e.components.byId||{});Object.values(e.pages.byId||{}).map((e=>{Object.keys(null===e||void 0===e?void 0:e.usedComponents).length>0&&Object.keys(e.usedComponents).forEach((n=>{if(!t.includes(n))throw new r(`Component ${n} in ${e.title} is missing from the snapshot`);if(e.usedComponents[n]<1||!e.usedComponents[n]||void 0===!e.usedComponents[n])throw new r(`Component ${n} is referred ${e.usedComponents[n]} times which is invalid`)}))}))})(t),t}))}})},63193:function(e,t,n){n.d(t,{h:function(){return f}});var o=n(777460),i=n(676422),s=n.n(i),r=n(202784),a=n(378888);const c="pt-btn-group",l=[".pt-btn-group.jsx-853287781{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;width:100%;}",".grid-container.jsx-853287781{display:grid;grid-template-columns:repeat(3,minmax(0,1fr));width:100%;place-items:center;}"];l.__hash="853287781";var d=n(273231),p=n(768e3),u=n(552322);function h(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function y(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?h(Object(n),!0).forEach((function(t){(0,o.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):h(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}const m={default:"start",center:"center","space-between":"space-between",stretch:"stretch",end:"end"},f=e=>{const{children:t,arrangement:n,alignment:o="default",cornerStyle:i="sharp",onSelectionChange:h,behavior:f,gap:g}=e,_=e.selectedButton?[].concat(e.selectedButton):[],b=r.Children.map(t,(e=>{let t={};if(null!==e&&e.props){if("tabs"===f||"toggles"===f&&e.props){const n=e.props.cornerStyle||"sharp",o=e.props.actionName;t=y(y({},t),{},{cornerStyle:n,isPressed:-1!==_.indexOf(o),onChange:()=>h&&h(o)})}if("cross"===n){const n=e.props.positionInGrid;t=y(y({},t),{},{positionInGrid:n})}return r.cloneElement(e,t)}}));return(0,u.jsxs)("div",{className:`jsx-${l.__hash} `+s().dynamic([["3330094067",[c,n,m[o],d.Rh[i],c,"stretch"===o?1:"inherit",c,"row"===n&&g?p.m[g]:"0px","column"===n&&g?p.m[g]:"0px"]]])+" "+`${"cross"===n&&"grid-container"} ${(0,a.x8)(c)}`,children:[b,(0,u.jsx)(s(),{id:l.__hash,children:l}),(0,u.jsx)(s(),{id:"3330094067",dynamic:[c,n,m[o],d.Rh[i],c,"stretch"===o?1:"inherit",c,"row"===n&&g?p.m[g]:"0px","column"===n&&g?p.m[g]:"0px"],children:[`.pt-btn-group.__jsx-style-dynamic-selector{-webkit-flex-direction:${n};-ms-flex-direction:${n};flex-direction:${n};-webkit-box-pack:${m[o]};-webkit-justify-content:${m[o]};-ms-flex-pack:${m[o]};justify-content:${m[o]};border-radius:${d.Rh[i]};}`,`.pt-btn-group.__jsx-style-dynamic-selector>*{-webkit-flex:${"stretch"===o?1:"inherit"};-ms-flex:${"stretch"===o?1:"inherit"};flex:${"stretch"===o?1:"inherit"};}`,`.pt-btn-group.__jsx-style-dynamic-selector>* + *{margin-left:${"row"===n&&g?p.m[g]:"0px"};margin-top:${"column"===n&&g?p.m[g]:"0px"};}`]})]})};f.defaultProps={arrangement:"row",behavior:"none",alignment:"default"}},636201:function(e,t,n){n.d(t,{S:function(){return m}});var o=n(777460),i=n(676422),s=n.n(i),r=n(202784),a=n(378888),c=n(781872);const l="pt-input",d=e=>(0,a.x8)(l,e.size,e.style),p=[".pt-input.jsx-1974129866{position:relative;display:-webkit-inline-box;display:-webkit-inline-flex;display:-ms-inline-flexbox;display:inline-flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;}",".input-addon-wrapper.jsx-1974129866{display:-webkit-inline-box;display:-webkit-inline-flex;display:-ms-inline-flexbox;display:inline-flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;border:none;}",`.pt-input.jsx-1974129866 input.jsx-1974129866{background-color:transparent;color:${c.DM.GRAY_1000};text-align:inherit;width:100%;outline:none;text-overflow:ellipsis;overflow:hidden;white-space:nowrap;height:${c.N_.THREE_UNITS};padding-left:${c.N_.HALF_UNIT};}`,".pt-input.tiny.jsx-1974129866 input.jsx-1974129866{width:35px;}",".pt-input.short.jsx-1974129866 input.jsx-1974129866{width:50px;}",".pt-input.medium.jsx-1974129866 input.jsx-1974129866{width:100px;}",".pt-input.long.jsx-1974129866 input.jsx-1974129866{width:125px;}",".pt-input.flexible.jsx-1974129866,.pt-input.flexible.jsx-1974129866 input.jsx-1974129866{width:100%;}",".pt-input.jsx-1974129866 .height-lg.jsx-1974129866>input.jsx-1974129866{height:32px;padding:8px;}",".pt-input.adaptive.jsx-1974129866,.pt-input.jsx-1974129866 .input-addon-wrapper.adaptive.jsx-1974129866,.pt-input.adaptive.jsx-1974129866 input.jsx-1974129866{max-width:100%;width:-webkit-max-content;width:-moz-max-content;width:max-content;}",".pt-input.label.jsx-1974129866 input.jsx-1974129866{padding-left:0px;}",`.pt-input.transparent.jsx-1974129866 input.jsx-1974129866{padding-left:0px;color:${c.DM.GRAY_900};}`,`.pt-input.label.jsx-1974129866 input.jsx-1974129866:not(:hover):not(:focus){color:${c.DM.GRAY_900};}`,`.pt-input.jsx-1974129866 input.jsx-1974129866::-webkit-input-placeholder{color:${c.DM.GRAY_700};font-style:italic;opacity:1;}`,`.pt-input.jsx-1974129866 input.jsx-1974129866::-moz-placeholder{color:${c.DM.GRAY_700};font-style:italic;opacity:1;}`,`.pt-input.jsx-1974129866 input.jsx-1974129866:-ms-input-placeholder{color:${c.DM.GRAY_700};font-style:italic;opacity:1;}`,`.pt-input.jsx-1974129866 input.jsx-1974129866::placeholder{color:${c.DM.GRAY_700};font-style:italic;opacity:1;}`,`.pt-input.transparent.jsx-1974129866 input.jsx-1974129866::-webkit-input-placeholder{color:${c.DM.GRAY_600};font-style:italic;opacity:1;}`,`.pt-input.transparent.jsx-1974129866 input.jsx-1974129866::-moz-placeholder{color:${c.DM.GRAY_600};font-style:italic;opacity:1;}`,`.pt-input.transparent.jsx-1974129866 input.jsx-1974129866:-ms-input-placeholder{color:${c.DM.GRAY_600};font-style:italic;opacity:1;}`,`.pt-input.transparent.jsx-1974129866 input.jsx-1974129866::placeholder{color:${c.DM.GRAY_600};font-style:italic;opacity:1;}`,".input-addon-wrapper.flexible.jsx-1974129866{width:100%;}",`.input-addon-wrapper.line.jsx-1974129866{border:none;border-bottom:1px solid ${c.DM.GRAY_400};}`,`.input-addon-wrapper.line.jsx-1974129866:hover{border-color:${c.DM.GRAY_500};}`,`.input-addon-wrapper.line.jsx-1974129866:focus-within{border-color:${c.DM.ACCENT_500};}`,".input-addon-wrapper.transparent.jsx-1974129866{border:none;border-bottom:1px solid transparent;}",`.input-addon-wrapper.transparent.jsx-1974129866:hover{border-color:${c.DM.GRAY_500};}`,`.input-addon-wrapper.transparent.jsx-1974129866:focus-within{border-color:${c.DM.ACCENT_500};}`,".input-addon-wrapper.boxed.jsx-1974129866{border:0;}",".input-addon-wrapper.label.jsx-1974129866{border-bottom:1px solid transparent;}",`.input-addon-wrapper.label.jsx-1974129866:focus-within{border-color:${c.DM.ACCENT_500};}`,`.line-label.jsx-1974129866{margin-right:${c.N_.UNIT};pointer-events:none;}`,`.boxed-label.jsx-1974129866{position:absolute;left:${c.N_.UNIT};top:${c.N_.HALF_UNIT};-webkit-transition:${c.OK.MOVE};transition:${c.OK.MOVE};text-transform:capitalize;pointer-events:none;color:${c.DM.GRAY_700};}`,`.field-active.jsx-1974129866{-webkit-transform:translateY(-10px);-ms-transform:translateY(-10px);transform:translateY(-10px);padding:0 ${c.N_.HALF_UNIT};font-size:9px;color:${c.DM.ACCENT_500};}`,`.input-border.jsx-1974129866{border:1px solid ${c.DM.GRAY_400};position:absolute;top:-5px;left:0;bottom:0;right:0;margin:0;pointer-events:none;border-radius:4px;}`,`.input-border-label.jsx-1974129866{width:auto;height:11px;font-size:9px;display:block;padding:0;max-width:0.01px;visibility:hidden;-webkit-transition:${c.OK.MOVE};transition:${c.OK.MOVE};}`,".input-border-label.jsx-1974129866>span.jsx-1974129866{padding:0 2px;}",`.pt-input.boxed.jsx-1974129866 input.jsx-1974129866:hover+.input-border.jsx-1974129866{border:1px solid ${c.DM.GRAY_500};}`,`.pt-input.boxed.jsx-1974129866 input.jsx-1974129866:focus+.input-border.jsx-1974129866{border-color:${c.DM.ACCENT_500};}`,".pt-input.boxed.jsx-1974129866 input.jsx-1974129866:focus+.input-border.jsx-1974129866 .input-border-label.jsx-1974129866{max-width:100px;}",`.not-valid.jsx-1974129866,.not-valid.jsx-1974129866 .input-border.jsx-1974129866{border-color:${c.DM.DANGER} !important;}`,"input[type='number'].jsx-1974129866::-webkit-outer-spin-button,input[type='number'].jsx-1974129866::-webkit-inner-spin-button{-webkit-appearance:none;margin:0;}","input[disabled].jsx-1974129866{pointer-events:none;}"];p.__hash="1974129866";var u=n(552322);function h(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function y(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?h(Object(n),!0).forEach((function(t){(0,o.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):h(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}const m=(0,r.forwardRef)(((e,t)=>{const{value:n="",defaultValue:o,placeholder:i,label:a,color:c,refAttrs:l,dataAttrs:h,onChange:m,onFocus:f,onKeyDown:g,onBlur:_,selectOnFocus:b,addonAfter:I,style:v,size:w,height:O="md",isDisabled:j,autofocusOnMount:S,validationMessage:N,disableDrag:D,type:E,allowOnlyPositiveNumbers:T}=e,P=t||(0,r.createRef)(),C=a?(0,r.createRef)():null,{0:x,1:A}=(0,r.useState)(n),{0:F,1:k}=(0,r.useState)("");(0,r.useEffect)((()=>{null!==l&&void 0!==l&&l.autoFocus&&null!==P&&void 0!==P&&P.current&&P.current.focus(),C&&C.current&&e.size&&k(((e,t)=>{switch(t){case"short":return`${e.getBoundingClientRect().width+50}px`;case"long":return`${e.getBoundingClientRect().width+100}px`;default:return"100%"}})(null===C||void 0===C?void 0:C.current,e.size))}),[]),(0,r.useEffect)((()=>{P.current&&P.current.scrollWidth>P.current.clientWidth&&P.current.setAttribute("title",String(n)),"adaptive"===w&&P.current&&(P.current.style.width=n?String(n).length+1+"ch":"20px")}),[n]);return(0,u.jsxs)("div",{style:{width:a&&"line"===v?F:void 0},className:`jsx-${p.__hash} `+(d(e)||""),children:[a&&(0,u.jsx)("label",{htmlFor:a,ref:C,className:`jsx-${p.__hash} ${v}-label`,children:a}),(0,u.jsxs)("div",{className:`jsx-${p.__hash} input-addon-wrapper ${v} ${w} height-${O} ${N?"not-valid":""}`,children:[(0,u.jsx)("input",y(y(y({id:"boxed"===v?a:void 0,type:E},l),h),{},{style:y(y({},(null===l||void 0===l?void 0:l.style)||{}),{},{color:c}),ref:P,value:n,defaultValue:o,placeholder:i,onDragStart:e=>{D&&e.preventDefault()},min:"number"===E&&T?0:void 0,onChange:e=>{if(A(e.target.value),m&&m(e),"adaptive"===w&&P.current){const t=e.currentTarget.value;P.current.style.width=t?t.length+1+"ch":"20px"}},onKeyDown:e=>{var t;"Enter"===e.key&&(null===(t=P.current)||void 0===t||t.blur());g&&g(e)},onBlur:e=>{var t;a&&!x&&(null===C||void 0===C||null===(t=C.current)||void 0===t||t.classList.remove("field-active"));_&&_(e)},onFocus:t=>{var n;(b&&t.currentTarget.select(),a&&"boxed"===e.style)&&(null===C||void 0===C||null===(n=C.current)||void 0===n||n.classList.add("field-active"));f&&f(t)},disabled:j||(null===l||void 0===l?void 0:l.disabled),autoFocus:S,className:`jsx-${p.__hash} `+(h&&null!=h.className&&h.className||l&&null!=l.className&&l.className||"")})),"boxed"===v&&(0,u.jsx)("fieldset",{className:`jsx-${p.__hash} input-border`,children:(0,u.jsx)("legend",{className:`jsx-${p.__hash} input-border-label`,children:a&&(0,u.jsx)("span",{className:`jsx-${p.__hash}`,children:a})})}),I]}),(0,u.jsx)(s(),{id:p.__hash,children:p})]})}));m.defaultProps={size:"medium",type:"text",style:"line",selectOnFocus:!0}},5220:function(e,t,n){n.d(t,{E:function(){return f}});var o=n(777460),i=n(676422),s=n.n(i),r=n(768e3),a=n(202784),c=n(378888),l=n(781872);const d="thq-select-list",p=e=>(0,c.x8)(d,e.noPadding&&"no-padding"),u=[`.${d}.jsx-4074416474{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-flow:column;-ms-flex-flow:column;flex-flow:column;width:100%;padding:0 ${l.N_.UNIT};outline:none;box-shadow:none;}`,`.${d}.no-padding.jsx-4074416474{padding:0;}`];u.__hash="4074416474";var h=n(552322);function y(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function m(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?y(Object(n),!0).forEach((function(t){(0,o.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):y(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}const f=a.forwardRef(((e,t)=>{const{refAttrs:n,dataAttrs:o,children:i,onSelect:c,onDoubleClick:l,onContextMenu:d,onMouseOut:y,onMouseOver:f,gap:g="none"}=e,_=e=>{const t=e.target.closest("[data-item-id]");if(!t)return null;const n=t.dataset.itemId;return n||null},b=a.useCallback((e=>{const t=_(e);t&&(e.target.closest("[disabled]")||null===c||void 0===c||c(t,e))}),[c]),I=a.useCallback((e=>{const t=_(e);t&&(null===l||void 0===l||l(t))}),[l]),v=a.useCallback((e=>{const t=_(e);t&&d&&(e.preventDefault(),e.stopPropagation(),d(t,e))}),[d]),w=a.useCallback((e=>{const t=_(e);if(!t)return;const n=e.target.closest("[data-item-id]");if(!n)return;const o=n.children[0].classList.contains("letPropagate");f&&(e.preventDefault(),o||e.stopPropagation(),f(t))}),[f]),O=a.useCallback((e=>{const t=_(e);t&&y&&(e.preventDefault(),e.stopPropagation(),y(t))}),[y]);return(0,h.jsxs)("ul",m(m(m({ref:t},n),o),{},{role:"listbox",tabIndex:0,onClick:b,onDoubleClick:I,onContextMenu:v,onMouseOver:w,onMouseOut:O,style:{gap:r.m[g]},className:`jsx-${u.__hash} `+(p(e)||""),children:[i,(0,h.jsx)(s(),{id:u.__hash,children:u})]}))}));f.displayName="SelectList"},893291:function(e,t,n){n.d(t,{r:function(){return u}});var o=n(676422),i=n.n(o),s=n(202784),r=n(781872),a=n(378888);const c="pt-switch",l=e=>(0,a.x8)(c,e.size),d=[".pt-switch.jsx-1597725481{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;width:-webkit-max-content;width:-moz-max-content;width:max-content;}",".pt-switch.jsx-1597725481 .toggle.jsx-1597725481{position:relative;display:inline-block;width:30px;height:16px;}",".pt-switch.large.jsx-1597725481 .toggle.jsx-1597725481{width:50px;height:25px;}",".pt-switch.medium.jsx-1597725481 .toggle.jsx-1597725481{width:45px;height:20px;}",`.pt-switch.jsx-1597725481 .label-text.jsx-1597725481{padding:0px ${r.N_.HALF_UNIT};color:${r.DM.GRAY_900};-webkit-transition:${r.OK.FADE};transition:${r.OK.FADE};max-width:130px;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;}`,`.pt-switch.jsx-1597725481 .label-text.paddingRight.jsx-1597725481{padding:0px ${r.N_.UNIT} 0px 0px;}`,`.pt-switch.jsx-1597725481 .label-text.inactive.jsx-1597725481{color:${r.DM.GRAY_700};}`,`.pt-switch.jsx-1597725481 .label-text.purple.jsx-1597725481{color:${r.DM.PURPLE_500};}`,`.pt-switch.jsx-1597725481:hover .label-text.jsx-1597725481{color:${r.DM.GRAY_1000};}`,".pt-switch.jsx-1597725481 .checkbox.jsx-1597725481{opacity:0;width:0;height:0;}",`.pt-switch.jsx-1597725481 .slider.jsx-1597725481{position:absolute;top:0;left:0;right:0;bottom:0;background-color:${r.DM.GRAY_500};-webkit-transition:${r.OK.FADE};transition:${r.OK.FADE};border-radius:16px;}`,`.pt-switch.jsx-1597725481:hover .slider.jsx-1597725481:before{background-color:${r.DM.GRAY_1000};}`,`.pt-switch.jsx-1597725481:hover .checkbox.jsx-1597725481:checked+.slider.jsx-1597725481{background-color:${r.DM.ACCENT_600};}`,`.pt-switch.jsx-1597725481:hover .checkbox.jsx-1597725481:disabled+.slider.jsx-1597725481{background-color:${r.DM.GRAY_500};}`,`[data-whatintent='keyboard'] .pt-switch.jsx-1597725481 .checkbox.jsx-1597725481:focus+.slider.jsx-1597725481{box-shadow:${r.E6.OUTLINE};}`,`.pt-switch.jsx-1597725481 .slider.jsx-1597725481:before{position:absolute;content:'';height:12px;width:12px;top:2px;left:2px;background-color:${r.DM.GRAY_800};-webkit-transition:${r.OK.MOVE};transition:${r.OK.MOVE};border-radius:50%;}`,".pt-switch.large.jsx-1597725481 .slider.jsx-1597725481:before{height:21px;width:21px;}",".pt-switch.medium.jsx-1597725481 .slider.jsx-1597725481:before{height:16px;width:16px;}",`.pt-switch.jsx-1597725481 .checkbox.jsx-1597725481:checked+.slider.jsx-1597725481{background-color:${r.DM.ACCENT_500};}`,`.pt-switch.jsx-1597725481 .checkbox.jsx-1597725481:disabled+.slider.jsx-1597725481{background-color:${r.DM.GRAY_500};}`,`.pt-switch.jsx-1597725481 .checkbox.jsx-1597725481:checked+.slider.jsx-1597725481:before{background-color:${r.DM.GRAY_1000};}`,".pt-switch.jsx-1597725481 .checkbox.jsx-1597725481:checked+.slider.jsx-1597725481:before{-webkit-transform:translateX(15px);-ms-transform:translateX(15px);transform:translateX(15px);}",".pt-switch.large.jsx-1597725481 .checkbox.jsx-1597725481:checked+.slider.jsx-1597725481:before{-webkit-transform:translateX(25px);-ms-transform:translateX(25px);transform:translateX(25px);}",".pt-switch.medium.jsx-1597725481 .checkbox.jsx-1597725481:checked+.slider.jsx-1597725481:before{-webkit-transform:translateX(24px);-ms-transform:translateX(24px);transform:translateX(24px);}",`.pt-switch.jsx-1597725481 .checkbox.jsx-1597725481:disabled+.slider.jsx-1597725481:before{background-color:${r.DM.GRAY_1000};}`,`body.light-theme .pt-switch.jsx-1597725481 .slider.jsx-1597725481{background:${r.DM.GRAY_300};}`,`body.light-theme .pt-switch.jsx-1597725481 .slider.jsx-1597725481:before,body.light-theme .pt-switch.jsx-1597725481 .checkbox.jsx-1597725481:checked+.slider.jsx-1597725481:before{background:${r.DM.GRAY_200};}`,`.pt-switch.jsx-1597725481 .label-text-left.jsx-1597725481{margin-right:${r.N_.TWO_UNITS};}`,`.pt-switch.jsx-1597725481 .label-text-right.jsx-1597725481{margin-left:${r.N_.TWO_UNITS};}`];d.__hash="1597725481";var p=n(552322);const u=s.forwardRef(((e,t)=>{const{value:n,defaultValue:o,labelPosition:r,label:a,onChange:c,disabled:u,children:h}=e,{0:y,1:m}=(0,s.useState)(o),f=(0,s.useCallback)((e=>{m(e.target.checked),c&&c(e)}),[c]),g=t=>a&&r===t?"object"!==typeof a?(0,p.jsxs)("span",{className:`jsx-${d.__hash} label-text ${e.padding} ${e.textColor}`,children:[a,(0,p.jsx)(i(),{id:d.__hash,children:d})]}):"object"===typeof a?a:Array.isArray(a)?(0,p.jsx)("span",{className:""+("before"===t?"label-text-left":"label-text-right"),children:a[0]}):void 0:null;return(0,p.jsxs)("label",{className:`jsx-${d.__hash} `+(l(e)||""),children:[g("before"),(0,p.jsxs)("span",{className:`jsx-${d.__hash} toggle`,children:[(0,p.jsx)("input",{ref:t,type:"checkbox",disabled:u,onChange:f,checked:null!==n&&void 0!==n?n:y,className:`jsx-${d.__hash} checkbox`}),(0,p.jsx)("span",{className:`jsx-${d.__hash} slider`}),h]}),g("after"),(0,p.jsx)(i(),{id:d.__hash,children:d})]})}));u.defaultProps={defaultValue:!1,labelPosition:"before"}}}]);
